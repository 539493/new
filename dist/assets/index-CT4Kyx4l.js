import{r as E,a as Jc,R as _,g as bt,c as gt,b as Bo}from"./vendor-tAaa2TlE.js";import{l as Ho}from"./socket-TjCxX7sJ.js";import{R as Xc,a as ei,B as Qc}from"./router-Skg1zGfq.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var zo={exports:{}},Gs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zc=E,ed=Symbol.for("react.element"),td=Symbol.for("react.fragment"),rd=Object.prototype.hasOwnProperty,sd=Zc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nd={key:!0,ref:!0,__self:!0,__source:!0};function Go(t,r,s){var n,a={},i=null,o=null;s!==void 0&&(i=""+s),r.key!==void 0&&(i=""+r.key),r.ref!==void 0&&(o=r.ref);for(n in r)rd.call(r,n)&&!nd.hasOwnProperty(n)&&(a[n]=r[n]);if(t&&t.defaultProps)for(n in r=t.defaultProps,r)a[n]===void 0&&(a[n]=r[n]);return{$$typeof:ed,type:t,key:i,ref:o,props:a,_owner:sd.current}}Gs.Fragment=td;Gs.jsx=Go;Gs.jsxs=Go;zo.exports=Gs;var e=zo.exports,qo,ti=Jc;qo=ti.createRoot,ti.hydrateRoot;const Ge=[];for(let t=0;t<256;++t)Ge.push((t+256).toString(16).slice(1));function ad(t,r=0){return(Ge[t[r+0]]+Ge[t[r+1]]+Ge[t[r+2]]+Ge[t[r+3]]+"-"+Ge[t[r+4]]+Ge[t[r+5]]+"-"+Ge[t[r+6]]+Ge[t[r+7]]+"-"+Ge[t[r+8]]+Ge[t[r+9]]+"-"+Ge[t[r+10]]+Ge[t[r+11]]+Ge[t[r+12]]+Ge[t[r+13]]+Ge[t[r+14]]+Ge[t[r+15]]).toLowerCase()}let vn;const id=new Uint8Array(16);function od(){if(!vn){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");vn=crypto.getRandomValues.bind(crypto)}return vn(id)}const ld=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ri={randomUUID:ld};function cd(t,r,s){var a;if(ri.randomUUID&&!t)return ri.randomUUID();t=t||{};const n=t.random??((a=t.rng)==null?void 0:a.call(t))??od();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,ad(n)}const Re="https://nauchi.onrender.com",dd="https://nauchi.onrender.com",ud={transports:["websocket","polling"],timeout:1e4,forceNew:!0,upgrade:!0,rememberUpgrade:!0};window.location.hostname.includes("onrender.com");const Yo=E.createContext(void 0),tt=()=>{const t=E.useContext(Yo);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},dr=()=>{try{const t=localStorage.getItem("tutoring_users");return t?JSON.parse(t):[]}catch{return[]}},vs=t=>{try{localStorage.setItem("tutoring_users",JSON.stringify(t)),window.dispatchEvent(new StorageEvent("storage",{key:"tutoring_users",newValue:JSON.stringify(t),oldValue:localStorage.getItem("tutoring_users"),storageArea:localStorage})),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_users",newValue:JSON.stringify(t),oldValue:localStorage.getItem("tutoring_users")}}))}catch{}},bs=t=>{try{localStorage.setItem("tutoring_currentUser",JSON.stringify(t))}catch{}},md=()=>{try{const t=localStorage.getItem("tutoring_currentUser");return t?JSON.parse(t):null}catch{return null}},hd=({children:t})=>{const[r,s]=E.useState(()=>{try{return md()}catch{return null}}),[n,a]=E.useState(!1);let i=null;try{const m=_.useContext(require("./DataContext").DataContext);m&&(i=m.deleteUserData)}catch{}if(E.useEffect(()=>{const b=setTimeout(()=>{try{const j=dr();a(!0)}catch{a(!0)}},100);return()=>clearTimeout(b)},[]),!n)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Инициализация авторизации..."})]})});const o=async(m,b)=>{await new Promise(u=>setTimeout(u,1e3));const h=dr().find(u=>u.email===m);return h?(s(h),bs(h),!0):(alert("Пользователь с таким email не найден. Пожалуйста, зарегистрируйтесь."),!1)},l=async(m,b,j,h,u,w)=>{try{const x=await fetch(`${Re}/api/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:m,password:b,name:j,nickname:h,role:u,phone:w})});if(!x.ok){const P=await x.text();try{const A=JSON.parse(P);alert(A.error||"Ошибка регистрации на сервере")}catch{alert("Ошибка регистрации на сервере. Используется локальная регистрация.")}throw new Error("Server registration failed")}const S=await x.json(),D=[...dr(),S];vs(D),s(S),bs(S);try{const P=await fetch(`${Re}/api/sync`);if(P.ok){const A=await P.json();console.log("✅ Данные синхронизированы после регистрации"),A.teacherProfiles&&localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(A.teacherProfiles)),A.studentProfiles&&localStorage.setItem("tutoring_studentProfiles",JSON.stringify(A.studentProfiles));const H=[];A.teacherProfiles&&Object.entries(A.teacherProfiles).forEach(([O,z])=>{H.push({id:O,email:z.email||"",name:z.name||"",nickname:z.nickname||"",role:"teacher",phone:z.phone||"",profile:z})}),A.studentProfiles&&Object.entries(A.studentProfiles).forEach(([O,z])=>{H.push({id:O,email:z.email||"",name:z.name||"",nickname:z.nickname||"",role:"student",phone:z.phone||"",profile:z})}),localStorage.setItem("tutoring_users",JSON.stringify(H)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_users",newValue:JSON.stringify(H)}}))}}catch(P){console.warn("⚠️ Не удалось синхронизировать данные после регистрации:",P)}return!0}catch{const S=dr(),v=S.some(O=>O.email===m),D=S.some(O=>O.nickname===h);if(v)return alert("Пользователь с таким email уже существует"),!1;if(D)return alert("Пользователь с таким никнеймом уже существует"),!1;const P=u==="teacher"?{subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,education:{university:"",degree:"",graduationYear:void 0,courses:[]}}:{grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""},A={id:cd(),email:m,name:j,nickname:h,role:u,phone:w,profile:P,avatar:P.avatar},H=[...S,A];if(vs(H),s(A),bs(A),u==="teacher"){const O=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");O[A.id]=P,localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(O)),console.log("✅ Профиль преподавателя сохранен локально:",A.id),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_teacherProfiles",newValue:JSON.stringify(O)}}))}if(u==="student"){const O=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");O[A.id]=P,localStorage.setItem("tutoring_studentProfiles",JSON.stringify(O)),console.log("✅ Профиль студента сохранен локально:",A.id),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_studentProfiles",newValue:JSON.stringify(O)}}))}try{const O=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}"),z=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}"),R=JSON.parse(localStorage.getItem("tutoring_users")||"[]");if(Object.keys(O).length>0||Object.keys(z).length>0){const K=await fetch(`${Re}/api/upload-local-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherProfiles:O,studentProfiles:z,users:R})});if(K.ok){const Y=await K.json();console.log("✅ Локальные данные загружены на сервер:",Y),alert("Регистрация выполнена локально и данные синхронизированы с сервером!")}else console.warn("⚠️ Не удалось загрузить локальные данные на сервер"),alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}else alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}catch(O){console.warn("⚠️ Ошибка загрузки локальных данных на сервер:",O),alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}return!0}},c=()=>{s(null),localStorage.removeItem("tutoring_currentUser")},d=m=>{if(r){const b={...r,profile:m,avatar:m.avatar};s(b),bs(b);const h=dr().map(u=>u.id===r.id?b:u);vs(h),typeof window<"u"&&window.location.hostname!=="localhost"&&fetch("https://tutoring-platform-1756666331-zjfl.onrender.com/api/updateProfile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.id,profileData:m,role:r.role})}).then(u=>{if(u.ok){console.log("Profile updated successfully on server");const w=window.socket;w&&w.emit("profileUpdated",{userId:r.id,profileData:m,role:r.role})}else console.error("Failed to update profile on server:",u.status)}).catch(u=>{console.error("Failed to update profile on server:",u)})}},f=()=>{s(null),localStorage.removeItem("tutoring_users"),localStorage.removeItem("tutoring_currentUser")},g=async()=>{if(!r)return alert("Пользователь не найден"),!1;if(!window.confirm("Вы уверены, что хотите удалить свой аккаунт? Это действие нельзя отменить. Все ваши данные будут безвозвратно удалены."))return!1;try{(await fetch(`${Re}/api/delete-user`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.id,role:r.role})})).ok||console.warn("Не удалось удалить пользователя с сервера, продолжаем локальное удаление");const h=dr().filter(u=>u.id!==r.id);if(vs(h),r.role==="teacher"){const u=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");delete u[r.id],localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(u)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_teacherProfiles",newValue:JSON.stringify(u)}}))}else if(r.role==="student"){const u=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");delete u[r.id],localStorage.setItem("tutoring_studentProfiles",JSON.stringify(u)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_studentProfiles",newValue:JSON.stringify(u)}}))}if(i)i(r.id);else{const w=JSON.parse(localStorage.getItem("tutoring_timeSlots")||"[]").filter(z=>z.teacherId!==r.id);localStorage.setItem("tutoring_timeSlots",JSON.stringify(w));const S=JSON.parse(localStorage.getItem("tutoring_lessons")||"[]").filter(z=>z.teacherId!==r.id&&z.studentId!==r.id);localStorage.setItem("tutoring_lessons",JSON.stringify(S));const D=JSON.parse(localStorage.getItem("tutoring_chats")||"[]").filter(z=>!z.participants.includes(r.id));localStorage.setItem("tutoring_chats",JSON.stringify(D));const A=JSON.parse(localStorage.getItem("tutoring_posts")||"[]").filter(z=>z.userId!==r.id);localStorage.setItem("tutoring_posts",JSON.stringify(A));const O=JSON.parse(localStorage.getItem("tutoring_notifications")||"[]").filter(z=>z.userId!==r.id);localStorage.setItem("tutoring_notifications",JSON.stringify(O))}return c(),alert("Аккаунт успешно удален"),!0}catch(b){return console.error("Ошибка при удалении аккаунта:",b),alert("Произошла ошибка при удалении аккаунта"),!1}};return e.jsx(Yo.Provider,{value:{user:r,login:o,register:l,logout:c,updateProfile:d,clearAllUsers:f,deleteAccount:g},children:t})},Vo=E.createContext(void 0),ct=()=>{const t=E.useContext(Vo);if(!t)throw new Error("useData must be used within a DataProvider");return t},mt=(t,r)=>{try{const s=localStorage.getItem(t);if(s){const n=JSON.parse(s);return Array.isArray(n)?n:r}}catch{}return r},Q=(t,r)=>{try{localStorage.setItem(t,JSON.stringify(r))}catch{}},ys=()=>{const t=new Date,r=new Date(t);r.setDate(r.getDate()+1);const s=new Date(t);s.setDate(s.getDate()+2);const n=new Date(t);return n.setDate(n.getDate()+7),{timeSlots:[],lessons:[],chats:[],studentProfiles:{},teacherProfiles:{}}},fd=({children:t})=>{const r=E.useRef(null),[s,n]=E.useState(!0),[a,i]=E.useState(()=>{const $=mt("tutoring_timeSlots",[]);if($.length>0)return $;const U=ys();return Q("tutoring_timeSlots",U.timeSlots),U.timeSlots}),[o,l]=E.useState(()=>mt("tutoring_lessons",[])),[c,d]=E.useState(()=>mt("tutoring_chats",[])),[f,g]=E.useState(()=>{const $=mt("tutoring_studentProfiles",{});if(Object.keys($).length>0)return $;const U=ys();return Q("tutoring_studentProfiles",U.studentProfiles),U.studentProfiles}),[m,b]=E.useState(()=>{const $=mt("tutoring_teacherProfiles",{});if(Object.keys($).length>0)return console.log("📱 Загружены локальные профили преподавателей:",Object.keys($).length),$;const U=ys();return Q("tutoring_teacherProfiles",U.teacherProfiles),U.teacherProfiles}),[j,h]=E.useState(()=>{try{const $=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("🔄 Загружаем пользователей из localStorage при инициализации:",$.length);const U=$.filter(p=>p.role==="teacher");return console.log("👨‍🏫 Зарегистрированных преподавателей в localStorage:",U.length,U.map(p=>({id:p.id,name:p.name}))),$}catch($){return console.error("❌ Ошибка загрузки пользователей из localStorage:",$),[]}}),[u,w]=E.useState(()=>mt("tutoring_posts",[])),[x,S]=E.useState(()=>mt("tutoring_notifications",[])),{user:v,updateProfile:D}=tt(),P=()=>{const $=mt("tutoring_timeSlots",[]),U=mt("tutoring_lessons",[]),p=mt("tutoring_chats",[]),N=ys(),T=($.length>0?$:N.timeSlots).filter((C,M,ae)=>M===ae.findIndex(ce=>ce.id===C.id));i(T),l(U),d(p),g(N.studentProfiles),Q("tutoring_timeSlots",T),Q("tutoring_lessons",U),Q("tutoring_chats",p),Q("tutoring_studentProfiles",N.studentProfiles),ze()},A=async()=>{try{console.log("🔄 Загружаем пользователей с сервера...");const $=await fetch(`${Re}/api/users`);if(!$.ok)return console.warn("⚠️ Не удалось загрузить пользователей с сервера:",$.status),[];const U=await $.json();console.log("✅ Пользователи загружены с сервера:",U.length);const p=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("📱 Локальные пользователи:",p.length);const y=[...p,...U].filter((T,C,M)=>C===M.findIndex(ae=>ae.id===T.id));return console.log("✅ Уникальные пользователи:",y.length),console.log("👨‍🏫 Преподаватели:",y.filter(T=>T.role==="teacher").length),console.log("👨‍🎓 Студенты:",y.filter(T=>T.role==="student").length),h(y),localStorage.setItem("tutoring_users",JSON.stringify(y)),y}catch($){return console.error("❌ Ошибка загрузки пользователей с сервера:",$),[]}},H=async()=>{try{console.log("Loading lessons from server...");const $=await fetch(`${Re}/api/lessons`);if(!$.ok)return console.error("Failed to load lessons from server:",$.status),[];const U=await $.json();console.log("Loaded lessons from server:",U.length,U);const p=JSON.parse(localStorage.getItem("tutoring_lessons")||"[]");console.log("Local lessons:",p.length,p);const y=[...p,...U].filter((T,C,M)=>C===M.findIndex(ae=>ae.id===T.id));return console.log("Setting lessons in context:",y.length,y),l(y),Q("tutoring_lessons",y),y}catch($){return console.error("Error loading lessons from server:",$),[]}},O=()=>{try{console.log("🔄 Принудительное обновление списка пользователей...");const $=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("👥 Загружено пользователей из localStorage:",$.length);const U=$.filter(N=>N.role==="teacher");console.log("👨‍🏫 Зарегистрированных преподавателей:",U.length,U.map(N=>({id:N.id,name:N.name}))),h($);const p=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");console.log("📱 Обновляем teacherProfiles из localStorage:",Object.keys(p).length),b(p),console.log("✅ Обновление пользователей завершено")}catch($){console.error("❌ Ошибка при обновлении пользователей:",$),h([])}},z=()=>{try{console.log("👨‍🏫 Принудительная загрузка зарегистрированных преподавателей...");const $=JSON.parse(localStorage.getItem("tutoring_users")||"[]"),U=$.filter(N=>N.role==="teacher");console.log("📱 Зарегистрированных преподавателей в localStorage:",U.length),U.forEach(N=>{console.log(`  - ${N.name} (${N.email}) - ID: ${N.id}`)}),h($);const p=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");return b(p),console.log("✅ Зарегистрированные преподаватели загружены (независимо от онлайн статуса)"),U}catch($){return console.error("❌ Ошибка загрузки зарегистрированных преподавателей:",$),[]}},R=()=>{console.log("🔄 Принудительное обновление всех данных..."),z(),O(),A(),H(),r.current&&s&&(r.current.emit("requestAllSlots"),r.current.emit("requestAllUsers")),K().catch($=>{console.error("❌ Ошибка при синхронизации данных:",$)})},K=async()=>{try{console.log("🔄 Принудительная синхронизация данных с сервера..."),await A();const $=await fetch(`${Re}/api/sync`,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(1e4)});if(!$.ok){console.warn("⚠️ Не удалось синхронизировать данные с сервера:",$.status,$.statusText);return}const U=$.headers.get("content-type");if(!U||!U.includes("application/json")){console.warn("⚠️ Сервер вернул не-JSON ответ:",U);return}const p=await $.json();console.log("✅ Данные синхронизации получены:",Object.keys(p)),p.timeSlots&&(i(p.timeSlots),Q("tutoring_timeSlots",p.timeSlots),console.log("✅ Слоты обновлены:",p.timeSlots.length)),p.lessons&&(l(p.lessons),Q("tutoring_lessons",p.lessons),console.log("✅ Уроки обновлены:",p.lessons.length)),p.chats&&(d(p.chats),Q("tutoring_chats",p.chats),console.log("✅ Чаты обновлены:",p.chats.length)),p.posts&&(w(p.posts),Q("tutoring_posts",p.posts),console.log("✅ Посты обновлены:",p.posts.length));const N=[];p.teacherProfiles&&(console.log("👨‍🏫 Обновляем профили преподавателей:",Object.keys(p.teacherProfiles).length),Object.entries(p.teacherProfiles).forEach(([y,T])=>{const C=T,M={id:y,email:String(C.email||""),name:String(C.name||""),nickname:String(C.nickname||""),role:"teacher",phone:String(C.phone||""),profile:C};N.push(M),console.log("👨‍🏫 Добавлен преподаватель:",M.id,M.name,M.email)})),p.studentProfiles&&Object.entries(p.studentProfiles).forEach(([y,T])=>{const C=T;N.push({id:y,email:String(C.email||""),name:String(C.name||""),nickname:String(C.nickname||""),role:"student",phone:String(C.phone||""),profile:C})}),h(N),Q("tutoring_users",N),console.log("✅ Синхронизация завершена успешно"),console.log("📊 Итоговые данные:"),console.log("- Всего пользователей:",N.length),console.log("- Преподавателей:",N.filter(y=>y.role==="teacher").length),console.log("- Студентов:",N.filter(y=>y.role==="student").length),console.log("- Пользователи:",N)}catch($){console.warn("Error syncing data (continuing with local data):",$)}},Y=async()=>{try{console.log("📤 Загружаем локальные данные на сервер...");const $=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}"),U=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}"),p=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("📊 Локальные данные:"),console.log(`   👨‍🏫 Преподаватели: ${Object.keys($).length}`),console.log(`   👨‍🎓 Студенты: ${Object.keys(U).length}`),console.log(`   👥 Пользователи: ${p.length}`);const N=await fetch(`${Re}/api/upload-local-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherProfiles:$,studentProfiles:U,users:p})});if(!N.ok){const T=await N.json();throw new Error(T.error||"Ошибка загрузки данных на сервер")}const y=await N.json();return console.log("✅ Локальные данные успешно загружены на сервер:",y),await K(),y}catch($){throw console.error("❌ Ошибка загрузки локальных данных на сервер:",$),$}},ee=async $=>{try{console.log(`🗑️ Удаляем пользователя: ${$}`);const U=await fetch(`${Re}/api/users/${$}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!U.ok){const N=await U.json();throw new Error(N.error||"Ошибка удаления пользователя")}const p=await U.json();return console.log("✅ Пользователь успешно удален:",p),h(N=>{const y=N.filter(T=>T.id!==$);return Q("tutoring_users",y),y}),b(N=>{const y={...N};return delete y[$],Q("tutoring_teacherProfiles",y),y}),g(N=>{const y={...N};return delete y[$],Q("tutoring_studentProfiles",y),y}),i(N=>N.filter(y=>y.teacherId!==$)),l(N=>N.filter(y=>y.teacherId!==$&&y.studentId!==$)),d(N=>N.filter(y=>!y.participants.includes($))),w(N=>N.filter(y=>y.userId!==$)),S(N=>N.filter(y=>y.userId!==$)),!0}catch(U){return console.error("❌ Ошибка удаления пользователя:",U),!1}};E.useEffect(()=>{const $=async()=>{try{const p=await fetch(`${Re}/api/health`,{method:"GET",signal:AbortSignal.timeout(5e3)});if(p.ok){const N=await p.json();return console.log("Server health check passed:",N),!0}return!1}catch(p){return console.warn("Server not available, working in offline mode:",p),!1}};(async()=>{if(!await $()){console.log("Server not available, loading local data only"),P(),H();return}console.log("Server is available, initializing Socket.IO connection...");const N=Ho(Re,{...ud,reconnection:!0,reconnectionAttempts:3,reconnectionDelay:2e3,timeout:1e4});return r.current=N,N.on("connect",()=>{n(!0),console.log("✅ Connected to server via Socket.IO"),console.log(`🌐 Server URL: ${Re}`),console.log(`🔌 Socket ID: ${N.id}`),console.log("🔄 Первоначальное подключение - обновляем данные..."),R();const y=mt("tutoring_timeSlots",[]);y.length>0&&y.forEach(T=>{r.current&&r.current.emit("createSlot",T)}),r.current&&(r.current.emit("requestAllPosts"),v&&(r.current.emit("requestUserNotifications",v.id),r.current.emit("subscribeNotifications",v.id)))}),N.on("disconnect",()=>{console.log("🔌 Disconnected from server")}),N.on("reconnect",y=>{n(!0),console.log(`🔄 Reconnected to server after ${y} attempts`),console.log("🔄 Восстановление соединения - обновляем данные..."),R()}),N.on("reconnect_attempt",y=>{console.log(`🔄 Reconnection attempt ${y}`)}),N.on("connect_error",y=>{console.warn("❌ Socket.IO connection error:",y),console.warn("🔧 Working in offline mode until reconnection..."),P(),H()}),N.on("initialData",y=>{const M=[...mt("tutoring_timeSlots",[]),...y.timeSlots].filter((ae,ce,Me)=>ce===Me.findIndex(F=>F.id===ae.id));i(M),l(y.lessons),Q("tutoring_timeSlots",M),Q("tutoring_lessons",y.lessons),y.chats&&(d(y.chats),Q("tutoring_chats",y.chats))}),N.on("allSlots",y=>{i(y),Q("tutoring_timeSlots",y)}),N.on("allUsers",y=>{h(y),Q("tutoring_users",y)}),r.current&&s&&(r.current.emit("requestAllSlots"),r.current.emit("requestAllUsers")),N.on("slotCreated",y=>{console.log("Slot created via WebSocket:",y),i(T=>{if(T.find(M=>M.id===y.id)){const M=T.map(ae=>ae.id===y.id?y:ae);return Q("tutoring_timeSlots",M),console.log("Existing slot updated, total slots:",M.length),M}else{const M=[...T,y];return Q("tutoring_timeSlots",M),console.log("New slot added, total slots:",M.length),M}})}),N.on("slotBooked",y=>{console.log("Slot booked via WebSocket:",y),i(T=>{const C=T.map(M=>M.id===y.slotId?{...M,isBooked:!0,bookedStudentId:y.bookedStudentId||y.lesson.studentId}:M);return Q("tutoring_timeSlots",C),C}),l(T=>{if(!T.find(M=>M.id===y.lesson.id)){const M=[...T,y.lesson];return Q("tutoring_lessons",M),console.log("New lesson added, total lessons:",M.length),M}return T})}),N.on("slotCancelled",y=>{console.log("Slot cancelled via WebSocket:",y),i(T=>{const C=T.map(M=>M.id===y.slotId?{...M,isBooked:!1,bookedStudentId:void 0}:M);return Q("tutoring_timeSlots",C),C}),l(T=>{const C=T.filter(M=>M.id!==y.lessonId);return Q("tutoring_lessons",C),console.log("Lesson removed, total lessons:",C.length),C})}),N.on("chatCreated",y=>{d(T=>{if(!T.find(M=>M.id===y.id)){const M=[...T,y];return Q("tutoring_chats",M),M}return T})}),N.on("receiveMessage",y=>{d(T=>T.map(C=>{if(C.id===y.chatId){const M={...C,messages:[...C.messages,y.message],lastMessage:y.message};return Q("tutoring_chats",T.map(ae=>ae.id===C.id?M:ae)),M}return C}))}),N.on("chatDeleted",y=>{console.log("chatDeleted event received:",y),d(T=>{const C=T.filter(M=>M.id!==y.chatId);return console.log(`Chat ${y.chatId} removed from state. Total chats: ${C.length}`),Q("tutoring_chats",C),C})}),N.on("chatMarkedAsRead",y=>{d(T=>{const C=T.map(M=>M.id===y.chatId?{...M,messages:M.messages.map(ae=>({...ae,isRead:!0}))}:M);return Q("tutoring_chats",C),C})}),N.on("chatMessagesCleared",y=>{d(T=>{const C=T.map(M=>M.id===y.chatId?{...M,messages:[]}:M);return Q("tutoring_chats",C),C})}),N.on("chatArchived",y=>{d(T=>{const C=T.map(M=>M.id===y.chatId?{...M,archived:!0}:M);return Q("tutoring_chats",C),C})}),N.on("chatUnarchived",y=>{d(T=>{const C=T.map(M=>M.id===y.chatId?{...M,archived:!1}:M);return Q("tutoring_chats",C),C})}),N.on("newNotification",y=>{S(T=>{const C=[...T,y];return Q("tutoring_notifications",C),C})}),N.on("slotDeleted",y=>{console.log("Slot deleted via WebSocket:",y),i(T=>{const C=T.filter(M=>M.id!==y.slotId);return Q("tutoring_timeSlots",C),console.log("Slot removed, total slots:",C.length),C})}),N.on("allSlots",y=>{console.log("Received all slots from server:",y.length),i(y),Q("tutoring_timeSlots",y)}),N.on("allLessons",y=>{console.log("Received all lessons from server:",y.length),l(y),Q("tutoring_lessons",y)}),N.on("dataUpdated",y=>{if(console.log("Received dataUpdated event:",y.type),y.timeSlots&&(i(y.timeSlots),Q("tutoring_timeSlots",y.timeSlots),console.log("Slots updated via dataUpdated:",y.timeSlots.length)),y.lessons&&(l(y.lessons),Q("tutoring_lessons",y.lessons),console.log("Lessons updated via dataUpdated:",y.lessons.length)),y.teacherProfiles){b(y.teacherProfiles),Q("tutoring_teacherProfiles",y.teacherProfiles);const C=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(M=>M.role==="teacher"&&y.teacherProfiles[M.id]?{...M,profile:y.teacherProfiles[M.id]}:M);h(C),Q("tutoring_users",C)}if(y.studentProfiles){g(y.studentProfiles),Q("tutoring_studentProfiles",y.studentProfiles);const C=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(M=>M.role==="student"&&y.studentProfiles[M.id]?{...M,profile:y.studentProfiles[M.id]}:M);h(C),Q("tutoring_users",C)}}),N.on("userRegistered",y=>{h(T=>{if(!T.find(M=>M.id===y.id)){const M=[...T,y];return Q("tutoring_users",M),M}return T})}),N.on("userDeleted",y=>{console.log("🗑️ Получено событие удаления пользователя:",y),h(T=>{const C=T.filter(M=>M.id!==y.userId);return Q("tutoring_users",C),C}),y.userRole==="teacher"?b(T=>{const C={...T};return delete C[y.userId],Q("tutoring_teacherProfiles",C),C}):y.userRole==="student"&&g(T=>{const C={...T};return delete C[y.userId],Q("tutoring_studentProfiles",C),C}),i(T=>T.filter(C=>C.teacherId!==y.userId)),l(T=>T.filter(C=>C.teacherId!==y.userId&&C.studentId!==y.userId)),d(T=>T.filter(C=>!C.participants.includes(y.userId))),w(T=>T.filter(C=>C.userId!==y.userId)),S(T=>T.filter(C=>C.userId!==y.userId)),console.log("✅ Пользователь удален из локального состояния")}),r.current&&r.current.on("lessonCompleted",y=>{if(l(T=>{const C=T.map(M=>M.id===y.lesson.id?y.lesson:M);return Q("tutoring_lessons",C),C}),v&&v.role==="teacher"&&y.lesson.status==="completed"){const T={...v.profile};T.lessonsCount=(T.lessonsCount||0)+1,D(T)}}),N.on("studentProfiles",y=>{g(y||{});const C=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(y).forEach(([M,ae])=>{const ce=C.findIndex(Me=>Me.id===M);ce>=0?C[ce]={...C[ce],profile:ae}:C.push({id:M,email:ae.email||"",name:ae.name||"",nickname:ae.nickname||"",role:"student",phone:ae.phone||"",profile:ae})}),localStorage.setItem("tutoring_users",JSON.stringify(C)),h(C)}),N.on("teacherProfiles",y=>{b(y),Q("tutoring_teacherProfiles",y);const C=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(y).forEach(([M,ae])=>{const ce=C.findIndex(Me=>Me.id===M);ce>=0?C[ce]={...C[ce],profile:ae}:C.push({id:M,email:ae.email||"",name:ae.name||"",nickname:ae.nickname||"",role:"teacher",phone:ae.phone||"",profile:ae})}),localStorage.setItem("tutoring_users",JSON.stringify(C)),h(C)}),N.on("studentProfiles",y=>{g(y),Q("tutoring_studentProfiles",y);const C=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(y).forEach(([M,ae])=>{const ce=C.findIndex(Me=>Me.id===M);ce>=0?C[ce]={...C[ce],profile:ae}:C.push({id:M,email:ae.email||"",name:ae.name||"",nickname:ae.nickname||"",role:"student",phone:ae.phone||"",profile:ae})}),localStorage.setItem("tutoring_users",JSON.stringify(C)),h(C)}),N.on("studentProfileUpdated",y=>{g(T=>({...T,[y.studentId]:y.profile}))}),N.on("teacherProfileUpdated",y=>{try{const C=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(M=>M.id===y.teacherId?{...M,profile:y.profile,avatar:y.profile.avatar}:M);localStorage.setItem("tutoring_users",JSON.stringify(C)),h(C)}catch{}}),N.on("profileUpdated",y=>{try{const T=JSON.parse(localStorage.getItem("tutoring_users")||"[]");let C=!1;const M="userId"in y?y.userId:y.id,ae="type"in y?y.type:y.role,ce=y.profile,Me=T.map(F=>F.id===M?(C=!0,{...F,profile:ce,avatar:ce.avatar,name:ce.name||F.name,email:ce.email||F.email}):F);C||Me.push({id:M,role:ae,profile:ce,avatar:ce.avatar,name:ce.name||"",email:ce.email||""}),localStorage.setItem("tutoring_users",JSON.stringify(Me)),h(Me),ae==="teacher"?b(F=>({...F,[M]:ce})):ae==="student"&&g(F=>({...F,[M]:ce})),console.log("Profile updated via WebSocket:",{userId:M,role:ae,profile:ce})}catch(T){console.error("Error processing profileUpdated event:",T)}}),N.on("userRegistered",y=>{try{const T=JSON.parse(localStorage.getItem("tutoring_users")||"[]"),C=T.findIndex(M=>M.id===y.id);C>=0?T[C]=y:T.push(y),localStorage.setItem("tutoring_users",JSON.stringify(T)),h(T)}catch{}}),N.on("allPosts",y=>{w(y),Q("tutoring_posts",y)}),N.on("postCreated",y=>{w(T=>{const C=[y,...T];return Q("tutoring_posts",C),C})}),N.on("postReactionUpdated",y=>{w(T=>{const C=T.map(M=>M.id===y.postId?{...M,reactions:y.reactions,likes:y.likes}:M);return Q("tutoring_posts",C),C})}),N.on("postCommentAdded",y=>{w(T=>{const C=T.map(M=>M.id===y.postId?{...M,comments:[...M.comments,y.comment]}:M);return Q("tutoring_posts",C),C})}),N.on("postEdited",y=>{w(T=>{const C=T.map(M=>M.id===y.postId?{...M,text:y.text,tags:y.tags,editedAt:y.editedAt}:M);return Q("tutoring_posts",C),C})}),N.on("postDeleted",y=>{w(T=>{const C=T.filter(M=>M.id!==y.postId);return Q("tutoring_posts",C),C})}),N.on("postBookmarkUpdated",y=>{w(T=>{const C=T.map(M=>M.id===y.postId?{...M,bookmarks:y.bookmarks}:M);return Q("tutoring_posts",C),C})}),N.on("searchResults",y=>{}),N.on("userNotifications",y=>{S(y),Q("tutoring_notifications",y)}),N.on("newNotification",y=>{S(T=>{const C=[y,...T];return Q("tutoring_notifications",C),C})}),N.on("notificationMarkedAsRead",y=>{S(T=>{const C=T.map(M=>M.id===y.notificationId?{...M,isRead:!0,readAt:new Date().toISOString()}:M);return Q("tutoring_notifications",C),C})}),N.on("allNotificationsMarkedAsRead",y=>{S(T=>{const C=T.map(M=>M.userId===y.userId?{...M,isRead:!0,readAt:new Date().toISOString()}:M);return Q("tutoring_notifications",C),C})}),()=>{N.close(),r.current=null}})()},[]),E.useEffect(()=>{const $=p=>{if(p.key==="tutoring_users")try{const N=JSON.parse(p.newValue||"[]");h(N)}catch{h([])}},U=p=>{var N,y,T;if(((N=p.detail)==null?void 0:N.key)==="tutoring_users")try{const C=JSON.parse(p.detail.newValue||"[]");h(C),console.log("🔄 Пользователи обновлены через customStorage:",C.length)}catch{h([])}if(((y=p.detail)==null?void 0:y.key)==="tutoring_teacherProfiles")try{const C=JSON.parse(p.detail.newValue||"{}");b(C),console.log("🔄 Профили преподавателей обновлены через customStorage:",Object.keys(C).length)}catch(C){console.error("❌ Ошибка обновления профилей преподавателей:",C)}if(((T=p.detail)==null?void 0:T.key)==="tutoring_studentProfiles")try{const C=JSON.parse(p.detail.newValue||"{}");g(C),console.log("🔄 Профили студентов обновлены через customStorage:",Object.keys(C).length)}catch(C){console.error("❌ Ошибка обновления профилей студентов:",C)}};return window.addEventListener("storage",$),window.addEventListener("customStorage",U),()=>{window.removeEventListener("storage",$),window.removeEventListener("customStorage",U)}},[]),E.useEffect(()=>{Q("tutoring_timeSlots",a)},[a]),E.useEffect(()=>{Q("tutoring_lessons",o)},[o]),E.useEffect(()=>{Q("tutoring_chats",c)},[c]),E.useEffect(()=>{Q("tutoring_posts",u)},[u]),E.useEffect(()=>{Q("tutoring_notifications",x)},[x]),E.useEffect(()=>{v&&r.current&&s&&(r.current.emit("subscribeNotifications",v.id),r.current.emit("requestUserNotifications",v.id))},[v,s]);const B=$=>{const U={...$,id:`slot_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};i(p=>{const N=[...p,U];return Q("tutoring_timeSlots",N),N}),r.current&&s&&r.current.emit("createSlot",U)},V=async($,U,p,N)=>new Promise((y,T)=>{if((N==null?void 0:N.mode)==="assign"&&(!U||!p)){alert("Ошибка: не выбран ученик для назначения урока!"),T(new Error("createSlot: assign mode without studentId/studentName"));return}const C=!!U,M={...$,id:`slot_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,isBooked:C,...C?{bookedStudentId:U}:{}};if(i(ae=>{const ce=[...ae,M];return Q("tutoring_timeSlots",ce),ce}),r.current&&s&&r.current.emit("createSlot",M),C&&U&&p){const ae={id:`lesson_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,studentId:U,teacherId:M.teacherId,studentName:p,teacherName:M.teacherName,subject:M.subject,date:M.date,startTime:M.startTime,endTime:M.endTime,duration:M.duration,format:M.format,status:"scheduled",price:M.price,lessonType:M.lessonType};if(l(ce=>[...ce,ae]),fe(U,M.teacherId,p,M.teacherName),v&&v.role==="teacher"){const ce={...v.profile};ce.students||(ce.students=[]),ce.students.includes(U)||ce.students.push(U),D(ce)}r.current&&s&&r.current.emit("bookSlot",{slotId:M.id,lesson:ae,bookedStudentId:U})}y(M)}),I=($,U,p,N)=>{const y=a.find(C=>C.id===$);if(!y||y.isBooked)return;if(v&&v.role==="teacher"){const C={...v.profile};C.students||(C.students=[]),C.students.includes(U)||C.students.push(U),D(C)}i(C=>C.map(M=>M.id===$?{...M,isBooked:!0,bookedStudentId:U}:M));const T={id:`lesson_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,studentId:U,teacherId:y.teacherId,studentName:p,teacherName:y.teacherName,subject:y.subject,date:y.date,startTime:y.startTime,endTime:y.endTime,duration:y.duration,format:y.format,status:"scheduled",price:y.price,lessonType:y.lessonType,comment:N||""};l(C=>[...C,T]),fe(U,y.teacherId,p,y.teacherName),r.current&&s&&r.current.emit("bookSlot",{slotId:$,lesson:T,bookedStudentId:U})},W=$=>{const U=o.find(N=>N.id===$);if(!U)return;const p=a.find(N=>N.teacherId===U.teacherId&&N.date===U.date&&N.startTime===U.startTime);l(N=>N.filter(y=>y.id!==$)),p&&(i(N=>N.map(y=>y.id===p.id?{...y,isBooked:!1,bookedStudentId:void 0}:y)),r.current&&s&&r.current.emit("cancelSlot",{slotId:p.id,lessonId:$}))},J=($,U,p)=>{const N=o.find(T=>T.id===$);if(!N)return;const y=new Date(`2000-01-01T${p}`);y.setMinutes(y.getMinutes()+N.duration),l(T=>T.map(C=>C.id===$?{...C,date:U,startTime:p,endTime:y.toTimeString().slice(0,5)}:C)),i(T=>T.map(C=>C.teacherId===N.teacherId&&C.date===N.date&&C.startTime===N.startTime?{...C,isBooked:!1,bookedStudentId:void 0}:C))},L=$=>a.filter(p=>{var T;if(p.isBooked)return!1;const N=new Date(p.date),y=new Date;if(y.setHours(0,0,0,0),N<y||$.grade&&$.grade!==""&&(!p.grades||!p.grades.includes($.grade))||$.subject&&$.subject!==""&&p.subject!==$.subject||$.experience&&$.experience!==""&&p.experience!==$.experience||$.lessonType&&$.lessonType!==""&&p.lessonType!==$.lessonType||$.duration&&$.duration>0&&p.duration!==$.duration||$.format&&$.format!==""&&p.format!==$.format||$.minRating&&$.minRating>0&&(p.rating||0)<$.minRating||$.goals&&$.goals.length>0&&(!p.goals||!$.goals.some(C=>p.goals.includes(C))))return!1;if($.city&&$.city!==""){const C=j.find(ae=>ae.id===p.teacherId),M=((T=C==null?void 0:C.profile)==null?void 0:T.city)||"";if(M&&!M.toLowerCase().includes($.city.toLowerCase()))return!1}return!0}),fe=($,U,p,N)=>{console.log("🔍 getOrCreateChat DEBUG:"),console.log("- Participant 1:",{id:$,name:p}),console.log("- Participant 2:",{id:U,name:N}),console.log("- Current chats count:",c.length);const y=c.find(C=>C.participants.includes($)&&C.participants.includes(U));if(y)return console.log("✅ Found existing chat:",y.id),y.id;console.log("🆕 Creating new chat...");const T={id:`chat_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,participants:[$,U],participantNames:[p,N],messages:[]};if(console.log("📝 New chat created:",T.id),d(C=>{const M=[...C,T];return Q("tutoring_chats",M),console.log("💾 Chat saved to localStorage, total chats:",M.length),M}),r.current&&s){console.log("📡 Sending chat to server..."),r.current.emit("createChat",T);const C={id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:U,type:"new_chat",title:"Новый чат",message:`${p} создал с вами чат`,isRead:!1,timestamp:new Date().toISOString(),data:{chatId:T.id,studentId:$,studentName:p}};r.current.emit("createNotification",C),console.log("📬 Notification sent to server")}else console.log("⚠️ Socket not connected, chat not sent to server");return console.log("🔍 END getOrCreateChat DEBUG"),T.id},he=($,U,p,N)=>{console.log("🔍 sendMessage DEBUG:"),console.log("- Chat ID:",$),console.log("- Sender:",{id:U,name:p}),console.log("- Content:",N);const y=c.find(ae=>ae.id===$);if(!y){console.error("❌ Chat not found:",$);return}console.log("✅ Chat found:",{id:y.id,participants:y.participants,participantNames:y.participantNames});const T=y.participants.find(ae=>ae!==U),C=y.participantNames.find((ae,ce)=>y.participants[ce]!==U);if(!T){console.error("❌ Receiver not found in chat participants");return}console.log("📬 Receiver:",{id:T,name:C});const M={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,senderId:U,senderName:p,receiverId:T,receiverName:C||"Неизвестный пользователь",content:N,timestamp:new Date().toISOString(),isRead:!1};console.log("📝 Message created:",M.id),d(ae=>ae.map(ce=>{if(ce.id===$){const Me={...ce,messages:[...ce.messages,M],lastMessage:M};return Q("tutoring_chats",ae.map(F=>F.id===ce.id?Me:F)),console.log("💾 Message saved locally, total messages in chat:",Me.messages.length),Me}return ce})),r.current&&s?(console.log("📡 Sending message to server..."),r.current.emit("sendMessage",{chatId:$,message:M}),console.log("✅ Message sent to server")):console.log("⚠️ Socket not connected, message not sent to server"),console.log("🔍 END sendMessage DEBUG")},xe=($,U,p,N,y)=>{if(console.log("🔍 sendMessageToUser DEBUG:"),console.log("- Sender:",{id:$,name:U}),console.log("- Receiver:",{id:p,name:N}),console.log("- Content:",y),!$||!U||!p||!N||!y)return console.error("❌ Missing required parameters for sendMessageToUser"),"";const T=fe($,p,U,N);return console.log("- Chat ID:",T),T?(he(T,$,U,y),console.log("✅ Message sent successfully to chat:",T),console.log("🔍 END sendMessageToUser DEBUG"),T):(console.error("❌ Failed to create or find chat"),"")},ve=$=>{r.current&&s&&r.current.emit("lessonCompleted",{lessonId:$})},$e=($,U)=>{r.current&&r.current.emit("updateStudentProfile",{studentId:$,profile:U}),g(p=>({...p,[$]:U}))},X=$=>{i(U=>{const p=U.map(N=>N.id===$?{...N,isDeleted:!0}:N);return Q("tutoring_timeSlots",p),p}),r.current&&s&&r.current.emit("deleteSlot",{slotId:$})},be=()=>{i([]),l([]),d([]),localStorage.removeItem("tutoring_timeSlots"),localStorage.removeItem("tutoring_lessons"),localStorage.removeItem("tutoring_chats"),localStorage.removeItem("tutoring_users"),localStorage.removeItem("tutoring_currentUser")},Ee=($,U)=>{b(p=>{const N={...p,[$]:U};return Q("tutoring_teacherProfiles",N),N}),r.current&&s&&r.current.emit("updateTeacherProfile",{teacherId:$,profile:U});try{const N=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(y=>y.id===$?{...y,profile:U,avatar:U.avatar}:y);localStorage.setItem("tutoring_users",JSON.stringify(N))}catch(p){console.error("Ошибка обновления списка пользователей:",p)}},te=$=>{if(!v)return;const U=y=>{if(!y)return[];const T=/#[\wа-яё]+/gi,C=y.match(T);return C?[...new Set(C.map(M=>M.toLowerCase()))]:[]},p=$.media.map(y=>URL.createObjectURL(y)),N={id:`post_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:v.id,userName:v.name,userAvatar:v.avatar,text:$.text,media:p,type:$.type,date:new Date().toISOString(),reactions:[],comments:[],isBookmarked:!1,tags:U($.text),likes:0,views:0,bookmarks:[]};w(y=>{const T=[N,...y];return Q("tutoring_posts",T),T}),r.current&&s&&r.current.emit("createPost",N)},Ne=($,U)=>{v&&(w(p=>{const N=p.map(y=>{if(y.id===$){const T=y.reactions.find(ae=>ae.userId===v.id);let C=[...y.reactions],M=y.likes||0;return T?T.type===U?(C=y.reactions.filter(ae=>ae.userId!==v.id),M=Math.max(0,M-1)):T.type=U:(C.push({id:`reaction_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:v.id,type:U,date:new Date().toISOString()}),M++),{...y,reactions:C,likes:M}}return y});return Q("tutoring_posts",N),N}),r.current&&s&&r.current.emit("addReaction",{postId:$,reactionType:U,userId:v.id}))},ke=($,U)=>{if(!v)return;const p={id:`comment_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:v.id,userName:v.name,userAvatar:v.avatar,text:U,date:new Date().toISOString()};w(N=>{const y=N.map(T=>T.id===$?{...T,comments:[...T.comments,p]}:T);return Q("tutoring_posts",y),y}),r.current&&s&&r.current.emit("addComment",{postId:$,comment:p})},rt=$=>{},st=$=>{v&&(w(U=>{const p=U.map(N=>{if(N.id===$){const y=N.bookmarks||[],T=y.indexOf(v.id);let C=[...y];return T===-1?C.push(v.id):C.splice(T,1),{...N,bookmarks:C}}return N});return Q("tutoring_posts",p),p}),r.current&&s&&r.current.emit("bookmarkPost",{postId:$,userId:v.id}))},He=($,U)=>{const p=N=>{if(!N)return[];const y=/#[\wа-яё]+/gi,T=N.match(y);return T?[...new Set(T.map(C=>C.toLowerCase()))]:[]};w(N=>{const y=N.map(T=>T.id===$?{...T,text:U,tags:p(U),editedAt:new Date().toISOString()}:T);return Q("tutoring_posts",y),y}),r.current&&s&&r.current.emit("editPost",{postId:$,newText:U})},q=$=>{w(U=>{const p=U.filter(N=>N.id!==$);return Q("tutoring_posts",p),p}),r.current&&s&&r.current.emit("deletePost",{postId:$})},pe=$=>{console.log("deleteChat called with chatId:",$),console.log("Current chats count:",c.length),d(U=>{if(!U.find(y=>y.id===$))return console.warn("Chat not found for deletion:",$),U;const N=U.filter(y=>y.id!==$);return console.log(`Chat ${$} removed. New count: ${N.length}`),Q("tutoring_chats",N),N}),r.current&&s?(console.log("Sending deleteChat event to server"),r.current.emit("deleteChat",{chatId:$})):console.warn("Socket not connected, chat deletion not synced to server")},ue=$=>{d(U=>{const p=U.map(N=>N.id===$?{...N,messages:N.messages.map(y=>({...y,isRead:!0}))}:N);return Q("tutoring_chats",p),p}),r.current&&s&&r.current.emit("markChatAsRead",{chatId:$})},je=$=>{d(U=>{const p=U.map(N=>N.id===$?{...N,messages:[]}:N);return Q("tutoring_chats",p),p}),r.current&&s&&r.current.emit("clearChatMessages",{chatId:$})},Ie=$=>{d(U=>{const p=U.map(N=>N.id===$?{...N,archived:!0}:N);return Q("tutoring_chats",p),p}),r.current&&s&&r.current.emit("archiveChat",{chatId:$})},Oe=$=>{d(U=>{const p=U.map(N=>N.id===$?{...N,archived:!1}:N);return Q("tutoring_chats",p),p}),r.current&&s&&r.current.emit("unarchiveChat",{chatId:$})},ze=async()=>{try{console.log("🔄 Loading chats from server:",`${Re}/api/sync`);const $=await fetch(`${Re}/api/sync`);if($.ok){const U=$.headers.get("content-type");if(U&&U.includes("application/json")){const p=await $.json();p.chats&&(console.log("✅ Loaded chats from server:",p.chats.length),d(p.chats),Q("tutoring_chats",p.chats))}else console.warn("⚠️ Server returned non-JSON response, using local chats")}else console.error("❌ Failed to load chats from server:",$.status,$.statusText)}catch($){console.warn("⚠️ Error loading chats from server, using local chats:",$)}},nt=$=>{console.log("🗑️ Удаляем все данные пользователя:",$),i(U=>{const p=U.filter(N=>N.teacherId!==$);return Q("tutoring_timeSlots",p),p}),l(U=>{const p=U.filter(N=>N.teacherId!==$&&N.studentId!==$);return Q("tutoring_lessons",p),p}),d(U=>{const p=U.filter(N=>!N.participants.includes($));return Q("tutoring_chats",p),p}),w(U=>{const p=U.filter(N=>N.userId!==$);return Q("tutoring_posts",p),p}),S(U=>{const p=U.filter(N=>N.userId!==$);return Q("tutoring_notifications",p),p}),(v==null?void 0:v.role)==="teacher"?b(U=>{const p={...U};return delete p[$],Q("tutoring_teacherProfiles",p),p}):(v==null?void 0:v.role)==="student"&&g(U=>{const p={...U};return delete p[$],Q("tutoring_studentProfiles",p),p}),h(U=>{const p=U.filter(N=>N.id!==$);return Q("tutoring_users",p),p}),console.log("✅ Все данные пользователя удалены")};return e.jsx(Vo.Provider,{value:{timeSlots:a,lessons:o,chats:c,posts:u,createTimeSlot:B,bookLesson:I,cancelLesson:W,rescheduleLesson:J,getFilteredSlots:L,sendMessage:he,sendMessageToUser:xe,getOrCreateChat:fe,clearAllData:be,isConnected:s,completeLesson:ve,studentProfiles:f,updateStudentProfile:$e,deleteSlot:X,createSlot:V,allUsers:j,setAllUsers:$=>{h($),localStorage.setItem("tutoring_users",JSON.stringify($))},refreshUsers:O,loadRegisteredTeachers:z,refreshAllData:R,forceSyncData:K,uploadLocalDataToServer:Y,deleteUser:ee,teacherProfiles:m,updateTeacherProfile:Ee,socketRef:r,loadInitialData:P,createPost:te,addReaction:Ne,addComment:ke,sharePost:rt,bookmarkPost:st,editPost:He,deletePost:q,searchPosts:$=>{r.current&&s&&r.current.emit("searchPosts",$)},getPostsByUser:$=>u.filter(U=>U.userId===$),getBookmarkedPosts:$=>u.filter(U=>{var p;return(p=U.bookmarks)==null?void 0:p.includes($)}),notifications:x,subscribeToNotifications:$=>{r.current&&s&&r.current.emit("subscribeNotifications",$)},unsubscribeFromNotifications:$=>{r.current&&s&&r.current.emit("unsubscribeNotifications",$)},markNotificationAsRead:$=>{S(U=>{const p=U.map(N=>N.id===$?{...N,isRead:!0,readAt:new Date().toISOString()}:N);return Q("tutoring_notifications",p),p}),r.current&&s&&r.current.emit("markNotificationAsRead",$)},markAllNotificationsAsRead:$=>{S(U=>{const p=U.map(N=>N.userId===$?{...N,isRead:!0,readAt:new Date().toISOString()}:N);return Q("tutoring_notifications",p),p}),r.current&&s&&r.current.emit("markAllNotificationsAsRead",$)},deleteNotification:$=>{S(U=>{const p=U.filter(N=>N.id!==$);return Q("tutoring_notifications",p),p})},deleteChat:pe,markChatAsRead:ue,clearChatMessages:je,archiveChat:Ie,unarchiveChat:Oe,loadChatsFromServer:ze,deleteUserData:nt},children:t})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var gd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),oe=(t,r)=>{const s=E.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},f)=>E.createElement("svg",{ref:f,...gd,width:a,height:a,stroke:n,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${xd(t)}`,l].join(" "),...d},[...r.map(([g,m])=>E.createElement(g,m)),...Array.isArray(c)?c:[c]]));return s.displayName=`${t}`,s};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=oe("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=oe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=oe("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=oe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=oe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=oe("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=oe("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=oe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=oe("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=oe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=oe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=oe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=oe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=oe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=oe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=oe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=oe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=oe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=oe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=oe("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=oe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=oe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=oe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=oe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=oe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=oe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=oe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=oe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=oe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=oe("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=oe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dd=oe("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=oe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=oe("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=oe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=oe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=oe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=oe("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=oe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=oe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=oe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=oe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=oe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=oe("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=oe("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=oe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=oe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=oe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=oe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=oe("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=oe("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=oe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=oe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=oe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=oe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=oe("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=oe("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=oe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Bd=({onSuccess:t})=>{const[r,s]=E.useState(!0),[n,a]=E.useState(""),[i,o]=E.useState(""),[l,c]=E.useState(""),[d,f]=E.useState(""),[g,m]=E.useState(""),[b,j]=E.useState("student"),[h,u]=E.useState(!1),[w,x]=E.useState(!1),{login:S,register:v}=tt(),D=async P=>{P.preventDefault(),u(!0);try{if(r)await S(n,i),t();else{if(!w){x(!0),u(!1);return}if(!g.trim()){alert("Пожалуйста, введите никнейм"),u(!1);return}if(!d.trim()){alert("Пожалуйста, введите номер телефона"),u(!1);return}await v(n,i,l,g,b,d)&&t()}}catch{}finally{u(!1)}};return!r&&w?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-[#0D3C69] rounded-xl flex items-center justify-center mb-4",children:e.jsx(Be,{className:"h-6 w-6 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Выберите роль"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Кто вы на нашей платформе?"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>j("student"),className:`w-full p-6 rounded-xl border-2 transition-all duration-200 ${b==="student"?"border-[#0D3C69] bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${b==="student"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(ye,{className:`h-6 w-6 ${b==="student"?"text-[#0D3C69]":"text-gray-600"}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Ученик"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ищу репетитора для обучения"})]})]})}),e.jsx("button",{onClick:()=>j("teacher"),className:`w-full p-6 rounded-xl border-2 transition-all duration-200 ${b==="teacher"?"border-[#0D3C69] bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${b==="teacher"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(Fd,{className:`h-6 w-6 ${b==="teacher"?"text-[#0D3C69]":"text-gray-600"}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Преподаватель"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Провожу уроки и делюсь знаниями"})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nickname",className:"block text-sm font-medium text-gray-700 mb-1",children:"Никнейм"}),e.jsx("input",{id:"nickname",type:"text",value:g,onChange:P=>m(P.target.value),required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200",placeholder:"Введите никнейм"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Номер телефона"}),e.jsxs("div",{className:"relative",children:[e.jsx(xr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",type:"tel",value:d,onChange:P=>f(P.target.value),required:!0,className:"w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsx("button",{onClick:D,disabled:h||!g.trim()||!d.trim(),className:"w-full bg-[#0D3C69] hover:bg-[#0A2F56] text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Создание аккаунта...":"Завершить регистрацию"}),e.jsx("button",{onClick:()=>x(!1),className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-4 rounded-lg transition-colors duration-200",children:"Назад"})]})]})}):e.jsxs("div",{className:"min-h-screen flex",children:[e.jsx("div",{className:"flex-1 bg-white flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Добро пожаловать"}),e.jsx("p",{className:"text-lg text-gray-600",children:r?"Войдите в свой аккаунт":"Создайте новый аккаунт"})]}),e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[!r&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Имя"}),e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"name",type:"text",value:l,onChange:P=>c(P.target.value),required:!r,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"Введите ваше имя"})]})]}),!r&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Номер телефона"}),e.jsxs("div",{className:"relative",children:[e.jsx(xr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",type:"tel",value:d,onChange:P=>f(P.target.value),required:!r,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ta,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"email",type:"email",value:n,onChange:P=>a(P.target.value),required:!0,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"Введите ваш email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Пароль"}),e.jsxs("div",{className:"relative",children:[e.jsx(Jo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"password",type:"password",value:i,onChange:P=>o(P.target.value),required:!0,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:r?"Введите пароль":"Создайте пароль"})]})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-[#0D3C69] hover:bg-[#0A2F56] text-white font-bold py-4 px-6 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-lg shadow-lg hover:shadow-xl transform hover:scale-105",children:h?r?"Вход...":"Создание аккаунта...":r?"Войти":"Создать аккаунт"})]}),e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["Продолжая, вы соглашаетесь с"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Условиями использования"})," ","и"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Политикой конфиденциальности"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-gray-600",children:r?"Нет аккаунта? ":"Уже есть аккаунт? "}),e.jsx("button",{onClick:()=>{s(!r),x(!1),a(""),o(""),c(""),f(""),m("")},className:"text-[#0D3C69] hover:text-[#0A2F56] font-medium",children:r?"Зарегистрироваться":"Войти"})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"text-[#0D3C69] hover:text-[#0A2F56] text-sm",children:"Получить помощь"})}),e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["Этот сайт защищен reCAPTCHA Enterprise и применяются"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Политика конфиденциальности"})," ","и"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Условия использования"})," ","Google."]})]})}),e.jsxs("div",{className:"flex-1 bg-gray-900 flex flex-col items-center justify-center p-8 relative overflow-hidden",children:[e.jsx("h2",{className:"text-5xl font-bold text-white mb-8 text-center",children:"Платформа для обучения"}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("blockquote",{className:"text-xl text-gray-300 italic leading-relaxed",children:'"Важно не количество знаний, а качество их. Можно знать очень многое не зная самого нужного."'}),e.jsx("cite",{className:"text-sm text-gray-400 mt-4 block",children:"— Л. Толстой"})]}),e.jsxs("div",{className:"relative w-full h-64 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-blue-900 via-purple-900 to-black"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 opacity-20"})}),e.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((P,A)=>e.jsx("div",{className:"absolute w-1 h-1 bg-yellow-300 rounded-full animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`}},A))})]})]})]})},Hd=({activeTab:t,onTabChange:r})=>{const{user:s,logout:n}=tt(),a=[{id:"home",label:"Главная",icon:kd},{id:"lessons",label:"Мои уроки",icon:Ke},{id:"chats",label:"Чаты",icon:Ae},{id:"profile",label:"Профиль",icon:ye}],i=[{id:"slots",label:"Слоты",icon:Ke},{id:"calendar",label:"Календарь",icon:pd},{id:"students",label:"Ученики",icon:ye},{id:"chats",label:"Чаты",icon:Ae},{id:"profile",label:"Профиль",icon:ye}],o=(s==null?void 0:s.role)==="teacher"?i:a;return e.jsx("nav",{className:"bg-card-light dark:bg-card-dark shadow-lg border-b border-border-light dark:border-border-dark transition-colors",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-8",children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-xl flex items-center justify-center shadow-md",style:{background:"#175b8c"},children:e.jsx("span",{className:"text-white font-bold text-lg",style:{fontFamily:"Inter, sans-serif",fontSize:28},children:"Na"})}),e.jsx("span",{className:"ml-3 text-2xl font-bold",style:{color:"#175b8c",fontFamily:"Inter, sans-serif"},children:"uchi"})]}),e.jsx("div",{className:"hidden md:flex space-x-8",children:o.map(l=>{const c=l.icon;return e.jsxs("button",{onClick:()=>r(l.id),className:`flex items-center gap-2 px-5 py-3 rounded-xl text-base font-semibold transition-all duration-200 shadow-none ${t===l.id?"bg-primary-light/10 text-primary-light dark:bg-primary-dark/20 dark:text-primary-dark shadow-md":"text-textSecondary-light dark:text-textSecondary-dark hover:bg-border-light dark:hover:bg-border-dark hover:text-primary-light dark:hover:text-primary-dark"}`,children:[e.jsx(c,{className:"h-5 w-5"}),e.jsx("span",{children:l.label})]},l.id)})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:s==null?void 0:s.nickname.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:s==null?void 0:s.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["@",s==null?void 0:s.nickname]})]}),e.jsx("span",{className:"hidden md:block text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full",children:(s==null?void 0:s.role)==="teacher"?"Преподаватель":"Ученик"})]}),e.jsx("button",{onClick:n,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg transition-all duration-200",title:"Выйти",children:e.jsx($d,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"md:hidden border-t border-border-light dark:border-border-dark",children:e.jsx("div",{className:"flex space-x-1 py-2 overflow-x-auto",children:o.map(l=>{const c=l.icon;return e.jsxs("button",{onClick:()=>r(l.id),className:`flex-shrink-0 flex flex-col items-center gap-1 px-4 py-3 rounded-xl text-xs font-semibold transition-all duration-200 ${t===l.id?"bg-primary-light/10 text-primary-light dark:bg-primary-dark/20 dark:text-primary-dark shadow-md":"text-textSecondary-light dark:text-textSecondary-dark hover:bg-border-light dark:hover:bg-border-dark hover:text-primary-light dark:hover:text-primary-dark"}`,children:[e.jsx(c,{className:"h-5 w-5"}),e.jsx("span",{children:l.label})]},l.id)})})})]})})};function Rt(t){"@babel/helpers - typeof";return Rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Rt(t)}function zd(t,r){if(Rt(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Rt(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function nl(t){var r=zd(t,"string");return Rt(r)=="symbol"?r:r+""}function Xt(t,r,s){return(r=nl(r))in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function ai(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Se(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?ai(Object(s),!0).forEach(function(n){Xt(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ai(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function Vs(t,r){if(t==null)return{};var s={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(r.indexOf(n)!==-1)continue;s[n]=t[n]}return s}function Tt(t,r){if(t==null)return{};var s,n,a=Vs(t,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)s=i[n],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(a[s]=t[s])}return a}function Fe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function ii(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nl(n.key),n)}}function Ue(t,r,s){return r&&ii(t.prototype,r),s&&ii(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ms(t){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ms(t)}function al(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(al=function(){return!!t})()}function Gd(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qd(t,r){if(r&&(Rt(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gd(t)}function Je(t,r,s){return r=Ms(r),qd(t,al()?Reflect.construct(r,s||[],Ms(t).constructor):r.apply(t,s))}function _s(t,r){return _s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,n){return s.__proto__=n,s},_s(t,r)}function Xe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&_s(t,r)}function il(t){if(Array.isArray(t))return t}function Yd(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(s=s.call(t)).next,r!==0)for(;!(c=(n=i.call(s)).done)&&(l.push(n.value),l.length!==r);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&s.return!=null&&(o=s.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function Pn(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=Array(r);s<r;s++)n[s]=t[s];return n}function na(t,r){if(t){if(typeof t=="string")return Pn(t,r);var s={}.toString.call(t).slice(8,-1);return s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set"?Array.from(t):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Pn(t,r):void 0}}function ol(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tr(t,r){return il(t)||Yd(t,r)||na(t,r)||ol()}function ll(t){var r,s,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t))for(r=0;r<t.length;r++)t[r]&&(s=ll(t[r]))&&(n&&(n+=" "),n+=s);else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Pe(){for(var t,r,s=0,n="";s<arguments.length;)(t=arguments[s++])&&(r=ll(t))&&(n&&(n+=" "),n+=r);return n}function _e(){return _e=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)({}).hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},_e.apply(null,arguments)}var Vd=function(t,r,s,n,a,i,o,l){if(!t){var c;if(r===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[s,n,a,i,o,l],f=0;c=new Error(r.replace(/%s/g,function(){return d[f++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}},Kd=Vd;const qr=bt(Kd);var Jd=function(){};function Xd(t,r){var s={};return Object.keys(t).forEach(function(n){s[$s(n)]=Jd}),s}function oi(t,r){return t[r]!==void 0}function $s(t){return"default"+t.charAt(0).toUpperCase()+t.substr(1)}function Qd(t){return!!t&&(typeof t!="function"||t.prototype&&t.prototype.isReactComponent)}function Zd(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,_s(t,r)}function cl(){var t=this.constructor.getDerivedStateFromProps(this.props,this.state);t!=null&&this.setState(t)}function dl(t){function r(s){var n=this.constructor.getDerivedStateFromProps(t,s);return n??null}this.setState(r.bind(this))}function ul(t,r){try{var s=this.props,n=this.state;this.props=t,this.state=r,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(s,n)}finally{this.props=s,this.state=n}}cl.__suppressDeprecationWarning=!0;dl.__suppressDeprecationWarning=!0;ul.__suppressDeprecationWarning=!0;function eu(t){var r=t.prototype;if(!r||!r.isReactComponent)throw new Error("Can only polyfill class components");if(typeof t.getDerivedStateFromProps!="function"&&typeof r.getSnapshotBeforeUpdate!="function")return t;var s=null,n=null,a=null;if(typeof r.componentWillMount=="function"?s="componentWillMount":typeof r.UNSAFE_componentWillMount=="function"&&(s="UNSAFE_componentWillMount"),typeof r.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof r.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof r.componentWillUpdate=="function"?a="componentWillUpdate":typeof r.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),s!==null||n!==null||a!==null){var i=t.displayName||t.name,o=typeof t.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+i+" uses "+o+" but also contains the following legacy lifecycles:"+(s!==null?`
  `+s:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof t.getDerivedStateFromProps=="function"&&(r.componentWillMount=cl,r.componentWillReceiveProps=dl),typeof r.getSnapshotBeforeUpdate=="function"){if(typeof r.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");r.componentWillUpdate=ul;var l=r.componentDidUpdate;r.componentDidUpdate=function(d,f,g){var m=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:g;l.call(this,d,f,m)}}return t}var tu="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function ml(t,r,s){s===void 0&&(s=[]);var n=t.displayName||t.name||"Component",a=Qd(t),i=Object.keys(r),o=i.map($s);a||!s.length||qr(!1);var l=function(d){Zd(f,d);function f(){for(var m,b=arguments.length,j=new Array(b),h=0;h<b;h++)j[h]=arguments[h];m=d.call.apply(d,[this].concat(j))||this,m.handlers=Object.create(null),i.forEach(function(w){var x=r[w],S=function(D){if(m.props[x]){var P;m._notifying=!0;for(var A=arguments.length,H=new Array(A>1?A-1:0),O=1;O<A;O++)H[O-1]=arguments[O];(P=m.props)[x].apply(P,[D].concat(H)),m._notifying=!1}m.unmounted||m.setState(function(z){var R,K=z.values;return{values:_e(Object.create(null),K,(R={},R[w]=D,R))}})};m.handlers[x]=S}),s.length&&(m.attachRef=function(w){m.inner=w});var u=Object.create(null);return i.forEach(function(w){u[w]=m.props[$s(w)]}),m.state={values:u,prevProps:{}},m}var g=f.prototype;return g.shouldComponentUpdate=function(){return!this._notifying},f.getDerivedStateFromProps=function(b,j){var h=j.values,u=j.prevProps,w={values:_e(Object.create(null),h),prevProps:{}};return i.forEach(function(x){w.prevProps[x]=b[x],!oi(b,x)&&oi(u,x)&&(w.values[x]=b[$s(x)])}),w},g.componentWillUnmount=function(){this.unmounted=!0},g.render=function(){var b=this,j=this.props,h=j.innerRef,u=Vs(j,["innerRef"]);o.forEach(function(x){delete u[x]});var w={};return i.forEach(function(x){var S=b.props[x];w[x]=S!==void 0?S:b.state.values[x]}),_.createElement(t,_e({},u,w,this.handlers,{ref:h||this.attachRef}))},f}(_.Component);eu(l),l.displayName="Uncontrolled("+n+")",l.propTypes=_e({innerRef:function(){}},Xd(r)),s.forEach(function(d){l.prototype[d]=function(){var g;return(g=this.inner)[d].apply(g,arguments)}});var c=l;return _.forwardRef&&(c=_.forwardRef(function(d,f){return _.createElement(l,_e({},d,{innerRef:f,__source:{fileName:tu,lineNumber:128},__self:this}))}),c.propTypes=l.propTypes),c.ControlledComponent=t,c.deferControlTo=function(d,f,g){return f===void 0&&(f={}),ml(d,_e({},r,f),g)},c}var hl={exports:{}},ru="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",su=ru,nu=su;function fl(){}function gl(){}gl.resetWarningCache=fl;var au=function(){function t(n,a,i,o,l,c){if(c!==nu){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function r(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:gl,resetWarningCache:fl};return s.PropTypes=s,s};hl.exports=au();var iu=hl.exports;const re=bt(iu);var Ps="milliseconds",Yr="seconds",Vr="minutes",Kr="hours",rr="day",vr="week",Jr="month",sr="year",nr="decade",ar="century",xl={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},ou={month:1,year:12,decade:10*12,century:100*12};function lu(t){return[31,cu(t),31,30,31,30,31,31,30,31,30,31]}function cu(t){return t%4===0&&t%100!==0||t%400===0?29:28}function jt(t,r,s){switch(t=new Date(t),s){case Ps:case Yr:case Vr:case Kr:case rr:case vr:return du(t,r*xl[s]);case Jr:case sr:case nr:case ar:return uu(t,r*ou[s])}throw new TypeError('Invalid units: "'+s+'"')}function du(t,r){var s=new Date(+t+r);return mu(t,s)}function uu(t,r){var s=t.getFullYear(),n=t.getMonth(),a=t.getDate(),i=s*12+n+r,o=Math.trunc(i/12),l=i%12,c=Math.min(a,lu(o)[l]),d=new Date(t);return d.setFullYear(o),d.setDate(1),d.setMonth(l),d.setDate(c),d}function mu(t,r){var s=t.getTimezoneOffset(),n=r.getTimezoneOffset(),a=n-s;return new Date(+r+a*xl.minutes)}function Xr(t,r,s){return jt(t,-r,s)}function qe(t,r,s){switch(t=new Date(t),r){case ar:case nr:case sr:t=Rs(t,0);case Jr:t=jl(t,1);case vr:case rr:t=es(t,0);case Kr:t=br(t,0);case Vr:t=Zr(t,0);case Yr:t=Qr(t,0)}return r===nr&&(t=Xr(t,ir(t)%10,"year")),r===ar&&(t=Xr(t,ir(t)%100,"year")),r===vr&&(t=wl(t,0,s)),t}function As(t,r,s){switch(t=new Date(t),t=qe(t,r,s),r){case ar:case nr:case sr:case Jr:case vr:t=jt(t,1,r),t=Xr(t,1,rr),t.setHours(23,59,59,999);break;case rr:t.setHours(23,59,59,999);break;case Kr:case Vr:case Yr:t=jt(t,1,r),t=Xr(t,1,Ps)}return t}var Sr=Cr(function(t,r){return t===r}),aa=Cr(function(t,r){return t!==r}),Ks=Cr(function(t,r){return t>r}),is=Cr(function(t,r){return t>=r}),ia=Cr(function(t,r){return t<r}),kr=Cr(function(t,r){return t<=r});function pl(){return new Date(Math.min.apply(Math,arguments))}function vl(){return new Date(Math.max.apply(Math,arguments))}function bl(t,r,s,n){return n=n||"day",(!r||is(t,r,n))&&(!s||kr(t,s,n))}var Qr=qt("Milliseconds"),Zr=qt("Seconds"),br=qt("Minutes"),es=qt("Hours"),yl=qt("Day"),jl=qt("Date"),Rs=qt("Month"),ir=qt("FullYear");function hu(t,r){return r===void 0?ir(qe(t,nr)):jt(t,r+10,sr)}function fu(t,r){return r===void 0?ir(qe(t,ar)):jt(t,r+100,sr)}function wl(t,r,s){var n=(yl(t)+7-(s||0))%7;return r===void 0?n:jt(t,r-n,rr)}function gu(t,r,s,n){var a,i,o;switch(s){case Ps:case Yr:case Vr:case Kr:case rr:case vr:a=r.getTime()-t.getTime();break;case Jr:case sr:case nr:case ar:a=(ir(r)-ir(t))*12+Rs(r)-Rs(t);break;default:throw new TypeError('Invalid units: "'+s+'"')}switch(s){case Ps:i=1;break;case Yr:i=1e3;break;case Vr:i=1e3*60;break;case Kr:i=1e3*60*60;break;case rr:i=1e3*60*60*24;break;case vr:i=1e3*60*60*24*7;break;case Jr:i=1;break;case sr:i=12;break;case nr:i=120;break;case ar:i=1200;break;default:throw new TypeError('Invalid units: "'+s+'"')}return o=a/i,n?o:Math.round(o)}function qt(t){var r=function(s){switch(s){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(t);return function(s,n){if(n===void 0)return s["get"+t]();var a=new Date(s);return a["set"+t](n),r&&a["get"+t]()!=n&&(t==="Hours"||n>=r&&a.getHours()-s.getHours()<Math.floor(n/r))&&a["set"+t](n+r),a}}function Cr(t){return function(r,s,n){return t(+qe(r,n),+qe(s,n))}}const li=Object.freeze(Object.defineProperty({__proto__:null,add:jt,century:fu,date:jl,day:yl,decade:hu,diff:gu,endOf:As,eq:Sr,gt:Ks,gte:is,hours:es,inRange:bl,lt:ia,lte:kr,max:vl,milliseconds:Qr,min:pl,minutes:br,month:Rs,neq:aa,seconds:Zr,startOf:qe,subtract:Xr,weekday:wl,year:ir},Symbol.toStringTag,{value:"Module"}));function xu(t){if(Array.isArray(t))return Pn(t)}function Nl(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pu(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Es(t){return xu(t)||Nl(t)||na(t)||pu()}function vu(t,r,s){var n=-1,a=t.length;r<0&&(r=-r>a?0:a+r),s=s>a?a:s,s<0&&(s+=a),a=r>s?0:s-r>>>0,r>>>=0;for(var i=Array(a);++n<a;)i[n]=t[n+r];return i}var Sl=vu;function bu(t,r){return t===r||t!==t&&r!==r}var os=bu,yu=typeof gt=="object"&&gt&&gt.Object===Object&&gt,kl=yu,ju=kl,wu=typeof self=="object"&&self&&self.Object===Object&&self,Nu=ju||wu||Function("return this")(),Mt=Nu,Su=Mt,ku=Su.Symbol,$r=ku,ci=$r,Cl=Object.prototype,Cu=Cl.hasOwnProperty,$u=Cl.toString,Ar=ci?ci.toStringTag:void 0;function Eu(t){var r=Cu.call(t,Ar),s=t[Ar];try{t[Ar]=void 0;var n=!0}catch{}var a=$u.call(t);return n&&(r?t[Ar]=s:delete t[Ar]),a}var Du=Eu,Tu=Object.prototype,Ou=Tu.toString;function Mu(t){return Ou.call(t)}var _u=Mu,di=$r,Pu=Du,Au=_u,Ru="[object Null]",Iu="[object Undefined]",ui=di?di.toStringTag:void 0;function Lu(t){return t==null?t===void 0?Iu:Ru:ui&&ui in Object(t)?Pu(t):Au(t)}var Er=Lu;function Fu(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var Ft=Fu,Uu=Er,Wu=Ft,Bu="[object AsyncFunction]",Hu="[object Function]",zu="[object GeneratorFunction]",Gu="[object Proxy]";function qu(t){if(!Wu(t))return!1;var r=Uu(t);return r==Hu||r==zu||r==Bu||r==Gu}var oa=qu,Yu=9007199254740991;function Vu(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Yu}var la=Vu,Ku=oa,Ju=la;function Xu(t){return t!=null&&Ju(t.length)&&!Ku(t)}var ls=Xu,Qu=9007199254740991,Zu=/^(?:0|[1-9]\d*)$/;function em(t,r){var s=typeof t;return r=r??Qu,!!r&&(s=="number"||s!="symbol"&&Zu.test(t))&&t>-1&&t%1==0&&t<r}var ca=em,tm=os,rm=ls,sm=ca,nm=Ft;function am(t,r,s){if(!nm(s))return!1;var n=typeof r;return(n=="number"?rm(s)&&sm(r,s.length):n=="string"&&r in s)?tm(s[r],t):!1}var Js=am,im=/\s/;function om(t){for(var r=t.length;r--&&im.test(t.charAt(r)););return r}var lm=om,cm=lm,dm=/^\s+/;function um(t){return t&&t.slice(0,cm(t)+1).replace(dm,"")}var mm=um;function hm(t){return t!=null&&typeof t=="object"}var Yt=hm,fm=Er,gm=Yt,xm="[object Symbol]";function pm(t){return typeof t=="symbol"||gm(t)&&fm(t)==xm}var cs=pm,vm=mm,mi=Ft,bm=cs,hi=NaN,ym=/^[-+]0x[0-9a-f]+$/i,jm=/^0b[01]+$/i,wm=/^0o[0-7]+$/i,Nm=parseInt;function Sm(t){if(typeof t=="number")return t;if(bm(t))return hi;if(mi(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=mi(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=vm(t);var s=jm.test(t);return s||wm.test(t)?Nm(t.slice(2),s?2:8):ym.test(t)?hi:+t}var km=Sm,Cm=km,fi=1/0,$m=17976931348623157e292;function Em(t){if(!t)return t===0?t:0;if(t=Cm(t),t===fi||t===-fi){var r=t<0?-1:1;return r*$m}return t===t?t:0}var $l=Em,Dm=$l;function Tm(t){var r=Dm(t),s=r%1;return r===r?s?r-s:r:0}var El=Tm,Om=Sl,Mm=Js,_m=El,Pm=Math.ceil,Am=Math.max;function Rm(t,r,s){(s?Mm(t,r,s):r===void 0)?r=1:r=Am(_m(r),0);var n=t==null?0:t.length;if(!n||r<1)return[];for(var a=0,i=0,o=Array(Pm(n/r));a<n;)o[i++]=Om(t,a,a+=r);return o}var Im=Rm;const Lm=bt(Im);function ds(t){return t&&t.ownerDocument||document}function Fm(t){var r=ds(t);return r&&r.defaultView||window}function Um(t,r){return Fm(t).getComputedStyle(t,r)}var Wm=/([A-Z])/g;function Bm(t){return t.replace(Wm,"-$1").toLowerCase()}var Hm=/^ms-/;function js(t){return Bm(t).replace(Hm,"-ms-")}var zm=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Gm(t){return!!(t&&zm.test(t))}function mr(t,r){var s="",n="";if(typeof r=="string")return t.style.getPropertyValue(js(r))||Um(t).getPropertyValue(js(r));Object.keys(r).forEach(function(a){var i=r[a];!i&&i!==0?t.style.removeProperty(js(a)):Gm(a)?n+=a+"("+i+") ":s+=js(a)+": "+i+";"}),n&&(s+="transform: "+n+";"),t.style.cssText+=";"+s}function ts(t,r){if(t.contains)return t.contains(r);if(t.compareDocumentPosition)return t===r||!!(t.compareDocumentPosition(r)&16)}function qm(t){return"nodeType"in t&&t.nodeType===document.DOCUMENT_NODE}function da(t){return"window"in t&&t.window===t?t:qm(t)&&t.defaultView||!1}function Dl(t){var r=t==="pageXOffset"?"scrollLeft":"scrollTop";function s(n,a){var i=da(n);if(a===void 0)return i?i[t]:n[r];i?i.scrollTo(i[t],a):n[r]=a}return s}const Tl=Dl("pageXOffset"),Ol=Dl("pageYOffset");function Qt(t){var r=ds(t),s={top:0,left:0,height:0,width:0},n=r&&r.documentElement;return!n||!ts(n,t)||(t.getBoundingClientRect!==void 0&&(s=t.getBoundingClientRect()),s={top:s.top+Ol(n)-(n.clientTop||0),left:s.left+Tl(n)-(n.clientLeft||0),width:s.width,height:s.height}),s}var Ym=function(r){return!!r&&"offsetParent"in r};function Vm(t){for(var r=ds(t),s=t&&t.offsetParent;Ym(s)&&s.nodeName!=="HTML"&&mr(s,"position")==="static";)s=s.offsetParent;return s||r.documentElement}var Km=function(r){return r.nodeName&&r.nodeName.toLowerCase()};function Ml(t,r){var s={top:0,left:0},n;if(mr(t,"position")==="fixed")n=t.getBoundingClientRect();else{var a=r||Vm(t);n=Qt(t),Km(a)!=="html"&&(s=Qt(a));var i=String(mr(a,"borderTopWidth")||0);s.top+=parseInt(i,10)-Ol(a)||0;var o=String(mr(a,"borderLeftWidth")||0);s.left+=parseInt(o,10)-Tl(a)||0}var l=String(mr(t,"marginTop")||0),c=String(mr(t,"marginLeft")||0);return _e({},n,{top:n.top-s.top-(parseInt(l,10)||0),left:n.left-s.left-(parseInt(c,10)||0)})}const ua=!!(typeof window<"u"&&window.document&&window.document.createElement);var gi=new Date().getTime();function Jm(t){var r=new Date().getTime(),s=Math.max(0,16-(r-gi)),n=setTimeout(t,s);return gi=r,n}var Xm=["","webkit","moz","o","ms"],An="clearTimeout",Rn=Jm,xi=function(r,s){return r+(r?s[0].toUpperCase()+s.substr(1):s)+"AnimationFrame"};ua&&Xm.some(function(t){var r=xi(t,"request");return r in window&&(An=xi(t,"cancel"),Rn=function(n){return window[r](n)}),!!Rn});var pi=function(r){typeof window[An]=="function"&&window[An](r)},_l=Rn,bn;function Qm(t,r){if(!bn){var s=document.body,n=s.matches||s.matchesSelector||s.webkitMatchesSelector||s.mozMatchesSelector||s.msMatchesSelector;bn=function(i,o){return n.call(i,o)}}return bn(t,r)}var Zm=Function.prototype.bind.call(Function.prototype.call,[].slice);function eh(t,r){return Zm(t.querySelectorAll(r))}var In=!1,Ln=!1;try{var yn={get passive(){return In=!0},get once(){return Ln=In=!0}};ua&&(window.addEventListener("test",yn,yn),window.removeEventListener("test",yn,!0))}catch{}function th(t,r,s,n){if(n&&typeof n!="boolean"&&!Ln){var a=n.once,i=n.capture,o=s;!Ln&&a&&(o=s.__once||function l(c){this.removeEventListener(r,l,i),s.call(this,c)},s.__once=o),t.addEventListener(r,o,In?n:i)}t.addEventListener(r,s,n)}function rh(t){const r=E.useRef(t);return E.useEffect(()=>{r.current=t},[t]),r}function vi(t){const r=rh(t);return E.useCallback(function(...s){return r.current&&r.current(...s)},[r])}function bi(){return E.useState(null)}function sh(){const t=E.useRef(!0),r=E.useRef(()=>t.current);return E.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),r.current}function nh(t){const r=sh();return[t[0],E.useCallback(s=>{if(r())return t[1](s)},[r,t[1]])]}var it="top",pt="bottom",vt="right",ot="left",ma="auto",us=[it,pt,vt,ot],yr="start",rs="end",ah="clippingParents",Pl="viewport",Rr="popper",ih="reference",yi=us.reduce(function(t,r){return t.concat([r+"-"+yr,r+"-"+rs])},[]),ha=[].concat(us,[ma]).reduce(function(t,r){return t.concat([r,r+"-"+yr,r+"-"+rs])},[]),oh="beforeRead",lh="read",ch="afterRead",dh="beforeMain",uh="main",mh="afterMain",hh="beforeWrite",fh="write",gh="afterWrite",xh=[oh,lh,ch,dh,uh,mh,hh,fh,gh];function Et(t){return t.split("-")[0]}function dt(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var r=t.ownerDocument;return r&&r.defaultView||window}return t}function or(t){var r=dt(t).Element;return t instanceof r||t instanceof Element}function Dt(t){var r=dt(t).HTMLElement;return t instanceof r||t instanceof HTMLElement}function fa(t){if(typeof ShadowRoot>"u")return!1;var r=dt(t).ShadowRoot;return t instanceof r||t instanceof ShadowRoot}var Zt=Math.max,Is=Math.min,jr=Math.round;function Fn(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function Al(){return!/^((?!chrome|android).)*safari/i.test(Fn())}function wr(t,r,s){r===void 0&&(r=!1),s===void 0&&(s=!1);var n=t.getBoundingClientRect(),a=1,i=1;r&&Dt(t)&&(a=t.offsetWidth>0&&jr(n.width)/t.offsetWidth||1,i=t.offsetHeight>0&&jr(n.height)/t.offsetHeight||1);var o=or(t)?dt(t):window,l=o.visualViewport,c=!Al()&&s,d=(n.left+(c&&l?l.offsetLeft:0))/a,f=(n.top+(c&&l?l.offsetTop:0))/i,g=n.width/a,m=n.height/i;return{width:g,height:m,top:f,right:d+g,bottom:f+m,left:d,x:d,y:f}}function ga(t){var r=wr(t),s=t.offsetWidth,n=t.offsetHeight;return Math.abs(r.width-s)<=1&&(s=r.width),Math.abs(r.height-n)<=1&&(n=r.height),{x:t.offsetLeft,y:t.offsetTop,width:s,height:n}}function Rl(t,r){var s=r.getRootNode&&r.getRootNode();if(t.contains(r))return!0;if(s&&fa(s)){var n=r;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function zt(t){return t?(t.nodeName||"").toLowerCase():null}function It(t){return dt(t).getComputedStyle(t)}function ph(t){return["table","td","th"].indexOf(zt(t))>=0}function Vt(t){return((or(t)?t.ownerDocument:t.document)||window.document).documentElement}function Xs(t){return zt(t)==="html"?t:t.assignedSlot||t.parentNode||(fa(t)?t.host:null)||Vt(t)}function ji(t){return!Dt(t)||It(t).position==="fixed"?null:t.offsetParent}function vh(t){var r=/firefox/i.test(Fn()),s=/Trident/i.test(Fn());if(s&&Dt(t)){var n=It(t);if(n.position==="fixed")return null}var a=Xs(t);for(fa(a)&&(a=a.host);Dt(a)&&["html","body"].indexOf(zt(a))<0;){var i=It(a);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||r&&i.willChange==="filter"||r&&i.filter&&i.filter!=="none")return a;a=a.parentNode}return null}function ms(t){for(var r=dt(t),s=ji(t);s&&ph(s)&&It(s).position==="static";)s=ji(s);return s&&(zt(s)==="html"||zt(s)==="body"&&It(s).position==="static")?r:s||vh(t)||r}function xa(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Br(t,r,s){return Zt(t,Is(r,s))}function bh(t,r,s){var n=Br(t,r,s);return n>s?s:n}function Il(){return{top:0,right:0,bottom:0,left:0}}function Ll(t){return Object.assign({},Il(),t)}function Fl(t,r){return r.reduce(function(s,n){return s[n]=t,s},{})}var yh=function(r,s){return r=typeof r=="function"?r(Object.assign({},s.rects,{placement:s.placement})):r,Ll(typeof r!="number"?r:Fl(r,us))};function jh(t){var r,s=t.state,n=t.name,a=t.options,i=s.elements.arrow,o=s.modifiersData.popperOffsets,l=Et(s.placement),c=xa(l),d=[ot,vt].indexOf(l)>=0,f=d?"height":"width";if(!(!i||!o)){var g=yh(a.padding,s),m=ga(i),b=c==="y"?it:ot,j=c==="y"?pt:vt,h=s.rects.reference[f]+s.rects.reference[c]-o[c]-s.rects.popper[f],u=o[c]-s.rects.reference[c],w=ms(i),x=w?c==="y"?w.clientHeight||0:w.clientWidth||0:0,S=h/2-u/2,v=g[b],D=x-m[f]-g[j],P=x/2-m[f]/2+S,A=Br(v,P,D),H=c;s.modifiersData[n]=(r={},r[H]=A,r.centerOffset=A-P,r)}}function wh(t){var r=t.state,s=t.options,n=s.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=r.elements.popper.querySelector(a),!a)||Rl(r.elements.popper,a)&&(r.elements.arrow=a))}const Nh={name:"arrow",enabled:!0,phase:"main",fn:jh,effect:wh,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Nr(t){return t.split("-")[1]}var Sh={top:"auto",right:"auto",bottom:"auto",left:"auto"};function kh(t,r){var s=t.x,n=t.y,a=r.devicePixelRatio||1;return{x:jr(s*a)/a||0,y:jr(n*a)/a||0}}function wi(t){var r,s=t.popper,n=t.popperRect,a=t.placement,i=t.variation,o=t.offsets,l=t.position,c=t.gpuAcceleration,d=t.adaptive,f=t.roundOffsets,g=t.isFixed,m=o.x,b=m===void 0?0:m,j=o.y,h=j===void 0?0:j,u=typeof f=="function"?f({x:b,y:h}):{x:b,y:h};b=u.x,h=u.y;var w=o.hasOwnProperty("x"),x=o.hasOwnProperty("y"),S=ot,v=it,D=window;if(d){var P=ms(s),A="clientHeight",H="clientWidth";if(P===dt(s)&&(P=Vt(s),It(P).position!=="static"&&l==="absolute"&&(A="scrollHeight",H="scrollWidth")),P=P,a===it||(a===ot||a===vt)&&i===rs){v=pt;var O=g&&P===D&&D.visualViewport?D.visualViewport.height:P[A];h-=O-n.height,h*=c?1:-1}if(a===ot||(a===it||a===pt)&&i===rs){S=vt;var z=g&&P===D&&D.visualViewport?D.visualViewport.width:P[H];b-=z-n.width,b*=c?1:-1}}var R=Object.assign({position:l},d&&Sh),K=f===!0?kh({x:b,y:h},dt(s)):{x:b,y:h};if(b=K.x,h=K.y,c){var Y;return Object.assign({},R,(Y={},Y[v]=x?"0":"",Y[S]=w?"0":"",Y.transform=(D.devicePixelRatio||1)<=1?"translate("+b+"px, "+h+"px)":"translate3d("+b+"px, "+h+"px, 0)",Y))}return Object.assign({},R,(r={},r[v]=x?h+"px":"",r[S]=w?b+"px":"",r.transform="",r))}function Ch(t){var r=t.state,s=t.options,n=s.gpuAcceleration,a=n===void 0?!0:n,i=s.adaptive,o=i===void 0?!0:i,l=s.roundOffsets,c=l===void 0?!0:l,d={placement:Et(r.placement),variation:Nr(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:a,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,wi(Object.assign({},d,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:o,roundOffsets:c})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,wi(Object.assign({},d,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}const $h={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ch,data:{}};var ws={passive:!0};function Eh(t){var r=t.state,s=t.instance,n=t.options,a=n.scroll,i=a===void 0?!0:a,o=n.resize,l=o===void 0?!0:o,c=dt(r.elements.popper),d=[].concat(r.scrollParents.reference,r.scrollParents.popper);return i&&d.forEach(function(f){f.addEventListener("scroll",s.update,ws)}),l&&c.addEventListener("resize",s.update,ws),function(){i&&d.forEach(function(f){f.removeEventListener("scroll",s.update,ws)}),l&&c.removeEventListener("resize",s.update,ws)}}const Dh={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Eh,data:{}};var Th={left:"right",right:"left",bottom:"top",top:"bottom"};function Ds(t){return t.replace(/left|right|bottom|top/g,function(r){return Th[r]})}var Oh={start:"end",end:"start"};function Ni(t){return t.replace(/start|end/g,function(r){return Oh[r]})}function pa(t){var r=dt(t),s=r.pageXOffset,n=r.pageYOffset;return{scrollLeft:s,scrollTop:n}}function va(t){return wr(Vt(t)).left+pa(t).scrollLeft}function Mh(t,r){var s=dt(t),n=Vt(t),a=s.visualViewport,i=n.clientWidth,o=n.clientHeight,l=0,c=0;if(a){i=a.width,o=a.height;var d=Al();(d||!d&&r==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:o,x:l+va(t),y:c}}function _h(t){var r,s=Vt(t),n=pa(t),a=(r=t.ownerDocument)==null?void 0:r.body,i=Zt(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),o=Zt(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),l=-n.scrollLeft+va(t),c=-n.scrollTop;return It(a||s).direction==="rtl"&&(l+=Zt(s.clientWidth,a?a.clientWidth:0)-i),{width:i,height:o,x:l,y:c}}function ba(t){var r=It(t),s=r.overflow,n=r.overflowX,a=r.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+n)}function Ul(t){return["html","body","#document"].indexOf(zt(t))>=0?t.ownerDocument.body:Dt(t)&&ba(t)?t:Ul(Xs(t))}function Hr(t,r){var s;r===void 0&&(r=[]);var n=Ul(t),a=n===((s=t.ownerDocument)==null?void 0:s.body),i=dt(n),o=a?[i].concat(i.visualViewport||[],ba(n)?n:[]):n,l=r.concat(o);return a?l:l.concat(Hr(Xs(o)))}function Un(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Ph(t,r){var s=wr(t,!1,r==="fixed");return s.top=s.top+t.clientTop,s.left=s.left+t.clientLeft,s.bottom=s.top+t.clientHeight,s.right=s.left+t.clientWidth,s.width=t.clientWidth,s.height=t.clientHeight,s.x=s.left,s.y=s.top,s}function Si(t,r,s){return r===Pl?Un(Mh(t,s)):or(r)?Ph(r,s):Un(_h(Vt(t)))}function Ah(t){var r=Hr(Xs(t)),s=["absolute","fixed"].indexOf(It(t).position)>=0,n=s&&Dt(t)?ms(t):t;return or(n)?r.filter(function(a){return or(a)&&Rl(a,n)&&zt(a)!=="body"}):[]}function Rh(t,r,s,n){var a=r==="clippingParents"?Ah(t):[].concat(r),i=[].concat(a,[s]),o=i[0],l=i.reduce(function(c,d){var f=Si(t,d,n);return c.top=Zt(f.top,c.top),c.right=Is(f.right,c.right),c.bottom=Is(f.bottom,c.bottom),c.left=Zt(f.left,c.left),c},Si(t,o,n));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function Wl(t){var r=t.reference,s=t.element,n=t.placement,a=n?Et(n):null,i=n?Nr(n):null,o=r.x+r.width/2-s.width/2,l=r.y+r.height/2-s.height/2,c;switch(a){case it:c={x:o,y:r.y-s.height};break;case pt:c={x:o,y:r.y+r.height};break;case vt:c={x:r.x+r.width,y:l};break;case ot:c={x:r.x-s.width,y:l};break;default:c={x:r.x,y:r.y}}var d=a?xa(a):null;if(d!=null){var f=d==="y"?"height":"width";switch(i){case yr:c[d]=c[d]-(r[f]/2-s[f]/2);break;case rs:c[d]=c[d]+(r[f]/2-s[f]/2);break}}return c}function ss(t,r){r===void 0&&(r={});var s=r,n=s.placement,a=n===void 0?t.placement:n,i=s.strategy,o=i===void 0?t.strategy:i,l=s.boundary,c=l===void 0?ah:l,d=s.rootBoundary,f=d===void 0?Pl:d,g=s.elementContext,m=g===void 0?Rr:g,b=s.altBoundary,j=b===void 0?!1:b,h=s.padding,u=h===void 0?0:h,w=Ll(typeof u!="number"?u:Fl(u,us)),x=m===Rr?ih:Rr,S=t.rects.popper,v=t.elements[j?x:m],D=Rh(or(v)?v:v.contextElement||Vt(t.elements.popper),c,f,o),P=wr(t.elements.reference),A=Wl({reference:P,element:S,placement:a}),H=Un(Object.assign({},S,A)),O=m===Rr?H:P,z={top:D.top-O.top+w.top,bottom:O.bottom-D.bottom+w.bottom,left:D.left-O.left+w.left,right:O.right-D.right+w.right},R=t.modifiersData.offset;if(m===Rr&&R){var K=R[a];Object.keys(z).forEach(function(Y){var ee=[vt,pt].indexOf(Y)>=0?1:-1,B=[it,pt].indexOf(Y)>=0?"y":"x";z[Y]+=K[B]*ee})}return z}function Ih(t,r){r===void 0&&(r={});var s=r,n=s.placement,a=s.boundary,i=s.rootBoundary,o=s.padding,l=s.flipVariations,c=s.allowedAutoPlacements,d=c===void 0?ha:c,f=Nr(n),g=f?l?yi:yi.filter(function(j){return Nr(j)===f}):us,m=g.filter(function(j){return d.indexOf(j)>=0});m.length===0&&(m=g);var b=m.reduce(function(j,h){return j[h]=ss(t,{placement:h,boundary:a,rootBoundary:i,padding:o})[Et(h)],j},{});return Object.keys(b).sort(function(j,h){return b[j]-b[h]})}function Lh(t){if(Et(t)===ma)return[];var r=Ds(t);return[Ni(t),r,Ni(r)]}function Fh(t){var r=t.state,s=t.options,n=t.name;if(!r.modifiersData[n]._skip){for(var a=s.mainAxis,i=a===void 0?!0:a,o=s.altAxis,l=o===void 0?!0:o,c=s.fallbackPlacements,d=s.padding,f=s.boundary,g=s.rootBoundary,m=s.altBoundary,b=s.flipVariations,j=b===void 0?!0:b,h=s.allowedAutoPlacements,u=r.options.placement,w=Et(u),x=w===u,S=c||(x||!j?[Ds(u)]:Lh(u)),v=[u].concat(S).reduce(function(ve,$e){return ve.concat(Et($e)===ma?Ih(r,{placement:$e,boundary:f,rootBoundary:g,padding:d,flipVariations:j,allowedAutoPlacements:h}):$e)},[]),D=r.rects.reference,P=r.rects.popper,A=new Map,H=!0,O=v[0],z=0;z<v.length;z++){var R=v[z],K=Et(R),Y=Nr(R)===yr,ee=[it,pt].indexOf(K)>=0,B=ee?"width":"height",V=ss(r,{placement:R,boundary:f,rootBoundary:g,altBoundary:m,padding:d}),I=ee?Y?vt:ot:Y?pt:it;D[B]>P[B]&&(I=Ds(I));var W=Ds(I),J=[];if(i&&J.push(V[K]<=0),l&&J.push(V[I]<=0,V[W]<=0),J.every(function(ve){return ve})){O=R,H=!1;break}A.set(R,J)}if(H)for(var L=j?3:1,fe=function($e){var X=v.find(function(be){var Ee=A.get(be);if(Ee)return Ee.slice(0,$e).every(function(te){return te})});if(X)return O=X,"break"},he=L;he>0;he--){var xe=fe(he);if(xe==="break")break}r.placement!==O&&(r.modifiersData[n]._skip=!0,r.placement=O,r.reset=!0)}}const Uh={name:"flip",enabled:!0,phase:"main",fn:Fh,requiresIfExists:["offset"],data:{_skip:!1}};function ki(t,r,s){return s===void 0&&(s={x:0,y:0}),{top:t.top-r.height-s.y,right:t.right-r.width+s.x,bottom:t.bottom-r.height+s.y,left:t.left-r.width-s.x}}function Ci(t){return[it,vt,pt,ot].some(function(r){return t[r]>=0})}function Wh(t){var r=t.state,s=t.name,n=r.rects.reference,a=r.rects.popper,i=r.modifiersData.preventOverflow,o=ss(r,{elementContext:"reference"}),l=ss(r,{altBoundary:!0}),c=ki(o,n),d=ki(l,a,i),f=Ci(c),g=Ci(d);r.modifiersData[s]={referenceClippingOffsets:c,popperEscapeOffsets:d,isReferenceHidden:f,hasPopperEscaped:g},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":g})}const Bh={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Wh};function Hh(t,r,s){var n=Et(t),a=[ot,it].indexOf(n)>=0?-1:1,i=typeof s=="function"?s(Object.assign({},r,{placement:t})):s,o=i[0],l=i[1];return o=o||0,l=(l||0)*a,[ot,vt].indexOf(n)>=0?{x:l,y:o}:{x:o,y:l}}function zh(t){var r=t.state,s=t.options,n=t.name,a=s.offset,i=a===void 0?[0,0]:a,o=ha.reduce(function(f,g){return f[g]=Hh(g,r.rects,i),f},{}),l=o[r.placement],c=l.x,d=l.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=c,r.modifiersData.popperOffsets.y+=d),r.modifiersData[n]=o}const Gh={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:zh};function qh(t){var r=t.state,s=t.name;r.modifiersData[s]=Wl({reference:r.rects.reference,element:r.rects.popper,placement:r.placement})}const Yh={name:"popperOffsets",enabled:!0,phase:"read",fn:qh,data:{}};function Vh(t){return t==="x"?"y":"x"}function Kh(t){var r=t.state,s=t.options,n=t.name,a=s.mainAxis,i=a===void 0?!0:a,o=s.altAxis,l=o===void 0?!1:o,c=s.boundary,d=s.rootBoundary,f=s.altBoundary,g=s.padding,m=s.tether,b=m===void 0?!0:m,j=s.tetherOffset,h=j===void 0?0:j,u=ss(r,{boundary:c,rootBoundary:d,padding:g,altBoundary:f}),w=Et(r.placement),x=Nr(r.placement),S=!x,v=xa(w),D=Vh(v),P=r.modifiersData.popperOffsets,A=r.rects.reference,H=r.rects.popper,O=typeof h=="function"?h(Object.assign({},r.rects,{placement:r.placement})):h,z=typeof O=="number"?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),R=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,K={x:0,y:0};if(P){if(i){var Y,ee=v==="y"?it:ot,B=v==="y"?pt:vt,V=v==="y"?"height":"width",I=P[v],W=I+u[ee],J=I-u[B],L=b?-H[V]/2:0,fe=x===yr?A[V]:H[V],he=x===yr?-H[V]:-A[V],xe=r.elements.arrow,ve=b&&xe?ga(xe):{width:0,height:0},$e=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:Il(),X=$e[ee],be=$e[B],Ee=Br(0,A[V],ve[V]),te=S?A[V]/2-L-Ee-X-z.mainAxis:fe-Ee-X-z.mainAxis,Ne=S?-A[V]/2+L+Ee+be+z.mainAxis:he+Ee+be+z.mainAxis,ke=r.elements.arrow&&ms(r.elements.arrow),rt=ke?v==="y"?ke.clientTop||0:ke.clientLeft||0:0,st=(Y=R==null?void 0:R[v])!=null?Y:0,He=I+te-st-rt,q=I+Ne-st,pe=Br(b?Is(W,He):W,I,b?Zt(J,q):J);P[v]=pe,K[v]=pe-I}if(l){var ue,je=v==="x"?it:ot,Ie=v==="x"?pt:vt,Oe=P[D],ze=D==="y"?"height":"width",nt=Oe+u[je],$=Oe-u[Ie],U=[it,ot].indexOf(w)!==-1,p=(ue=R==null?void 0:R[D])!=null?ue:0,N=U?nt:Oe-A[ze]-H[ze]-p+z.altAxis,y=U?Oe+A[ze]+H[ze]-p-z.altAxis:$,T=b&&U?bh(N,Oe,y):Br(b?N:nt,Oe,b?y:$);P[D]=T,K[D]=T-Oe}r.modifiersData[n]=K}}const Jh={name:"preventOverflow",enabled:!0,phase:"main",fn:Kh,requiresIfExists:["offset"]};function Xh(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Qh(t){return t===dt(t)||!Dt(t)?pa(t):Xh(t)}function Zh(t){var r=t.getBoundingClientRect(),s=jr(r.width)/t.offsetWidth||1,n=jr(r.height)/t.offsetHeight||1;return s!==1||n!==1}function ef(t,r,s){s===void 0&&(s=!1);var n=Dt(r),a=Dt(r)&&Zh(r),i=Vt(r),o=wr(t,a,s),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!s)&&((zt(r)!=="body"||ba(i))&&(l=Qh(r)),Dt(r)?(c=wr(r,!0),c.x+=r.clientLeft,c.y+=r.clientTop):i&&(c.x=va(i))),{x:o.left+l.scrollLeft-c.x,y:o.top+l.scrollTop-c.y,width:o.width,height:o.height}}function tf(t){var r=new Map,s=new Set,n=[];t.forEach(function(i){r.set(i.name,i)});function a(i){s.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(l){if(!s.has(l)){var c=r.get(l);c&&a(c)}}),n.push(i)}return t.forEach(function(i){s.has(i.name)||a(i)}),n}function rf(t){var r=tf(t);return xh.reduce(function(s,n){return s.concat(r.filter(function(a){return a.phase===n}))},[])}function sf(t){var r;return function(){return r||(r=new Promise(function(s){Promise.resolve().then(function(){r=void 0,s(t())})})),r}}function nf(t){var r=t.reduce(function(s,n){var a=s[n.name];return s[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,s},{});return Object.keys(r).map(function(s){return r[s]})}var $i={placement:"bottom",modifiers:[],strategy:"absolute"};function Ei(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return!r.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function af(t){t===void 0&&(t={});var r=t,s=r.defaultModifiers,n=s===void 0?[]:s,a=r.defaultOptions,i=a===void 0?$i:a;return function(l,c,d){d===void 0&&(d=i);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},$i,i),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},g=[],m=!1,b={state:f,setOptions:function(w){var x=typeof w=="function"?w(f.options):w;h(),f.options=Object.assign({},i,f.options,x),f.scrollParents={reference:or(l)?Hr(l):l.contextElement?Hr(l.contextElement):[],popper:Hr(c)};var S=rf(nf([].concat(n,f.options.modifiers)));return f.orderedModifiers=S.filter(function(v){return v.enabled}),j(),b.update()},forceUpdate:function(){if(!m){var w=f.elements,x=w.reference,S=w.popper;if(Ei(x,S)){f.rects={reference:ef(x,ms(S),f.options.strategy==="fixed"),popper:ga(S)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(z){return f.modifiersData[z.name]=Object.assign({},z.data)});for(var v=0;v<f.orderedModifiers.length;v++){if(f.reset===!0){f.reset=!1,v=-1;continue}var D=f.orderedModifiers[v],P=D.fn,A=D.options,H=A===void 0?{}:A,O=D.name;typeof P=="function"&&(f=P({state:f,options:H,name:O,instance:b})||f)}}}},update:sf(function(){return new Promise(function(u){b.forceUpdate(),u(f)})}),destroy:function(){h(),m=!0}};if(!Ei(l,c))return b;b.setOptions(d).then(function(u){!m&&d.onFirstUpdate&&d.onFirstUpdate(u)});function j(){f.orderedModifiers.forEach(function(u){var w=u.name,x=u.options,S=x===void 0?{}:x,v=u.effect;if(typeof v=="function"){var D=v({state:f,name:w,instance:b,options:S}),P=function(){};g.push(D||P)}})}function h(){g.forEach(function(u){return u()}),g=[]}return b}}var of=af({defaultModifiers:[Bh,Yh,$h,Dh,Gh,Uh,Jh,Nh]}),Di=function(r){return{position:r,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},lf={name:"applyStyles",enabled:!1},cf={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(r){var s=r.state;return function(){var n=s.elements,a=n.reference,i=n.popper;if("removeAttribute"in a){var o=(a.getAttribute("aria-describedby")||"").split(",").filter(function(l){return l.trim()!==i.id});o.length?a.setAttribute("aria-describedby",o.join(",")):a.removeAttribute("aria-describedby")}}},fn:function(r){var s,n=r.state,a=n.elements,i=a.popper,o=a.reference,l=(s=i.getAttribute("role"))==null?void 0:s.toLowerCase();if(i.id&&l==="tooltip"&&"setAttribute"in o){var c=o.getAttribute("aria-describedby");if(c&&c.split(",").indexOf(i.id)!==-1)return;o.setAttribute("aria-describedby",c?c+","+i.id:i.id)}}},df=[];function uf(t,r,s){var n=s===void 0?{}:s,a=n.enabled,i=a===void 0?!0:a,o=n.placement,l=o===void 0?"bottom":o,c=n.strategy,d=c===void 0?"absolute":c,f=n.modifiers,g=f===void 0?df:f,m=Vs(n,["enabled","placement","strategy","modifiers"]),b=E.useRef(),j=E.useCallback(function(){var v;(v=b.current)==null||v.update()},[]),h=E.useCallback(function(){var v;(v=b.current)==null||v.forceUpdate()},[]),u=nh(E.useState({placement:l,update:j,forceUpdate:h,attributes:{},styles:{popper:Di(d),arrow:{}}})),w=u[0],x=u[1],S=E.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(D){var P=D.state,A={},H={};Object.keys(P.elements).forEach(function(O){A[O]=P.styles[O],H[O]=P.attributes[O]}),x({state:P,styles:A,attributes:H,update:j,forceUpdate:h,placement:P.placement})}}},[j,h,x]);return E.useEffect(function(){!b.current||!i||b.current.setOptions({placement:l,strategy:d,modifiers:[].concat(g,[S,lf])})},[d,l,S,i]),E.useEffect(function(){if(!(!i||t==null||r==null))return b.current=of(t,r,_e({},m,{placement:l,strategy:d,modifiers:[].concat(g,[cf,S])})),function(){b.current!=null&&(b.current.destroy(),b.current=void 0,x(function(v){return _e({},v,{attributes:{},styles:{popper:Di(d)}})}))}},[i,t,r]),w}function mf(t,r,s,n){var a=n&&typeof n!="boolean"?n.capture:n;t.removeEventListener(r,s,a),s.__once&&t.removeEventListener(r,s.__once,a)}function Fr(t,r,s,n){return th(t,r,s,n),function(){mf(t,r,s,n)}}var hf=function(){},ff=hf;const gf=bt(ff);function xf(t){return t&&"setState"in t?Bo.findDOMNode(t):t??null}const pf=function(t){return ds(xf(t))};var vf=27,Ti=function(){};function bf(t){return t.button===0}function yf(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}var Oi=function(r){return r&&("current"in r?r.current:r)};function jf(t,r,s){var n=s===void 0?{}:s,a=n.disabled,i=n.clickTrigger,o=i===void 0?"click":i,l=E.useRef(!1),c=r||Ti,d=E.useCallback(function(m){var b,j=Oi(t);gf(!!j,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),l.current=!j||yf(m)||!bf(m)||!!ts(j,(b=m.composedPath==null?void 0:m.composedPath()[0])!=null?b:m.target)},[t]),f=vi(function(m){l.current||c(m)}),g=vi(function(m){m.keyCode===vf&&c(m)});E.useEffect(function(){if(!(a||t==null)){var m=window.event,b=pf(Oi(t)),j=Fr(b,o,d,!0),h=Fr(b,o,function(x){if(x===m){m=void 0;return}f(x)}),u=Fr(b,"keyup",function(x){if(x===m){m=void 0;return}g(x)}),w=[];return"ontouchstart"in b.documentElement&&(w=[].slice.call(b.body.children).map(function(x){return Fr(x,"mousemove",Ti)})),function(){j(),h(),u(),w.forEach(function(x){return x()})}}},[t,a,o,d,f,g])}function wf(t){var r={};return Array.isArray(t)?(t==null||t.forEach(function(s){r[s.name]=s}),r):t||r}function Nf(t){return t===void 0&&(t={}),Array.isArray(t)?t:Object.keys(t).map(function(r){return t[r].name=r,t[r]})}function Sf(t){var r,s,n,a,i=t.enabled,o=t.enableEvents,l=t.placement,c=t.flip,d=t.offset,f=t.fixed,g=t.containerPadding,m=t.arrowElement,b=t.popperConfig,j=b===void 0?{}:b,h=wf(j.modifiers);return _e({},j,{placement:l,enabled:i,strategy:f?"fixed":j.strategy,modifiers:Nf(_e({},h,{eventListeners:{enabled:o},preventOverflow:_e({},h.preventOverflow,{options:g?_e({padding:g},(r=h.preventOverflow)==null?void 0:r.options):(s=h.preventOverflow)==null?void 0:s.options}),offset:{options:_e({offset:d},(n=h.offset)==null?void 0:n.options)},arrow:_e({},h.arrow,{enabled:!!m,options:_e({},(a=h.arrow)==null?void 0:a.options,{element:m})}),flip:_e({enabled:!!c},h.flip)}))})}function kf(t,r){return t.classList?t.classList.contains(r):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+r+" ")!==-1}function Cf(t,r){t.classList?t.classList.add(r):kf(t,r)||(typeof t.className=="string"?t.className=t.className+" "+r:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+r))}function Mi(t,r){return t.replace(new RegExp("(^|\\s)"+r+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function $f(t,r){t.classList?t.classList.remove(r):typeof t.className=="string"?t.className=Mi(t.className,r):t.setAttribute("class",Mi(t.className&&t.className.baseVal||"",r))}var Ns;function ya(t){if((!Ns&&Ns!==0||t)&&ua){var r=document.createElement("div");r.style.position="absolute",r.style.top="-9999px",r.style.width="50px",r.style.height="50px",r.style.overflow="scroll",document.body.appendChild(r),Ns=r.offsetWidth-r.clientWidth,document.body.removeChild(r)}return Ns}var jn=function(r){var s;return typeof document>"u"?null:r==null?ds().body:(typeof r=="function"&&(r=r()),r&&"current"in r&&(r=r.current),(s=r)!=null&&s.nodeType&&r||null)};function _i(t,r){var s=E.useState(function(){return jn(t)}),n=s[0],a=s[1];if(!n){var i=jn(t);i&&a(i)}return E.useEffect(function(){},[r,n]),E.useEffect(function(){var o=jn(t);o!==n&&a(o)},[t,n]),n}const Pi=t=>!t||typeof t=="function"?t:r=>{t.current=r};function Ef(t,r){const s=Pi(t),n=Pi(r);return a=>{s&&s(a),n&&n(a)}}function Df(t,r){return E.useMemo(()=>Ef(t,r),[t,r])}var ja=_.forwardRef(function(t,r){var s=t.flip,n=t.offset,a=t.placement,i=t.containerPadding,o=i===void 0?5:i,l=t.popperConfig,c=l===void 0?{}:l,d=t.transition,f=bi(),g=f[0],m=f[1],b=bi(),j=b[0],h=b[1],u=Df(m,r),w=_i(t.container),x=_i(t.target),S=E.useState(!t.show),v=S[0],D=S[1],P=uf(x,g,Sf({placement:a,enableEvents:!!t.show,containerPadding:o||5,flip:s,offset:n,arrowElement:j,popperConfig:c})),A=P.styles,H=P.attributes,O=Vs(P,["styles","attributes"]);t.show?v&&D(!1):!t.transition&&!v&&D(!0);var z=function(){D(!0),t.onExited&&t.onExited.apply(t,arguments)},R=t.show||d&&!v;if(jf(g,t.onHide,{disabled:!t.rootClose||t.rootCloseDisabled,clickTrigger:t.rootCloseEvent}),!R)return null;var K=t.children(_e({},O,{show:!!t.show,props:_e({},H.popper,{style:A.popper,ref:u}),arrowProps:_e({},H.arrow,{style:A.arrow,ref:h})}));if(d){var Y=t.onExit,ee=t.onExiting,B=t.onEnter,V=t.onEntering,I=t.onEntered;K=_.createElement(d,{in:t.show,appear:!0,onExit:Y,onExiting:ee,onExited:z,onEnter:B,onEntering:V,onEntered:I},K)}return w?Bo.createPortal(K,w):null});ja.displayName="Overlay";ja.propTypes={show:re.bool,placement:re.oneOf(ha),target:re.any,container:re.any,flip:re.bool,children:re.func.isRequired,containerPadding:re.number,popperConfig:re.object,rootClose:re.bool,rootCloseEvent:re.oneOf(["click","mousedown"]),rootCloseDisabled:re.bool,onHide:function(r){for(var s=arguments.length,n=new Array(s>1?s-1:0),a=1;a<s;a++)n[a-1]=arguments[a];if(r.rootClose){var i;return(i=re.func).isRequired.apply(i,[r].concat(n))}return re.func.apply(re,[r].concat(n))},transition:re.elementType,onEnter:re.func,onEntering:re.func,onEntered:re.func,onExit:re.func,onExiting:re.func,onExited:re.func};function Tf(){this.__data__=[],this.size=0}var Of=Tf,Mf=os;function _f(t,r){for(var s=t.length;s--;)if(Mf(t[s][0],r))return s;return-1}var Qs=_f,Pf=Qs,Af=Array.prototype,Rf=Af.splice;function If(t){var r=this.__data__,s=Pf(r,t);if(s<0)return!1;var n=r.length-1;return s==n?r.pop():Rf.call(r,s,1),--this.size,!0}var Lf=If,Ff=Qs;function Uf(t){var r=this.__data__,s=Ff(r,t);return s<0?void 0:r[s][1]}var Wf=Uf,Bf=Qs;function Hf(t){return Bf(this.__data__,t)>-1}var zf=Hf,Gf=Qs;function qf(t,r){var s=this.__data__,n=Gf(s,t);return n<0?(++this.size,s.push([t,r])):s[n][1]=r,this}var Yf=qf,Vf=Of,Kf=Lf,Jf=Wf,Xf=zf,Qf=Yf;function Dr(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var n=t[r];this.set(n[0],n[1])}}Dr.prototype.clear=Vf;Dr.prototype.delete=Kf;Dr.prototype.get=Jf;Dr.prototype.has=Xf;Dr.prototype.set=Qf;var Zs=Dr,Zf=Zs;function eg(){this.__data__=new Zf,this.size=0}var tg=eg;function rg(t){var r=this.__data__,s=r.delete(t);return this.size=r.size,s}var sg=rg;function ng(t){return this.__data__.get(t)}var ag=ng;function ig(t){return this.__data__.has(t)}var og=ig,lg=Mt,cg=lg["__core-js_shared__"],dg=cg,wn=dg,Ai=function(){var t=/[^.]+$/.exec(wn&&wn.keys&&wn.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function ug(t){return!!Ai&&Ai in t}var mg=ug,hg=Function.prototype,fg=hg.toString;function gg(t){if(t!=null){try{return fg.call(t)}catch{}try{return t+""}catch{}}return""}var Bl=gg,xg=oa,pg=mg,vg=Ft,bg=Bl,yg=/[\\^$.*+?()[\]{}|]/g,jg=/^\[object .+?Constructor\]$/,wg=Function.prototype,Ng=Object.prototype,Sg=wg.toString,kg=Ng.hasOwnProperty,Cg=RegExp("^"+Sg.call(kg).replace(yg,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $g(t){if(!vg(t)||pg(t))return!1;var r=xg(t)?Cg:jg;return r.test(bg(t))}var Eg=$g;function Dg(t,r){return t==null?void 0:t[r]}var Tg=Dg,Og=Eg,Mg=Tg;function _g(t,r){var s=Mg(t,r);return Og(s)?s:void 0}var cr=_g,Pg=cr,Ag=Mt,Rg=Pg(Ag,"Map"),wa=Rg,Ig=cr,Lg=Ig(Object,"create"),en=Lg,Ri=en;function Fg(){this.__data__=Ri?Ri(null):{},this.size=0}var Ug=Fg;function Wg(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var Bg=Wg,Hg=en,zg="__lodash_hash_undefined__",Gg=Object.prototype,qg=Gg.hasOwnProperty;function Yg(t){var r=this.__data__;if(Hg){var s=r[t];return s===zg?void 0:s}return qg.call(r,t)?r[t]:void 0}var Vg=Yg,Kg=en,Jg=Object.prototype,Xg=Jg.hasOwnProperty;function Qg(t){var r=this.__data__;return Kg?r[t]!==void 0:Xg.call(r,t)}var Zg=Qg,ex=en,tx="__lodash_hash_undefined__";function rx(t,r){var s=this.__data__;return this.size+=this.has(t)?0:1,s[t]=ex&&r===void 0?tx:r,this}var sx=rx,nx=Ug,ax=Bg,ix=Vg,ox=Zg,lx=sx;function Tr(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var n=t[r];this.set(n[0],n[1])}}Tr.prototype.clear=nx;Tr.prototype.delete=ax;Tr.prototype.get=ix;Tr.prototype.has=ox;Tr.prototype.set=lx;var cx=Tr,Ii=cx,dx=Zs,ux=wa;function mx(){this.size=0,this.__data__={hash:new Ii,map:new(ux||dx),string:new Ii}}var hx=mx;function fx(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}var gx=fx,xx=gx;function px(t,r){var s=t.__data__;return xx(r)?s[typeof r=="string"?"string":"hash"]:s.map}var tn=px,vx=tn;function bx(t){var r=vx(this,t).delete(t);return this.size-=r?1:0,r}var yx=bx,jx=tn;function wx(t){return jx(this,t).get(t)}var Nx=wx,Sx=tn;function kx(t){return Sx(this,t).has(t)}var Cx=kx,$x=tn;function Ex(t,r){var s=$x(this,t),n=s.size;return s.set(t,r),this.size+=s.size==n?0:1,this}var Dx=Ex,Tx=hx,Ox=yx,Mx=Nx,_x=Cx,Px=Dx;function Or(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var n=t[r];this.set(n[0],n[1])}}Or.prototype.clear=Tx;Or.prototype.delete=Ox;Or.prototype.get=Mx;Or.prototype.has=_x;Or.prototype.set=Px;var Na=Or,Ax=Zs,Rx=wa,Ix=Na,Lx=200;function Fx(t,r){var s=this.__data__;if(s instanceof Ax){var n=s.__data__;if(!Rx||n.length<Lx-1)return n.push([t,r]),this.size=++s.size,this;s=this.__data__=new Ix(n)}return s.set(t,r),this.size=s.size,this}var Ux=Fx,Wx=Zs,Bx=tg,Hx=sg,zx=ag,Gx=og,qx=Ux;function Mr(t){var r=this.__data__=new Wx(t);this.size=r.size}Mr.prototype.clear=Bx;Mr.prototype.delete=Hx;Mr.prototype.get=zx;Mr.prototype.has=Gx;Mr.prototype.set=qx;var Sa=Mr,Yx="__lodash_hash_undefined__";function Vx(t){return this.__data__.set(t,Yx),this}var Kx=Vx;function Jx(t){return this.__data__.has(t)}var Xx=Jx,Qx=Na,Zx=Kx,ep=Xx;function Ls(t){var r=-1,s=t==null?0:t.length;for(this.__data__=new Qx;++r<s;)this.add(t[r])}Ls.prototype.add=Ls.prototype.push=Zx;Ls.prototype.has=ep;var tp=Ls;function rp(t,r){for(var s=-1,n=t==null?0:t.length;++s<n;)if(r(t[s],s,t))return!0;return!1}var sp=rp;function np(t,r){return t.has(r)}var ap=np,ip=tp,op=sp,lp=ap,cp=1,dp=2;function up(t,r,s,n,a,i){var o=s&cp,l=t.length,c=r.length;if(l!=c&&!(o&&c>l))return!1;var d=i.get(t),f=i.get(r);if(d&&f)return d==r&&f==t;var g=-1,m=!0,b=s&dp?new ip:void 0;for(i.set(t,r),i.set(r,t);++g<l;){var j=t[g],h=r[g];if(n)var u=o?n(h,j,g,r,t,i):n(j,h,g,t,r,i);if(u!==void 0){if(u)continue;m=!1;break}if(b){if(!op(r,function(w,x){if(!lp(b,x)&&(j===w||a(j,w,s,n,i)))return b.push(x)})){m=!1;break}}else if(!(j===h||a(j,h,s,n,i))){m=!1;break}}return i.delete(t),i.delete(r),m}var Hl=up,mp=Mt,hp=mp.Uint8Array,zl=hp;function fp(t){var r=-1,s=Array(t.size);return t.forEach(function(n,a){s[++r]=[a,n]}),s}var gp=fp;function xp(t){var r=-1,s=Array(t.size);return t.forEach(function(n){s[++r]=n}),s}var pp=xp,Li=$r,Fi=zl,vp=os,bp=Hl,yp=gp,jp=pp,wp=1,Np=2,Sp="[object Boolean]",kp="[object Date]",Cp="[object Error]",$p="[object Map]",Ep="[object Number]",Dp="[object RegExp]",Tp="[object Set]",Op="[object String]",Mp="[object Symbol]",_p="[object ArrayBuffer]",Pp="[object DataView]",Ui=Li?Li.prototype:void 0,Nn=Ui?Ui.valueOf:void 0;function Ap(t,r,s,n,a,i,o){switch(s){case Pp:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case _p:return!(t.byteLength!=r.byteLength||!i(new Fi(t),new Fi(r)));case Sp:case kp:case Ep:return vp(+t,+r);case Cp:return t.name==r.name&&t.message==r.message;case Dp:case Op:return t==r+"";case $p:var l=yp;case Tp:var c=n&wp;if(l||(l=jp),t.size!=r.size&&!c)return!1;var d=o.get(t);if(d)return d==r;n|=Np,o.set(t,r);var f=bp(l(t),l(r),n,a,i,o);return o.delete(t),f;case Mp:if(Nn)return Nn.call(t)==Nn.call(r)}return!1}var Rp=Ap;function Ip(t,r){for(var s=-1,n=r.length,a=t.length;++s<n;)t[a+s]=r[s];return t}var ka=Ip,Lp=Array.isArray,yt=Lp,Fp=ka,Up=yt;function Wp(t,r,s){var n=r(t);return Up(t)?n:Fp(n,s(t))}var Gl=Wp;function Bp(t,r){for(var s=-1,n=t==null?0:t.length,a=0,i=[];++s<n;){var o=t[s];r(o,s,t)&&(i[a++]=o)}return i}var Hp=Bp;function zp(){return[]}var ql=zp,Gp=Hp,qp=ql,Yp=Object.prototype,Vp=Yp.propertyIsEnumerable,Wi=Object.getOwnPropertySymbols,Kp=Wi?function(t){return t==null?[]:(t=Object(t),Gp(Wi(t),function(r){return Vp.call(t,r)}))}:qp,Ca=Kp;function Jp(t,r){for(var s=-1,n=Array(t);++s<t;)n[s]=r(s);return n}var Xp=Jp,Qp=Er,Zp=Yt,e0="[object Arguments]";function t0(t){return Zp(t)&&Qp(t)==e0}var r0=t0,Bi=r0,s0=Yt,Yl=Object.prototype,n0=Yl.hasOwnProperty,a0=Yl.propertyIsEnumerable,i0=Bi(function(){return arguments}())?Bi:function(t){return s0(t)&&n0.call(t,"callee")&&!a0.call(t,"callee")},$a=i0,Fs={exports:{}};function o0(){return!1}var l0=o0;Fs.exports;(function(t,r){var s=Mt,n=l0,a=r&&!r.nodeType&&r,i=a&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===a,l=o?s.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;t.exports=d})(Fs,Fs.exports);var rn=Fs.exports,c0=Er,d0=la,u0=Yt,m0="[object Arguments]",h0="[object Array]",f0="[object Boolean]",g0="[object Date]",x0="[object Error]",p0="[object Function]",v0="[object Map]",b0="[object Number]",y0="[object Object]",j0="[object RegExp]",w0="[object Set]",N0="[object String]",S0="[object WeakMap]",k0="[object ArrayBuffer]",C0="[object DataView]",$0="[object Float32Array]",E0="[object Float64Array]",D0="[object Int8Array]",T0="[object Int16Array]",O0="[object Int32Array]",M0="[object Uint8Array]",_0="[object Uint8ClampedArray]",P0="[object Uint16Array]",A0="[object Uint32Array]",De={};De[$0]=De[E0]=De[D0]=De[T0]=De[O0]=De[M0]=De[_0]=De[P0]=De[A0]=!0;De[m0]=De[h0]=De[k0]=De[f0]=De[C0]=De[g0]=De[x0]=De[p0]=De[v0]=De[b0]=De[y0]=De[j0]=De[w0]=De[N0]=De[S0]=!1;function R0(t){return u0(t)&&d0(t.length)&&!!De[c0(t)]}var I0=R0;function L0(t){return function(r){return t(r)}}var sn=L0,Us={exports:{}};Us.exports;(function(t,r){var s=kl,n=r&&!r.nodeType&&r,a=n&&!0&&t&&!t.nodeType&&t,i=a&&a.exports===n,o=i&&s.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();t.exports=l})(Us,Us.exports);var Ea=Us.exports,F0=I0,U0=sn,Hi=Ea,zi=Hi&&Hi.isTypedArray,W0=zi?U0(zi):F0,Da=W0,B0=Xp,H0=$a,z0=yt,G0=rn,q0=ca,Y0=Da,V0=Object.prototype,K0=V0.hasOwnProperty;function J0(t,r){var s=z0(t),n=!s&&H0(t),a=!s&&!n&&G0(t),i=!s&&!n&&!a&&Y0(t),o=s||n||a||i,l=o?B0(t.length,String):[],c=l.length;for(var d in t)(r||K0.call(t,d))&&!(o&&(d=="length"||a&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||q0(d,c)))&&l.push(d);return l}var Vl=J0,X0=Object.prototype;function Q0(t){var r=t&&t.constructor,s=typeof r=="function"&&r.prototype||X0;return t===s}var Ta=Q0;function Z0(t,r){return function(s){return t(r(s))}}var Kl=Z0,ev=Kl,tv=ev(Object.keys,Object),rv=tv,sv=Ta,nv=rv,av=Object.prototype,iv=av.hasOwnProperty;function ov(t){if(!sv(t))return nv(t);var r=[];for(var s in Object(t))iv.call(t,s)&&s!="constructor"&&r.push(s);return r}var lv=ov,cv=Vl,dv=lv,uv=ls;function mv(t){return uv(t)?cv(t):dv(t)}var hs=mv,hv=Gl,fv=Ca,gv=hs;function xv(t){return hv(t,gv,fv)}var Jl=xv,Gi=Jl,pv=1,vv=Object.prototype,bv=vv.hasOwnProperty;function yv(t,r,s,n,a,i){var o=s&pv,l=Gi(t),c=l.length,d=Gi(r),f=d.length;if(c!=f&&!o)return!1;for(var g=c;g--;){var m=l[g];if(!(o?m in r:bv.call(r,m)))return!1}var b=i.get(t),j=i.get(r);if(b&&j)return b==r&&j==t;var h=!0;i.set(t,r),i.set(r,t);for(var u=o;++g<c;){m=l[g];var w=t[m],x=r[m];if(n)var S=o?n(x,w,m,r,t,i):n(w,x,m,t,r,i);if(!(S===void 0?w===x||a(w,x,s,n,i):S)){h=!1;break}u||(u=m=="constructor")}if(h&&!u){var v=t.constructor,D=r.constructor;v!=D&&"constructor"in t&&"constructor"in r&&!(typeof v=="function"&&v instanceof v&&typeof D=="function"&&D instanceof D)&&(h=!1)}return i.delete(t),i.delete(r),h}var jv=yv,wv=cr,Nv=Mt,Sv=wv(Nv,"DataView"),kv=Sv,Cv=cr,$v=Mt,Ev=Cv($v,"Promise"),Dv=Ev,Tv=cr,Ov=Mt,Mv=Tv(Ov,"Set"),_v=Mv,Pv=cr,Av=Mt,Rv=Pv(Av,"WeakMap"),Iv=Rv,Wn=kv,Bn=wa,Hn=Dv,zn=_v,Gn=Iv,Xl=Er,_r=Bl,qi="[object Map]",Lv="[object Object]",Yi="[object Promise]",Vi="[object Set]",Ki="[object WeakMap]",Ji="[object DataView]",Fv=_r(Wn),Uv=_r(Bn),Wv=_r(Hn),Bv=_r(zn),Hv=_r(Gn),Kt=Xl;(Wn&&Kt(new Wn(new ArrayBuffer(1)))!=Ji||Bn&&Kt(new Bn)!=qi||Hn&&Kt(Hn.resolve())!=Yi||zn&&Kt(new zn)!=Vi||Gn&&Kt(new Gn)!=Ki)&&(Kt=function(t){var r=Xl(t),s=r==Lv?t.constructor:void 0,n=s?_r(s):"";if(n)switch(n){case Fv:return Ji;case Uv:return qi;case Wv:return Yi;case Bv:return Vi;case Hv:return Ki}return r});var nn=Kt,Sn=Sa,zv=Hl,Gv=Rp,qv=jv,Xi=nn,Qi=yt,Zi=rn,Yv=Da,Vv=1,eo="[object Arguments]",to="[object Array]",Ss="[object Object]",Kv=Object.prototype,ro=Kv.hasOwnProperty;function Jv(t,r,s,n,a,i){var o=Qi(t),l=Qi(r),c=o?to:Xi(t),d=l?to:Xi(r);c=c==eo?Ss:c,d=d==eo?Ss:d;var f=c==Ss,g=d==Ss,m=c==d;if(m&&Zi(t)){if(!Zi(r))return!1;o=!0,f=!1}if(m&&!f)return i||(i=new Sn),o||Yv(t)?zv(t,r,s,n,a,i):Gv(t,r,c,s,n,a,i);if(!(s&Vv)){var b=f&&ro.call(t,"__wrapped__"),j=g&&ro.call(r,"__wrapped__");if(b||j){var h=b?t.value():t,u=j?r.value():r;return i||(i=new Sn),a(h,u,s,n,i)}}return m?(i||(i=new Sn),qv(t,r,s,n,a,i)):!1}var Xv=Jv,Qv=Xv,so=Yt;function Ql(t,r,s,n,a){return t===r?!0:t==null||r==null||!so(t)&&!so(r)?t!==t&&r!==r:Qv(t,r,s,n,Ql,a)}var Oa=Ql,Zv=Oa;function eb(t,r){return Zv(t,r)}var tb=eb;const rb=bt(tb);function kn(t,r){var s=da(t);return s?s.innerHeight:Qt(t).height}function Zl(t,r,s){t.closest&&!s&&t.closest(r);var n=t;do{if(Qm(n,r))return n;n=n.parentElement}while(n&&n!==s&&n.nodeType===document.ELEMENT_NODE);return null}function sb(t,r,s,n){for(var a=t.length,i=s+(n?1:-1);n?i--:++i<a;)if(r(t[i],i,t))return i;return-1}var nb=sb,ab=Sa,ib=Oa,ob=1,lb=2;function cb(t,r,s,n){var a=s.length,i=a,o=!n;if(t==null)return!i;for(t=Object(t);a--;){var l=s[a];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++a<i;){l=s[a];var c=l[0],d=t[c],f=l[1];if(o&&l[2]){if(d===void 0&&!(c in t))return!1}else{var g=new ab;if(n)var m=n(d,f,c,t,r,g);if(!(m===void 0?ib(f,d,ob|lb,n,g):m))return!1}}return!0}var db=cb,ub=Ft;function mb(t){return t===t&&!ub(t)}var ec=mb,hb=ec,fb=hs;function gb(t){for(var r=fb(t),s=r.length;s--;){var n=r[s],a=t[n];r[s]=[n,a,hb(a)]}return r}var xb=gb;function pb(t,r){return function(s){return s==null?!1:s[t]===r&&(r!==void 0||t in Object(s))}}var tc=pb,vb=db,bb=xb,yb=tc;function jb(t){var r=bb(t);return r.length==1&&r[0][2]?yb(r[0][0],r[0][1]):function(s){return s===t||vb(s,t,r)}}var wb=jb,Nb=yt,Sb=cs,kb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Cb=/^\w*$/;function $b(t,r){if(Nb(t))return!1;var s=typeof t;return s=="number"||s=="symbol"||s=="boolean"||t==null||Sb(t)?!0:Cb.test(t)||!kb.test(t)||r!=null&&t in Object(r)}var Ma=$b,rc=Na,Eb="Expected a function";function _a(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(Eb);var s=function(){var n=arguments,a=r?r.apply(this,n):n[0],i=s.cache;if(i.has(a))return i.get(a);var o=t.apply(this,n);return s.cache=i.set(a,o)||i,o};return s.cache=new(_a.Cache||rc),s}_a.Cache=rc;var Db=_a,Tb=Db,Ob=500;function Mb(t){var r=Tb(t,function(n){return s.size===Ob&&s.clear(),n}),s=r.cache;return r}var _b=Mb,Pb=_b,Ab=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Rb=/\\(\\)?/g,Ib=Pb(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(Ab,function(s,n,a,i){r.push(a?i.replace(Rb,"$1"):n||s)}),r}),Lb=Ib;function Fb(t,r){for(var s=-1,n=t==null?0:t.length,a=Array(n);++s<n;)a[s]=r(t[s],s,t);return a}var Pa=Fb,no=$r,Ub=Pa,Wb=yt,Bb=cs,ao=no?no.prototype:void 0,io=ao?ao.toString:void 0;function sc(t){if(typeof t=="string")return t;if(Wb(t))return Ub(t,sc)+"";if(Bb(t))return io?io.call(t):"";var r=t+"";return r=="0"&&1/t==-1/0?"-0":r}var Hb=sc,zb=Hb;function Gb(t){return t==null?"":zb(t)}var qb=Gb,Yb=yt,Vb=Ma,Kb=Lb,Jb=qb;function Xb(t,r){return Yb(t)?t:Vb(t,r)?[t]:Kb(Jb(t))}var an=Xb,Qb=cs;function Zb(t){if(typeof t=="string"||Qb(t))return t;var r=t+"";return r=="0"&&1/t==-1/0?"-0":r}var fs=Zb,ey=an,ty=fs;function ry(t,r){r=ey(r,t);for(var s=0,n=r.length;t!=null&&s<n;)t=t[ty(r[s++])];return s&&s==n?t:void 0}var on=ry,sy=on;function ny(t,r,s){var n=t==null?void 0:sy(t,r);return n===void 0?s:n}var ay=ny;function iy(t,r){return t!=null&&r in Object(t)}var oy=iy,ly=an,cy=$a,dy=yt,uy=ca,my=la,hy=fs;function fy(t,r,s){r=ly(r,t);for(var n=-1,a=r.length,i=!1;++n<a;){var o=hy(r[n]);if(!(i=t!=null&&s(t,o)))break;t=t[o]}return i||++n!=a?i:(a=t==null?0:t.length,!!a&&my(a)&&uy(o,a)&&(dy(t)||cy(t)))}var gy=fy,xy=oy,py=gy;function vy(t,r){return t!=null&&py(t,r,xy)}var by=vy,yy=Oa,jy=ay,wy=by,Ny=Ma,Sy=ec,ky=tc,Cy=fs,$y=1,Ey=2;function Dy(t,r){return Ny(t)&&Sy(r)?ky(Cy(t),r):function(s){var n=jy(s,t);return n===void 0&&n===r?wy(s,t):yy(r,n,$y|Ey)}}var Ty=Dy;function Oy(t){return t}var ln=Oy;function My(t){return function(r){return r==null?void 0:r[t]}}var _y=My,Py=on;function Ay(t){return function(r){return Py(r,t)}}var Ry=Ay,Iy=_y,Ly=Ry,Fy=Ma,Uy=fs;function Wy(t){return Fy(t)?Iy(Uy(t)):Ly(t)}var By=Wy,Hy=wb,zy=Ty,Gy=ln,qy=yt,Yy=By;function Vy(t){return typeof t=="function"?t:t==null?Gy:typeof t=="object"?qy(t)?zy(t[0],t[1]):Hy(t):Yy(t)}var cn=Vy,Ky=nb,Jy=cn,Xy=El,Qy=Math.max;function Zy(t,r,s){var n=t==null?0:t.length;if(!n)return-1;var a=s==null?0:Xy(s);return a<0&&(a=Qy(n+a,0)),Ky(t,Jy(r),a)}var ej=Zy;const tj=bt(ej);var rj=Math.ceil,sj=Math.max;function nj(t,r,s,n){for(var a=-1,i=sj(rj((r-t)/(s||1)),0),o=Array(i);i--;)o[n?i:++a]=t,t+=s;return o}var aj=nj,ij=aj,oj=Js,Cn=$l;function lj(t){return function(r,s,n){return n&&typeof n!="number"&&oj(r,s,n)&&(s=n=void 0),r=Cn(r),s===void 0?(s=r,r=0):s=Cn(s),n=n===void 0?r<s?1:-1:Cn(n),ij(r,s,n,t)}}var cj=lj,dj=cj,uj=dj(),mj=uj;const hj=bt(mj);var oo=Number.isNaN||function(r){return typeof r=="number"&&r!==r};function fj(t,r){return!!(t===r||oo(t)&&oo(r))}function gj(t,r){if(t.length!==r.length)return!1;for(var s=0;s<t.length;s++)if(!fj(t[s],r[s]))return!1;return!0}function nc(t,r){r===void 0&&(r=gj);var s=null;function n(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];if(s&&s.lastThis===this&&r(a,s.lastArgs))return s.lastResult;var o=t.apply(this,a);return s={lastResult:o,lastArgs:a,lastThis:this},o}return n.clear=function(){s=null},n}function qn(t,r){var s=da(t);return s?s.innerWidth:Qt(t).width}var lo=$r,xj=$a,pj=yt,co=lo?lo.isConcatSpreadable:void 0;function vj(t){return pj(t)||xj(t)||!!(co&&t&&t[co])}var bj=vj,yj=ka,jj=bj;function ac(t,r,s,n,a){var i=-1,o=t.length;for(s||(s=jj),a||(a=[]);++i<o;){var l=t[i];r>0&&s(l)?r>1?ac(l,r-1,s,n,a):yj(a,l):n||(a[a.length]=l)}return a}var ic=ac;function wj(t){return function(r,s,n){for(var a=-1,i=Object(r),o=n(r),l=o.length;l--;){var c=o[t?l:++a];if(s(i[c],c,i)===!1)break}return r}}var Nj=wj,Sj=Nj,kj=Sj(),Cj=kj,$j=Cj,Ej=hs;function Dj(t,r){return t&&$j(t,r,Ej)}var Aa=Dj,Tj=ls;function Oj(t,r){return function(s,n){if(s==null)return s;if(!Tj(s))return t(s,n);for(var a=s.length,i=r?a:-1,o=Object(s);(r?i--:++i<a)&&n(o[i],i,o)!==!1;);return s}}var Mj=Oj,_j=Aa,Pj=Mj,Aj=Pj(_j),Rj=Aj,Ij=Rj,Lj=ls;function Fj(t,r){var s=-1,n=Lj(t)?Array(t.length):[];return Ij(t,function(a,i,o){n[++s]=r(a,i,o)}),n}var Uj=Fj;function Wj(t,r){var s=t.length;for(t.sort(r);s--;)t[s]=t[s].value;return t}var Bj=Wj,uo=cs;function Hj(t,r){if(t!==r){var s=t!==void 0,n=t===null,a=t===t,i=uo(t),o=r!==void 0,l=r===null,c=r===r,d=uo(r);if(!l&&!d&&!i&&t>r||i&&o&&c&&!l&&!d||n&&o&&c||!s&&c||!a)return 1;if(!n&&!i&&!d&&t<r||d&&s&&a&&!n&&!i||l&&s&&a||!o&&a||!c)return-1}return 0}var zj=Hj,Gj=zj;function qj(t,r,s){for(var n=-1,a=t.criteria,i=r.criteria,o=a.length,l=s.length;++n<o;){var c=Gj(a[n],i[n]);if(c){if(n>=l)return c;var d=s[n];return c*(d=="desc"?-1:1)}}return t.index-r.index}var Yj=qj,$n=Pa,Vj=on,Kj=cn,Jj=Uj,Xj=Bj,Qj=sn,Zj=Yj,ew=ln,tw=yt;function rw(t,r,s){r.length?r=$n(r,function(i){return tw(i)?function(o){return Vj(o,i.length===1?i[0]:i)}:i}):r=[ew];var n=-1;r=$n(r,Qj(Kj));var a=Jj(t,function(i,o,l){var c=$n(r,function(d){return d(i)});return{criteria:c,index:++n,value:i}});return Xj(a,function(i,o){return Zj(i,o,s)})}var sw=rw;function nw(t,r,s){switch(s.length){case 0:return t.call(r);case 1:return t.call(r,s[0]);case 2:return t.call(r,s[0],s[1]);case 3:return t.call(r,s[0],s[1],s[2])}return t.apply(r,s)}var aw=nw,iw=aw,mo=Math.max;function ow(t,r,s){return r=mo(r===void 0?t.length-1:r,0),function(){for(var n=arguments,a=-1,i=mo(n.length-r,0),o=Array(i);++a<i;)o[a]=n[r+a];a=-1;for(var l=Array(r+1);++a<r;)l[a]=n[a];return l[r]=s(o),iw(t,this,l)}}var oc=ow;function lw(t){return function(){return t}}var cw=lw,dw=cr,uw=function(){try{var t=dw(Object,"defineProperty");return t({},"",{}),t}catch{}}(),lc=uw,mw=cw,ho=lc,hw=ln,fw=ho?function(t,r){return ho(t,"toString",{configurable:!0,enumerable:!1,value:mw(r),writable:!0})}:hw,gw=fw,xw=800,pw=16,vw=Date.now;function bw(t){var r=0,s=0;return function(){var n=vw(),a=pw-(n-s);if(s=n,a>0){if(++r>=xw)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}var yw=bw,jw=gw,ww=yw,Nw=ww(jw),cc=Nw,Sw=ln,kw=oc,Cw=cc;function $w(t,r){return Cw(kw(t,r,Sw),t+"")}var dc=$w,Ew=ic,Dw=sw,Tw=dc,fo=Js,Ow=Tw(function(t,r){if(t==null)return[];var s=r.length;return s>1&&fo(t,r[0],r[1])?r=[]:s>2&&fo(r[0],r[1],r[2])&&(r=[r[0]]),Dw(t,Ew(r,1),[])}),Mw=Ow;const _w=bt(Mw);function uc(t){return il(t)||Nl(t)||na(t)||ol()}function Pw(t){var r=[];if(t!=null)for(var s in Object(t))r.push(s);return r}var Aw=Pw,Rw=Ft,Iw=Ta,Lw=Aw,Fw=Object.prototype,Uw=Fw.hasOwnProperty;function Ww(t){if(!Rw(t))return Lw(t);var r=Iw(t),s=[];for(var n in t)n=="constructor"&&(r||!Uw.call(t,n))||s.push(n);return s}var Bw=Ww,Hw=Vl,zw=Bw,Gw=ls;function qw(t){return Gw(t)?Hw(t,!0):zw(t)}var dn=qw,Yw=dc,Vw=os,Kw=Js,Jw=dn,mc=Object.prototype,Xw=mc.hasOwnProperty,Qw=Yw(function(t,r){t=Object(t);var s=-1,n=r.length,a=n>2?r[2]:void 0;for(a&&Kw(r[0],r[1],a)&&(n=1);++s<n;)for(var i=r[s],o=Jw(i),l=-1,c=o.length;++l<c;){var d=o[l],f=t[d];(f===void 0||Vw(f,mc[d])&&!Xw.call(t,d))&&(t[d]=i[d])}return t}),Zw=Qw;const eN=bt(Zw);var go=lc;function tN(t,r,s){r=="__proto__"&&go?go(t,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):t[r]=s}var Ra=tN,rN=Ra,sN=Aa,nN=cn;function aN(t,r){var s={};return r=nN(r),sN(t,function(n,a,i){rN(s,a,r(n,a,i))}),s}var iN=aN;const oN=bt(iN);function lN(t,r){for(var s=-1,n=t==null?0:t.length;++s<n&&r(t[s],s,t)!==!1;);return t}var hc=lN,cN=Ra,dN=os,uN=Object.prototype,mN=uN.hasOwnProperty;function hN(t,r,s){var n=t[r];(!(mN.call(t,r)&&dN(n,s))||s===void 0&&!(r in t))&&cN(t,r,s)}var fc=hN,fN=fc,gN=Ra;function xN(t,r,s,n){var a=!s;s||(s={});for(var i=-1,o=r.length;++i<o;){var l=r[i],c=n?n(s[l],t[l],l,s,t):void 0;c===void 0&&(c=t[l]),a?gN(s,l,c):fN(s,l,c)}return s}var gs=xN,pN=gs,vN=hs;function bN(t,r){return t&&pN(r,vN(r),t)}var yN=bN,jN=gs,wN=dn;function NN(t,r){return t&&jN(r,wN(r),t)}var SN=NN,Ws={exports:{}};Ws.exports;(function(t,r){var s=Mt,n=r&&!r.nodeType&&r,a=n&&!0&&t&&!t.nodeType&&t,i=a&&a.exports===n,o=i?s.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(d,f){if(f)return d.slice();var g=d.length,m=l?l(g):new d.constructor(g);return d.copy(m),m}t.exports=c})(Ws,Ws.exports);var kN=Ws.exports;function CN(t,r){var s=-1,n=t.length;for(r||(r=Array(n));++s<n;)r[s]=t[s];return r}var $N=CN,EN=gs,DN=Ca;function TN(t,r){return EN(t,DN(t),r)}var ON=TN,MN=Kl,_N=MN(Object.getPrototypeOf,Object),un=_N,PN=ka,AN=un,RN=Ca,IN=ql,LN=Object.getOwnPropertySymbols,FN=LN?function(t){for(var r=[];t;)PN(r,RN(t)),t=AN(t);return r}:IN,gc=FN,UN=gs,WN=gc;function BN(t,r){return UN(t,WN(t),r)}var HN=BN,zN=Gl,GN=gc,qN=dn;function YN(t){return zN(t,qN,GN)}var xc=YN,VN=Object.prototype,KN=VN.hasOwnProperty;function JN(t){var r=t.length,s=new t.constructor(r);return r&&typeof t[0]=="string"&&KN.call(t,"index")&&(s.index=t.index,s.input=t.input),s}var XN=JN,xo=zl;function QN(t){var r=new t.constructor(t.byteLength);return new xo(r).set(new xo(t)),r}var Ia=QN,ZN=Ia;function e1(t,r){var s=r?ZN(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.byteLength)}var t1=e1,r1=/\w*$/;function s1(t){var r=new t.constructor(t.source,r1.exec(t));return r.lastIndex=t.lastIndex,r}var n1=s1,po=$r,vo=po?po.prototype:void 0,bo=vo?vo.valueOf:void 0;function a1(t){return bo?Object(bo.call(t)):{}}var i1=a1,o1=Ia;function l1(t,r){var s=r?o1(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.length)}var c1=l1,d1=Ia,u1=t1,m1=n1,h1=i1,f1=c1,g1="[object Boolean]",x1="[object Date]",p1="[object Map]",v1="[object Number]",b1="[object RegExp]",y1="[object Set]",j1="[object String]",w1="[object Symbol]",N1="[object ArrayBuffer]",S1="[object DataView]",k1="[object Float32Array]",C1="[object Float64Array]",$1="[object Int8Array]",E1="[object Int16Array]",D1="[object Int32Array]",T1="[object Uint8Array]",O1="[object Uint8ClampedArray]",M1="[object Uint16Array]",_1="[object Uint32Array]";function P1(t,r,s){var n=t.constructor;switch(r){case N1:return d1(t);case g1:case x1:return new n(+t);case S1:return u1(t,s);case k1:case C1:case $1:case E1:case D1:case T1:case O1:case M1:case _1:return f1(t,s);case p1:return new n;case v1:case j1:return new n(t);case b1:return m1(t);case y1:return new n;case w1:return h1(t)}}var A1=P1,R1=Ft,yo=Object.create,I1=function(){function t(){}return function(r){if(!R1(r))return{};if(yo)return yo(r);t.prototype=r;var s=new t;return t.prototype=void 0,s}}(),pc=I1,L1=pc,F1=un,U1=Ta;function W1(t){return typeof t.constructor=="function"&&!U1(t)?L1(F1(t)):{}}var B1=W1,H1=nn,z1=Yt,G1="[object Map]";function q1(t){return z1(t)&&H1(t)==G1}var Y1=q1,V1=Y1,K1=sn,jo=Ea,wo=jo&&jo.isMap,J1=wo?K1(wo):V1,X1=J1,Q1=nn,Z1=Yt,e2="[object Set]";function t2(t){return Z1(t)&&Q1(t)==e2}var r2=t2,s2=r2,n2=sn,No=Ea,So=No&&No.isSet,a2=So?n2(So):s2,i2=a2,o2=Sa,l2=hc,c2=fc,d2=yN,u2=SN,m2=kN,h2=$N,f2=ON,g2=HN,x2=Jl,p2=xc,v2=nn,b2=XN,y2=A1,j2=B1,w2=yt,N2=rn,S2=X1,k2=Ft,C2=i2,$2=hs,E2=dn,D2=1,T2=2,O2=4,vc="[object Arguments]",M2="[object Array]",_2="[object Boolean]",P2="[object Date]",A2="[object Error]",bc="[object Function]",R2="[object GeneratorFunction]",I2="[object Map]",L2="[object Number]",yc="[object Object]",F2="[object RegExp]",U2="[object Set]",W2="[object String]",B2="[object Symbol]",H2="[object WeakMap]",z2="[object ArrayBuffer]",G2="[object DataView]",q2="[object Float32Array]",Y2="[object Float64Array]",V2="[object Int8Array]",K2="[object Int16Array]",J2="[object Int32Array]",X2="[object Uint8Array]",Q2="[object Uint8ClampedArray]",Z2="[object Uint16Array]",eS="[object Uint32Array]",Ce={};Ce[vc]=Ce[M2]=Ce[z2]=Ce[G2]=Ce[_2]=Ce[P2]=Ce[q2]=Ce[Y2]=Ce[V2]=Ce[K2]=Ce[J2]=Ce[I2]=Ce[L2]=Ce[yc]=Ce[F2]=Ce[U2]=Ce[W2]=Ce[B2]=Ce[X2]=Ce[Q2]=Ce[Z2]=Ce[eS]=!0;Ce[A2]=Ce[bc]=Ce[H2]=!1;function Ts(t,r,s,n,a,i){var o,l=r&D2,c=r&T2,d=r&O2;if(s&&(o=a?s(t,n,a,i):s(t)),o!==void 0)return o;if(!k2(t))return t;var f=w2(t);if(f){if(o=b2(t),!l)return h2(t,o)}else{var g=v2(t),m=g==bc||g==R2;if(N2(t))return m2(t,l);if(g==yc||g==vc||m&&!a){if(o=c||m?{}:j2(t),!l)return c?g2(t,u2(o,t)):f2(t,d2(o,t))}else{if(!Ce[g])return a?t:{};o=y2(t,g,l)}}i||(i=new o2);var b=i.get(t);if(b)return b;i.set(t,o),C2(t)?t.forEach(function(u){o.add(Ts(u,r,s,u,t,i))}):S2(t)&&t.forEach(function(u,w){o.set(w,Ts(u,r,s,w,t,i))});var j=d?c?p2:x2:c?E2:$2,h=f?void 0:j(t);return l2(h||t,function(u,w){h&&(w=u,u=t[w]),c2(o,w,Ts(u,r,s,w,t,i))}),o}var tS=Ts;function rS(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}var sS=rS,nS=on,aS=Sl;function iS(t,r){return r.length<2?t:nS(t,aS(r,0,-1))}var oS=iS,lS=an,cS=sS,dS=oS,uS=fs;function mS(t,r){return r=lS(r,t),t=dS(t,r),t==null||delete t[uS(cS(r))]}var hS=mS,fS=Er,gS=un,xS=Yt,pS="[object Object]",vS=Function.prototype,bS=Object.prototype,jc=vS.toString,yS=bS.hasOwnProperty,jS=jc.call(Object);function wS(t){if(!xS(t)||fS(t)!=pS)return!1;var r=gS(t);if(r===null)return!0;var s=yS.call(r,"constructor")&&r.constructor;return typeof s=="function"&&s instanceof s&&jc.call(s)==jS}var NS=wS,SS=NS;function kS(t){return SS(t)?void 0:t}var CS=kS,$S=ic;function ES(t){var r=t==null?0:t.length;return r?$S(t,1):[]}var DS=ES,TS=DS,OS=oc,MS=cc;function _S(t){return MS(OS(t,void 0,TS),t+"")}var PS=_S,AS=Pa,RS=tS,IS=hS,LS=an,FS=gs,US=CS,WS=PS,BS=xc,HS=1,zS=2,GS=4,qS=WS(function(t,r){var s={};if(t==null)return s;var n=!1;r=AS(r,function(i){return i=LS(i,t),n||(n=i.length>1),i}),FS(t,BS(t),s),n&&(s=RS(s,HS|zS|GS,US));for(var a=r.length;a--;)IS(s,r[a]);return s}),YS=qS;const VS=bt(YS);var KS=hc,JS=pc,XS=Aa,QS=cn,ZS=un,ek=yt,tk=rn,rk=oa,sk=Ft,nk=Da;function ak(t,r,s){var n=ek(t),a=n||tk(t)||nk(t);if(r=QS(r),s==null){var i=t&&t.constructor;a?s=n?new i:[]:sk(t)?s=rk(i)?JS(ZS(t)):{}:s={}}return(a?KS:XS)(t,function(o,l,c){return r(s,o,l,c)}),s}var ik=ak;const ok=bt(ik);var lk={exports:{}};(function(t,r){(function(s,n){t.exports=n()})(gt,function(){return function(s,n,a){n.prototype.isBetween=function(i,o,l,c){var d=a(i),f=a(o),g=(c=c||"()")[0]==="(",m=c[1]===")";return(g?this.isAfter(d,l):!this.isBefore(d,l))&&(m?this.isBefore(f,l):!this.isAfter(f,l))||(g?this.isBefore(d,l):!this.isAfter(d,l))&&(m?this.isAfter(f,l):!this.isBefore(f,l))}}})})(lk);var ck={exports:{}};(function(t,r){(function(s,n){t.exports=n()})(gt,function(){return function(s,n){n.prototype.isSameOrAfter=function(a,i){return this.isSame(a,i)||this.isAfter(a,i)}}})})(ck);var dk={exports:{}};(function(t,r){(function(s,n){t.exports=n()})(gt,function(){return function(s,n){n.prototype.isSameOrBefore=function(a,i){return this.isSame(a,i)||this.isBefore(a,i)}}})})(dk);var uk={exports:{}};(function(t,r){(function(s,n){t.exports=n()})(gt,function(){return function(s,n,a){var i=n.prototype,o=function(g){return g&&(g.indexOf?g:g.s)},l=function(g,m,b,j,h){var u=g.name?g:g.$locale(),w=o(u[m]),x=o(u[b]),S=w||x.map(function(D){return D.slice(0,j)});if(!h)return S;var v=u.weekStart;return S.map(function(D,P){return S[(P+(v||0))%7]})},c=function(){return a.Ls[a.locale()]},d=function(g,m){return g.formats[m]||function(b){return b.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(j,h,u){return h||u.slice(1)})}(g.formats[m.toUpperCase()])},f=function(){var g=this;return{months:function(m){return m?m.format("MMMM"):l(g,"months")},monthsShort:function(m){return m?m.format("MMM"):l(g,"monthsShort","months",3)},firstDayOfWeek:function(){return g.$locale().weekStart||0},weekdays:function(m){return m?m.format("dddd"):l(g,"weekdays")},weekdaysMin:function(m){return m?m.format("dd"):l(g,"weekdaysMin","weekdays",2)},weekdaysShort:function(m){return m?m.format("ddd"):l(g,"weekdaysShort","weekdays",3)},longDateFormat:function(m){return d(g.$locale(),m)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return f.bind(this)()},a.localeData=function(){var g=c();return{firstDayOfWeek:function(){return g.weekStart||0},weekdays:function(){return a.weekdays()},weekdaysShort:function(){return a.weekdaysShort()},weekdaysMin:function(){return a.weekdaysMin()},months:function(){return a.months()},monthsShort:function(){return a.monthsShort()},longDateFormat:function(m){return d(g,m)},meridiem:g.meridiem,ordinal:g.ordinal}},a.months=function(){return l(c(),"months")},a.monthsShort=function(){return l(c(),"monthsShort","months",3)},a.weekdays=function(g){return l(c(),"weekdays",null,null,g)},a.weekdaysShort=function(g){return l(c(),"weekdaysShort","weekdays",3,g)},a.weekdaysMin=function(g){return l(c(),"weekdaysMin","weekdays",2,g)}}})})(uk);var mk={exports:{}};(function(t,r){(function(s,n){t.exports=n()})(gt,function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(n,a,i){var o=a.prototype,l=o.format;i.en.formats=s,o.format=function(c){c===void 0&&(c="YYYY-MM-DDTHH:mm:ssZ");var d=this.$locale().formats,f=function(g,m){return g.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(b,j,h){var u=h&&h.toUpperCase();return j||m[h]||s[h]||m[u].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(w,x,S){return x||S.slice(1)})})}(c,d===void 0?{}:d);return l.call(this,f)}}})})(mk);var hk={exports:{}};(function(t,r){(function(s,n){t.exports=n()})(gt,function(){return function(s,n,a){var i=function(o,l){if(!l||!l.length||l.length===1&&!l[0]||l.length===1&&Array.isArray(l[0])&&!l[0].length)return null;var c;l.length===1&&l[0].length>0&&(l=l[0]),c=(l=l.filter(function(f){return f}))[0];for(var d=1;d<l.length;d+=1)l[d].isValid()&&!l[d][o](c)||(c=l[d]);return c};a.max=function(){var o=[].slice.call(arguments,0);return i("isAfter",o)},a.min=function(){var o=[].slice.call(arguments,0);return i("isBefore",o)}}})})(hk);var fk={exports:{}};(function(t,r){(function(s,n){t.exports=n()})(gt,function(){var s="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(i,o,l){var c=o.prototype;l.utc=function(h){var u={date:h,utc:!0,args:arguments};return new o(u)},c.utc=function(h){var u=l(this.toDate(),{locale:this.$L,utc:!0});return h?u.add(this.utcOffset(),s):u},c.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var d=c.parse;c.parse=function(h){h.utc&&(this.$u=!0),this.$utils().u(h.$offset)||(this.$offset=h.$offset),d.call(this,h)};var f=c.init;c.init=function(){if(this.$u){var h=this.$d;this.$y=h.getUTCFullYear(),this.$M=h.getUTCMonth(),this.$D=h.getUTCDate(),this.$W=h.getUTCDay(),this.$H=h.getUTCHours(),this.$m=h.getUTCMinutes(),this.$s=h.getUTCSeconds(),this.$ms=h.getUTCMilliseconds()}else f.call(this)};var g=c.utcOffset;c.utcOffset=function(h,u){var w=this.$utils().u;if(w(h))return this.$u?0:w(this.$offset)?g.call(this):this.$offset;if(typeof h=="string"&&(h=function(D){D===void 0&&(D="");var P=D.match(n);if(!P)return null;var A=(""+P[0]).match(a)||["-",0,0],H=A[0],O=60*+A[1]+ +A[2];return O===0?0:H==="+"?O:-O}(h),h===null))return this;var x=Math.abs(h)<=16?60*h:h,S=this;if(u)return S.$offset=x,S.$u=h===0,S;if(h!==0){var v=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(S=this.local().add(x+v,s)).$offset=x,S.$x.$localOffset=v}else S=this.utc();return S};var m=c.format;c.format=function(h){var u=h||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return m.call(this,u)},c.valueOf=function(){var h=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*h},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var b=c.toDate;c.toDate=function(h){return h==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():b.call(this)};var j=c.diff;c.diff=function(h,u,w){if(h&&this.$u===h.$u)return j.call(this,h,u,w);var x=this.local(),S=l(h).local();return j.call(x,S,u,w)}}})})(fk);var gk={exports:{}};(function(t,r){(function(s,n){t.exports=n()})(gt,function(){return function(s,n){n.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}}})})(gk);function Nt(t){return t.children}var lt={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},Ze={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},ko=Object.keys(Ze).map(function(t){return Ze[t]});re.oneOfType([re.string,re.func]);re.any;re.func;re.oneOfType([re.arrayOf(re.oneOf(ko)),re.objectOf(function(t,r){var s=ko.indexOf(r)!==-1&&typeof t[r]=="boolean";if(s)return null;for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];return re.elementType.apply(re,[t,r].concat(a))})]);re.oneOfType([re.oneOf(["overlap","no-overlap"]),re.func]);var Co={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function wc(t,r){var s=qe(t,"month");return qe(s,"week",r.startOfWeek())}function Nc(t,r){var s=As(t,"month");return As(s,"week",r.startOfWeek())}function xk(t,r){for(var s=wc(t,r),n=Nc(t,r),a=[];kr(s,n,"day");)a.push(s),s=jt(s,1,"day");return a}function pk(t,r){var s=qe(t,r);return Sr(s,t)?s:jt(s,1,r)}function vk(t,r){for(var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",n=t,a=[];kr(n,r,s);)a.push(n),n=jt(n,1,s);return a}function bk(t,r){return r==null&&t==null?null:(r==null&&(r=new Date),t==null&&(t=new Date),t=qe(t,"day"),t=es(t,es(r)),t=br(t,br(r)),t=Zr(t,Zr(r)),Qr(t,Qr(r)))}function $o(t){return es(t)===0&&br(t)===0&&Zr(t)===0&&Qr(t)===0}function yk(t,r,s,n){return s==="day"&&(s="date"),Math.abs(li[s](t,void 0,n)-li[s](r,void 0,n))}function La(t,r,s){return!s||s==="milliseconds"?Math.abs(+t-+r):Math.round(Math.abs(+qe(t,s)/Co[s]-+qe(r,s)/Co[s]))}var jk=re.oneOfType([re.string,re.func]);function wk(t,r,s,n,a){var i=typeof n=="function"?n(s,a,t):r.call(t,s,n,a);return qr(i==null||typeof i=="string","`localizer format(..)` must return a string, null, or undefined"),i}function Nk(t,r,s){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,r+s,0,0)}function Fa(t,r){return t.getTimezoneOffset()-r.getTimezoneOffset()}function Sk(t,r){return La(t,r,"minutes")+Fa(t,r)}function kk(t){var r=qe(t,"day");return La(r,t,"minutes")+Fa(r,t)}function Ck(t,r){return ia(t,r,"day")}function $k(t,r,s){var n=Sr(t,r,"minutes");return n?is(r,s,"minutes"):Ks(r,s,"minutes")}function Yn(t,r){return yk(t,r,"day")}function Ek(t){var r=t.evtA,s=r.start,n=r.end,a=r.allDay,i=t.evtB,o=i.start,l=i.end,c=i.allDay,d=+qe(s,"day")-+qe(o,"day"),f=Yn(s,n),g=Yn(o,l);return d||g-f||!!c-!!a||+s-+o||+n-+l}function Dk(t){var r=t.event,s=r.start,n=r.end,a=t.range,i=a.start,o=a.end,l=qe(s,"day"),c=kr(l,o,"day"),d=aa(l,n,"minutes"),f=d?Ks(n,i,"minutes"):is(n,i,"minutes");return c&&f}function Tk(t,r){return Sr(t,r,"day")}function Ok(t,r){return $o(t)&&$o(r)}var Mk=Ue(function t(r){var s=this;Fe(this,t),qr(typeof r.format=="function","date localizer `format(..)` must be a function"),qr(typeof r.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=r.propType||jk,this.formats=r.formats,this.format=function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return wk.apply(void 0,[s,r.format].concat(a))},this.startOfWeek=r.firstOfWeek,this.merge=r.merge||bk,this.inRange=r.inRange||bl,this.lt=r.lt||ia,this.lte=r.lte||kr,this.gt=r.gt||Ks,this.gte=r.gte||is,this.eq=r.eq||Sr,this.neq=r.neq||aa,this.startOf=r.startOf||qe,this.endOf=r.endOf||As,this.add=r.add||jt,this.range=r.range||vk,this.diff=r.diff||La,this.ceil=r.ceil||pk,this.min=r.min||pl,this.max=r.max||vl,this.minutes=r.minutes||br,this.daySpan=r.daySpan||Yn,this.firstVisibleDay=r.firstVisibleDay||wc,this.lastVisibleDay=r.lastVisibleDay||Nc,this.visibleDays=r.visibleDays||xk,this.getSlotDate=r.getSlotDate||Nk,this.getTimezoneOffset=r.getTimezoneOffset||function(n){return n.getTimezoneOffset()},this.getDstOffset=r.getDstOffset||Fa,this.getTotalMin=r.getTotalMin||Sk,this.getMinutesFromMidnight=r.getMinutesFromMidnight||kk,this.continuesPrior=r.continuesPrior||Ck,this.continuesAfter=r.continuesAfter||$k,this.sortEvents=r.sortEvents||Ek,this.inEventRange=r.inEventRange||Dk,this.isSameDate=r.isSameDate||Tk,this.startAndEndAreDateOnly=r.startAndEndAreDateOnly||Ok,this.segmentOffset=r.browserTZOffset?r.browserTZOffset():0});function _k(t,r,s,n){var a=Se(Se({},t.formats),s);return Se(Se({},t),{},{messages:n,startOfWeek:function(){return t.startOfWeek(r)},format:function(o,l){return t.format(o,a[l]||l,r)}})}var Pk=function(t){function r(){var s;Fe(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=Je(this,r,[].concat(a)),s.navigate=function(o){s.props.onNavigate(o)},s.view=function(o){s.props.onView(o)},s}return Xe(r,t),Ue(r,[{key:"render",value:function(){var n=this.props,a=n.localizer.messages,i=n.label;return _.createElement("div",{className:"rbc-toolbar"},_.createElement("span",{className:"rbc-btn-group"},_.createElement("button",{type:"button",onClick:this.navigate.bind(null,lt.TODAY)},a.today),_.createElement("button",{type:"button",onClick:this.navigate.bind(null,lt.PREVIOUS)},a.previous),_.createElement("button",{type:"button",onClick:this.navigate.bind(null,lt.NEXT)},a.next)),_.createElement("span",{className:"rbc-toolbar-label"},i),_.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(a)))}},{key:"viewNamesGroup",value:function(n){var a=this,i=this.props.views,o=this.props.view;if(i.length>1)return i.map(function(l){return _.createElement("button",{type:"button",key:l,className:Pe({"rbc-active":o===l}),onClick:a.view.bind(null,l)},n[l])})}}])}(_.Component);function Te(t,r){t&&t.apply(null,[].concat(r))}var Ak={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(r){return"+".concat(r," more")}};function Rk(t){return Se(Se({},Ak),t)}function Ik(t){var r=t.ref,s=t.callback;E.useEffect(function(){var n=function(i){r.current&&!r.current.contains(i.target)&&s()};return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}},[r,s])}var Lk=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],Sc=function(t){function r(){return Fe(this,r),Je(this,r,arguments)}return Xe(r,t),Ue(r,[{key:"render",value:function(){var n=this.props,a=n.style,i=n.className,o=n.event,l=n.selected,c=n.isAllDay,d=n.onSelect,f=n.onDoubleClick,g=n.onKeyPress,m=n.localizer,b=n.continuesPrior,j=n.continuesAfter,h=n.accessors,u=n.getters,w=n.children,x=n.components,S=x.event,v=x.eventWrapper,D=n.slotStart,P=n.slotEnd,A=Tt(n,Lk);delete A.resizable;var H=h.title(o),O=h.tooltip(o),z=h.end(o),R=h.start(o),K=h.allDay(o),Y=c||K||m.diff(R,m.ceil(z,"day"),"day")>1,ee=u.eventProp(o,R,z,l),B=_.createElement("div",{className:"rbc-event-content",title:O||void 0},S?_.createElement(S,{event:o,continuesPrior:b,continuesAfter:j,title:H,isAllDay:K,localizer:m,slotStart:D,slotEnd:P}):H);return _.createElement(v,Object.assign({},this.props,{type:"date"}),_.createElement("div",Object.assign({},A,{style:Se(Se({},ee.style),a),className:Pe("rbc-event",i,ee.className,{"rbc-selected":l,"rbc-event-allday":Y,"rbc-event-continues-prior":b,"rbc-event-continues-after":j}),onClick:function(I){return d&&d(o,I)},onDoubleClick:function(I){return f&&f(o,I)},onKeyDown:function(I){return g&&g(o,I)}}),typeof w=="function"?w(B):B))}}])}(_.Component);function mn(t,r){return!t||r==null?!1:rb(t,r)}function kc(t,r){var s=t.right-t.left,n=s/r;return n}function Cc(t,r,s,n){var a=kc(t,n);return s?n-1-Math.floor((r-t.left)/a):Math.floor((r-t.left)/a)}function Fk(t,r){var s=r.x,n=r.y;return n>=t.top&&n<=t.bottom&&s>=t.left&&s<=t.right}function Uk(t,r,s,n,a){var i=-1,o=-1,l=n-1,c=kc(r,n),d=Cc(r,s.x,a,n),f=r.top<s.y&&r.bottom>s.y,g=r.top<t.y&&r.bottom>t.y,m=t.y>r.bottom,b=r.top>t.y,j=s.top<r.top&&s.bottom>r.bottom;return j&&(i=0,o=l),f&&(b?(i=0,o=d):m&&(i=d,o=l)),g&&(i=o=a?l-Math.floor((t.x-r.left)/c):Math.floor((t.x-r.left)/c),f?d<i?i=d:o=d:t.y<s.y?o=l:i=0),{startIdx:i,endIdx:o}}function Wk(t){var r=t.target,s=t.offset,n=t.container,a=t.box,i=Qt(r),o=i.top,l=i.left,c=i.width,d=i.height,f=Qt(n),g=f.top,m=f.left,b=f.width,j=f.height,h=Qt(a),u=h.width,w=h.height,x=g+j,S=m+b,v=o+w,D=l+u,P=s.x,A=s.y,H=v>x?o-w-A:o+A+d,O=D>S?l+P-u+c:l+P;return{topOffset:H,leftOffset:O}}function Bk(t){var r=t.containerRef,s=t.accessors,n=t.getters,a=t.selected,i=t.components,o=t.localizer,l=t.position,c=t.show,d=t.events,f=t.slotStart,g=t.slotEnd,m=t.onSelect,b=t.onDoubleClick,j=t.onKeyPress,h=t.handleDragStart,u=t.popperRef,w=t.target,x=t.offset;Ik({ref:u,callback:c}),E.useLayoutEffect(function(){var D=Wk({target:w,offset:x,container:r.current,box:u.current}),P=D.topOffset,A=D.leftOffset;u.current.style.top="".concat(P,"px"),u.current.style.left="".concat(A,"px")},[x.x,x.y,w]);var S=l.width,v={minWidth:S+S/2};return _.createElement("div",{style:v,className:"rbc-overlay",ref:u},_.createElement("div",{className:"rbc-overlay-header"},o.format(f,"dayHeaderFormat")),d.map(function(D,P){return _.createElement(Sc,{key:P,type:"popup",localizer:o,event:D,getters:n,onSelect:m,accessors:s,components:i,onDoubleClick:b,onKeyPress:j,continuesPrior:o.lt(s.end(D),f,"day"),continuesAfter:o.gte(s.start(D),g,"day"),slotStart:f,slotEnd:g,selected:mn(D,a),draggable:!0,onDragStart:function(){return h(D)},onDragEnd:function(){return c()}})}))}var $c=_.forwardRef(function(t,r){return _.createElement(Bk,Object.assign({},t,{popperRef:r}))});$c.propTypes={accessors:re.object.isRequired,getters:re.object.isRequired,selected:re.object,components:re.object.isRequired,localizer:re.object.isRequired,position:re.object.isRequired,show:re.func.isRequired,events:re.array.isRequired,slotStart:re.instanceOf(Date).isRequired,slotEnd:re.instanceOf(Date),onSelect:re.func,onDoubleClick:re.func,onKeyPress:re.func,handleDragStart:re.func,style:re.object,offset:re.shape({x:re.number,y:re.number})};function Hk(t){var r=t.containerRef,s=t.popupOffset,n=s===void 0?5:s,a=t.overlay,i=t.accessors,o=t.localizer,l=t.components,c=t.getters,d=t.selected,f=t.handleSelectEvent,g=t.handleDoubleClickEvent,m=t.handleKeyPressEvent,b=t.handleDragStart,j=t.onHide,h=t.overlayDisplay,u=E.useRef(null);if(!a.position)return null;var w=n;isNaN(n)||(w={x:n,y:n});var x=a.position,S=a.events,v=a.date,D=a.end;return _.createElement(ja,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:j,target:a.target},function(P){var A=P.props;return _.createElement($c,Object.assign({},A,{containerRef:r,ref:u,target:a.target,offset:w,accessors:i,getters:c,selected:d,components:l,localizer:o,position:x,show:h,events:S,slotStart:v,slotEnd:D,onSelect:f,onDoubleClick:g,onKeyPress:m,handleDragStart:b}))})}var Ua=_.forwardRef(function(t,r){return _.createElement(Hk,Object.assign({},t,{containerRef:r}))});Ua.propTypes={popupOffset:re.oneOfType([re.number,re.shape({x:re.number,y:re.number})]),overlay:re.shape({position:re.object,events:re.array,date:re.instanceOf(Date),end:re.instanceOf(Date)}),accessors:re.object.isRequired,localizer:re.object.isRequired,components:re.object.isRequired,getters:re.object.isRequired,selected:re.object,handleSelectEvent:re.func,handleDoubleClickEvent:re.func,handleKeyPressEvent:re.func,handleDragStart:re.func,onHide:re.func,overlayDisplay:re.func};function Ve(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return Fr(s,t,r,{passive:!1})}function zk(t,r,s){return!t||ts(t,document.elementFromPoint(r,s))}function Gk(t,r){var s=r.clientX,n=r.clientY,a=document.elementFromPoint(s,n);return Zl(a,".rbc-event",t)}function qk(t,r){var s=r.clientX,n=r.clientY,a=document.elementFromPoint(s,n);return Zl(a,".rbc-show-more",t)}function Bs(t,r){return!!Gk(t,r)}function Yk(t,r){return!!qk(t,r)}function Ir(t){var r=t;return t.touches&&t.touches.length&&(r=t.touches[0]),{clientX:r.clientX,clientY:r.clientY,pageX:r.pageX,pageY:r.pageY}}var Eo=5,Vk=250,Ec=function(){function t(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=s.global,a=n===void 0?!1:n,i=s.longPressThreshold,o=i===void 0?250:i,l=s.validContainers,c=l===void 0?[]:l;Fe(this,t),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=r,this.globalMouse=!r||a,this.longPressThreshold=o,this.validContainers=c,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Ve("touchmove",function(){},window),this._removeKeyDownListener=Ve("keydown",this._keyListener),this._removeKeyUpListener=Ve("keyup",this._keyListener),this._removeDropFromOutsideListener=Ve("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Ve("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return Ue(t,[{key:"on",value:function(s,n){var a=this._listeners[s]||(this._listeners[s]=[]);return a.push(n),{remove:function(){var o=a.indexOf(n);o!==-1&&a.splice(o,1)}}}},{key:"emit",value:function(s){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o,l=this._listeners[s]||[];return l.forEach(function(c){o===void 0&&(o=c.apply(void 0,a))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(s){var n=this._selectRect;return!n||!this.selecting?!1:Do(n,lr(s))}},{key:"filter",value:function(s){var n=this._selectRect;return!n||!this.selecting?[]:s.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(s,n){var a=this,i=null,o=null,l=null,c=function(m){i=setTimeout(function(){f(),s(m)},a.longPressThreshold),o=Ve("touchmove",function(){return f()}),l=Ve("touchend",function(){return f()})},d=Ve("touchstart",c),f=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return n&&c(n),function(){f(),d()}}},{key:"_addInitialEventListener",value:function(){var s=this,n=Ve("mousedown",function(i){s._removeInitialEventListener(),s._handleInitialEvent(i),s._removeInitialEventListener=Ve("mousedown",s._handleInitialEvent)}),a=Ve("touchstart",function(i){s._removeInitialEventListener(),s._removeInitialEventListener=s._addLongPressListener(s._handleInitialEvent,i)});this._removeInitialEventListener=function(){n(),a()}}},{key:"_dropFromOutsideListener",value:function(s){var n=Ir(s),a=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dropFromOutside",{x:a,y:i,clientX:o,clientY:l}),s.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(s){var n=Ir(s),a=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dragOverFromOutside",{x:a,y:i,clientX:o,clientY:l}),s.preventDefault()}},{key:"_handleInitialEvent",value:function(s){if(this._initialEvent=s,!this.isDetached){var n=Ir(s),a=n.clientX,i=n.clientY,o=n.pageX,l=n.pageY,c=this.container(),d,f;if(!(s.which===3||s.button===2||!zk(c,a,i))){if(!this.globalMouse&&c&&!ts(c,s.target)){var g=Kk(0),m=g.top,b=g.left,j=g.bottom,h=g.right;if(f=lr(c),d=Do({top:f.top-m,left:f.left-b,bottom:f.bottom+j,right:f.right+h},{top:l,left:o}),!d)return}var u=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(s.type),x:o,y:l,clientX:a,clientY:i});if(u!==!1)switch(s.type){case"mousedown":this._removeEndListener=Ve("mouseup",this._handleTerminatingEvent),this._onEscListener=Ve("keydown",this._handleTerminatingEvent),this._removeMoveListener=Ve("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(s),this._removeEndListener=Ve("touchend",this._handleTerminatingEvent),this._removeMoveListener=Ve("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(s){var n=s.target,a=this.validContainers;return!a||!a.length||!n?!0:a.some(function(i){return!!n.closest(i)})}},{key:"_handleTerminatingEvent",value:function(s){var n=this.selecting,a=this._selectRect;if(!n&&s.type.includes("key")&&(s=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!s){var i=!this.container||ts(this.container(),s.target),o=this._isWithinValidContainer(s);return s.key==="Escape"||!o?this.emit("reset"):!n&&i?this._handleClickEvent(s):n?this.emit("select",a):this.emit("reset")}}},{key:"_handleClickEvent",value:function(s){var n=Ir(s),a=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY,c=new Date().getTime();return this._lastClickData&&c-this._lastClickData.timestamp<Vk?(this._lastClickData=null,this.emit("doubleClick",{x:a,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:c},this.emit("click",{x:a,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(s){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,a=n.x,i=n.y,o=Ir(s),l=o.pageX,c=o.pageY,d=Math.abs(a-l),f=Math.abs(i-c),g=Math.min(l,a),m=Math.min(c,i),b=this.selecting,j=this.isClick(l,c);j&&!b&&!(d||f)||(!b&&!j&&this.emit("selectStart",this._initialEventData),j||(this.selecting=!0,this._selectRect={top:m,left:g,x:l,y:c,right:g+d,bottom:m+f},this.emit("selecting",this._selectRect)),s.preventDefault())}}},{key:"_keyListener",value:function(s){this.ctrl=s.metaKey||s.ctrlKey}},{key:"isClick",value:function(s,n){var a=this._initialEventData,i=a.x,o=a.y,l=a.isTouch;return!l&&Math.abs(s-i)<=Eo&&Math.abs(n-o)<=Eo}}])}();function Kk(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return Rt(t)!=="object"&&(t={top:t,left:t,right:t,bottom:t}),t}function Do(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=lr(t),a=n.top,i=n.left,o=n.right,l=o===void 0?i:o,c=n.bottom,d=c===void 0?a:c,f=lr(r),g=f.top,m=f.left,b=f.right,j=b===void 0?m:b,h=f.bottom,u=h===void 0?g:h;return!(d-s<g||a+s>u||l-s<m||i+s>j)}function lr(t){if(!t.getBoundingClientRect)return t;var r=t.getBoundingClientRect(),s=r.left+To("left"),n=r.top+To("top");return{top:n,left:s,right:(t.offsetWidth||0)+s,bottom:(t.offsetHeight||0)+n}}function To(t){if(t==="left")return window.pageXOffset||document.body.scrollLeft||0;if(t==="top")return window.pageYOffset||document.body.scrollTop||0}var Jk=function(t){function r(s,n){var a;return Fe(this,r),a=Je(this,r,[s,n]),a.state={selecting:!1},a.containerRef=E.createRef(),a}return Xe(r,t),Ue(r,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(n){!n.selectable&&this.props.selectable&&this._selectable(),n.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var n=this.props,a=n.range,i=n.getNow,o=n.getters,l=n.date,c=n.components.dateCellWrapper,d=n.localizer,f=this.state,g=f.selecting,m=f.startIdx,b=f.endIdx,j=i();return _.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},a.map(function(h,u){var w=g&&u>=m&&u<=b,x=o.dayProp(h),S=x.className,v=x.style;return _.createElement(c,{key:u,value:h,range:a},_.createElement("div",{style:v,className:Pe("rbc-day-bg",S,w&&"rbc-selected-cell",d.isSameDate(h,j)&&"rbc-today",l&&d.neq(l,h,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var n=this,a=this.containerRef.current,i=this._selector=new Ec(this.props.container,{longPressThreshold:this.props.longPressThreshold}),o=function(c,d){if(!Bs(a,c)&&!Yk(a,c)){var f=lr(a),g=n.props,m=g.range,b=g.rtl;if(Fk(f,c)){var j=Cc(f,c.x,b,m.length);n._selectSlot({startIdx:j,endIdx:j,action:d,box:c})}}n._initial={},n.setState({selecting:!1})};i.on("selecting",function(l){var c=n.props,d=c.range,f=c.rtl,g=-1,m=-1;if(n.state.selecting||(Te(n.props.onSelectStart,[l]),n._initial={x:l.x,y:l.y}),i.isSelected(a)){var b=lr(a),j=Uk(n._initial,b,l,d.length,f);g=j.startIdx,m=j.endIdx}n.setState({selecting:!0,startIdx:g,endIdx:m})}),i.on("beforeSelect",function(l){if(n.props.selectable==="ignoreEvents")return!Bs(n.containerRef.current,l)}),i.on("click",function(l){return o(l,"click")}),i.on("doubleClick",function(l){return o(l,"doubleClick")}),i.on("select",function(l){n._selectSlot(Se(Se({},n.state),{},{action:"select",bounds:l})),n._initial={},n.setState({selecting:!1}),Te(n.props.onSelectEnd,[n.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(n){var a=n.endIdx,i=n.startIdx,o=n.action,l=n.bounds,c=n.box;a!==-1&&i!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:i,end:a,action:o,bounds:l,box:c,resourceId:this.props.resourceId})}}])}(_.Component),ht={propTypes:{slotMetrics:re.object.isRequired,selected:re.object,isAllDay:re.bool,accessors:re.object.isRequired,localizer:re.object.isRequired,components:re.object.isRequired,getters:re.object.isRequired,onSelect:re.func,onDoubleClick:re.func,onKeyPress:re.func},defaultProps:{segments:[],selected:{}},renderEvent:function(r,s){var n=r.selected;r.isAllDay;var a=r.accessors,i=r.getters,o=r.onSelect,l=r.onDoubleClick,c=r.onKeyPress,d=r.localizer,f=r.slotMetrics,g=r.components,m=r.resizable,b=f.continuesPrior(s),j=f.continuesAfter(s);return _.createElement(Sc,{event:s,getters:i,localizer:d,accessors:a,components:g,onSelect:o,onDoubleClick:l,onKeyPress:c,continuesPrior:b,continuesAfter:j,slotStart:f.first,slotEnd:f.last,selected:mn(s,n),resizable:m})},renderSpan:function(r,s,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(s)/r*100+"%";return _.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},a)}},Dc=function(t){function r(){return Fe(this,r),Je(this,r,arguments)}return Xe(r,t),Ue(r,[{key:"render",value:function(){var n=this,a=this.props,i=a.segments,o=a.slotMetrics.slots,l=a.className,c=1;return _.createElement("div",{className:Pe(l,"rbc-row")},i.reduce(function(d,f,g){var m=f.event,b=f.left,j=f.right,h=f.span,u="_lvl_"+g,w=b-c,x=ht.renderEvent(n.props,m);return w&&d.push(ht.renderSpan(o,w,"".concat(u,"_gap"))),d.push(ht.renderSpan(o,h,u,x)),c=j+1,d},[]))}}])}(_.Component);Dc.defaultProps=Se({},ht.defaultProps);function Tc(t){var r=t.dateRange,s=t.unit,n=s===void 0?"day":s,a=t.localizer;return{first:r[0],last:a.add(r[r.length-1],1,n)}}function Xk(t,r,s,n){var a=Tc({dateRange:r,localizer:n}),i=a.first,o=a.last,l=n.diff(i,o,"day"),c=n.max(n.startOf(s.start(t),"day"),i),d=n.min(n.ceil(s.end(t),"day"),o),f=tj(r,function(m){return n.isSameDate(m,c)}),g=n.diff(c,d,"day");return g=Math.min(g,l),g=Math.max(g-n.segmentOffset,1),{event:t,span:g,left:f+1,right:Math.max(f+g,1)}}function Vn(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,s,n,a,i=[],o=[];for(s=0;s<t.length;s++){for(a=t[s],n=0;n<i.length&&Qk(a,i[n]);n++);n>=r?o.push(a):(i[n]||(i[n]=[])).push(a)}for(s=0;s<i.length;s++)i[s].sort(function(l,c){return l.left-c.left});return{levels:i,extra:o}}function ns(t,r,s,n,a){var i={start:n.start(t),end:n.end(t)},o={start:r,end:s};return a.inEventRange({event:i,range:o})}function Qk(t,r){return r.some(function(s){return s.left<=t.right&&s.right>=t.left})}function Zk(t,r,s){var n=Es(t),a=[],i=[];n.forEach(function(c){var d=r.start(c),f=r.end(c);s.daySpan(d,f)>1?a.push(c):i.push(c)});var o=a.sort(function(c,d){return Kn(c,d,r,s)}),l=i.sort(function(c,d){return Kn(c,d,r,s)});return[].concat(Es(o),Es(l))}function Kn(t,r,s,n){var a={start:s.start(t),end:s.end(t),allDay:s.allDay(t)},i={start:s.start(r),end:s.end(r),allDay:s.allDay(r)};return n.sortEvents({evtA:a,evtB:i})}var Jn=function(r,s){return r.left<=s&&r.right>=s},En=function(r,s){return r.filter(function(n){return Jn(n,s)}).map(function(n){return n.event})},Oc=function(t){function r(){return Fe(this,r),Je(this,r,arguments)}return Xe(r,t),Ue(r,[{key:"render",value:function(){for(var n=this.props,a=n.segments,i=n.slotMetrics.slots,o=Vn(a).levels[0],l=1,c=1,d=[];l<=i;){var f="_lvl_"+l,g=o.filter(function(v){return Jn(v,l)})[0]||{},m=g.event,b=g.left,j=g.right,h=g.span;if(!m){var u=this.getHiddenEventsForSlot(a,l);if(u.length>0){var w=l-c;w&&d.push(ht.renderSpan(i,w,f+"_gap")),d.push(ht.renderSpan(i,1,f,this.renderShowMore(a,l))),c=l=l+1;continue}l++;continue}var x=Math.max(0,b-c);if(this.canRenderSlotEvent(b,h)){var S=ht.renderEvent(this.props,m);x&&d.push(ht.renderSpan(i,x,f+"_gap")),d.push(ht.renderSpan(i,h,f,S)),c=l=j+1}else x&&d.push(ht.renderSpan(i,x,f+"_gap")),d.push(ht.renderSpan(i,1,f,this.renderShowMore(a,l))),c=l=l+1}return _.createElement("div",{className:"rbc-row"},d)}},{key:"getHiddenEventsForSlot",value:function(n,a){var i=En(n,a),o=Vn(n).levels[0],l=o.filter(function(c){return Jn(c,a)}).map(function(c){return c.event});return i.filter(function(c){return!l.some(function(d){return d===c})})}},{key:"canRenderSlotEvent",value:function(n,a){var i=this.props.segments;return hj(n,n+a).every(function(o){var l=En(i,o).length;return l===1})}},{key:"renderShowMore",value:function(n,a){var i=this,o=this.props,l=o.localizer,c=o.slotMetrics,d=o.components,f=c.getEventsForSlot(a),g=En(n,a),m=g.length;if(d!=null&&d.showMore){var b=d.showMore,j=c.getDateForSlot(a-1);return m?_.createElement(b,{localizer:l,slotDate:j,slot:a,count:m,events:f,remainingEvents:g}):!1}return m?_.createElement("button",{type:"button",key:"sm_"+a,className:Pe("rbc-button-link","rbc-show-more"),onClick:function(u){return i.showMore(a,u)}},l.messages.showMore(m,g,f)):!1}},{key:"showMore",value:function(n,a){a.preventDefault(),a.stopPropagation(),this.props.onShowMore(n,a.target)}}])}(_.Component);Oc.defaultProps=Se({},ht.defaultProps);var e5=function(r){var s=r.children;return _.createElement("div",{className:"rbc-row-content-scroll-container"},s)},t5=function(r,s){return r.left<=s&&r.right>=s},r5=function(r,s){return r[0].range===s[0].range&&r[0].events===s[0].events};function Mc(){return nc(function(t){for(var r=t.range,s=t.events,n=t.maxRows,a=t.minRows,i=t.accessors,o=t.localizer,l=Tc({dateRange:r,localizer:o}),c=l.first,d=l.last,f=s.map(function(h){return Xk(h,r,i,o)}),g=Vn(f,Math.max(n-1,1)),m=g.levels,b=g.extra,j=b.length>0?a-1:a;m.length<j;)m.push([]);return{first:c,last:d,levels:m,extra:b,range:r,slots:r.length,clone:function(u){var w=Mc();return w(Se(Se({},t),u))},getDateForSlot:function(u){return r[u]},getSlotForDate:function(u){return r.find(function(w){return o.isSameDate(w,u)})},getEventsForSlot:function(u){return f.filter(function(w){return t5(w,u)}).map(function(w){return w.event})},continuesPrior:function(u){return o.continuesPrior(i.start(u),c)},continuesAfter:function(u){var w=i.start(u),x=i.end(u);return o.continuesAfter(w,x,d)}}},r5)}var as=function(t){function r(){var s;Fe(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=Je(this,r,[].concat(a)),s.handleSelectSlot=function(o){var l=s.props,c=l.range,d=l.onSelectSlot;d(c.slice(o.start,o.end+1),o)},s.handleShowMore=function(o,l){var c=s.props,d=c.range,f=c.onShowMore,g=s.slotMetrics(s.props),m=eh(s.containerRef.current,".rbc-row-bg")[0],b;m&&(b=m.children[o-1]);var j=g.getEventsForSlot(o);f(j,d[o-1],b,o,l)},s.getContainer=function(){var o=s.props.container;return o?o():s.containerRef.current},s.renderHeadingCell=function(o,l){var c=s.props,d=c.renderHeader,f=c.getNow,g=c.localizer;return d({date:o,key:"header_".concat(l),className:Pe("rbc-date-cell",g.isSameDate(o,f())&&"rbc-now")})},s.renderDummy=function(){var o=s.props,l=o.className,c=o.range,d=o.renderHeader,f=o.showAllEvents;return _.createElement("div",{className:l,ref:s.containerRef},_.createElement("div",{className:Pe("rbc-row-content",f&&"rbc-row-content-scrollable")},d&&_.createElement("div",{className:"rbc-row",ref:s.headingRowRef},c.map(s.renderHeadingCell)),_.createElement("div",{className:"rbc-row",ref:s.eventRowRef},_.createElement("div",{className:"rbc-row-segment"},_.createElement("div",{className:"rbc-event"},_.createElement("div",{className:"rbc-event-content"}," "))))))},s.containerRef=E.createRef(),s.headingRowRef=E.createRef(),s.eventRowRef=E.createRef(),s.slotMetrics=Mc(),s}return Xe(r,t),Ue(r,[{key:"getRowLimit",value:function(){var n,a=kn(this.eventRowRef.current),i=(n=this.headingRowRef)!==null&&n!==void 0&&n.current?kn(this.headingRowRef.current):0,o=kn(this.containerRef.current)-i;return Math.max(Math.floor(o/a),1)}},{key:"render",value:function(){var n=this.props,a=n.date,i=n.rtl,o=n.range,l=n.className,c=n.selected,d=n.selectable,f=n.renderForMeasure,g=n.accessors,m=n.getters,b=n.components,j=n.getNow,h=n.renderHeader,u=n.onSelect,w=n.localizer,x=n.onSelectStart,S=n.onSelectEnd,v=n.onDoubleClick,D=n.onKeyPress,P=n.resourceId,A=n.longPressThreshold,H=n.isAllDay,O=n.resizable,z=n.showAllEvents;if(f)return this.renderDummy();var R=this.slotMetrics(this.props),K=R.levels,Y=R.extra,ee=z?e5:Nt,B=b.weekWrapper,V={selected:c,accessors:g,getters:m,localizer:w,components:b,onSelect:u,onDoubleClick:v,onKeyPress:D,resourceId:P,slotMetrics:R,resizable:O};return _.createElement("div",{className:l,role:"rowgroup",ref:this.containerRef},_.createElement(Jk,{localizer:w,date:a,getNow:j,rtl:i,range:o,selectable:d,container:this.getContainer,getters:m,onSelectStart:x,onSelectEnd:S,onSelectSlot:this.handleSelectSlot,components:b,longPressThreshold:A,resourceId:P}),_.createElement("div",{className:Pe("rbc-row-content",z&&"rbc-row-content-scrollable"),role:"row"},h&&_.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},o.map(this.renderHeadingCell)),_.createElement(ee,null,_.createElement(B,Object.assign({isAllDay:H},V,{rtl:this.props.rtl}),K.map(function(I,W){return _.createElement(Dc,Object.assign({key:W,segments:I},V))}),!!Y.length&&_.createElement(Oc,Object.assign({segments:Y,onShowMore:this.handleShowMore},V))))))}}])}(_.Component);as.defaultProps={minRows:0,maxRows:1/0};var Wa=function(r){var s=r.label;return _.createElement("span",{role:"columnheader","aria-sort":"none"},s)},s5=function(r){var s=r.label,n=r.drilldownView,a=r.onDrillDown;return n?_.createElement("button",{type:"button",className:"rbc-button-link",onClick:a},s):_.createElement("span",null,s)},n5=["date","className"],a5=function(r,s,n,a,i){return r.filter(function(o){return ns(o,s,n,a,i)})},hn=function(t){function r(){var s;Fe(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=Je(this,r,[].concat(a)),s.getContainer=function(){return s.containerRef.current},s.renderWeek=function(o,l){var c=s.props,d=c.events,f=c.components,g=c.selectable,m=c.getNow,b=c.selected,j=c.date,h=c.localizer,u=c.longPressThreshold,w=c.accessors,x=c.getters,S=c.showAllEvents,v=s.state,D=v.needLimitMeasure,P=v.rowLimit,A=a5(Es(d),o[0],o[o.length-1],w,h),H=Zk(A,w,h);return _.createElement(as,{key:l,ref:l===0?s.slotRowRef:void 0,container:s.getContainer,className:"rbc-month-row",getNow:m,date:j,range:o,events:H,maxRows:S?1/0:P,selected:b,selectable:g,components:f,accessors:w,getters:x,localizer:h,renderHeader:s.readerDateHeading,renderForMeasure:D,onShowMore:s.handleShowMore,onSelect:s.handleSelectEvent,onDoubleClick:s.handleDoubleClickEvent,onKeyPress:s.handleKeyPressEvent,onSelectSlot:s.handleSelectSlot,longPressThreshold:u,rtl:s.props.rtl,resizable:s.props.resizable,showAllEvents:S})},s.readerDateHeading=function(o){var l=o.date,c=o.className,d=Tt(o,n5),f=s.props,g=f.date,m=f.getDrilldownView,b=f.localizer,j=b.neq(g,l,"month"),h=b.isSameDate(l,g),u=m(l),w=b.format(l,"dateFormat"),x=s.props.components.dateHeader||s5;return _.createElement("div",Object.assign({},d,{className:Pe(c,j&&"rbc-off-range",h&&"rbc-current"),role:"cell"}),_.createElement(x,{label:w,date:l,drilldownView:u,isOffRange:j,onDrillDown:function(v){return s.handleHeadingClick(l,u,v)}}))},s.handleSelectSlot=function(o,l){s._pendingSelection=s._pendingSelection.concat(o),clearTimeout(s._selectTimer),s._selectTimer=setTimeout(function(){return s.selectDates(l)})},s.handleHeadingClick=function(o,l,c){c.preventDefault(),s.clearSelection(),Te(s.props.onDrillDown,[o,l])},s.handleSelectEvent=function(){s.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onSelectEvent,l)},s.handleDoubleClickEvent=function(){s.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onDoubleClickEvent,l)},s.handleKeyPressEvent=function(){s.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onKeyPressEvent,l)},s.handleShowMore=function(o,l,c,d,f){var g=s.props,m=g.popup,b=g.onDrillDown,j=g.onShowMore,h=g.getDrilldownView,u=g.doShowMoreDrillDown;if(s.clearSelection(),m){var w=Ml(c,s.containerRef.current);s.setState({overlay:{date:l,events:o,position:w,target:f}})}else u&&Te(b,[l,h(l)||Ze.DAY]);Te(j,[o,l,d])},s.overlayDisplay=function(){s.setState({overlay:null})},s.state={rowLimit:5,needLimitMeasure:!0,date:null},s.containerRef=E.createRef(),s.slotRowRef=E.createRef(),s._bgRows=[],s._pendingSelection=[],s}return Xe(r,t),Ue(r,[{key:"componentDidMount",value:function(){var n=this,a;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){a||_l(function(){a=!1,n.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,o=n.className,l=i.visibleDays(a,i),c=Lm(l,7);return this._weekCount=c.length,_.createElement("div",{className:Pe("rbc-month-view",o),role:"table","aria-label":"Month View",ref:this.containerRef},_.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(c[0])),c.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(n){var a=this.props,i=a.localizer,o=a.components,l=n[0],c=n[n.length-1],d=o.header||Wa;return i.range(l,c,"day").map(function(f,g){return _.createElement("div",{key:"header_"+g,className:"rbc-header"},_.createElement(d,{date:f,localizer:i,label:i.format(f,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var n,a,i=this,o=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},l=this.props,c=l.accessors,d=l.localizer,f=l.components,g=l.getters,m=l.selected,b=l.popupOffset,j=l.handleDragStart,h=function(){return i.setState({overlay:null})};return _.createElement(Ua,{overlay:o,accessors:c,localizer:d,components:f,getters:g,selected:m,popupOffset:b,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:j,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:h})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(n){var a=this._pendingSelection.slice();this._pendingSelection=[],a.sort(function(l,c){return+l-+c});var i=new Date(a[0]),o=new Date(a[a.length-1]);o.setDate(a[a.length-1].getDate()+1),Te(this.props.onSelectSlot,{slots:a,start:i,end:o,action:n.action,bounds:n.bounds,box:n.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(n,a){var i=n.date,o=n.localizer;return{date:i,needLimitMeasure:o.neq(i,a.date,"month")}}}])}(_.Component);hn.range=function(t,r){var s=r.localizer,n=s.firstVisibleDay(t,s),a=s.lastVisibleDay(t,s);return{start:n,end:a}};hn.navigate=function(t,r,s){var n=s.localizer;switch(r){case lt.PREVIOUS:return n.add(t,-1,"month");case lt.NEXT:return n.add(t,1,"month");default:return t}};hn.title=function(t,r){var s=r.localizer;return s.format(t,"monthHeaderFormat")};var Oo=function(r){var s=r.min,n=r.max,a=r.step,i=r.slots,o=r.localizer;return"".concat(+o.startOf(s,"minutes"))+"".concat(+o.startOf(n,"minutes"))+"".concat(a,"-").concat(i)};function Ba(t){for(var r=t.min,s=t.max,n=t.step,a=t.timeslots,i=t.localizer,o=Oo({step:n,localizer:i}),l=1+i.getTotalMin(r,s),c=i.getMinutesFromMidnight(r),d=Math.ceil((l-1)/(n*a)),f=d*a,g=new Array(d),m=new Array(f),b=0;b<d;b++){g[b]=new Array(a);for(var j=0;j<a;j++){var h=b*a+j,u=h*n;m[h]=g[b][j]=i.getSlotDate(r,c,u)}}var w=m.length*n;m.push(i.getSlotDate(r,c,w));function x(S){var v=i.diff(r,S,"minutes")+i.getDstOffset(r,S);return Math.min(v,l)}return{groups:g,update:function(v){return Oo(v)!==o?Ba(v):this},dateIsInGroup:function(v,D){var P=g[D+1];return i.inRange(v,g[D][0],P?P[0]:s,"minutes")},nextSlot:function(v){var D=m[Math.min(m.findIndex(function(P){return P===v||i.eq(P,v)})+1,m.length-1)];return i.eq(D,v)&&(D=i.add(v,n,"minutes")),D},closestSlotToPosition:function(v){var D=Math.min(m.length-1,Math.max(0,Math.floor(v*f)));return m[D]},closestSlotFromPoint:function(v,D){var P=Math.abs(D.top-D.bottom);return this.closestSlotToPosition((v.y-D.top)/P)},closestSlotFromDate:function(v){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(i.lt(v,r,"minutes"))return m[0];if(i.gt(v,s,"minutes"))return m[m.length-1];var P=i.diff(r,v,"minutes");return m[(P-P%n)/n+D]},startsBeforeDay:function(v){return i.lt(v,r,"day")},startsAfterDay:function(v){return i.gt(v,s,"day")},startsBefore:function(v){return i.lt(i.merge(r,v),r,"minutes")},startsAfter:function(v){return i.gt(i.merge(s,v),s,"minutes")},getRange:function(v,D,P,A){P||(v=i.min(s,i.max(r,v))),A||(D=i.min(s,i.max(r,D)));var H=x(v),O=x(D),z=O>n*f&&!i.eq(s,D)?(H-n)/(n*f)*100:H/(n*f)*100;return{top:z,height:O/(n*f)*100-z,start:x(v),startDate:v,end:x(D),endDate:D}},getCurrentTimePosition:function(v){var D=x(v),P=D/(n*f)*100;return P}}}var i5=function(){function t(r,s){var n=s.accessors,a=s.slotMetrics;Fe(this,t);var i=a.getRange(n.start(r),n.end(r)),o=i.start,l=i.startDate,c=i.end,d=i.endDate,f=i.top,g=i.height;this.start=o,this.end=c,this.startMs=+l,this.endMs=+d,this.top=f,this.height=g,this.data=r}return Ue(t,[{key:"_width",get:function(){if(this.rows){var s=this.rows.reduce(function(a,i){return Math.max(a,i.leaves.length+1)},0)+1;return 100/s}if(this.leaves){var n=100-this.container._width;return n/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var s=this._width,n=Math.min(100,this._width*1.7);if(this.rows)return n;if(this.leaves)return this.leaves.length>0?n:s;var a=this.row.leaves,i=a.indexOf(this);return i===a.length-1?s:n}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var s=this.row,n=s.leaves,a=s.xOffset,i=s._width,o=n.indexOf(this)+1;return a+o*i}}])}();function o5(t,r,s){return Math.abs(r.start-t.start)<s||r.start>t.start&&r.start<t.end}function l5(t){for(var r=_w(t,["startMs",function(l){return-l.endMs}]),s=[];r.length>0;){var n=r.shift();s.push(n);for(var a=0;a<r.length;a++){var i=r[a];if(!(n.endMs>i.startMs)){if(a>0){var o=r.splice(a,1)[0];s.push(o)}break}}}return s}function _c(t){for(var r=t.events,s=t.minimumStartDifference,n=t.slotMetrics,a=t.accessors,i=r.map(function(f){return new i5(f,{slotMetrics:n,accessors:a})}),o=l5(i),l=[],c=function(){var g=o[d],m=l.find(function(h){return h.end>g.start||Math.abs(g.start-h.start)<s});if(!m)return g.rows=[],l.push(g),1;g.container=m;for(var b=null,j=m.rows.length-1;!b&&j>=0;j--)o5(m.rows[j],g,s)&&(b=m.rows[j]);b?(b.leaves.push(g),g.row=b):(g.leaves=[],m.rows.push(g))},d=0;d<o.length;d++)c();return o.map(function(f){return{event:f.data,style:{top:f.top,height:f.height,width:f.width,xOffset:Math.max(0,f.xOffset)}}})}function Pc(t,r,s){for(var n=0;n<t.friends.length;++n)if(!(s.indexOf(t.friends[n])>-1)){r=r>t.friends[n].idx?r:t.friends[n].idx,s.push(t.friends[n]);var a=Pc(t.friends[n],r,s);r=r>a?r:a}return r}function c5(t){var r=t.events,s=t.minimumStartDifference,n=t.slotMetrics,a=t.accessors,i=_c({events:r,minimumStartDifference:s,slotMetrics:n,accessors:a});i.sort(function(B,V){return B=B.style,V=V.style,B.top!==V.top?B.top>V.top?1:-1:B.height!==V.height?B.top+B.height<V.top+V.height?1:-1:0});for(var o=0;o<i.length;++o)i[o].friends=[],delete i[o].style.left,delete i[o].style.left,delete i[o].idx,delete i[o].size;for(var l=0;l<i.length-1;++l)for(var c=i[l],d=c.style.top,f=c.style.top+c.style.height,g=l+1;g<i.length;++g){var m=i[g],b=m.style.top,j=m.style.top+m.style.height;(b>=d&&j<=f||j>d&&j<=f||b>=d&&b<f)&&(c.friends.push(m),m.friends.push(c))}for(var h=0;h<i.length;++h){for(var u=i[h],w=[],x=0;x<100;++x)w.push(1);for(var S=0;S<u.friends.length;++S)u.friends[S].idx!==void 0&&(w[u.friends[S].idx]=0);u.idx=w.indexOf(1)}for(var v=0;v<i.length;++v){var D=0;if(!i[v].size){var P=[],A=Pc(i[v],0,P);D=100/(A+1),i[v].size=D;for(var H=0;H<P.length;++H)P[H].size=D}}for(var O=0;O<i.length;++O){var z=i[O];z.style.left=z.idx*z.size;for(var R=0,K=0;K<z.friends.length;++K){var Y=z.friends[K].idx;R=R>Y?R:Y}R<=z.idx&&(z.size=100-z.idx*z.size);var ee=z.idx===0?0:3;z.style.width="calc(".concat(z.size,"% - ").concat(ee,"px)"),z.style.height="calc(".concat(z.style.height,"% - 2px)"),z.style.xOffset="calc(".concat(z.style.left,"% + ").concat(ee,"px)")}return i}var Mo={overlap:_c,"no-overlap":c5};function d5(t){return!!(t&&t.constructor&&t.call&&t.apply)}function u5(t){t.events,t.minimumStartDifference,t.slotMetrics,t.accessors;var r=t.dayLayoutAlgorithm,s=r;return r in Mo&&(s=Mo[r]),d5(s)?s.apply(this,arguments):[]}var Ac=function(t){function r(){return Fe(this,r),Je(this,r,arguments)}return Xe(r,t),Ue(r,[{key:"render",value:function(){var n=this.props,a=n.renderSlot,i=n.resource,o=n.group,l=n.getters,c=n.components,d=c===void 0?{}:c,f=d.timeSlotWrapper,g=f===void 0?Nt:f,m=l?l.slotGroupProp(o):{};return _.createElement("div",Object.assign({className:"rbc-timeslot-group"},m),o.map(function(b,j){var h=l?l.slotProp(b,i):{};return _.createElement(g,{key:j,value:b,resource:i},_.createElement("div",Object.assign({},h,{className:Pe("rbc-time-slot",h.className)}),a&&a(b,j)))}))}}])}(E.Component);function ks(t){return typeof t=="string"?t:t+"%"}function m5(t){var r=t.style,s=t.className,n=t.event,a=t.accessors,i=t.rtl,o=t.selected,l=t.label,c=t.continuesPrior,d=t.continuesAfter,f=t.getters,g=t.onClick,m=t.onDoubleClick,b=t.isBackgroundEvent,j=t.onKeyPress,h=t.components,u=h.event,w=h.eventWrapper,x=a.title(n),S=a.tooltip(n),v=a.end(n),D=a.start(n),P=f.eventProp(n,D,v,o),A=[_.createElement("div",{key:"1",className:"rbc-event-label"},l),_.createElement("div",{key:"2",className:"rbc-event-content"},u?_.createElement(u,{event:n,title:x}):x)],H=r.height,O=r.top,z=r.width,R=r.xOffset,K=Se(Se({},P.style),{},Xt({top:ks(O),height:ks(H),width:ks(z)},i?"right":"left",ks(R)));return _.createElement(w,Object.assign({type:"time"},t),_.createElement("div",{role:"button",tabIndex:0,onClick:g,onDoubleClick:m,style:K,onKeyDown:j,title:S?(typeof l=="string"?l+": ":"")+S:void 0,className:Pe(b?"rbc-background-event":"rbc-event",s,P.className,{"rbc-selected":o,"rbc-event-continues-earlier":c,"rbc-event-continues-later":d})},A))}var h5=function(r){var s=r.children,n=r.className,a=r.style,i=r.innerRef;return _.createElement("div",{className:n,style:a,ref:i},s)},f5=_.forwardRef(function(t,r){return _.createElement(h5,Object.assign({},t,{innerRef:r}))}),g5=["dayProp"],x5=["eventContainerWrapper","timeIndicatorWrapper"],Rc=function(t){function r(){var s;Fe(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=Je(this,r,[].concat(a)),s.state={selecting:!1,timeIndicatorPosition:null},s.intervalTriggered=!1,s.renderEvents=function(o){var l=o.events,c=o.isBackgroundEvent,d=s.props,f=d.rtl,g=d.selected,m=d.accessors,b=d.localizer,j=d.getters,h=d.components,u=d.step,w=d.timeslots,x=d.dayLayoutAlgorithm,S=d.resizable,v=s,D=v.slotMetrics,P=b.messages,A=u5({events:l,accessors:m,slotMetrics:D,minimumStartDifference:Math.ceil(u*w/2),dayLayoutAlgorithm:x});return A.map(function(H,O){var z,R=H.event,K=H.style,Y=m.end(R),ee=m.start(R),B=(z=m.eventId(R))!==null&&z!==void 0?z:"evt_"+O,V="eventTimeRangeFormat",I,W=D.startsBeforeDay(ee),J=D.startsAfterDay(Y);W?V="eventTimeRangeEndFormat":J&&(V="eventTimeRangeStartFormat"),W&&J?I=P.allDay:I=b.format({start:ee,end:Y},V);var L=W||D.startsBefore(ee),fe=J||D.startsAfter(Y);return _.createElement(m5,{style:K,event:R,label:I,key:B,getters:j,rtl:f,components:h,continuesPrior:L,continuesAfter:fe,accessors:m,resource:s.props.resource,selected:mn(R,g),onClick:function(xe){return s._select(Se(Se(Se({},R),s.props.resource&&{sourceResource:s.props.resource}),c&&{isBackgroundEvent:!0}),xe)},onDoubleClick:function(xe){return s._doubleClick(R,xe)},isBackgroundEvent:c,onKeyPress:function(xe){return s._keyPress(R,xe)},resizable:S})})},s._selectable=function(){var o=s.containerRef.current,l=s.props,c=l.longPressThreshold,d=l.localizer,f=s._selector=new Ec(function(){return o},{longPressThreshold:c}),g=function(h){var u=s.props.onSelecting,w=s.state||{},x=m(h),S=x.startDate,v=x.endDate;u&&(d.eq(w.startDate,S,"minutes")&&d.eq(w.endDate,v,"minutes")||u({start:S,end:v,resourceId:s.props.resource})===!1)||(s.state.start!==x.start||s.state.end!==x.end||s.state.selecting!==x.selecting)&&s.setState(x)},m=function(h){var u=s.slotMetrics.closestSlotFromPoint(h,lr(o));s.state.selecting||(s._initialSlot=u);var w=s._initialSlot;d.lte(w,u)?u=s.slotMetrics.nextSlot(u):d.gt(w,u)&&(w=s.slotMetrics.nextSlot(w));var x=s.slotMetrics.getRange(d.min(w,u),d.max(w,u));return Se(Se({},x),{},{selecting:!0,top:"".concat(x.top,"%"),height:"".concat(x.height,"%")})},b=function(h,u){if(!Bs(s.containerRef.current,h)){var w=m(h),x=w.startDate,S=w.endDate;s._selectSlot({startDate:x,endDate:S,action:u,box:h})}s.setState({selecting:!1})};f.on("selecting",g),f.on("selectStart",g),f.on("beforeSelect",function(j){if(s.props.selectable==="ignoreEvents")return!Bs(s.containerRef.current,j)}),f.on("click",function(j){return b(j,"click")}),f.on("doubleClick",function(j){return b(j,"doubleClick")}),f.on("select",function(j){s.state.selecting&&(s._selectSlot(Se(Se({},s.state),{},{action:"select",bounds:j})),s.setState({selecting:!1}))}),f.on("reset",function(){s.state.selecting&&s.setState({selecting:!1})})},s._teardownSelectable=function(){s._selector&&(s._selector.teardown(),s._selector=null)},s._selectSlot=function(o){for(var l=o.startDate,c=o.endDate,d=o.action,f=o.bounds,g=o.box,m=l,b=[];s.props.localizer.lte(m,c);)b.push(m),m=new Date(+m+s.props.step*60*1e3);Te(s.props.onSelectSlot,{slots:b,start:l,end:c,resourceId:s.props.resource,action:d,bounds:f,box:g})},s._select=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onSelectEvent,l)},s._doubleClick=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onDoubleClickEvent,l)},s._keyPress=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onKeyPressEvent,l)},s.slotMetrics=Ba(s.props),s.containerRef=E.createRef(),s}return Xe(r,t),Ue(r,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(n,a){this.props.selectable&&!n.selectable&&this._selectable(),!this.props.selectable&&n.selectable&&this._teardownSelectable();var i=this.props,o=i.getNow,l=i.isNow,c=i.localizer,d=i.date,f=i.min,g=i.max,m=c.neq(n.getNow(),o(),"minutes");if(n.isNow!==l||m){if(this.clearTimeIndicatorInterval(),l){var b=!m&&c.eq(n.date,d,"minutes")&&a.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(b)}}else l&&(c.neq(n.min,f,"minutes")||c.neq(n.max,g,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!a&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){n.intervalTriggered=!0,n.positionTimeIndicator(),n.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var n=this.props,a=n.min,i=n.max,o=n.getNow,l=o();if(l>=a&&l<=i){var c=this.slotMetrics.getCurrentTimePosition(l);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:c})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var n=this.props,a=n.date,i=n.max,o=n.rtl,l=n.isNow,c=n.resource,d=n.accessors,f=n.localizer,g=n.getters,m=g.dayProp,b=Tt(g,g5),j=n.components,h=j.eventContainerWrapper,u=j.timeIndicatorWrapper,w=Tt(j,x5);this.slotMetrics=this.slotMetrics.update(this.props);var x=this.slotMetrics,S=this.state,v=S.selecting,D=S.top,P=S.height,A=S.startDate,H=S.endDate,O={start:A,end:H},z=m(i,c),R=z.className,K=z.style,Y={className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}},ee=w.dayColumnWrapper||f5;return _.createElement(ee,{ref:this.containerRef,date:a,style:K,className:Pe(R,"rbc-day-slot","rbc-time-column",l&&"rbc-now",l&&"rbc-today",v&&"rbc-slot-selecting"),slotMetrics:x,resource:c},x.groups.map(function(B,V){return _.createElement(Ac,{key:V,group:B,resource:c,getters:b,components:w})}),_.createElement(h,{localizer:f,resource:c,accessors:d,getters:b,components:w,slotMetrics:x},_.createElement("div",{className:Pe("rbc-events-container",o&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),v&&_.createElement("div",{className:"rbc-slot-selection",style:{top:D,height:P}},_.createElement("span",null,f.format(O,"selectRangeFormat"))),l&&this.intervalTriggered&&_.createElement(u,Y,_.createElement("div",Y)))}}])}(_.Component);Rc.defaultProps={dragThroughEvents:!0,timeslots:2};var Ic=function(r){var s=r.label;return _.createElement(_.Fragment,null,s)},p5=function(t){function r(){var s;Fe(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=Je(this,r,[].concat(a)),s.handleHeaderClick=function(o,l,c){c.preventDefault(),Te(s.props.onDrillDown,[o,l])},s.renderRow=function(o){var l=s.props,c=l.events,d=l.rtl,f=l.selectable,g=l.getNow,m=l.range,b=l.getters,j=l.localizer,h=l.accessors,u=l.components,w=l.resizable,x=h.resourceId(o),S=o?c.filter(function(v){return h.resource(v)===x}):c;return _.createElement(as,{isAllDay:!0,rtl:d,getNow:g,minRows:2,maxRows:s.props.allDayMaxRows+1,range:m,events:S,resourceId:x,className:"rbc-allday-cell",selectable:f,selected:s.props.selected,components:u,accessors:h,getters:b,localizer:j,onSelect:s.props.onSelectEvent,onShowMore:s.props.onShowMore,onDoubleClick:s.props.onDoubleClickEvent,onKeyPress:s.props.onKeyPressEvent,onSelectSlot:s.props.onSelectSlot,longPressThreshold:s.props.longPressThreshold,resizable:w})},s}return Xe(r,t),Ue(r,[{key:"renderHeaderCells",value:function(n){var a=this,i=this.props,o=i.localizer,l=i.getDrilldownView,c=i.getNow,d=i.getters.dayProp,f=i.components.header,g=f===void 0?Wa:f,m=c();return n.map(function(b,j){var h=l(b),u=o.format(b,"dayFormat"),w=d(b),x=w.className,S=w.style,v=_.createElement(g,{date:b,label:u,localizer:o});return _.createElement("div",{key:j,style:S,className:Pe("rbc-header",x,o.isSameDate(b,m)&&"rbc-today")},h?_.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(P){return a.handleHeaderClick(b,h,P)}},v):_.createElement("span",null,v))})}},{key:"render",value:function(){var n=this,a=this.props,i=a.width,o=a.rtl,l=a.resources,c=a.range,d=a.events,f=a.getNow,g=a.accessors,m=a.selectable,b=a.components,j=a.getters,h=a.scrollRef,u=a.localizer,w=a.isOverflowing,x=a.components,S=x.timeGutterHeader,v=x.resourceHeader,D=v===void 0?Ic:v,P=a.resizable,A={};w&&(A[o?"marginLeft":"marginRight"]="".concat(ya()-1,"px"));var H=l.groupEvents(d);return _.createElement("div",{style:A,ref:h,className:Pe("rbc-time-header",w&&"rbc-overflowing")},_.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:i,minWidth:i,maxWidth:i}},S&&_.createElement(S,null)),l.map(function(O,z){var R=tr(O,2),K=R[0],Y=R[1];return _.createElement("div",{className:"rbc-time-header-content",key:K||z},Y&&_.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(z)},_.createElement("div",{className:"rbc-header"},_.createElement(D,{index:z,label:g.resourceTitle(Y),resource:Y}))),_.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(c.length<=1?" rbc-time-header-cell-single-day":"")},n.renderHeaderCells(c)),_.createElement(as,{isAllDay:!0,rtl:o,getNow:f,minRows:2,maxRows:n.props.allDayMaxRows+1,range:c,events:H.get(K)||[],resourceId:Y&&K,className:"rbc-allday-cell",selectable:m,selected:n.props.selected,components:b,accessors:g,getters:j,localizer:u,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:P}))}))}}])}(_.Component),v5=function(t){function r(){var s;Fe(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=Je(this,r,[].concat(a)),s.handleHeaderClick=function(o,l,c){c.preventDefault(),Te(s.props.onDrillDown,[o,l])},s}return Xe(r,t),Ue(r,[{key:"renderHeaderCells",value:function(n){var a=this,i=this.props,o=i.localizer,l=i.getDrilldownView,c=i.getNow,d=i.getters.dayProp,f=i.components,g=f.header,m=g===void 0?Wa:g,b=f.resourceHeader,j=b===void 0?Ic:b,h=i.resources,u=i.accessors,w=i.events,x=i.rtl,S=i.selectable,v=i.components,D=i.getters,P=i.resizable,A=c(),H=h.groupEvents(w);return n.map(function(O,z){var R=l(O),K=o.format(O,"dayFormat"),Y=d(O),ee=Y.className,B=Y.style,V=_.createElement(m,{date:O,label:K,localizer:o});return _.createElement("div",{key:z,className:"rbc-time-header-content rbc-resource-grouping"},_.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(n.length<=1?" rbc-time-header-cell-single-day":"")},_.createElement("div",{style:B,className:Pe("rbc-header",ee,o.isSameDate(O,A)&&"rbc-today")},R?_.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(W){return a.handleHeaderClick(O,R,W)}},V):_.createElement("span",null,V))),_.createElement("div",{className:"rbc-row"},h.map(function(I,W){var J=tr(I,2),L=J[0],fe=J[1];return _.createElement("div",{key:"resource_".concat(L,"_").concat(W),className:Pe("rbc-header",ee,o.isSameDate(O,A)&&"rbc-today")},_.createElement(j,{index:W,label:u.resourceTitle(fe),resource:fe}))})),_.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},h.map(function(I,W){var J=tr(I,2),L=J[0],fe=J[1],he=(H.get(L)||[]).filter(function(xe){return o.isSameDate(xe.start,O)||o.isSameDate(xe.end,O)});return _.createElement(as,{key:"resource_".concat(L,"_").concat(W),isAllDay:!0,rtl:x,getNow:c,minRows:2,maxRows:a.props.allDayMaxRows+1,range:[O],events:he,resourceId:fe&&L,className:"rbc-allday-cell",selectable:S,selected:a.props.selected,components:v,accessors:u,getters:D,localizer:o,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:P})})))})}},{key:"render",value:function(){var n=this.props,a=n.width,i=n.rtl,o=n.range,l=n.scrollRef,c=n.isOverflowing,d=n.components.timeGutterHeader,f={};return c&&(f[i?"marginLeft":"marginRight"]="".concat(ya()-1,"px")),_.createElement("div",{style:f,ref:l,className:Pe("rbc-time-header",c&&"rbc-overflowing")},_.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:a,minWidth:a,maxWidth:a}},d&&_.createElement(d,null)),this.renderHeaderCells(o))}}])}(_.Component);function b5(t){var r=t.min,s=t.max,n=t.localizer;return n.getTimezoneOffset(r)!==n.getTimezoneOffset(s)?{start:n.add(r,-1,"day"),end:n.add(s,-1,"day")}:{start:r,end:s}}var y5=function(r){var s=r.min,n=r.max,a=r.timeslots,i=r.step,o=r.localizer,l=r.getNow,c=r.resource,d=r.components,f=r.getters,g=r.gutterRef,m=d.timeGutterWrapper,b=E.useMemo(function(){return b5({min:s,max:n,localizer:o})},[s==null?void 0:s.toISOString(),n==null?void 0:n.toISOString(),o]),j=b.start,h=b.end,u=E.useState(Ba({min:j,max:h,timeslots:a,step:i,localizer:o})),w=tr(u,2),x=w[0],S=w[1];E.useEffect(function(){x&&S(x.update({min:j,max:h,timeslots:a,step:i,localizer:o}))},[j==null?void 0:j.toISOString(),h==null?void 0:h.toISOString(),a,i]);var v=E.useCallback(function(D,P){if(P)return null;var A=x.dateIsInGroup(l(),P);return _.createElement("span",{className:Pe("rbc-label",A&&"rbc-now")},o.format(D,"timeGutterFormat"))},[x,o,l]);return _.createElement(m,{slotMetrics:x},_.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:g},x.groups.map(function(D,P){return _.createElement(Ac,{key:P,group:D,resource:c,components:d,renderSlot:v,getters:f})})))},j5=_.forwardRef(function(t,r){return _.createElement(y5,Object.assign({gutterRef:r},t))}),Dn={};function w5(t,r){return{map:function(n){return t?t.map(function(a,i){return n([r.resourceId(a),a],i)}):[n([Dn,null],0)]},groupEvents:function(n){var a=new Map;return t?(n.forEach(function(i){var o=r.resource(i)||Dn;if(Array.isArray(o))o.forEach(function(c){var d=a.get(c)||[];d.push(i),a.set(c,d)});else{var l=a.get(o)||[];l.push(i),a.set(o,l)}}),a):(a.set(Dn,n),a)}}}var Pr=function(t){function r(s){var n;return Fe(this,r),n=Je(this,r,[s]),n.handleScroll=function(a){n.scrollRef.current&&(n.scrollRef.current.scrollLeft=a.target.scrollLeft)},n.handleResize=function(){pi(n.rafHandle),n.rafHandle=_l(n.checkOverflow)},n.handleKeyPressEvent=function(){n.clearSelection();for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];Te(n.props.onKeyPressEvent,i)},n.handleSelectEvent=function(){n.clearSelection();for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];Te(n.props.onSelectEvent,i)},n.handleDoubleClickEvent=function(){n.clearSelection();for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];Te(n.props.onDoubleClickEvent,i)},n.handleShowMore=function(a,i,o,l,c){var d=n.props,f=d.popup,g=d.onDrillDown,m=d.onShowMore,b=d.getDrilldownView,j=d.doShowMoreDrillDown;if(n.clearSelection(),f){var h=Ml(o,n.containerRef.current);n.setState({overlay:{date:i,events:a,position:Se(Se({},h),{},{width:"200px"}),target:c}})}else j&&Te(g,[i,b(i)||Ze.DAY]);Te(m,[a,i,l])},n.handleSelectAllDaySlot=function(a,i){var o=n.props.onSelectSlot,l=new Date(a[0]),c=new Date(a[a.length-1]);c.setDate(a[a.length-1].getDate()+1),Te(o,{slots:a,start:l,end:c,action:i.action,resourceId:i.resourceId})},n.overlayDisplay=function(){n.setState({overlay:null})},n.checkOverflow=function(){if(!n._updatingOverflow){var a=n.contentRef.current;if(a!=null&&a.scrollHeight){var i=a.scrollHeight>a.clientHeight;n.state.isOverflowing!==i&&(n._updatingOverflow=!0,n.setState({isOverflowing:i},function(){n._updatingOverflow=!1}))}}},n.memoizedResources=nc(function(a,i){return w5(a,i)}),n.state={gutterWidth:void 0,isOverflowing:null},n.scrollRef=_.createRef(),n.contentRef=_.createRef(),n.containerRef=_.createRef(),n._scrollRatio=null,n.gutterRef=E.createRef(),n}return Xe(r,t),Ue(r,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),pi(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(n,a,i,o,l,c,d,f,g,m){var b=this.props,j=b.min,h=b.max,u=(o.get(a)||[]).filter(function(x){return c.inRange(n,d.start(x),d.end(x),"day")}),w=(l.get(a)||[]).filter(function(x){return c.inRange(n,d.start(x),d.end(x),"day")});return _.createElement(Rc,Object.assign({},this.props,{localizer:c,min:c.merge(n,j),max:c.merge(n,h),resource:i&&a,components:f,isNow:c.isSameDate(n,m),key:"".concat(a,"-").concat(n),date:n,events:u,backgroundEvents:w,dayLayoutAlgorithm:g}))}},{key:"renderResourcesFirst",value:function(n,a,i,o,l,c,d,f,g){var m=this;return a.map(function(b){var j=tr(b,2),h=j[0],u=j[1];return n.map(function(w){return m.renderDayColumn(w,h,u,i,o,l,c,f,g,d)})})}},{key:"renderRangeFirst",value:function(n,a,i,o,l,c,d,f,g){var m=this;return n.map(function(b){return _.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:b},a.map(function(j){var h=tr(j,2),u=h[0],w=h[1];return _.createElement("div",{style:{flex:1},key:c.resourceId(w)},m.renderDayColumn(b,u,w,i,o,l,c,f,g,d))}))})}},{key:"renderEvents",value:function(n,a,i,o){var l=this.props,c=l.accessors,d=l.localizer,f=l.resourceGroupingLayout,g=l.components,m=l.dayLayoutAlgorithm,b=this.memoizedResources(this.props.resources,c),j=b.groupEvents(a),h=b.groupEvents(i);return f?this.renderRangeFirst(n,b,j,h,d,c,o,g,m):this.renderResourcesFirst(n,b,j,h,d,c,o,g,m)}},{key:"render",value:function(){var n,a=this.props,i=a.events,o=a.backgroundEvents,l=a.range,c=a.width,d=a.rtl,f=a.selected,g=a.getNow,m=a.resources,b=a.components,j=a.accessors,h=a.getters,u=a.localizer,w=a.min,x=a.max,S=a.showMultiDayTimes,v=a.longPressThreshold,D=a.resizable,P=a.resourceGroupingLayout;c=c||this.state.gutterWidth;var A=l[0],H=l[l.length-1];this.slots=l.length;var O=[],z=[],R=[];i.forEach(function(Y){if(ns(Y,A,H,j,u)){var ee=j.start(Y),B=j.end(Y);j.allDay(Y)||u.startAndEndAreDateOnly(ee,B)||!S&&!u.isSameDate(ee,B)?O.push(Y):z.push(Y)}}),o.forEach(function(Y){ns(Y,A,H,j,u)&&R.push(Y)}),O.sort(function(Y,ee){return Kn(Y,ee,j,u)});var K={range:l,events:O,width:c,rtl:d,getNow:g,localizer:u,selected:f,allDayMaxRows:this.props.showAllEvents?1/0:(n=this.props.allDayMaxRows)!==null&&n!==void 0?n:1/0,resources:this.memoizedResources(m,j),selectable:this.props.selectable,accessors:j,getters:h,components:b,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:v,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:D};return _.createElement("div",{className:Pe("rbc-time-view",m&&"rbc-time-view-resources"),ref:this.containerRef},m&&m.length>1&&P?_.createElement(v5,K):_.createElement(p5,K),this.props.popup&&this.renderOverlay(),_.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},_.createElement(j5,{date:A,ref:this.gutterRef,localizer:u,min:u.merge(A,w),max:u.merge(A,x),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:b,className:"rbc-time-gutter",getters:h}),this.renderEvents(l,z,R,g())))}},{key:"renderOverlay",value:function(){var n,a,i=this,o=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},l=this.props,c=l.accessors,d=l.localizer,f=l.components,g=l.getters,m=l.selected,b=l.popupOffset,j=l.handleDragStart,h=function(){return i.setState({overlay:null})};return _.createElement(Ua,{overlay:o,accessors:c,localizer:d,components:f,getters:g,selected:m,popupOffset:b,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:j,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:h})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var n=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var a,i=(a=n.gutterRef)!==null&&a!==void 0&&a.current?qn(n.gutterRef.current):void 0;i&&n.state.gutterWidth!==i&&n.setState({gutterWidth:i})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var n=this.contentRef.current;n.scrollTop=n.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,a=n.min,i=n.max,o=n.scrollToTime,l=n.localizer,c=l.diff(l.merge(o,a),o,"milliseconds"),d=l.diff(a,i,"milliseconds");this._scrollRatio=c/d}}])}(E.Component);Pr.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var N5=["date","localizer","min","max","scrollToTime","enableAutoScroll"],fn=function(t){function r(){return Fe(this,r),Je(this,r,arguments)}return Xe(r,t),Ue(r,[{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,o=n.min,l=o===void 0?i.startOf(new Date,"day"):o,c=n.max,d=c===void 0?i.endOf(new Date,"day"):c,f=n.scrollToTime,g=f===void 0?i.startOf(new Date,"day"):f,m=n.enableAutoScroll,b=m===void 0?!0:m,j=Tt(n,N5),h=r.range(a,{localizer:i});return _.createElement(Pr,Object.assign({},j,{range:h,eventOffset:10,localizer:i,min:l,max:d,scrollToTime:g,enableAutoScroll:b}))}}])}(_.Component);fn.range=function(t,r){var s=r.localizer;return[s.startOf(t,"day")]};fn.navigate=function(t,r,s){var n=s.localizer;switch(r){case lt.PREVIOUS:return n.add(t,-1,"day");case lt.NEXT:return n.add(t,1,"day");default:return t}};fn.title=function(t,r){var s=r.localizer;return s.format(t,"dayHeaderFormat")};var S5=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Gt=function(t){function r(){return Fe(this,r),Je(this,r,arguments)}return Xe(r,t),Ue(r,[{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,o=n.min,l=o===void 0?i.startOf(new Date,"day"):o,c=n.max,d=c===void 0?i.endOf(new Date,"day"):c,f=n.scrollToTime,g=f===void 0?i.startOf(new Date,"day"):f,m=n.enableAutoScroll,b=m===void 0?!0:m,j=Tt(n,S5),h=r.range(a,this.props);return _.createElement(Pr,Object.assign({},j,{range:h,eventOffset:15,localizer:i,min:l,max:d,scrollToTime:g,enableAutoScroll:b}))}}])}(_.Component);Gt.defaultProps=Pr.defaultProps;Gt.navigate=function(t,r,s){var n=s.localizer;switch(r){case lt.PREVIOUS:return n.add(t,-1,"week");case lt.NEXT:return n.add(t,1,"week");default:return t}};Gt.range=function(t,r){var s=r.localizer,n=s.startOfWeek(),a=s.startOf(t,"week",n),i=s.endOf(t,"week",n);return s.range(a,i)};Gt.title=function(t,r){var s=r.localizer,n=Gt.range(t,{localizer:s}),a=uc(n),i=a[0],o=a.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var k5=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function Ha(t,r){return Gt.range(t,r).filter(function(s){return[6,0].indexOf(s.getDay())===-1})}var xs=function(t){function r(){return Fe(this,r),Je(this,r,arguments)}return Xe(r,t),Ue(r,[{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,o=n.min,l=o===void 0?i.startOf(new Date,"day"):o,c=n.max,d=c===void 0?i.endOf(new Date,"day"):c,f=n.scrollToTime,g=f===void 0?i.startOf(new Date,"day"):f,m=n.enableAutoScroll,b=m===void 0?!0:m,j=Tt(n,k5),h=Ha(a,this.props);return _.createElement(Pr,Object.assign({},j,{range:h,eventOffset:15,localizer:i,min:l,max:d,scrollToTime:g,enableAutoScroll:b}))}}])}(_.Component);xs.defaultProps=Pr.defaultProps;xs.range=Ha;xs.navigate=Gt.navigate;xs.title=function(t,r){var s=r.localizer,n=Ha(t,{localizer:s}),a=uc(n),i=a[0],o=a.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var gn=30;function xn(t){var r=t.accessors,s=t.components,n=t.date,a=t.events,i=t.getters,o=t.length,l=o===void 0?gn:o,c=t.localizer,d=t.onDoubleClickEvent,f=t.onSelectEvent,g=t.selected,m=E.useRef(null),b=E.useRef(null),j=E.useRef(null),h=E.useRef(null),u=E.useRef(null);E.useEffect(function(){S()});var w=function(H,O,z){var R=s.event,K=s.date;return O=O.filter(function(Y){return ns(Y,c.startOf(H,"day"),c.endOf(H,"day"),r,c)}),O.map(function(Y,ee){var B=r.title(Y),V=r.end(Y),I=r.start(Y),W=i.eventProp(Y,I,V,mn(Y,g)),J=ee===0&&c.format(H,"agendaDateFormat"),L=ee===0?_.createElement("td",{rowSpan:O.length,className:"rbc-agenda-date-cell"},K?_.createElement(K,{day:H,label:J}):J):!1;return _.createElement("tr",{key:z+"_"+ee,className:W.className,style:W.style},L,_.createElement("td",{className:"rbc-agenda-time-cell"},x(H,Y)),_.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(he){return f&&f(Y,he)},onDoubleClick:function(he){return d&&d(Y,he)}},R?_.createElement(R,{event:Y,title:B}):B))},[])},x=function(H,O){var z="",R=s.time,K=c.messages.allDay,Y=r.end(O),ee=r.start(O);return r.allDay(O)||(c.eq(ee,Y)?K=c.format(ee,"agendaTimeFormat"):c.isSameDate(ee,Y)?K=c.format({start:ee,end:Y},"agendaTimeRangeFormat"):c.isSameDate(H,ee)?K=c.format(ee,"agendaTimeFormat"):c.isSameDate(H,Y)&&(K=c.format(Y,"agendaTimeFormat"))),c.gt(H,ee,"day")&&(z="rbc-continues-prior"),c.lt(H,Y,"day")&&(z+=" rbc-continues-after"),_.createElement("span",{className:z.trim()},R?_.createElement(R,{event:O,day:H,label:K}):K)},S=function(){if(u.current){var H=m.current,O=u.current.firstChild;if(O){var z=h.current.scrollHeight>h.current.clientHeight,R=[],K=R;R=[qn(O.children[0]),qn(O.children[1])],(K[0]!==R[0]||K[1]!==R[1])&&(b.current.style.width=R[0]+"px",j.current.style.width=R[1]+"px"),z?(Cf(H,"rbc-header-overflowing"),H.style.marginRight=ya()+"px"):$f(H,"rbc-header-overflowing")}}},v=c.messages,D=c.add(n,l,"day"),P=c.range(n,D,"day");return a=a.filter(function(A){return ns(A,c.startOf(n,"day"),c.endOf(D,"day"),r,c)}),a.sort(function(A,H){return+r.start(A)-+r.start(H)}),_.createElement("div",{className:"rbc-agenda-view"},a.length!==0?_.createElement(_.Fragment,null,_.createElement("table",{ref:m,className:"rbc-agenda-table"},_.createElement("thead",null,_.createElement("tr",null,_.createElement("th",{className:"rbc-header",ref:b},v.date),_.createElement("th",{className:"rbc-header",ref:j},v.time),_.createElement("th",{className:"rbc-header"},v.event)))),_.createElement("div",{className:"rbc-agenda-content",ref:h},_.createElement("table",{className:"rbc-agenda-table"},_.createElement("tbody",{ref:u},P.map(function(A,H){return w(A,a,H)}))))):_.createElement("span",{className:"rbc-agenda-empty"},v.noEventsInRange))}xn.range=function(t,r){var s=r.length,n=s===void 0?gn:s,a=r.localizer,i=a.add(t,n,"day");return{start:t,end:i}};xn.navigate=function(t,r,s){var n=s.length,a=n===void 0?gn:n,i=s.localizer;switch(r){case lt.PREVIOUS:return i.add(t,-a,"day");case lt.NEXT:return i.add(t,a,"day");default:return t}};xn.title=function(t,r){var s=r.length,n=s===void 0?gn:s,a=r.localizer,i=a.add(t,n,"day");return a.format({start:t,end:i},"agendaHeaderFormat")};var Os=Xt(Xt(Xt(Xt(Xt({},Ze.MONTH,hn),Ze.WEEK,Gt),Ze.WORK_WEEK,xs),Ze.DAY,fn),Ze.AGENDA,xn),C5=["action","date","today"];function $5(t,r){var s=r.action,n=r.date,a=r.today,i=Tt(r,C5);switch(t=typeof t=="string"?Os[t]:t,s){case lt.TODAY:n=a||new Date;break;case lt.DATE:break;default:qr(t&&typeof t.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),n=t.navigate(n,s,i)}return n}function E5(t,r){var s=null;return typeof r=="function"?s=r(t):typeof r=="string"&&Rt(t)==="object"&&t!=null&&r in t&&(s=t[r]),s}var _t=function(r){return function(s){return E5(s,r)}},D5=["view","date","getNow","onNavigate"],T5=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function Lc(t){if(Array.isArray(t))return t;for(var r=[],s=0,n=Object.entries(t);s<n.length;s++){var a=tr(n[s],2),i=a[0],o=a[1];o&&r.push(i)}return r}function O5(t,r){var s=r.views,n=Lc(s);return n.indexOf(t)!==-1}var Fc=function(t){function r(){var s;Fe(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=Je(this,r,[].concat(a)),s.getViews=function(){var o=s.props.views;return Array.isArray(o)?ok(o,function(l,c){return l[c]=Os[c]},{}):Rt(o)==="object"?oN(o,function(l,c){return l===!0?Os[c]:l}):Os},s.getView=function(){var o=s.getViews();return o[s.props.view]},s.getDrilldownView=function(o){var l=s.props,c=l.view,d=l.drilldownView,f=l.getDrilldownView;return f?f(o,c,Object.keys(s.getViews())):d},s.handleRangeChange=function(o,l,c){var d=s.props,f=d.onRangeChange,g=d.localizer;f&&l.range&&f(l.range(o,{localizer:g}),c)},s.handleNavigate=function(o,l){var c=s.props,d=c.view,f=c.date,g=c.getNow,m=c.onNavigate,b=Tt(c,D5),j=s.getView(),h=g();f=$5(j,Se(Se({},b),{},{action:o,date:l||f||h,today:h})),m(f,d,o),s.handleRangeChange(f,j)},s.handleViewChange=function(o){o!==s.props.view&&O5(o,s.props)&&s.props.onView(o);var l=s.getViews();s.handleRangeChange(s.props.date||s.props.getNow(),l[o],o)},s.handleSelectEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onSelectEvent,l)},s.handleDoubleClickEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onDoubleClickEvent,l)},s.handleKeyPressEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onKeyPressEvent,l)},s.handleSelectSlot=function(o){Te(s.props.onSelectSlot,o)},s.handleDrillDown=function(o,l){var c=s.props.onDrillDown;if(c){c(o,l,s.drilldownView);return}l&&s.handleViewChange(l),s.handleNavigate(lt.DATE,o)},s.state={context:r.getContext(s.props)},s}return Xe(r,t),Ue(r,[{key:"render",value:function(){var n=this.props,a=n.view,i=n.toolbar,o=n.events,l=n.backgroundEvents,c=n.resourceGroupingLayout,d=n.style,f=n.className,g=n.elementProps,m=n.date,b=n.getNow,j=n.length,h=n.showMultiDayTimes,u=n.onShowMore,w=n.doShowMoreDrillDown;n.components,n.formats,n.messages,n.culture;var x=Tt(n,T5);m=m||b();var S=this.getView(),v=this.state.context,D=v.accessors,P=v.components,A=v.getters,H=v.localizer,O=v.viewNames,z=P.toolbar||Pk,R=S.title(m,{localizer:H,length:j});return _.createElement("div",Object.assign({},g,{className:Pe(f,"rbc-calendar",x.rtl&&"rbc-rtl"),style:d}),i&&_.createElement(z,{date:m,view:a,views:O,label:R,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:H}),_.createElement(S,Object.assign({},x,{events:o,backgroundEvents:l,date:m,getNow:b,length:j,localizer:H,getters:A,components:P,accessors:D,showMultiDayTimes:h,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:u,doShowMoreDrillDown:w,resourceGroupingLayout:c})))}}],[{key:"getDerivedStateFromProps",value:function(n){return{context:r.getContext(n)}}},{key:"getContext",value:function(n){var a=n.startAccessor,i=n.endAccessor,o=n.allDayAccessor,l=n.tooltipAccessor,c=n.titleAccessor,d=n.resourceAccessor,f=n.resourceIdAccessor,g=n.resourceTitleAccessor,m=n.eventIdAccessor,b=n.eventPropGetter,j=n.backgroundEventPropGetter,h=n.slotPropGetter,u=n.slotGroupPropGetter,w=n.dayPropGetter,x=n.view,S=n.views,v=n.localizer,D=n.culture,P=n.messages,A=P===void 0?{}:P,H=n.components,O=H===void 0?{}:H,z=n.formats,R=z===void 0?{}:z,K=Lc(S),Y=Rk(A);return{viewNames:K,localizer:_k(v,D,R,Y),getters:{eventProp:function(){return b&&b.apply(void 0,arguments)||{}},backgroundEventProp:function(){return j&&j.apply(void 0,arguments)||{}},slotProp:function(){return h&&h.apply(void 0,arguments)||{}},slotGroupProp:function(){return u&&u.apply(void 0,arguments)||{}},dayProp:function(){return w&&w.apply(void 0,arguments)||{}}},components:eN(O[x]||{},VS(O,K),{eventWrapper:Nt,backgroundEventWrapper:Nt,eventContainerWrapper:Nt,dateCellWrapper:Nt,weekWrapper:Nt,timeSlotWrapper:Nt,timeGutterWrapper:Nt,timeIndicatorWrapper:Nt}),accessors:{start:_t(a),end:_t(i),allDay:_t(o),tooltip:_t(l),title:_t(c),resource:_t(d),resourceId:_t(f),resourceTitle:_t(g),eventId:_t(m)}}}}])}(_.Component);Fc.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:Ze.MONTH,views:[Ze.MONTH,Ze.WEEK,Ze.DAY,Ze.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:Ze.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var za=ml(Fc,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),M5=function(r,s,n){var a=r.start,i=r.end;return"".concat(n.format(a,"P",s)," – ").concat(n.format(i,"P",s))},Tn=function(r,s,n){var a=r.start,i=r.end;return"".concat(n.format(a,"p",s)," – ").concat(n.format(i,"p",s))},_5=function(r,s,n){var a=r.start;return"".concat(n.format(a,"h:mma",s)," – ")},P5=function(r,s,n){var a=r.end;return" – ".concat(n.format(a,"h:mma",s))},A5=function(r,s,n){var a=r.start,i=r.end;return"".concat(n.format(a,"MMMM dd",s)," – ").concat(n.format(i,Sr(a,i,"month")?"dd":"MMMM dd",s))},R5={dateFormat:"dd",dayFormat:"dd eee",weekdayFormat:"ccc",selectRangeFormat:Tn,eventTimeRangeFormat:Tn,eventTimeRangeStartFormat:_5,eventTimeRangeEndFormat:P5,timeGutterFormat:"p",monthHeaderFormat:"MMMM yyyy",dayHeaderFormat:"cccc MMM dd",dayRangeHeaderFormat:A5,agendaHeaderFormat:M5,agendaDateFormat:"ccc MMM dd",agendaTimeFormat:"p",agendaTimeRangeFormat:Tn},Ga=function(r){var s=r.startOfWeek,n=r.getDay,a=r.format,i=r.locales;return new Mk({formats:R5,firstOfWeek:function(l){return n(s(new Date,{locale:i[l]}))},format:function(l,c,d){return a(new Date(l),c,{locale:i[d]})}})};function ut(t){const r=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&r==="[object Date]"?new t.constructor(+t):typeof t=="number"||r==="[object Number]"||typeof t=="string"||r==="[object String]"?new Date(t):new Date(NaN)}function Lt(t,r){return t instanceof Date?new t.constructor(r):new Date(r)}function I5(t,r){const s=ut(t);return isNaN(r)?Lt(t,NaN):(s.setDate(s.getDate()+r),s)}const Uc=6048e5,L5=864e5;let F5={};function pn(){return F5}function Ot(t,r){var l,c,d,f;const s=pn(),n=(r==null?void 0:r.weekStartsOn)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??s.weekStartsOn??((f=(d=s.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??0,a=ut(t),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Hs(t){return Ot(t,{weekStartsOn:1})}function Wc(t){const r=ut(t),s=r.getFullYear(),n=Lt(t,0);n.setFullYear(s+1,0,4),n.setHours(0,0,0,0);const a=Hs(n),i=Lt(t,0);i.setFullYear(s,0,4),i.setHours(0,0,0,0);const o=Hs(i);return r.getTime()>=a.getTime()?s+1:r.getTime()>=o.getTime()?s:s-1}function zs(t){const r=ut(t);return r.setHours(0,0,0,0),r}function _o(t){const r=ut(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}function U5(t,r){const s=zs(t),n=zs(r),a=+s-_o(s),i=+n-_o(n);return Math.round((a-i)/L5)}function W5(t){const r=Wc(t),s=Lt(t,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),Hs(s)}function qa(t){return Lt(t,Date.now())}function Bc(t,r){const s=zs(t),n=zs(r);return+s==+n}function B5(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function H5(t){if(!B5(t)&&typeof t!="number")return!1;const r=ut(t);return!isNaN(Number(r))}function z5(t){const r=ut(t),s=Lt(t,0);return s.setFullYear(r.getFullYear(),0,1),s.setHours(0,0,0,0),s}const G5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},q5=(t,r,s)=>{let n;const a=G5[t];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+n:n+" ago":n};function fr(t){return(r={})=>{const s=r.width?String(r.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const Y5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},V5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},K5={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},J5={date:fr({formats:Y5,defaultWidth:"full"}),time:fr({formats:V5,defaultWidth:"full"}),dateTime:fr({formats:K5,defaultWidth:"full"})},X5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Q5=(t,r,s,n)=>X5[t];function St(t){return(r,s)=>{const n=s!=null&&s.context?String(s.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=s!=null&&s.width?String(s.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=s!=null&&s.width?String(s.width):t.defaultWidth;a=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(r):r;return a[i]}}const Z5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},eC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},tC={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},rC={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},sC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},nC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},aC=(t,r)=>{const s=Number(t),n=s%100;if(n>20||n<10)switch(n%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},iC={ordinalNumber:aC,era:St({values:Z5,defaultWidth:"wide"}),quarter:St({values:eC,defaultWidth:"wide",argumentCallback:t=>t-1}),month:St({values:tC,defaultWidth:"wide"}),day:St({values:rC,defaultWidth:"wide"}),dayPeriod:St({values:sC,defaultWidth:"wide",formattingValues:nC,defaultFormattingWidth:"wide"})};function kt(t){return(r,s={})=>{const n=s.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=r.match(a);if(!i)return null;const o=i[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?lC(l,g=>g.test(o)):oC(l,g=>g.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=s.valueCallback?s.valueCallback(d):d;const f=r.slice(o.length);return{value:d,rest:f}}}function oC(t,r){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&r(t[s]))return s}function lC(t,r){for(let s=0;s<t.length;s++)if(r(t[s]))return s}function Hc(t){return(r,s={})=>{const n=r.match(t.matchPattern);if(!n)return null;const a=n[0],i=r.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=s.valueCallback?s.valueCallback(o):o;const l=r.slice(a.length);return{value:o,rest:l}}}const cC=/^(\d+)(th|st|nd|rd)?/i,dC=/\d+/i,uC={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},mC={any:[/^b/i,/^(a|c)/i]},hC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},fC={any:[/1/i,/2/i,/3/i,/4/i]},gC={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},xC={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},pC={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},vC={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},bC={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},yC={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},jC={ordinalNumber:Hc({matchPattern:cC,parsePattern:dC,valueCallback:t=>parseInt(t,10)}),era:kt({matchPatterns:uC,defaultMatchWidth:"wide",parsePatterns:mC,defaultParseWidth:"any"}),quarter:kt({matchPatterns:hC,defaultMatchWidth:"wide",parsePatterns:fC,defaultParseWidth:"any",valueCallback:t=>t+1}),month:kt({matchPatterns:gC,defaultMatchWidth:"wide",parsePatterns:xC,defaultParseWidth:"any"}),day:kt({matchPatterns:pC,defaultMatchWidth:"wide",parsePatterns:vC,defaultParseWidth:"any"}),dayPeriod:kt({matchPatterns:bC,defaultMatchWidth:"any",parsePatterns:yC,defaultParseWidth:"any"})},wC={code:"en-US",formatDistance:q5,formatLong:J5,formatRelative:Q5,localize:iC,match:jC,options:{weekStartsOn:0,firstWeekContainsDate:1}};function NC(t){const r=ut(t);return U5(r,z5(r))+1}function SC(t){const r=ut(t),s=+Hs(r)-+W5(r);return Math.round(s/Uc)+1}function zc(t,r){var f,g,m,b;const s=ut(t),n=s.getFullYear(),a=pn(),i=(r==null?void 0:r.firstWeekContainsDate)??((g=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((b=(m=a.locale)==null?void 0:m.options)==null?void 0:b.firstWeekContainsDate)??1,o=Lt(t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=Ot(o,r),c=Lt(t,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const d=Ot(c,r);return s.getTime()>=l.getTime()?n+1:s.getTime()>=d.getTime()?n:n-1}function kC(t,r){var l,c,d,f;const s=pn(),n=(r==null?void 0:r.firstWeekContainsDate)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??s.firstWeekContainsDate??((f=(d=s.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,a=zc(t,r),i=Lt(t,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),Ot(i,r)}function CC(t,r){const s=ut(t),n=+Ot(s,r)-+kC(s,r);return Math.round(n/Uc)+1}function we(t,r){const s=t<0?"-":"",n=Math.abs(t).toString().padStart(r,"0");return s+n}const Ut={y(t,r){const s=t.getFullYear(),n=s>0?s:1-s;return we(r==="yy"?n%100:n,r.length)},M(t,r){const s=t.getMonth();return r==="M"?String(s+1):we(s+1,2)},d(t,r){return we(t.getDate(),r.length)},a(t,r){const s=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h(t,r){return we(t.getHours()%12||12,r.length)},H(t,r){return we(t.getHours(),r.length)},m(t,r){return we(t.getMinutes(),r.length)},s(t,r){return we(t.getSeconds(),r.length)},S(t,r){const s=r.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,s-3));return we(a,r.length)}},ur={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Po={G:function(t,r,s){const n=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return s.era(n,{width:"abbreviated"});case"GGGGG":return s.era(n,{width:"narrow"});case"GGGG":default:return s.era(n,{width:"wide"})}},y:function(t,r,s){if(r==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return s.ordinalNumber(a,{unit:"year"})}return Ut.y(t,r)},Y:function(t,r,s,n){const a=zc(t,n),i=a>0?a:1-a;if(r==="YY"){const o=i%100;return we(o,2)}return r==="Yo"?s.ordinalNumber(i,{unit:"year"}):we(i,r.length)},R:function(t,r){const s=Wc(t);return we(s,r.length)},u:function(t,r){const s=t.getFullYear();return we(s,r.length)},Q:function(t,r,s){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return we(n,2);case"Qo":return s.ordinalNumber(n,{unit:"quarter"});case"QQQ":return s.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,r,s){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return we(n,2);case"qo":return s.ordinalNumber(n,{unit:"quarter"});case"qqq":return s.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,r,s){const n=t.getMonth();switch(r){case"M":case"MM":return Ut.M(t,r);case"Mo":return s.ordinalNumber(n+1,{unit:"month"});case"MMM":return s.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(n,{width:"wide",context:"formatting"})}},L:function(t,r,s){const n=t.getMonth();switch(r){case"L":return String(n+1);case"LL":return we(n+1,2);case"Lo":return s.ordinalNumber(n+1,{unit:"month"});case"LLL":return s.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(n,{width:"wide",context:"standalone"})}},w:function(t,r,s,n){const a=CC(t,n);return r==="wo"?s.ordinalNumber(a,{unit:"week"}):we(a,r.length)},I:function(t,r,s){const n=SC(t);return r==="Io"?s.ordinalNumber(n,{unit:"week"}):we(n,r.length)},d:function(t,r,s){return r==="do"?s.ordinalNumber(t.getDate(),{unit:"date"}):Ut.d(t,r)},D:function(t,r,s){const n=NC(t);return r==="Do"?s.ordinalNumber(n,{unit:"dayOfYear"}):we(n,r.length)},E:function(t,r,s){const n=t.getDay();switch(r){case"E":case"EE":case"EEE":return s.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(n,{width:"short",context:"formatting"});case"EEEE":default:return s.day(n,{width:"wide",context:"formatting"})}},e:function(t,r,s,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return we(i,2);case"eo":return s.ordinalNumber(i,{unit:"day"});case"eee":return s.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(a,{width:"short",context:"formatting"});case"eeee":default:return s.day(a,{width:"wide",context:"formatting"})}},c:function(t,r,s,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return we(i,r.length);case"co":return s.ordinalNumber(i,{unit:"day"});case"ccc":return s.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(a,{width:"narrow",context:"standalone"});case"cccccc":return s.day(a,{width:"short",context:"standalone"});case"cccc":default:return s.day(a,{width:"wide",context:"standalone"})}},i:function(t,r,s){const n=t.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return we(a,r.length);case"io":return s.ordinalNumber(a,{unit:"day"});case"iii":return s.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(n,{width:"short",context:"formatting"});case"iiii":default:return s.day(n,{width:"wide",context:"formatting"})}},a:function(t,r,s){const a=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,r,s){const n=t.getHours();let a;switch(n===12?a=ur.noon:n===0?a=ur.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,r,s){const n=t.getHours();let a;switch(n>=17?a=ur.evening:n>=12?a=ur.afternoon:n>=4?a=ur.morning:a=ur.night,r){case"B":case"BB":case"BBB":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,r,s){if(r==="ho"){let n=t.getHours()%12;return n===0&&(n=12),s.ordinalNumber(n,{unit:"hour"})}return Ut.h(t,r)},H:function(t,r,s){return r==="Ho"?s.ordinalNumber(t.getHours(),{unit:"hour"}):Ut.H(t,r)},K:function(t,r,s){const n=t.getHours()%12;return r==="Ko"?s.ordinalNumber(n,{unit:"hour"}):we(n,r.length)},k:function(t,r,s){let n=t.getHours();return n===0&&(n=24),r==="ko"?s.ordinalNumber(n,{unit:"hour"}):we(n,r.length)},m:function(t,r,s){return r==="mo"?s.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ut.m(t,r)},s:function(t,r,s){return r==="so"?s.ordinalNumber(t.getSeconds(),{unit:"second"}):Ut.s(t,r)},S:function(t,r){return Ut.S(t,r)},X:function(t,r,s){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return Ro(n);case"XXXX":case"XX":return Jt(n);case"XXXXX":case"XXX":default:return Jt(n,":")}},x:function(t,r,s){const n=t.getTimezoneOffset();switch(r){case"x":return Ro(n);case"xxxx":case"xx":return Jt(n);case"xxxxx":case"xxx":default:return Jt(n,":")}},O:function(t,r,s){const n=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+Ao(n,":");case"OOOO":default:return"GMT"+Jt(n,":")}},z:function(t,r,s){const n=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+Ao(n,":");case"zzzz":default:return"GMT"+Jt(n,":")}},t:function(t,r,s){const n=Math.trunc(t.getTime()/1e3);return we(n,r.length)},T:function(t,r,s){const n=t.getTime();return we(n,r.length)}};function Ao(t,r=""){const s=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),i=n%60;return i===0?s+String(a):s+String(a)+r+we(i,2)}function Ro(t,r){return t%60===0?(t>0?"-":"+")+we(Math.abs(t)/60,2):Jt(t,r)}function Jt(t,r=""){const s=t>0?"-":"+",n=Math.abs(t),a=we(Math.trunc(n/60),2),i=we(n%60,2);return s+a+r+i}const Io=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},Gc=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},$C=(t,r)=>{const s=t.match(/(P+)(p+)?/)||[],n=s[1],a=s[2];if(!a)return Io(t,r);let i;switch(n){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",Io(n,r)).replace("{{time}}",Gc(a,r))},EC={p:Gc,P:$C},DC=/^D+$/,TC=/^Y+$/,OC=["D","DD","YY","YYYY"];function MC(t){return DC.test(t)}function _C(t){return TC.test(t)}function PC(t,r,s){const n=AC(t,r,s);if(console.warn(n),OC.includes(t))throw new RangeError(n)}function AC(t,r,s){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${n} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const RC=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,IC=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,LC=/^'([^]*?)'?$/,FC=/''/g,UC=/[a-zA-Z]/;function We(t,r,s){var f,g,m,b,j,h,u,w;const n=pn(),a=(s==null?void 0:s.locale)??n.locale??wC,i=(s==null?void 0:s.firstWeekContainsDate)??((g=(f=s==null?void 0:s.locale)==null?void 0:f.options)==null?void 0:g.firstWeekContainsDate)??n.firstWeekContainsDate??((b=(m=n.locale)==null?void 0:m.options)==null?void 0:b.firstWeekContainsDate)??1,o=(s==null?void 0:s.weekStartsOn)??((h=(j=s==null?void 0:s.locale)==null?void 0:j.options)==null?void 0:h.weekStartsOn)??n.weekStartsOn??((w=(u=n.locale)==null?void 0:u.options)==null?void 0:w.weekStartsOn)??0,l=ut(t);if(!H5(l))throw new RangeError("Invalid time value");let c=r.match(IC).map(x=>{const S=x[0];if(S==="p"||S==="P"){const v=EC[S];return v(x,a.formatLong)}return x}).join("").match(RC).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const S=x[0];if(S==="'")return{isToken:!1,value:WC(x)};if(Po[S])return{isToken:!0,value:x};if(S.match(UC))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");return{isToken:!1,value:x}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return c.map(x=>{if(!x.isToken)return x.value;const S=x.value;(!(s!=null&&s.useAdditionalWeekYearTokens)&&_C(S)||!(s!=null&&s.useAdditionalDayOfYearTokens)&&MC(S))&&PC(S,r,String(t));const v=Po[S[0]];return v(l,S,a.localize,d)}).join("")}function WC(t){const r=t.match(LC);return r?r[1].replace(FC,"'"):t}function Ya(t){return ut(t).getDay()}function Xn(t,r,s){const n=Ot(t,s),a=Ot(r,s);return+n==+a}function BC(t,r){return Xn(t,qa(t),r)}function Lo(t){return Bc(t,qa(t))}function HC(t,r){return I5(t,-1)}function Fo(t){return Bc(t,HC(qa(t)))}function Lr(t,r){if(t.one!==void 0&&r===1)return t.one;const s=r%10,n=r%100;return s===1&&n!==11?t.singularNominative.replace("{{count}}",String(r)):s>=2&&s<=4&&(n<10||n>20)?t.singularGenitive.replace("{{count}}",String(r)):t.pluralGenitive.replace("{{count}}",String(r))}function Qe(t){return(r,s)=>s!=null&&s.addSuffix?s.comparison&&s.comparison>0?t.future?Lr(t.future,r):"через "+Lr(t.regular,r):t.past?Lr(t.past,r):Lr(t.regular,r)+" назад":Lr(t.regular,r)}const zC={lessThanXSeconds:Qe({regular:{one:"меньше секунды",singularNominative:"меньше {{count}} секунды",singularGenitive:"меньше {{count}} секунд",pluralGenitive:"меньше {{count}} секунд"},future:{one:"меньше, чем через секунду",singularNominative:"меньше, чем через {{count}} секунду",singularGenitive:"меньше, чем через {{count}} секунды",pluralGenitive:"меньше, чем через {{count}} секунд"}}),xSeconds:Qe({regular:{singularNominative:"{{count}} секунда",singularGenitive:"{{count}} секунды",pluralGenitive:"{{count}} секунд"},past:{singularNominative:"{{count}} секунду назад",singularGenitive:"{{count}} секунды назад",pluralGenitive:"{{count}} секунд назад"},future:{singularNominative:"через {{count}} секунду",singularGenitive:"через {{count}} секунды",pluralGenitive:"через {{count}} секунд"}}),halfAMinute:(t,r)=>r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"через полминуты":"полминуты назад":"полминуты",lessThanXMinutes:Qe({regular:{one:"меньше минуты",singularNominative:"меньше {{count}} минуты",singularGenitive:"меньше {{count}} минут",pluralGenitive:"меньше {{count}} минут"},future:{one:"меньше, чем через минуту",singularNominative:"меньше, чем через {{count}} минуту",singularGenitive:"меньше, чем через {{count}} минуты",pluralGenitive:"меньше, чем через {{count}} минут"}}),xMinutes:Qe({regular:{singularNominative:"{{count}} минута",singularGenitive:"{{count}} минуты",pluralGenitive:"{{count}} минут"},past:{singularNominative:"{{count}} минуту назад",singularGenitive:"{{count}} минуты назад",pluralGenitive:"{{count}} минут назад"},future:{singularNominative:"через {{count}} минуту",singularGenitive:"через {{count}} минуты",pluralGenitive:"через {{count}} минут"}}),aboutXHours:Qe({regular:{singularNominative:"около {{count}} часа",singularGenitive:"около {{count}} часов",pluralGenitive:"около {{count}} часов"},future:{singularNominative:"приблизительно через {{count}} час",singularGenitive:"приблизительно через {{count}} часа",pluralGenitive:"приблизительно через {{count}} часов"}}),xHours:Qe({regular:{singularNominative:"{{count}} час",singularGenitive:"{{count}} часа",pluralGenitive:"{{count}} часов"}}),xDays:Qe({regular:{singularNominative:"{{count}} день",singularGenitive:"{{count}} дня",pluralGenitive:"{{count}} дней"}}),aboutXWeeks:Qe({regular:{singularNominative:"около {{count}} недели",singularGenitive:"около {{count}} недель",pluralGenitive:"около {{count}} недель"},future:{singularNominative:"приблизительно через {{count}} неделю",singularGenitive:"приблизительно через {{count}} недели",pluralGenitive:"приблизительно через {{count}} недель"}}),xWeeks:Qe({regular:{singularNominative:"{{count}} неделя",singularGenitive:"{{count}} недели",pluralGenitive:"{{count}} недель"}}),aboutXMonths:Qe({regular:{singularNominative:"около {{count}} месяца",singularGenitive:"около {{count}} месяцев",pluralGenitive:"около {{count}} месяцев"},future:{singularNominative:"приблизительно через {{count}} месяц",singularGenitive:"приблизительно через {{count}} месяца",pluralGenitive:"приблизительно через {{count}} месяцев"}}),xMonths:Qe({regular:{singularNominative:"{{count}} месяц",singularGenitive:"{{count}} месяца",pluralGenitive:"{{count}} месяцев"}}),aboutXYears:Qe({regular:{singularNominative:"около {{count}} года",singularGenitive:"около {{count}} лет",pluralGenitive:"около {{count}} лет"},future:{singularNominative:"приблизительно через {{count}} год",singularGenitive:"приблизительно через {{count}} года",pluralGenitive:"приблизительно через {{count}} лет"}}),xYears:Qe({regular:{singularNominative:"{{count}} год",singularGenitive:"{{count}} года",pluralGenitive:"{{count}} лет"}}),overXYears:Qe({regular:{singularNominative:"больше {{count}} года",singularGenitive:"больше {{count}} лет",pluralGenitive:"больше {{count}} лет"},future:{singularNominative:"больше, чем через {{count}} год",singularGenitive:"больше, чем через {{count}} года",pluralGenitive:"больше, чем через {{count}} лет"}}),almostXYears:Qe({regular:{singularNominative:"почти {{count}} год",singularGenitive:"почти {{count}} года",pluralGenitive:"почти {{count}} лет"},future:{singularNominative:"почти через {{count}} год",singularGenitive:"почти через {{count}} года",pluralGenitive:"почти через {{count}} лет"}})},GC=(t,r,s)=>zC[t](r,s),qC={full:"EEEE, d MMMM y 'г.'",long:"d MMMM y 'г.'",medium:"d MMM y 'г.'",short:"dd.MM.y"},YC={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},VC={any:"{{date}}, {{time}}"},KC={date:fr({formats:qC,defaultWidth:"full"}),time:fr({formats:YC,defaultWidth:"full"}),dateTime:fr({formats:VC,defaultWidth:"any"})},Va=["воскресенье","понедельник","вторник","среду","четверг","пятницу","субботу"];function JC(t){const r=Va[t];switch(t){case 0:return"'в прошлое "+r+" в' p";case 1:case 2:case 4:return"'в прошлый "+r+" в' p";case 3:case 5:case 6:return"'в прошлую "+r+" в' p"}}function Uo(t){const r=Va[t];return t===2?"'во "+r+" в' p":"'в "+r+" в' p"}function XC(t){const r=Va[t];switch(t){case 0:return"'в следующее "+r+" в' p";case 1:case 2:case 4:return"'в следующий "+r+" в' p";case 3:case 5:case 6:return"'в следующую "+r+" в' p"}}const QC={lastWeek:(t,r,s)=>{const n=t.getDay();return Xn(t,r,s)?Uo(n):JC(n)},yesterday:"'вчера в' p",today:"'сегодня в' p",tomorrow:"'завтра в' p",nextWeek:(t,r,s)=>{const n=t.getDay();return Xn(t,r,s)?Uo(n):XC(n)},other:"P"},ZC=(t,r,s,n)=>{const a=QC[t];return typeof a=="function"?a(r,s,n):a},e4={narrow:["до н.э.","н.э."],abbreviated:["до н. э.","н. э."],wide:["до нашей эры","нашей эры"]},t4={narrow:["1","2","3","4"],abbreviated:["1-й кв.","2-й кв.","3-й кв.","4-й кв."],wide:["1-й квартал","2-й квартал","3-й квартал","4-й квартал"]},r4={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],wide:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"]},s4={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],wide:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"]},n4={narrow:["В","П","В","С","Ч","П","С"],short:["вс","пн","вт","ср","чт","пт","сб"],abbreviated:["вск","пнд","втр","срд","чтв","птн","суб"],wide:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"]},a4={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утро",afternoon:"день",evening:"вечер",night:"ночь"}},i4={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утра",afternoon:"дня",evening:"вечера",night:"ночи"}},o4=(t,r)=>{const s=Number(t),n=r==null?void 0:r.unit;let a;return n==="date"?a="-е":n==="week"||n==="minute"||n==="second"?a="-я":a="-й",s+a},l4={ordinalNumber:o4,era:St({values:e4,defaultWidth:"wide"}),quarter:St({values:t4,defaultWidth:"wide",argumentCallback:t=>t-1}),month:St({values:r4,defaultWidth:"wide",formattingValues:s4,defaultFormattingWidth:"wide"}),day:St({values:n4,defaultWidth:"wide"}),dayPeriod:St({values:a4,defaultWidth:"any",formattingValues:i4,defaultFormattingWidth:"wide"})},c4=/^(\d+)(-?(е|я|й|ое|ье|ая|ья|ый|ой|ий|ый))?/i,d4=/\d+/i,u4={narrow:/^((до )?н\.?\s?э\.?)/i,abbreviated:/^((до )?н\.?\s?э\.?)/i,wide:/^(до нашей эры|нашей эры|наша эра)/i},m4={any:[/^д/i,/^н/i]},h4={narrow:/^[1234]/i,abbreviated:/^[1234](-?[ыои]?й?)? кв.?/i,wide:/^[1234](-?[ыои]?й?)? квартал/i},f4={any:[/1/i,/2/i,/3/i,/4/i]},g4={narrow:/^[яфмаисонд]/i,abbreviated:/^(янв|фев|март?|апр|ма[йя]|июн[ья]?|июл[ья]?|авг|сент?|окт|нояб?|дек)\.?/i,wide:/^(январ[ья]|феврал[ья]|марта?|апрел[ья]|ма[йя]|июн[ья]|июл[ья]|августа?|сентябр[ья]|октябр[ья]|октябр[ья]|ноябр[ья]|декабр[ья])/i},x4={narrow:[/^я/i,/^ф/i,/^м/i,/^а/i,/^м/i,/^и/i,/^и/i,/^а/i,/^с/i,/^о/i,/^н/i,/^я/i],any:[/^я/i,/^ф/i,/^мар/i,/^ап/i,/^ма[йя]/i,/^июн/i,/^июл/i,/^ав/i,/^с/i,/^о/i,/^н/i,/^д/i]},p4={narrow:/^[впсч]/i,short:/^(вс|во|пн|по|вт|ср|чт|че|пт|пя|сб|су)\.?/i,abbreviated:/^(вск|вос|пнд|пон|втр|вто|срд|сре|чтв|чет|птн|пят|суб).?/i,wide:/^(воскресень[ея]|понедельника?|вторника?|сред[аы]|четверга?|пятниц[аы]|суббот[аы])/i},v4={narrow:[/^в/i,/^п/i,/^в/i,/^с/i,/^ч/i,/^п/i,/^с/i],any:[/^в[ос]/i,/^п[он]/i,/^в/i,/^ср/i,/^ч/i,/^п[ят]/i,/^с[уб]/i]},b4={narrow:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,abbreviated:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,wide:/^([дп]п|полночь|полдень|утр[оа]|день|дня|вечера?|ноч[ьи])/i},y4={any:{am:/^дп/i,pm:/^пп/i,midnight:/^полн/i,noon:/^полд/i,morning:/^у/i,afternoon:/^д[ен]/i,evening:/^в/i,night:/^н/i}},j4={ordinalNumber:Hc({matchPattern:c4,parsePattern:d4,valueCallback:t=>parseInt(t,10)}),era:kt({matchPatterns:u4,defaultMatchWidth:"wide",parsePatterns:m4,defaultParseWidth:"any"}),quarter:kt({matchPatterns:h4,defaultMatchWidth:"wide",parsePatterns:f4,defaultParseWidth:"any",valueCallback:t=>t+1}),month:kt({matchPatterns:g4,defaultMatchWidth:"wide",parsePatterns:x4,defaultParseWidth:"any"}),day:kt({matchPatterns:p4,defaultMatchWidth:"wide",parsePatterns:v4,defaultParseWidth:"any"}),dayPeriod:kt({matchPatterns:b4,defaultMatchWidth:"wide",parsePatterns:y4,defaultParseWidth:"any"})},ft={code:"ru",formatDistance:GC,formatLong:KC,formatRelative:ZC,localize:l4,match:j4,options:{weekStartsOn:1,firstWeekContainsDate:1}},Ka=({isOpen:t,onClose:r,onConfirm:s,slot:n,teacher:a,student:i})=>{var j;const[o,l]=E.useState(""),[c,d]=E.useState(!1),f=async()=>{d(!0);try{await s(o),r()}catch{}finally{d(!1)}},g=h=>{switch(h){case"online":return e.jsx(Be,{className:"h-4 w-4"});case"offline":return e.jsx(Ct,{className:"h-4 w-4"});case"mini-group":return e.jsx(sa,{className:"h-4 w-4"});default:return e.jsx(Be,{className:"h-4 w-4"})}},m=h=>{switch(h){case"online":return"Онлайн";case"offline":return"Очно";case"mini-group":return"Мини-группа";default:return h}},b=h=>{switch(h){case"regular":return"Обычный урок";case"consultation":return"Консультация";case"exam_prep":return"Подготовка к экзамену";case"homework_help":return"Помощь с домашним заданием";default:return h}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Подтверждение бронирования"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(et,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Преподаватель"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[a!=null&&a.avatar?e.jsx("img",{src:a.avatar,alt:a.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ye,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:(a==null?void 0:a.name)||"Преподаватель"}),e.jsx("p",{className:"text-sm text-gray-600",children:n==null?void 0:n.subject}),((j=a==null?void 0:a.profile)==null?void 0:j.rating)&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-yellow-500",children:"★"}),e.jsx("span",{className:"text-sm text-gray-600 ml-1",children:a.profile.rating})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Детали урока"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Ke,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Дата: ",new Date(n==null?void 0:n.date).toLocaleDateString("ru-RU")]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Ht,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Время: ",n==null?void 0:n.startTime," - ",n==null?void 0:n.endTime]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Be,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Предмет: ",n==null?void 0:n.subject]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[g(n==null?void 0:n.format),e.jsxs("span",{className:"text-sm",children:["Формат: ",m(n==null?void 0:n.format)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Ed,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Тип: ",b(n==null?void 0:n.lessonType)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Ko,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Стоимость: ",n==null?void 0:n.price," ₽"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Студент"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[i!=null&&i.avatar?e.jsx("img",{src:i.avatar,alt:i.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(ye,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:i==null?void 0:i.name}),e.jsx("p",{className:"text-sm text-gray-600",children:"Студент"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Примечание к уроку"}),e.jsx("textarea",{value:o,onChange:h=>l(h.target.value),placeholder:"Опишите ваши цели, задачи или особые пожелания к уроку...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:4}),e.jsx("p",{className:"text-sm text-gray-500",children:"Это поможет преподавателю лучше подготовиться к уроку"})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Отмена"}),e.jsx("button",{onClick:f,disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Бронирование..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать урок"})]})})]})]})}):null},qc=({teacher:t,onClose:r,onBookLesson:s,onMessage:n})=>{var Ee;const{user:a}=tt(),{timeSlots:i,bookLesson:o,posts:l,createPost:c,addReaction:d,addComment:f,sharePost:g,bookmarkPost:m,editPost:b,deletePost:j}=ct(),[h,u]=E.useState(!1),[w,x]=E.useState(!1),[S,v]=E.useState(!1),[D,P]=E.useState(!1),[A,H]=E.useState(!1),[O,z]=E.useState(null),[R,K]=E.useState("about"),[Y,ee]=E.useState(null),[B,V]=E.useState({}),I=i.filter(te=>te.teacherId===t.id),W=I.filter(te=>!te.isBooked),J=I.filter(te=>te.isBooked),L=t.profile,fe=l.filter(te=>te.userId===t.id),he=te=>{switch(te){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return te}},xe=te=>{switch(te){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}},ve=te=>{switch(te){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return te}},$e=te=>{z(te),H(!0)},X=async te=>{a&&O&&(o(O.id,a.id,a.name,te),H(!1),z(null))},be=(te,Ne)=>new Date(`${te}T${Ne}`).toLocaleDateString("ru-RU",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Zn,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>x(!w),className:`p-2 rounded-full transition-colors ${w?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(qs,{className:`w-5 h-5 ${w?"fill-current":""}`})}),e.jsx("button",{onClick:()=>u(!h),className:`p-2 rounded-full transition-colors ${h?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(xt,{className:`w-5 h-5 ${h?"fill-current":""}`})}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Bt,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsxs("div",{className:"h-56 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"}),e.jsx("div",{className:"absolute bottom-6 left-8 right-8",children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"text-white flex-1 mr-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 leading-tight",children:(L==null?void 0:L.name)||t.name||"Репетитор"}),e.jsxs("div",{className:"flex items-center space-x-4 flex-wrap",children:[(L==null?void 0:L.experience)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Wt,{className:"h-4 w-4 text-yellow-300"}),e.jsx("span",{className:"font-semibold text-xs",children:he(L.experience)})]}),(L==null?void 0:L.rating)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx($t,{className:"h-4 w-4 text-yellow-300 fill-current"}),e.jsx("span",{className:"font-semibold text-xs",children:L.rating})]}),(L==null?void 0:L.city)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-xs",children:L.city})]})]})]}),e.jsxs("div",{className:"text-right text-white/90 flex-shrink-0",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:(L==null?void 0:L.lessonsCount)||0}),e.jsx("div",{className:"text-sm opacity-80",children:"уроков"})]})]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start mt-8",children:[e.jsxs("div",{className:"flex-shrink-0 -mt-12 ml-8 relative",children:[e.jsxs("div",{className:"w-36 h-36 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-6 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-3 border-white rounded-full shadow-lg"}),L!=null&&L.avatar&&L.avatar.trim()!==""&&L.avatar!=="undefined"&&L.avatar!=="null"?e.jsx("img",{src:L.avatar,alt:(L==null?void 0:L.name)||t.name||"Репетитор",className:"w-36 h-36 object-cover rounded-full",onError:te=>{const Ne=te.target;Ne.style.display="none";const ke=Ne.nextElementSibling;ke&&ke.classList.remove("hidden")},onLoad:te=>{const ke=te.target.nextElementSibling;ke&&ke.classList.add("hidden")}}):null,e.jsx("div",{className:`w-36 h-36 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${L!=null&&L.avatar&&L.avatar.trim()!==""&&L.avatar!=="undefined"&&L.avatar!=="null"?"hidden":""}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(ye,{className:"h-16 w-16 text-white mb-2"}),e.jsx("div",{className:"text-white text-sm font-semibold",children:((L==null?void 0:L.name)||t.name||"Репетитор").charAt(0).toUpperCase()})]})})]}),e.jsxs("div",{className:"absolute -bottom-2 -right-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>u(!h),className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${h?"bg-red-500 text-white scale-110":"bg-white text-gray-600 hover:bg-red-50 hover:text-red-500"}`,children:e.jsx(xt,{className:`w-5 h-5 ${h?"fill-current":""}`})}),e.jsx("button",{className:"w-10 h-10 rounded-full bg-white text-gray-600 hover:bg-gray-50 shadow-lg transition-all duration-200 flex items-center justify-center",children:e.jsx(Bt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-wrap gap-4 mt-12 lg:mt-0",children:[e.jsxs("button",{onClick:()=>s(t.id),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Be,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Записаться на урок"})]}),n&&e.jsxs("button",{onClick:()=>n(t.id),className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-2xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ae,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Написать сообщение"})]}),e.jsxs("button",{onClick:()=>P(!D),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(Ke,{className:"h-6 w-6"}),e.jsxs("span",{className:"text-lg",children:["Слоты (",W.length,")"]})]}),e.jsxs("button",{onClick:()=>v(!S),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(gr,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Контактная информация"})]})]})]})]}),S&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 mb-8 mt-8 border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-lg",children:"Контактная информация"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.phone&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(xr,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:t.phone})]}),t.email&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(ta,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:t.email})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6 mt-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(L==null?void 0:L.lessonsCount)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Проведено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:((Ee=L==null?void 0:L.students)==null?void 0:Ee.length)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Учеников"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(L==null?void 0:L.rating)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Рейтинг"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:W.length}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Свободных слотов"})]})]}),fe.length>0&&e.jsxs("div",{className:"mb-8 mt-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx(er,{className:"w-5 h-5 mr-2 text-blue-600"}),"Записи ",(L==null?void 0:L.name)||t.name,e.jsx("span",{className:"ml-2 bg-blue-100 text-blue-800 py-0.5 px-2 rounded-full text-sm",children:fe.length})]})}),e.jsxs("div",{className:"space-y-4",children:[fe.slice(0,3).map(te=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:((L==null?void 0:L.name)||t.name).charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:(L==null?void 0:L.name)||t.name}),e.jsx("span",{className:"text-gray-500 text-sm",children:new Date(te.date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})})]}),e.jsx("div",{className:"text-gray-700 mb-3 whitespace-pre-line",children:te.text.length>200?`${te.text.substring(0,200)}...`:te.text}),te.tags&&te.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[te.tags.slice(0,3).map((Ne,ke)=>e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-1 rounded-md text-xs font-medium",children:["#",Ne]},ke)),te.tags.length>3&&e.jsxs("span",{className:"text-gray-500 text-xs",children:["+",te.tags.length-3," еще"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(xt,{className:"w-4 h-4"}),e.jsx("span",{children:te.likes||te.reactions.length})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{children:te.comments.length})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(gr,{className:"w-4 h-4"}),e.jsx("span",{children:te.views||0})]})]})]})]})},te.id)),fe.length>3&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"text-blue-600 hover:text-blue-800 font-medium",children:["Показать все записи (",fe.length,")"]})})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8 mt-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"about",label:"О преподавателе",count:null},{id:"slots",label:"Расписание",count:W.length},{id:"reviews",label:"Отзывы",count:0}].map(te=>e.jsxs("button",{onClick:()=>K(te.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${R===te.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[te.label,te.count!==null&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2 rounded-full text-xs",children:te.count})]},te.id))})}),e.jsxs("div",{className:"min-h-[400px]",children:[R==="about"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Основная информация"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ye,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Имя"}),e.jsx("div",{className:"font-semibold text-gray-900",children:(L==null?void 0:L.name)||t.name||"Репетитор"})]})]}),(L==null?void 0:L.experience)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Wt,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Опыт"}),e.jsx("div",{className:"font-semibold text-gray-900",children:he(L.experience)})]})]}),(L==null?void 0:L.experienceYears)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(sl,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Лет преподавания"}),e.jsx("div",{className:"font-semibold text-gray-900",children:L.experienceYears})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Cs,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Тип преподавателя"}),e.jsx("div",{className:"font-semibold text-gray-900",children:xe((L==null?void 0:L.teacherType)||"private")})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[(L==null?void 0:L.rating)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx($t,{className:"w-5 h-5 text-yellow-500 fill-current"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Рейтинг"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[L.rating,"/5"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Be,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Проведено уроков"}),e.jsx("div",{className:"font-semibold text-gray-900",children:(L==null?void 0:L.lessonsCount)||0})]})]}),(L==null?void 0:L.hourlyRate)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-green-600 font-bold text-lg",children:"₽"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Стоимость урока"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[L.hourlyRate," ₽/час"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(L==null?void 0:L.subjects)&&L.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-green-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-green-500 to-emerald-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Предметы"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:L.subjects.map((te,Ne)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-green-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-green-200/50 shadow-sm",children:te},Ne))})]}),(L==null?void 0:L.grades)&&L.grades.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-purple-500 to-pink-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Классы"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:L.grades.map((te,Ne)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-purple-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-purple-200/50 shadow-sm",children:te},Ne))})]})]}),(L==null?void 0:L.education)&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-orange-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-orange-500 to-red-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Образование"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[L.education.university&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"🎓"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Университет"}),e.jsx("div",{className:"font-semibold text-gray-900",children:L.education.university})]})]}),L.education.degree&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"📜"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Степень"}),e.jsx("div",{className:"font-semibold text-gray-900",children:L.education.degree})]})]}),L.education.graduationYear&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"📅"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Год выпуска"}),e.jsx("div",{className:"font-semibold text-gray-900",children:L.education.graduationYear})]})]})]})]}),(L==null?void 0:L.bio)&&e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-indigo-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-indigo-500 to-purple-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"О преподавателе"]}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm rounded-lg p-4 border border-indigo-200/50",children:e.jsx("p",{className:"text-indigo-800 leading-relaxed whitespace-pre-line",children:L.bio})})]}),(L==null?void 0:L.formats)&&L.formats.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 border border-teal-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-teal-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-teal-500 to-cyan-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Форматы обучения"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:L.formats.map((te,Ne)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-teal-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-teal-200/50 shadow-sm",children:ve(te)},Ne))})]})]}),R==="slots"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Доступные слоты"}),W.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:W.map(te=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:te.subject}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx("span",{children:be(te.date,te.startTime)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:ve(te.format)})]})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600 mt-3",children:[te.price," ₽"]})]})}),e.jsxs("button",{onClick:()=>$e(te),className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать"})]})]},te.id))}):e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-8 text-center",children:[e.jsx(Ke,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg mb-2",children:"Нет доступных слотов"}),e.jsx("p",{className:"text-gray-500",children:"Попробуйте позже или свяжитесь с преподавателем"})]})]}),J.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Забронированные уроки"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:J.map(te=>e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:te.subject}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx("span",{children:be(te.date,te.startTime)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:ve(te.format)})]})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-600 mt-3",children:[te.price," ₽"]})]})}),e.jsx("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded-xl text-sm font-medium text-center",children:"Забронировано"})]},te.id))})]})]}),R==="reviews"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx($t,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пока нет отзывов"}),e.jsx("p",{className:"text-gray-500",children:"Будьте первым, кто оставит отзыв о преподавателе"})]})]})]})]}),A&&O&&e.jsx(Ka,{isOpen:A,slot:O,onClose:()=>H(!1),onConfirm:X,teacher:t,student:a})]})},Wo="https://tutoring-platform-1756666331-zjfl.onrender.com",w4=({teacher:t,onClose:r,onBookLesson:s,onMessage:n})=>{var R,K,Y,ee;const{timeSlots:a,posts:i,lessons:o,refreshUsers:l,forceSyncData:c}=ct(),[d,f]=E.useState(!1),[g,m]=E.useState(!1),[b,j]=E.useState(!1),h=async()=>{var B,V;j(!0);try{const I=await fetch(`${Wo}/api/users/${t.id}`);if(I.ok){const W=await I.json();console.log("Fresh teacher data from refresh button:",W);const L=JSON.parse(localStorage.getItem("allUsers")||"[]").map(he=>he.id===W.id?W:he);localStorage.setItem("allUsers",JSON.stringify(L)),l(),await c();const fe={...t,name:W.name||t.name,email:W.email||t.email,avatar:((B=W.profile)==null?void 0:B.avatar)||W.avatar||t.avatar,profile:{...t.profile,...W.profile,avatar:((V=W.profile)==null?void 0:V.avatar)||W.avatar||t.avatar,name:W.name||t.name,email:W.email||t.email}};console.log("Updated teacher data in modal:",fe)}else console.warn("Failed to refresh teacher data:",I.status)}catch(I){console.error("Error refreshing teacher data:",I)}finally{j(!1)}},u=t.profile;console.log("Teacher in modal:",t),console.log("Profile in modal:",u),E.useEffect(()=>{(async()=>{var V,I;try{const W=await fetch(`${Wo}/api/users/${t.id}`);if(W.ok){const J=await W.json();console.log("Fresh teacher data in modal:",J);const fe=JSON.parse(localStorage.getItem("allUsers")||"[]").map(xe=>xe.id===J.id?J:xe);localStorage.setItem("allUsers",JSON.stringify(fe)),l(),await c();const he={...t,name:J.name||t.name,email:J.email||t.email,avatar:((V=J.profile)==null?void 0:V.avatar)||J.avatar||t.avatar,profile:{...t.profile,...J.profile,avatar:((I=J.profile)==null?void 0:I.avatar)||J.avatar||t.avatar,name:J.name||t.name,email:J.email||t.email}};console.log("Updated teacher data in modal useEffect:",he)}else console.warn("Failed to refresh teacher data in modal:",W.status)}catch(W){console.error("Error refreshing teacher data in modal:",W)}})()},[t.id]);const x=a.filter(B=>B.teacherId===t.id).filter(B=>!B.isBooked),S=i.filter(B=>B.userId===t.id),D=o.filter(B=>B.teacherId===t.id).filter(B=>B.status==="completed"),P=B=>{switch(B){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return B}},A=B=>{switch(B){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}},H=B=>{switch(B){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return B}},O=B=>{const V=new Date(B),W=Math.floor((new Date().getTime()-V.getTime())/(1e3*60*60));return W<1?"только что":W<24?`${W}ч назад`:W<48?"вчера":V.toLocaleDateString("ru-RU")},z=B=>new Date(B).toLocaleDateString("ru-RU",{weekday:"short",month:"short",day:"numeric"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(et,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m(!g),className:`p-2 rounded-full transition-colors ${g?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(qs,{className:`w-5 h-5 ${g?"fill-current":""}`})}),e.jsx("button",{onClick:()=>f(!d),className:`p-2 rounded-full transition-colors ${d?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(xt,{className:`w-5 h-5 ${d?"fill-current":""}`})}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Bt,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-6 mb-6",children:[e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-lg relative",children:[e.jsx("div",{className:"absolute top-1 right-1 w-4 h-4 bg-green-500 border-2 border-white rounded-full shadow-sm"}),(()=>{const B=(u==null?void 0:u.avatar)||t.avatar;return B&&B.trim()!==""&&B!=="undefined"&&B!=="null"?e.jsx("img",{src:B,alt:t.name,className:"w-24 h-24 object-cover rounded-full",onError:I=>{const W=I.target;W.style.display="none";const J=W.nextElementSibling;J&&J.classList.remove("hidden")},onLoad:I=>{const J=I.target.nextElementSibling;J&&J.classList.add("hidden")}}):null})(),e.jsx("div",{className:`w-24 h-24 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${(()=>{const B=(u==null?void 0:u.avatar)||t.avatar;return B&&B.trim()!==""&&B!=="undefined"&&B!=="null"?"hidden":""})()}`,children:e.jsx(ye,{className:"h-12 w-12 text-white"})})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:h,disabled:b,className:"p-2 text-gray-400 hover:text-blue-600 transition-colors disabled:opacity-50",title:"Обновить данные",children:e.jsx(Qo,{className:`w-5 h-5 ${b?"animate-spin":""}`})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Bt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[(u==null?void 0:u.rating)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx($t,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{children:u.rating})]}),(u==null?void 0:u.lessonsCount)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsxs("span",{children:[u.lessonsCount," уроков"]})]}),(u==null?void 0:u.experienceYears)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Wt,{className:"w-4 h-4"}),e.jsxs("span",{children:[u.experienceYears," лет опыта"]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-3",children:"Статистика"}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600 mb-1",children:D.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Проведено уроков"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600 mb-1",children:x.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Свободных слотов"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600 mb-1",children:S.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Записей"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600 mb-1",children:(u==null?void 0:u.reviewsCount)||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Отзывов"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>s(t.id),className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(Be,{className:"w-5 h-5"}),e.jsx("span",{children:"Записаться на урок"})]}),e.jsxs("button",{onClick:()=>n(t.id),className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),e.jsx("span",{children:"Написать сообщение"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"О преподавателе"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Be,{className:"w-3 h-3 mr-1"}),"Предметы:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((R=u==null?void 0:u.subjects)==null?void 0:R.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:u.subjects.map((B,V)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium",children:B},V))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Cs,{className:"w-3 h-3 mr-1"}),"Классы:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((K=u==null?void 0:u.grades)==null?void 0:K.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:u.grades.map((B,V)=>e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs font-medium",children:B},V))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(tl,{className:"w-3 h-3 mr-1"}),"Цели обучения:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((Y=u==null?void 0:u.goals)==null?void 0:Y.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:u.goals.map((B,V)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full text-xs font-medium",children:B},V))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Wt,{className:"w-3 h-3 mr-1"}),"Опыт:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:u!=null&&u.experience?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-0.5 rounded-full text-xs font-medium",children:P(u.experience)}),u.experienceYears&&e.jsxs("span",{className:"text-gray-600 text-xs",children:["(",u.experienceYears," лет)"]})]}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Cs,{className:"w-3 h-3 mr-1"}),"Тип преподавателя:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:e.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded-full text-xs font-medium",children:A((u==null?void 0:u.teacherType)||"private")})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Ct,{className:"w-3 h-3 mr-1"}),"Город:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:u!=null&&u.city?e.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-0.5 rounded-full text-xs font-medium",children:u.city}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Nd,{className:"w-3 h-3 mr-1"}),"Форматы обучения:"]}),e.jsx("div",{className:"text-base text-gray-900 mt-2",children:((ee=u==null?void 0:u.formats)==null?void 0:ee.length)>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:u.formats.map((B,V)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium",children:H(B)},V))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]})]})]})]}),(u==null?void 0:u.education)&&e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Образование"]}),e.jsxs("div",{className:"space-y-2",children:[u.education.university&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Университет:"}),e.jsx("div",{className:"text-sm text-gray-900",children:u.education.university})]}),u.education.degree&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Специальность:"}),e.jsx("div",{className:"text-sm text-gray-900",children:u.education.degree})]}),u.education.graduationYear&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Год выпуска:"}),e.jsx("div",{className:"text-sm text-gray-900",children:u.education.graduationYear})]}),u.education.courses&&u.education.courses.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Курсы:"}),e.jsx("div",{className:"space-y-1 mt-1",children:u.education.courses.map((B,V)=>e.jsxs("div",{className:"text-xs text-gray-700",children:["• ",B.name," (",B.institution,", ",B.year,")"]},V))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(Ko,{className:"w-4 h-4 mr-2"}),"Стоимость и услуги"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Базовая стоимость:"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 mt-1",children:u!=null&&u.hourlyRate?`${u.hourlyRate} ₽/час`:"Не указана"})]}),(u==null?void 0:u.durations)&&u.durations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Длительности занятий:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.durations.map((B,V)=>e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded-lg text-xs font-medium",children:[B," мин"]},V))})]}),(u==null?void 0:u.lessonTypes)&&u.lessonTypes.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Типы уроков:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.lessonTypes.map((B,V)=>e.jsx("span",{className:"bg-green-50 text-green-700 px-2 py-0.5 rounded-lg text-xs font-medium",children:B},V))})]})]}),e.jsxs("div",{className:"space-y-3",children:[(u==null?void 0:u.rating)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Рейтинг:"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(B=>e.jsx($t,{className:`w-4 h-4 ${B<=(u.rating||0)?"text-yellow-400 fill-current":"text-gray-300"}`},B))}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[u.rating,"/5"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Автоподбор:"}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:u!=null&&u.overbookingEnabled?e.jsx("span",{className:"text-green-600 font-medium",children:"✓ Доступен"}):e.jsx("span",{className:"text-gray-500",children:"Недоступен"})})]})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-700",children:"💡 Стоимость может варьироваться в зависимости от формата, длительности занятия и сложности материала"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"Доступные слоты (",x.length,")"]}),x.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Сводка по ценам:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Минимальная цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.min(...x.map(B=>B.price))," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Максимальная цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.max(...x.map(B=>B.price))," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Средняя цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.round(x.reduce((B,V)=>B+V.price,0)/x.length)," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Всего слотов:"}),e.jsx("div",{className:"font-semibold text-blue-600",children:x.length})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:x.slice(0,6).map(B=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:B.subject})]}),e.jsxs("span",{className:"text-base font-bold text-green-600",children:[B.price," ₽"]})]}),e.jsxs("div",{className:"space-y-1 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Ht,{className:"w-3 h-3"}),e.jsxs("span",{children:[z(B.date)," • ",B.startTime,"-",B.endTime]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Ct,{className:"w-3 h-3"}),e.jsxs("span",{children:[H(B.format)," • ",B.duration," мин"]})]}),B.experience&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Wt,{className:"w-3 h-3"}),e.jsxs("span",{children:["Опыт: ",P(B.experience)]})]})]}),e.jsxs("button",{onClick:()=>s(t.id),className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-2 px-4 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 text-sm font-semibold",children:["Записаться за ",B.price," ₽"]})]},B.id))}),x.length>6&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:["И еще ",x.length-6," доступных слотов"]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ke,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"Нет доступных слотов"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Следите за обновлениями расписания"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h3",{className:"text-base font-bold text-gray-900 flex items-center",children:[e.jsx(er,{className:"w-4 h-4 mr-2"}),"Записи преподавателя (",S.length,")"]})}),S.length>0?e.jsxs("div",{className:"space-y-3",children:[S.slice(0,3).map(B=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center flex-shrink-0",children:e.jsx(ye,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:B.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:O(B.date)})]}),e.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed text-sm",children:B.text}),B.tags&&B.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:B.tags.map((V,I)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium",children:V},I))}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(rl,{className:"w-3 h-3"}),e.jsx("span",{children:B.reactions.length})]}),e.jsxs("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(Ae,{className:"w-3 h-3"}),e.jsx("span",{children:B.comments.length})]}),e.jsx("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:e.jsx(Bt,{className:"w-3 h-3"})})]})]})]})},B.id)),S.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs("p",{className:"text-gray-600 text-xs",children:["И еще ",S.length-3," записей"]})})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(er,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"У преподавателя пока нет записей"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Записи появятся здесь, когда преподаватель начнет публиковать контент"})]})]})]})]})})},N4={ru:ft},S4=Ga({format:We,startOfWeek:Ot,getDay:Ya,locales:N4}),Yc=({onClose:t})=>{const{timeSlots:r,bookLesson:s}=ct(),{user:n}=tt(),[a,i]=E.useState(null),[o,l]=E.useState(!1),[c,d]=E.useState(!1),[f,g]=E.useState(null),b=r.filter(v=>!v.isBooked).map(v=>({id:v.id,title:`${v.teacherName} - ${v.subject}`,start:new Date(`${v.date}T${v.startTime}`),end:new Date(`${v.date}T${v.endTime}`),slot:v,teacherName:v.teacherName,subject:v.subject,price:v.price,format:v.format,experience:v.experience,rating:v.rating,city:v.city,teacherAvatar:v.teacherAvatar})),j=E.useCallback(v=>{let D={backgroundColor:"#3B82F6",borderRadius:"6px",opacity:.95,color:"white",border:"0px",display:"block",padding:"3px 6px",fontSize:"11px",fontWeight:"500",margin:"1px 0",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",transition:"all 0.2s ease"};return v.format==="offline"?D.backgroundColor="#10B981":v.format==="mini-group"&&(D.backgroundColor="#8B5CF6"),{style:D}},[]),h=E.useCallback(v=>{i(v),l(!0)},[]),u=v=>{if(!n){alert("Пожалуйста, войдите в систему для бронирования");return}g(v),d(!0),l(!1)},w=async v=>{if(n&&f)try{await s(f.id,n.id,n.name,v),d(!1),g(null),window.location.reload()}catch{alert("Произошла ошибка при бронировании. Попробуйте еще раз.")}},x=v=>{switch(v){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return v}},S=v=>{switch(v){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return v}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9998] p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-7xl w-full max-h-[90vh] overflow-hidden relative",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 p-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Календарь свободных слотов"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Выберите удобное время для занятия с преподавателем"})]}),e.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(et,{className:"w-6 h-6 text-gray-600"})})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:e.jsx(za,{localizer:S4,events:b,startAccessor:"start",endAccessor:"end",style:{height:600},eventPropGetter:j,onSelectEvent:h,views:["month","week","day"],messages:{next:"Следующий",previous:"Предыдущий",today:"Сегодня",month:"Месяц",week:"Неделя",day:"День",noEventsInRange:"Нет свободных слотов в выбранном диапазоне",showMore:v=>`+${v} еще`}})})}),o&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:v=>{v.target===v.currentTarget&&l(!1)},children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Детали слота"}),e.jsx("button",{onClick:()=>l(!1),className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(et,{className:"w-5 h-5 text-gray-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden",children:a.teacherAvatar?e.jsx("img",{src:a.teacherAvatar,alt:a.teacherName,className:"w-12 h-12 object-cover rounded-full"}):e.jsx(ye,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:a.teacherName}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[a.rating&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx($t,{className:"h-3 w-3 text-yellow-400 fill-current"}),e.jsx("span",{children:a.rating})]}),a.experience&&e.jsx("span",{className:"text-blue-600",children:x(a.experience)})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:a.subject})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ht,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-gray-700",children:[We(a.start,"dd MMMM yyyy, HH:mm",{locale:ft})," - ",We(a.end,"HH:mm",{locale:ft})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:S(a.format)})]}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[a.price," ₽"]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsxs("button",{onClick:()=>u(a.slot),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать"})]}),e.jsx("button",{onClick:()=>l(!1),className:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Отмена"})]})]})]})}),c&&f&&e.jsx(Ka,{slot:f,onClose:()=>d(!1),onConfirm:w})]})})},k4=({title:t,description:r,actionPrimary:s,actionSecondary:n,icon:a})=>e.jsx("div",{className:"col-span-full text-center py-14 card-gradient",children:e.jsxs("div",{className:"flex flex-col items-center",children:[a&&e.jsx("div",{className:"mb-3 text-blue-500",children:a}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),r&&e.jsx("p",{className:"text-gray-500 max-w-xl mx-auto mb-5",children:r}),e.jsxs("div",{className:"flex items-center gap-3 justify-center",children:[s&&e.jsx("button",{type:"button",onClick:s.onClick,className:`btn-primary px-5 py-2 rounded-lg ${s.variant==="secondary"?"btn-secondary":""}`,"aria-label":s.label,children:s.label}),n&&e.jsx("button",{type:"button",onClick:n.onClick,className:`btn-secondary px-5 py-2 rounded-lg ${n.variant==="primary"?"btn-primary":""}`,"aria-label":n.label,children:n.label})]})]})}),On=({setActiveTab:t})=>{var me;const{bookLesson:r,timeSlots:s,allUsers:n,refreshUsers:a,refreshAllData:i,forceSyncData:o,sendMessageToUser:l,teacherProfiles:c,loadRegisteredTeachers:d}=ct(),f=()=>{console.log("🔄 Принудительное обновление данных..."),i()};_.useEffect(()=>{console.log("🔄 StudentHome: Автоматическая загрузка зарегистрированных преподавателей..."),d();const k=setInterval(()=>{console.log("⏰ StudentHome: Периодическая загрузка зарегистрированных преподавателей..."),d()},3e4);return()=>clearInterval(k)},[d]);const{user:g}=tt(),[m,b]=E.useState({}),[j,h]=E.useState(!1),[u,w]=E.useState(!1),[x,S]=E.useState(!1),[v,D]=E.useState({grade:"",subject:"",goals:[],experience:"",duration:60,format:"online",city:"",date:"",startTime:"",comment:""}),[P,A]=E.useState(!1),[H,O]=E.useState(null),[z,R]=E.useState(!1),[K,Y]=E.useState(!1),[ee,B]=E.useState(null),[V,I]=E.useState(()=>{const k=new Date,G=k.getDay(),se=k.getDate()-G+(G===0?-6:1);return new Date(k.setDate(se))}),[W,J]=E.useState(null),[L,fe]=E.useState(null),[he,xe]=E.useState(""),[ve,$e]=E.useState(""),X=["Математика","Русский язык","Английский язык"],be=["1","2","3","4","5","6","7","8","9","10","11","Студент","Взрослый"],Ee=["подготовка к экзаменам","помощь с домашним заданием","углубленное изучение","разговорная практика"],te=["beginner","experienced","professional"],Ne=["online","offline","mini-group"],ke=[45,60],st=Ga({format:We,startOfWeek:Ot,getDay:Ya,locales:{ru:ft}}),[He,q]=E.useState([]),pe=async()=>{try{console.log("🔄 Загружаем всех преподавателей..."),console.log("🌐 SERVER_URL:",Re),console.log("🔄 Синхронизируем данные с сервера..."),await o(),console.log("📡 Запрашиваем пользователей с сервера...");const k=await fetch(`${Re}/api/users`);if(console.log("📡 Ответ сервера:",k.status,k.statusText),k.ok){const se=k.headers.get("content-type");if(console.log("📡 Content-Type:",se),se&&se.includes("application/json")){const de=await k.json();console.log("✅ Все пользователи загружены с сервера:",de.length,de);const ie=de.filter(ne=>ne.role==="teacher");console.log("✅ Преподаватели найдены:",ie.length,ie),q(ie),a(),i()}else console.warn("⚠️ Сервер вернул не-JSON ответ для пользователей"),q([])}else console.warn("⚠️ Не удалось загрузить пользователей с сервера:",k.status),q([]);console.log("📡 Запрашиваем преподавателей через /api/teachers...");const G=await fetch(`${Re}/api/teachers`);if(console.log("📡 Ответ /api/teachers:",G.status,G.statusText),G.ok){const se=G.headers.get("content-type");if(console.log("📡 Content-Type /api/teachers:",se),se&&se.includes("application/json")){const de=await G.json();console.log("✅ Преподаватели загружены через /api/teachers:",de.length,de),q(ie=>{const ge=[...ie,...de].filter((le,Le,Ye)=>Le===Ye.findIndex(wt=>wt.id===le.id));return console.log("✅ Объединенные преподаватели:",ge.length,ge),ge})}else console.warn("⚠️ Сервер вернул не-JSON ответ для преподавателей")}else console.warn("⚠️ Не удалось загрузить преподавателей через /api/teachers:",G.status)}catch(k){console.error("❌ Ошибка загрузки преподавателей с сервера:",k),q([])}};E.useEffect(()=>{console.log("🚀 Компонент StudentHome смонтирован, загружаем преподавателей..."),pe();const k=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");console.log("📱 Локальные профили преподавателей при монтировании:",Object.keys(k).length);const G=setInterval(()=>{console.log("🔄 Периодическое обновление списка преподавателей (каждые 30 сек)..."),pe()},3e4);return()=>clearInterval(G)},[o,a]),E.useEffect(()=>{const k=setTimeout(()=>{$e(he)},300);return()=>clearTimeout(k)},[he]),E.useEffect(()=>{const k=se=>{se.key==="tutoring_users"&&se.newValue&&(console.log("🔄 Обнаружены изменения в пользователях, обновляем список преподавателей"),pe())},G=se=>{var de;((de=se.detail)==null?void 0:de.key)==="tutoring_users"&&(console.log("🔄 Обнаружены кастомные изменения в пользователях, обновляем список преподавателей"),pe())};return window.addEventListener("storage",k),window.addEventListener("customStorage",G),()=>{window.removeEventListener("storage",k),window.removeEventListener("customStorage",G)}},[]),E.useEffect(()=>{console.log("📱 teacherProfiles изменились:",Object.keys(c).length),Object.keys(c).length>0&&console.log("✅ Найдены локальные профили преподавателей:",Object.keys(c))},[c]);const ue=_.useRef(null);_.useEffect(()=>{ue.current||(ue.current=Ho(dd),ue.current.on("slotCreated",()=>{setTimeout(()=>{je()},100)}),ue.current.on("userRegistered",()=>{setTimeout(()=>{i(),je()},100)}),ue.current.on("profileUpdated",k=>{console.log("Profile updated via WebSocket:",k),setTimeout(()=>{i(),je()},100)}))},[]);const je=()=>s.filter(G=>{if(G.isBooked)return!1;const se=new Date(G.date),de=new Date;return de.setHours(0,0,0,0),!(se<de)}),Ie=(k=!1)=>{w(!0);try{let G=s.filter(se=>{if(se.isBooked)return!1;const de=new Date(se.date),ie=new Date;return ie.setHours(0,0,0,0),!(de<ie)});if(m.grade&&m.grade!==""&&(G=G.filter(se=>se.grades&&se.grades.includes(m.grade))),m.subject&&m.subject!==""&&(G=G.filter(se=>se.subject===m.subject)),m.experience&&m.experience!==""&&(G=G.filter(se=>se.experience===m.experience)),m.format&&m.format!==""&&(G=G.filter(se=>se.format===m.format)),m.duration&&m.duration>0&&(G=G.filter(se=>se.duration===m.duration)),m.minRating&&m.minRating>0&&(G=G.filter(se=>(se.rating||0)>=m.minRating)),m.goals&&m.goals.length>0&&(G=G.filter(se=>se.goals&&m.goals.some(de=>se.goals.includes(de)))),W){const se=We(W,"yyyy-MM-dd");G=G.filter(de=>de.date===se)}L&&(G=G.filter(se=>{const de=parseInt(se.startTime.split(":")[0]),ie=parseInt(L.start.split(":")[0]),ne=parseInt(L.end.split(":")[0]);return de>=ie&&de<ne})),k&&h(!1)}catch(G){console.error("Error applying filters:",G)}finally{w(!1)}},Oe=()=>{b({}),J(null),fe(null),xe(""),je(),h(!1)},ze=async k=>{g&&H&&(r(H.id,g.id,g.name,k),setTimeout(()=>{Object.keys(m).length===0&&!W&&!L?je():Ie(!1)},100))},nt=()=>{if(S(!1),ue.current){const k={studentId:g==null?void 0:g.id,studentName:g==null?void 0:g.name,...v};ue.current.emit("overbookingRequest",k)}alert("Заявка на овербукинг отправлена! Мы подберем лучшего преподавателя за 5 часов до занятия.")},$=k=>{switch(k){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return k}},U=_.useMemo(()=>{console.log("🔄 Собираем всех преподавателей..."),console.log("📊 Исходные данные:"),console.log("- serverTeachers:",He.length,He),console.log("- allUsers:",(n==null?void 0:n.length)||0,n),console.log("- teacherProfiles:",Object.keys(c).length,c),console.log("- timeSlots:",s.length);const k=(n==null?void 0:n.filter(le=>le.role==="teacher").map(le=>{var Le,Ye,wt;return{id:le.id,name:le.name||((Le=le.profile)==null?void 0:Le.name)||"Репетитор",avatar:le.avatar||((Ye=le.profile)==null?void 0:Ye.avatar)||"",rating:((wt=le.profile)==null?void 0:wt.rating)||0,profile:le.profile||{},isRegistered:!0,source:"registered"}}))||[];console.log("👥 ЗАРЕГИСТРИРОВАННЫЕ преподаватели (ПРИОРИТЕТ):",k.length,k);const G=Object.entries(c).map(([le,Le])=>({id:le,name:Le.name||"Репетитор",avatar:Le.avatar||"",rating:Le.rating||0,profile:Le,isRegistered:!1,source:"profiles"}));console.log("📱 Преподаватели из teacherProfiles:",G.length,G);const se=He.map(le=>{var Le,Ye,wt;return{id:le.id,name:le.name||((Le=le.profile)==null?void 0:Le.name)||"Репетитор",avatar:le.avatar||((Ye=le.profile)==null?void 0:Ye.avatar)||"",rating:((wt=le.profile)==null?void 0:wt.rating)||0,profile:le.profile||{},isRegistered:!1,source:"server"}});console.log("📡 Преподаватели с сервера:",se.length,se);const de=s.filter(le=>le.teacherId&&le.teacherName).map(le=>({id:le.teacherId,name:le.teacherName,avatar:le.teacherAvatar||"",rating:le.rating||0,profile:{subjects:le.subject?[le.subject]:[],experience:le.experience||"beginner",grades:le.grades||[],goals:le.goals||[],city:"",bio:"",rating:le.rating||0,hourlyRate:le.price||0},isRegistered:!1,source:"slots"}));console.log("📅 Преподаватели из слотов:",de.length,de);const ie=[...k,...G,...se,...de];console.log("🔄 Всего источников:",ie.length);const ne=new Map;k.forEach(le=>{ne.set(le.id,le),console.log("✅ ГАРАНТИРОВАННО добавлен зарегистрированный преподаватель:",le.id,le.name)}),[...G,...se,...de].forEach(le=>{ne.has(le.id)?console.log("⏭️ Пропущен дубликат преподавателя:",le.id,le.name,le.source):(ne.set(le.id,le),console.log("➕ Добавлен дополнительный преподаватель:",le.id,le.name,le.source))});const ge=Array.from(ne.values());return console.log("✅ Итоговый список всех преподавателей:",ge.length,ge),ge},[He,n,s,c]),p=_.useMemo(()=>{const k=Object.keys(m).length>0||W||L||ve,G=s.filter(ie=>!ie.isBooked),se=new Set(G.map(ie=>ie.teacherId));console.log("🔍 Фильтрация преподавателей:"),console.log("- hasActiveFilters:",k),console.log("- filters:",m),console.log("- selectedDate:",W),console.log("- selectedTimeRange:",L),console.log("- debouncedSearchQuery:",ve),console.log("- availableSlots:",G.length),console.log("- teacherIdsWithSlots:",Array.from(se)),console.log("- allTeachers:",U.length);let de=U;if(k?console.log("- Показываем всех (есть активные фильтры):",de.length):(de=U.filter(ie=>se.has(ie.id)),console.log("- Показываем только с доступными слотами:",de.length)),k&&(de=U.filter(ie=>{const ne=ie.profile;return!(m.subject&&m.subject!==""&&(!(ne!=null&&ne.subjects)||!ne.subjects.includes(m.subject))||m.experience&&m.experience!==""&&(ne==null?void 0:ne.experience)!==m.experience||m.format&&m.format!==""&&(!(ne!=null&&ne.formats)||!ne.formats.includes(m.format))||m.city&&m.city!==""&&(!(ne!=null&&ne.city)||!ne.city.toLowerCase().includes(m.city.toLowerCase()))||m.minRating&&m.minRating>0&&((ne==null?void 0:ne.rating)||0)<m.minRating||m.duration&&m.duration>0&&(!(ne!=null&&ne.durations)||!ne.durations.includes(m.duration))||m.grade&&m.grade!==""&&(!(ne!=null&&ne.grades)||!ne.grades.includes(m.grade))||m.goals&&m.goals.length>0&&(!(ne!=null&&ne.goals)||!m.goals.some(ge=>ne.goals.includes(ge))))})),ve.trim()){const ie=ve.toLowerCase().trim();de=de.filter(ne=>{const ge=ne.profile;return!!(ne.name.toLowerCase().includes(ie)||ge!=null&&ge.subjects&&ge.subjects.some(le=>le.toLowerCase().includes(ie))||ge!=null&&ge.city&&ge.city.toLowerCase().includes(ie))})}return console.log("✅ StudentHome - Итоговый результат:",de.length,"преподавателей"),de},[U,m,W,L,ve,s]);function N(k){try{return JSON.parse(localStorage.getItem("tutoring_users")||"[]").find(se=>se.id===k&&se.role==="teacher")||null}catch{return null}}const[y,T]=E.useState(null),[C,M]=E.useState(!1),[ae,ce]=E.useState(!1);_.useEffect(()=>{Object.keys(m).length>0||W||L?Ie():je()},[m,W,L,s]),_.useEffect(()=>{je()},[n]),_.useEffect(()=>{const k=se=>{se.key==="tutoring_users"&&(a(),q([]),fetch(`${Re}/api/teachers`).then(de=>de.json()).then(de=>q(Array.isArray(de)?de:[])).catch(()=>q([])),je())},G=se=>{var de;((de=se.detail)==null?void 0:de.key)==="tutoring_users"&&(a(),q([]),fetch(`${Re}/api/teachers`).then(ie=>ie.json()).then(ie=>q(Array.isArray(ie)?ie:[])).catch(()=>q([])),je())};return window.addEventListener("storage",k),window.addEventListener("customStorage",G),()=>{window.removeEventListener("storage",k),window.removeEventListener("customStorage",G)}},[]),_.useEffect(()=>{je()},[s]);const Me=async k=>{var se,de,ie,ne,ge,le,Le,Ye,wt,Xa;console.log("Teacher clicked:",k);try{const ps=await fetch(`${Re}/api/users/${k.id}`);if(ps.ok){const at=await ps.json();if(console.log("Fresh teacher data from server:",at),at){const Kc=JSON.parse(localStorage.getItem("allUsers")||"[]").map(Za=>Za.id===at.id?at:Za);localStorage.setItem("allUsers",JSON.stringify(Kc));const Qa={id:at.id,name:at.name,email:at.email,avatar:((se=at.profile)==null?void 0:se.avatar)||at.avatar,role:"teacher",profile:{...at.profile,avatar:((de=at.profile)==null?void 0:de.avatar)||at.avatar,name:at.name,email:at.email}};console.log("Updated teacher data for modal:",Qa),T(Qa),M(!0);return}}}catch(ps){console.error("Error fetching fresh teacher data:",ps)}let G=N(k.id);G?G={...G,name:k.name||G.name,email:((Le=k.profile)==null?void 0:Le.email)||k.email||G.email,avatar:((Ye=k.profile)==null?void 0:Ye.avatar)||k.avatar||G.avatar,profile:{...G.profile,...k.profile,avatar:((wt=k.profile)==null?void 0:wt.avatar)||k.avatar||G.avatar,name:k.name||G.name,email:((Xa=k.profile)==null?void 0:Xa.email)||k.email||G.email}}:G={id:k.id,name:k.name,email:((ie=k.profile)==null?void 0:ie.email)||k.email||"",avatar:((ne=k.profile)==null?void 0:ne.avatar)||k.avatar,role:"teacher",profile:{...k.profile,avatar:((ge=k.profile)==null?void 0:ge.avatar)||k.avatar,name:k.name,email:((le=k.profile)==null?void 0:le.email)||k.email}},console.log("Fallback teacher data for modal:",G),T(G),M(!0)},F=k=>{const G=n.find(se=>se.id===k);G&&(B(G),Y(!0)),ce(!1)},Z=k=>{console.log("🔍 StudentHome handleMessage DEBUG:"),console.log("- Student user:",{id:g==null?void 0:g.id,name:g==null?void 0:g.name,role:g==null?void 0:g.role}),console.log("- Target teacher ID:",k);const G=n.find(se=>se.id===k);if(console.log("- Found teacher:",G),G&&g){console.log("- Sending message to teacher:",{studentId:g.id,teacherId:k,studentName:g.name,teacherName:G.name});const se=l(g.id,g.name,k,G.name,`Привет! Меня зовут ${g.name}. Можете ли вы помочь мне с обучением?`);console.log("- Message sent, chat ID:",se),t("chats")}else console.log("❌ Teacher not found or user not available");console.log("🔍 END StudentHome DEBUG"),ce(!1)};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-3",children:"Найди своего идеального репетитора"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Изучай профили преподавателей, связывайся с ними и записывайся на уроки"})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"flex items-center space-x-2 bg-green-50 border border-green-200 rounded-full px-4 py-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx(Ud,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Подключено в реальном времени"})]})})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap justify-center gap-4",children:[e.jsxs("button",{onClick:()=>S(!0),className:"group bg-gradient-to-r from-green-500 via-emerald-500 to-teal-500 text-white px-6 py-3 rounded-xl font-semibold text-base hover:from-green-600 hover:via-emerald-600 hover:to-teal-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Be,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Овербукинг"}),e.jsx("div",{className:"text-xs opacity-90",children:"Автоподбор"})]})]}),e.jsxs("button",{onClick:()=>R(!0),className:"group bg-gradient-to-r from-purple-500 via-pink-500 to-rose-500 text-white px-6 py-3 rounded-xl font-semibold text-base hover:from-purple-600 hover:via-pink-600 hover:to-rose-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Ke,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Календарь"}),e.jsx("div",{className:"text-xs opacity-90",children:"Слоты"})]})]})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative group",children:[e.jsx(zr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{type:"text",value:he,onChange:k=>xe(k.target.value),placeholder:"🔍 Поиск по предмету, преподавателю или городу...",className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base placeholder-gray-400"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>h(!j),className:`flex items-center space-x-2 px-4 py-2.5 rounded-xl font-medium transition-all duration-200 text-sm ${j?"bg-blue-600 text-white shadow-md":"bg-white border-2 border-gray-200 text-gray-700 hover:border-blue-300 hover:bg-blue-50"}`,children:[e.jsx(ea,{className:"h-4 w-4"}),e.jsx("span",{children:"Фильтры"}),(Object.keys(m).length>0||W||L||he.trim())&&e.jsx("span",{className:"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded-full text-xs font-bold",children:Object.keys(m).length+(W?1:0)+(L?1:0)+(he.trim()?1:0)})]}),e.jsx("button",{onClick:()=>Ie(!0),disabled:u,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2.5 rounded-xl font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 flex items-center space-x-2 text-sm",children:u?e.jsxs(e.Fragment,{children:[e.jsx(Qo,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Применение..."})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Применить"})})}),(Object.keys(m).length>0||W||L||he.trim())&&e.jsx("button",{onClick:Oe,className:"bg-white border-2 border-gray-300 text-gray-700 px-4 py-2.5 rounded-xl font-medium hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 text-sm",children:"Сбросить"})]})]}),j&&e.jsxs("div",{className:"bg-white p-6 rounded-2xl border-2 border-gray-100 shadow-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Класс"}),e.jsxs("select",{value:m.grade||"",onChange:k=>b({...m,grade:k.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой класс"}),be.map(k=>e.jsx("option",{value:k,children:k},k))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Предмет"}),e.jsxs("select",{value:m.subject||"",onChange:k=>b({...m,subject:k.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой предмет"}),X.map(k=>e.jsx("option",{value:k,children:k},k))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Опыт"}),e.jsxs("select",{value:m.experience||"",onChange:k=>b({...m,experience:k.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой опыт"}),te.map(k=>e.jsx("option",{value:k,children:$(k)},k))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Формат"}),e.jsxs("select",{value:m.format||"",onChange:k=>b({...m,format:k.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой формат"}),Ne.map(k=>e.jsx("option",{value:k,children:k==="online"?"Онлайн":k==="offline"?"Оффлайн":"Мини-группа"},k))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Длительность"}),e.jsxs("select",{value:m.duration||"",onChange:k=>b({...m,duration:k.target.value?parseInt(k.target.value):void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любая длительность"}),ke.map(k=>e.jsxs("option",{value:k,children:[k," мин"]},k))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Мин. рейтинг"}),e.jsxs("select",{value:m.minRating||"",onChange:k=>b({...m,minRating:k.target.value?parseFloat(k.target.value):void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой рейтинг"}),e.jsx("option",{value:"4",children:"4+ звезды"}),e.jsx("option",{value:"4.5",children:"4.5+ звезды"}),e.jsx("option",{value:"5",children:"5 звезд"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Город"}),e.jsx("input",{type:"text",value:m.city||"",onChange:k=>b({...m,city:k.target.value}),placeholder:"Введите город",className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Цели обучения"}),e.jsxs("select",{value:((me=m.goals)==null?void 0:me[0])||"",onChange:k=>b({...m,goals:k.target.value?[k.target.value]:void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любые цели"}),Ee.map(k=>e.jsx("option",{value:k,children:k},k))]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4 text-center",children:"Выберите дату и время"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Дата"}),e.jsx("div",{className:"border-2 border-gray-200 rounded-2xl overflow-hidden shadow-lg",children:e.jsx(za,{localizer:st,events:[],startAccessor:"start",endAccessor:"end",style:{height:280},views:["month"],view:"month",selectable:!0,onSelectSlot:k=>{J(k.start)},onSelectEvent:()=>{}})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Время"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Начало"}),e.jsx("input",{type:"time",value:(L==null?void 0:L.start)||"",onChange:k=>fe(G=>({start:k.target.value,end:(G==null?void 0:G.end)||"23:00"})),className:"w-full p-3 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Конец"}),e.jsx("input",{type:"time",value:(L==null?void 0:L.end)||"",onChange:k=>fe(G=>({start:(G==null?void 0:G.start)||"00:00",end:k.target.value})),className:"w-full p-3 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base"})]})]}),W&&e.jsxs("div",{className:"mt-4 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ke,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Выбрана дата:"})]}),e.jsx("p",{className:"text-base font-medium text-blue-900",children:We(W,"dd MMMM yyyy",{locale:ft})})]})]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:p.length>0?`Найдено ${p.length} преподавателей`:"Преподаватели"}),e.jsxs("button",{onClick:f,className:"px-3 py-1 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm flex items-center gap-2",title:"Обновить список преподавателей",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Обновить"]})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:p.length>0?"Зарегистрированные преподаватели всегда доступны для связи и бронирования уроков":"Попробуйте изменить фильтры или воспользоваться овербукингом"}),p.length>0&&e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 text-green-600 text-xs",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{children:"Все репетиторы доступны 24/7"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:p.length===0?e.jsx(k4,{title:Object.keys(m).length>0||W||L?"Нет преподавателей подходящих под фильтры":"Нет зарегистрированных преподавателей",description:Object.keys(m).length>0||W||L?"Попробуйте изменить фильтры или воспользоваться овербукингом":"Попробуйте воспользоваться овербукингом или обратитесь к администратору",actionPrimary:{label:"Овербукинг",onClick:()=>S(!0)},actionSecondary:{label:"Сбросить фильтры",onClick:Oe,variant:"secondary"}}):e.jsx(e.Fragment,{children:p.map(k=>{const G=k.profile,ie=s.filter(ne=>ne.teacherId===k.id).filter(ne=>!ne.isBooked).length>0;return e.jsxs("div",{className:"bg-white rounded-3xl border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer group overflow-hidden transform hover:-translate-y-2",onClick:()=>Me(k),children:[e.jsxs("div",{className:"h-32 relative overflow-hidden",style:{background:G!=null&&G.cardBackground?G.cardBackground.startsWith("http")||G.cardBackground.startsWith("data:")?`url(${G.cardBackground}) center/cover`:G.cardBackground:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsxs("div",{className:"absolute top-3 right-3 flex items-center space-x-2",children:[e.jsx("button",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-full text-white hover:bg-white/30 transition-colors border border-white/30",onClick:ne=>{ne.stopPropagation()},children:e.jsx(xt,{className:"h-3 w-3"})}),e.jsx("button",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-full text-white hover:bg-white/30 transition-colors border border-white/30",onClick:ne=>{ne.stopPropagation()},children:e.jsx(Bt,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"relative -mt-12 flex justify-center",children:e.jsxs("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-2 border-white rounded-full shadow-lg animate-pulse",title:"Зарегистрированный репетитор (всегда доступен)"}),(()=>{const ne=(G==null?void 0:G.avatar)||k.avatar;return ne&&ne.trim()!==""&&ne!=="undefined"&&ne!=="null"?e.jsx("img",{src:ne,alt:k.name,className:"w-32 h-32 object-cover rounded-full",onError:le=>{const Le=le.target;Le.style.display="none";const Ye=Le.nextElementSibling;Ye&&Ye.classList.remove("hidden")},onLoad:le=>{const Ye=le.target.nextElementSibling;Ye&&Ye.classList.add("hidden")}}):null})(),e.jsx("div",{className:`w-32 h-32 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${(()=>{const ne=(G==null?void 0:G.avatar)||k.avatar;return ne&&ne.trim()!==""&&ne!=="undefined"&&ne!=="null"?"hidden":""})()}`,children:e.jsx(ye,{className:"h-16 w-16 text-white"})})]})}),e.jsxs("div",{className:"px-6 pb-6 pt-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:(G==null?void 0:G.name)||k.name||"Репетитор"}),e.jsx("p",{className:"text-sm text-gray-600",children:(G==null?void 0:G.teacherType)==="private"?"Частный преподаватель":(G==null?void 0:G.teacherType)==="school"?"Преподаватель школы":(G==null?void 0:G.teacherType)==="both"?"Частный + Школа":"Частный преподаватель"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-600 mb-4",children:[(G==null?void 0:G.age)&&e.jsxs("span",{children:["возраст ",G.age," лет"]}),(G==null?void 0:G.experienceYears)&&e.jsxs("span",{children:["стаж ",G.experienceYears," лет"]})]}),e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsxs("div",{className:"flex items-center space-x-1 bg-green-50 px-3 py-1.5 rounded-full",children:[e.jsx(Ae,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:G!=null&&G.reviewsCount&&G.reviewsCount>0?`${G.reviewsCount} отзывов`:"отзывов нет"})]})}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-sm text-gray-600",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:(G==null?void 0:G.city)||"Город не указан"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:ne=>{ne.stopPropagation(),ie?(B(k),Y(!0)):Me(k)},className:`w-full py-3 rounded-xl font-semibold transition-all duration-200 text-base ${ie?"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1":"bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1"}`,children:ie?"Забронировать урок":"Связаться с репетитором"}),e.jsx("button",{onClick:ne=>{ne.stopPropagation(),Me(k)},className:"w-full py-2 text-gray-500 hover:text-blue-600 transition-colors text-sm font-medium",children:"Подробнее →"})]})]})]},k.id)})})})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Овербукинг - Автоподбор преподавателя"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Заполните форму, и мы автоматически подберем лучшего доступного преподавателя за 5 часов до занятия"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Класс"}),e.jsxs("select",{value:v.grade,onChange:k=>D({...v,grade:k.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Выберите класс"}),be.map(k=>e.jsx("option",{value:k,children:k},k))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предмет"}),e.jsxs("select",{value:v.subject,onChange:k=>D({...v,subject:k.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Выберите предмет"}),X.map(k=>e.jsx("option",{value:k,children:k},k))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата занятия"}),e.jsx("input",{type:"date",value:v.date,onChange:k=>D({...v,date:k.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Время начала"}),e.jsx("input",{type:"time",value:v.startTime,onChange:k=>D({...v,startTime:k.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цель занятий"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ee.map(k=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:v.goals.includes(k),onChange:G=>{G.target.checked?D({...v,goals:[...v.goals,k]}):D({...v,goals:v.goals.filter(se=>se!==k)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:k})]},k))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Опыт преподавателя"}),e.jsxs("select",{value:v.experience,onChange:k=>D({...v,experience:k.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Любой"}),te.map(k=>e.jsx("option",{value:k,children:$(k)},k))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Продолжительность"}),e.jsx("select",{value:v.duration,onChange:k=>D({...v,duration:Number(k.target.value)}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:ke.map(k=>e.jsxs("option",{value:k,children:[k," мин"]},k))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Формат"}),e.jsx("select",{value:v.format,onChange:k=>D({...v,format:k.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Ne.map(k=>e.jsx("option",{value:k,children:k==="online"?"Онлайн":k==="offline"?"Оффлайн":"Мини-группа"},k))})]})]}),v.format==="offline"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Город"}),e.jsx("input",{type:"text",value:v.city,onChange:k=>D({...v,city:k.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Введите ваш город"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Примечание"}),e.jsx("textarea",{value:v.comment,onChange:k=>D({...v,comment:k.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Например: хочу разобрать домашнее задание или подготовиться к контрольной..."})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-6",children:[e.jsx("button",{onClick:nt,disabled:!v.grade||!v.subject||!v.date||!v.startTime,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white py-3 px-4 rounded-lg font-medium hover:from-green-600 hover:to-emerald-600 transition-all duration-200 disabled:opacity-50",children:"Отправить заявку"}),e.jsx("button",{onClick:()=>S(!1),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Отмена"})]})]})})}),C&&y&&e.jsx(w4,{teacher:y,onClose:()=>M(!1),onBookLesson:k=>{M(!1),F(k)},onMessage:k=>{M(!1),Z(k)}}),P&&H&&g&&e.jsx(Ka,{isOpen:P,onClose:()=>{A(!1),O(null)},onConfirm:ze,slot:H,teacher:N(H.teacherId),student:g}),ae&&y&&e.jsx(qc,{teacher:y,onClose:()=>ce(!1),onBookLesson:F,onMessage:Z}),z&&e.jsx(Yc,{onClose:()=>R(!1)}),K&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center",children:e.jsx(ye,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Календарь ",(ee==null?void 0:ee.name)||"Преподавателя"]}),e.jsx("p",{className:"text-gray-600",children:"Выберите удобное время для занятия"})]})]}),e.jsx("button",{onClick:()=>{Y(!1),B(null)},className:"p-2 rounded-full hover:bg-gray-100",children:e.jsx(et,{className:"w-5 h-5 text-gray-600"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{const k=new Date(V);k.setDate(k.getDate()-7),I(k)},className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[V.toLocaleDateString("ru-RU",{day:"numeric",month:"long"})," — ",new Date(V.getTime()+6*24*60*60*1e3).toLocaleDateString("ru-RU",{day:"numeric",month:"long"})]}),e.jsx("button",{onClick:()=>{const k=new Date(V);k.setDate(k.getDate()+7),I(k)},className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("button",{onClick:()=>{const k=new Date,G=k.getDay(),se=k.getDate()-G+(G===0?-6:1);I(new Date(k.setDate(se)))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:"Сегодня"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-200 bg-gray-50",children:[e.jsx("div",{className:"w-20 p-3 border-r border-gray-200"}),Array.from({length:7},(k,G)=>{const se=new Date(V);return se.setDate(se.getDate()+G),e.jsxs("div",{className:"flex-1 p-3 border-r border-gray-200 last:border-r-0 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:se.toLocaleDateString("ru-RU",{weekday:"short"})}),e.jsx("div",{className:"text-xs text-gray-600",children:se.toLocaleDateString("ru-RU",{day:"numeric",month:"short"})})]},G)})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:Array.from({length:24},(k,G)=>G).map(k=>e.jsxs("div",{className:"flex border-b border-gray-200 last:border-b-0",children:[e.jsxs("div",{className:"w-20 bg-gray-50 p-3 border-r border-gray-200 flex items-center justify-center text-sm font-medium text-gray-600 sticky left-0",children:[k.toString().padStart(2,"0"),":00"]}),Array.from({length:7},(G,se)=>{const de=new Date(V);de.setDate(de.getDate()+se);const ie=de.toISOString().split("T")[0],ne=s.filter(ge=>ge.teacherId===(ee==null?void 0:ee.id)&&!ge.isBooked&&ge.date===ie&&parseInt(ge.startTime.split(":")[0])===k);return e.jsx("div",{className:"flex-1 p-3 border-r border-gray-200 last:border-r-0 min-h-[60px]",children:ne.map(ge=>e.jsxs("div",{className:"bg-blue-100 border border-blue-300 rounded-lg p-2 mb-2 cursor-pointer hover:bg-blue-200 transition-colors",onClick:()=>{g&&(O(ge),A(!0),Y(!1),B(null))},children:[e.jsxs("div",{className:"text-xs font-medium text-blue-900",children:[ge.startTime," - ",ge.endTime]}),e.jsx("div",{className:"text-xs text-blue-700",children:ge.subject}),e.jsxs("div",{className:"text-xs text-blue-600",children:[ge.price," ₽"]})]},ge.id))},se)})]},k))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["Доступные слоты: ",s.filter(k=>k.teacherId===(ee==null?void 0:ee.id)&&!k.isBooked).length]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Нажмите на любой слот в календаре для бронирования"})]})]})]})})]})},Mn=()=>{const{timeSlots:t,lessons:r,createSlot:s,cancelLesson:n,getOrCreateChat:a,completeLesson:i,deleteSlot:o,isConnected:l,socketRef:c}=ct(),{user:d}=tt(),[f,g]=E.useState(!1),[m,b]=E.useState({date:"",startTime:"",duration:60,subject:"",lessonType:"regular",format:"online",price:1e3}),[j,h]=_.useState(null),[u,w]=_.useState(!1),[x,S]=_.useState(null),[v,D]=E.useState(!1),[P,A]=E.useState([]),[H,O]=E.useState(null),[z,R]=E.useState(!1);_.useEffect(()=>{c.current&&(d!=null&&d.id)&&l&&c.current.emit("subscribeOverbooking",d.id)},[c.current,d==null?void 0:d.id,l]),_.useEffect(()=>{if(!c.current)return;const q=()=>{d!=null&&d.id&&(d!=null&&d.profile)&&l&&c.current.emit("subscribeOverbooking",d.id)};return c.current.off("connect",q),c.current.on("connect",q),d!=null&&d.id&&(d!=null&&d.profile)&&(c.current.emit("subscribeOverbooking",d.id),c.current.on("overbookingRequests",pe=>{A(pe),setTimeout(()=>{},100)}),c.current.on("newOverbookingRequest",pe=>{A(ue=>[...ue,pe])}),c.current.on("overbookingRequestAccepted",pe=>{A(ue=>ue.filter(je=>je.id!==pe.id))})),()=>{c.current&&(c.current.off("overbookingRequests"),c.current.off("newOverbookingRequest"),c.current.off("overbookingRequestAccepted"),c.current.off("connect",q))}},[d==null?void 0:d.id,d==null?void 0:d.profile,l]),_.useEffect(()=>{d&&d.profile&&Array.isArray(d.profile.subjects)&&d.profile.subjects.length>=1&&b(q=>({...q,subject:d.profile.subjects[0]}))},[d]);const Y=t.filter(q=>q.teacherId===(d==null?void 0:d.id)).filter(q=>!q.isBooked),ee=r.filter(q=>q.teacherId===(d==null?void 0:d.id)),B=ee.filter(q=>q.status==="scheduled"),V=ee.filter(q=>q.status==="completed"),I=(q,pe)=>{const ue=new Date(`${q.date}T${q.startTime}`),je=new Date(`${pe.date}T${pe.startTime}`);return ue.getTime()-je.getTime()},W=[...Y].sort(I),J=[...B].sort(I),L=[...V].sort(I),fe=()=>{if(!d||!m.date||!m.startTime||!m.subject){alert("Пожалуйста, заполните все обязательные поля");return}const q=new Date(`2000-01-01T${m.startTime}`),pe=new Date(q.getTime()+m.duration*6e4);let ue;d.profile&&d.role==="teacher"&&(ue=d.profile);const je={teacherId:d.id,teacherName:d.name,teacherAvatar:d.avatar,date:m.date,startTime:m.startTime,endTime:pe.toTimeString().slice(0,5),duration:m.duration,subject:m.subject,lessonType:m.lessonType,format:m.format,price:m.price,experience:(ue==null?void 0:ue.experience)||"beginner",goals:(ue==null?void 0:ue.goals)||[],grades:(ue==null?void 0:ue.grades)||[],rating:ue==null?void 0:ue.rating,bio:(ue==null?void 0:ue.bio)||"",...m.format==="offline"&&(ue!=null&&ue.city)?{city:ue.city}:{}};s(je),g(!1),b({date:"",startTime:"",duration:60,subject:"",lessonType:"regular",format:"online",price:1e3})},he=q=>{d&&(h(q),S(null),w(!0))},xe=q=>{d&&(S(q),h(null),w(!0))},ve=()=>{w(!1),h(null),S(null)},$e=async q=>{var ue,je,Ie,Oe,ze,nt;if(!d)return;c.current&&c.current.emit("acceptOverbookingRequest",{requestId:q.id,teacherId:d.id});const pe={teacherId:d.id,teacherName:d.name,teacherAvatar:d.avatar||"",date:q.date||new Date().toISOString().slice(0,10),startTime:q.startTime||"15:00",endTime:q.endTime||"16:00",duration:q.duration||60,subject:q.subject,lessonType:"regular",format:q.format,price:1e3,experience:((ue=d.profile)==null?void 0:ue.experience)||"beginner",goals:((je=d.profile)==null?void 0:je.goals)||[],grades:((Ie=d.profile)==null?void 0:Ie.grades)||[],rating:(Oe=d.profile)==null?void 0:Oe.rating,bio:((ze=d.profile)==null?void 0:ze.bio)||"",city:((nt=d.profile)==null?void 0:nt.city)||""};await s(pe,q.studentId,q.studentName),D(!1),alert("Вы приняли заявку. Слот создан и забронирован!")},X=q=>{switch(q){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return q}},be=q=>{switch(q){case"trial":return"Пробный";case"regular":return"Обычный";default:return q}},Ee=({slot:q,isBooked:pe,onClick:ue})=>e.jsx("div",{className:`card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden border-l-4 ${pe?"border-green-500":"border-blue-500"} cursor-pointer`,onClick:ue,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 leading-tight mb-1",children:q.subject}),e.jsxs("div",{className:"text-xs text-gray-500",children:[q.date," • ",q.startTime,"–",q.endTime]})]})}),te=({lesson:q,status:pe,onClick:ue})=>e.jsx("div",{className:`card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden border-l-4 ${pe==="completed"?"border-gray-400":"border-green-500"} cursor-pointer`,onClick:ue,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 leading-tight mb-1",children:q.subject}),e.jsxs("div",{className:"text-xs text-gray-500",children:[q.date," • ",q.startTime,"–",q.endTime]})]})}),Ne=(d==null?void 0:d.profile)&&"overbookingEnabled"in d.profile&&d.profile.overbookingEnabled,ke=d!=null&&d.profile&&"subjects"in d.profile?d.profile.subjects:[],rt=[45,60,90],st=["regular","trial"],He=["online","offline","mini-group"];return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 relative",children:[Ne&&e.jsxs("button",{className:"absolute top-0 right-0 p-2 rounded-full hover:bg-gray-100 transition z-10",title:"Уведомления",onClick:()=>D(!0),children:[e.jsx(Ur,{className:"w-7 h-7 text-blue-500"}),P.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full text-xs px-1.5 py-0.5",children:P.length})]}),e.jsx("h1",{className:"text-3xl font-bold gradient-text mb-2",children:"Управление слотами"}),e.jsx("p",{className:"text-gray-600",children:"Создавайте временные слоты для уроков и управляйте своим расписанием"})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:()=>D(!1),title:"Закрыть",children:e.jsx(et,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Заявки на овербукинг"}),P.length===0?e.jsx("div",{className:"text-gray-500 text-center",children:"Нет новых заявок"}):e.jsx("div",{className:"space-y-2",children:P.map(q=>e.jsxs("div",{className:"flex items-center gap-2 border rounded-lg px-3 py-2 bg-purple-50 cursor-pointer hover:bg-purple-100 transition",onClick:()=>{O(q),R(!0)},children:[e.jsx("span",{className:"font-semibold text-purple-800",children:q.studentName}),e.jsx("span",{className:"text-xs text-gray-500",children:q.subject}),e.jsx("span",{className:"text-xs text-gray-500",children:q.startTime||"—"})]},q.id))})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>g(!0),className:"btn-primary flex items-center space-x-2",children:[e.jsx(pr,{className:"h-5 w-5"}),e.jsx("span",{children:"Создать новый слот"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700 mb-4",children:"Свободные слоты"}),W.length>0?e.jsx("div",{className:"space-y-4",children:W.map(q=>e.jsx(Ee,{slot:q,isBooked:!1,onClick:()=>he(q)},q.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет свободных слотов"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-green-700 mb-4",children:"Забронированные уроки"}),J.length>0?e.jsx("div",{className:"space-y-4",children:J.map(q=>e.jsx(te,{lesson:q,status:"scheduled",onClick:()=>xe(q)},q.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет забронированных уроков"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4",children:"Завершённые уроки"}),L.length>0?e.jsx("div",{className:"space-y-4",children:L.map(q=>e.jsx(te,{lesson:q,status:"completed",onClick:()=>xe(q)},q.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет завершённых уроков"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-purple-700 mb-4",children:"Овербукинг"}),e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет новых заявок"})]})]}),f&&e.jsx("div",{className:"fixed inset-0 modal-backdrop flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"modal-content bg-white rounded-2xl shadow-2xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold gradient-text",children:"Создать новый слот"}),e.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Предмет *"}),e.jsxs("select",{value:m.subject,onChange:q=>b({...m,subject:q.target.value}),className:"input-modern w-full",children:[e.jsx("option",{value:"",children:"Выберите предмет"}),ke.map(q=>e.jsx("option",{value:q,children:q},q))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Дата *"}),e.jsx("input",{type:"date",value:m.date,onChange:q=>b({...m,date:q.target.value}),className:"input-modern w-full",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Время начала *"}),e.jsx("input",{type:"time",value:m.startTime,onChange:q=>b({...m,startTime:q.target.value}),className:"input-modern w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Длительность"}),e.jsx("select",{value:m.duration,onChange:q=>b({...m,duration:parseInt(q.target.value)}),className:"input-modern w-full",children:rt.map(q=>e.jsxs("option",{value:q,children:[q," минут"]},q))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Цена (₽)"}),e.jsx("input",{type:"number",value:m.price,onChange:q=>b({...m,price:parseInt(q.target.value)}),className:"input-modern w-full",min:"100",step:"100"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Тип урока"}),e.jsx("select",{value:m.lessonType,onChange:q=>b({...m,lessonType:q.target.value}),className:"input-modern w-full",children:st.map(q=>e.jsx("option",{value:q,children:be(q)},q))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Формат"}),e.jsx("select",{value:m.format,onChange:q=>b({...m,format:q.target.value}),className:"input-modern w-full",children:He.map(q=>e.jsx("option",{value:q,children:X(q)},q))})]})]}),e.jsxs("div",{className:"flex space-x-4 pt-4",children:[e.jsx("button",{onClick:fe,className:"btn-primary flex-1",children:"Создать слот"}),e.jsx("button",{onClick:()=>g(!1),className:"btn-secondary flex-1",children:"Отмена"})]})]})]})})}),u&&(j||x)&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[e.jsx("button",{onClick:ve,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:j?"Детали слота":"Детали урока"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Предмет:"})," ",(j||x).subject]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Дата:"})," ",(j||x).date," ",(j||x).startTime," - ",(j||x).endTime]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Формат:"})," ",(j||x).format]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Цена:"})," ",(j||x).price,"₽"]}),j&&j.studentName&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",j.studentName]}),x&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",x.studentName]}),((x==null?void 0:x.comment)||(j==null?void 0:j.comment))&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-blue-900",children:[e.jsx("span",{className:"font-medium",children:"Комментарий ученика:"})," ",(x==null?void 0:x.comment)||(j==null?void 0:j.comment)]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[j&&j.isBooked&&j.studentId&&d&&e.jsxs("button",{onClick:()=>{a(d.id,j.studentId,d.name,j.studentName),ve()},className:"flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200",children:[e.jsx(Ae,{className:"w-5 h-5"})," Чат с учеником"]}),j&&j.isBooked&&j.format==="online"&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(At,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Видеозвонок"})]})}),j&&j.isBooked&&e.jsxs("button",{onClick:()=>{i(j.lessonId),ve()},className:"flex items-center gap-2 bg-amber-100 text-amber-700 px-4 py-2 rounded-lg hover:bg-amber-200",children:[e.jsx(Wr,{className:"w-5 h-5"})," Завершить урок"]}),j&&e.jsx("button",{onClick:()=>{o(j.id),ve()},className:"absolute top-4 left-4 text-red-500 hover:text-red-700",children:e.jsx(Gr,{className:"w-6 h-6"})}),x&&x.status==="scheduled"&&d&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{a(d.id,x.studentId,d.name,x.studentName),ve()},className:"flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200",children:[e.jsx(Ae,{className:"w-5 h-5"})," Чат с учеником"]}),x.format==="online"&&e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(At,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Видеозвонок"})]}),e.jsxs("button",{onClick:()=>{i(x.id),ve()},className:"flex items-center gap-2 bg-amber-100 text-amber-700 px-4 py-2 rounded-lg hover:bg-amber-200",children:[e.jsx(Wr,{className:"w-5 h-5"})," Завершить урок"]})]}),x&&x.status==="completed"&&e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg text-center text-gray-800",children:"Урок завершён"})]})]})}),z&&H&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[e.jsx("button",{onClick:()=>{R(!1),O(null)},className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Заявка на овербукинг"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",H.studentName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Предмет:"})," ",H.subject]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Класс:"})," ",H.grade]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Формат:"})," ",H.format]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Длительность:"})," ",H.duration," мин"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Время:"})," ",H.startTime||"—"," - ",H.endTime||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Цели:"})," ",Array.isArray(H.goals)?H.goals.join(", "):H.goals]}),H.comment&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-blue-900",children:[e.jsx("span",{className:"font-medium",children:"Комментарий:"})," ",H.comment]})]}),e.jsx("button",{className:"mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",onClick:()=>{$e(H),R(!1),O(null)},children:"Забронировать слот"})]})})]})},C4={ru:ft},$4=Ga({format:We,startOfWeek:Ot,getDay:Ya,locales:C4}),Vc=({mode:t,student:r,onAssign:s})=>{const{timeSlots:n,lessons:a,bookLesson:i,createSlot:o}=ct(),{user:l}=tt(),[c,d]=E.useState(null),[f,g]=E.useState(!1),[m,b]=E.useState(""),[j,h]=E.useState(!1),[u,w]=E.useState(!1),[x,S]=E.useState({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),[v,D]=E.useState(!1),[P,A]=E.useState(null),[H,O]=E.useState(!1),[z,R]=E.useState(""),K=n.filter(X=>{if(X.teacherId!==(l==null?void 0:l.id)||X.status==="completed")return!1;if(t==="assign"&&r){if(X.isBooked&&X.bookedStudentId!==r.id)return!1}else if(X.isBooked)return!1;return!0}),Y=a.filter(X=>X.teacherId===(l==null?void 0:l.id)&&X.status!=="completed"),ee=t==="assign"?n.filter(X=>X.teacherId===(l==null?void 0:l.id)&&X.status!=="completed"):K,B=t==="assign"?a.filter(X=>X.teacherId===(l==null?void 0:l.id)&&X.status!=="completed"):Y,V=ee.map(X=>({id:X.id,title:`${X.subject} - ${X.isBooked?"Забронирован":"Свободен"}`,start:new Date(`${X.date}T${X.startTime}`),end:new Date(`${X.date}T${X.endTime}`),resource:X,type:"slot",isBooked:X.isBooked,subject:X.subject,price:X.price,format:X.format,lessonType:X.lessonType})),I=B.map(X=>({id:X.id,title:`${X.subject} - ${X.studentName}`,start:new Date(`${X.date}T${X.startTime}`),end:new Date(`${X.date}T${X.endTime}`),resource:X,type:"lesson",studentName:X.studentName,subject:X.subject,price:X.price,format:X.format,status:X.status})),W=[...V,...I],J=E.useCallback(X=>{let be={borderRadius:"8px",border:"none",padding:"4px 8px",fontSize:"12px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",transition:"all 0.2s ease"};return X.type==="slot"?X.isBooked?(be.backgroundColor="#10b981",be.color="white"):(be.backgroundColor="#3b82f6",be.color="white"):X.type==="lesson"&&(be.backgroundColor="#f59e0b",be.color="white"),{style:be}},[]),L=E.useCallback(X=>{d(X),g(!0),b("")},[]),fe=()=>{g(!1),d(null),b("")},he=async X=>{t==="assign"&&r&&(await i(X.id,r.id,r.name),s&&s())},xe=E.useCallback(X=>{const{start:be,end:Ee}=X,te=We(be,"yyyy-MM-dd"),Ne=We(be,"HH:mm"),ke=We(Ee,"HH:mm");S({date:te,startTime:Ne,endTime:ke,subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),w(!0)},[]),ve=async()=>{if(!l||!x.subject.trim()){alert("Пожалуйста, заполните все обязательные поля");return}if(!x.startTime||!x.endTime||x.startTime>=x.endTime){alert("Проверьте корректность времени начала и окончания");return}D(!0);try{if(t==="assign"&&r){await o({...x,teacherId:l.id,teacherName:l.name,duration:60,lessonType:x.lessonType,format:x.format,experience:x.experience,goals:x.goals||[],grades:x.grades||[]},r.id,r.name,{mode:"assign"}),w(!1),S({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]});return}await o({...x,teacherId:l.id,teacherName:l.name,duration:60,lessonType:x.lessonType,format:x.format,experience:x.experience,goals:x.goals||[],grades:x.grades||[]}),w(!1),S({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),alert("Слот успешно создан!")}catch{alert("Ошибка при создании слота")}finally{D(!1)}},$e=async X=>{if(r){O(!0);try{await i(X.id,r.id,r.name),R(`Урок назначен для ${r.name}`),setTimeout(()=>{R(""),A(null),s&&s()},1200)}catch{alert("Ошибка при бронировании слота")}finally{O(!1)}}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 p-2",children:[e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-1",children:"Календарь занятий"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Управляйте своим расписанием и отслеживайте забронированные уроки"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"p-3",children:e.jsx(za,{localizer:$4,events:W,startAccessor:"start",endAccessor:"end",style:{height:400},eventPropGetter:J,onSelectEvent:L,onSelectSlot:xe,selectable:!0,views:["month","week","day"],messages:{next:"Следующий",previous:"Предыдущий",today:"Сегодня",month:"Месяц",week:"Неделя",day:"День",noEventsInRange:"Нет событий в выбранном диапазоне",showMore:X=>`+${X} еще`},className:"custom-calendar"})})}),e.jsxs("div",{className:"mt-3 bg-white rounded-lg shadow-sm border border-gray-100 p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Легенда"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Свободные слоты"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Забронированные слоты"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Запланированные уроки"})]})]})]})]}),f&&c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-xs w-full p-3 transform transition-all duration-300 scale-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900",children:c.type==="slot"?"Детали слота":"Детали урока"}),e.jsx("button",{onClick:fe,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Предмет:"}),e.jsx("p",{className:"text-xs text-gray-900",children:c.subject})]}),c.type==="slot"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Статус:"}),e.jsx("p",{className:`text-xs font-medium ${c.isBooked?"text-green-600":"text-blue-600"}`,children:c.isBooked?"Забронирован":"Свободен"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Тип урока:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:c.lessonType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Формат:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:c.format})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Цена:"}),e.jsxs("p",{className:"text-xs text-gray-900",children:[c.price," ₽"]})]}),!c.isBooked&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Имя студента для бронирования:"}),e.jsx("input",{type:"text",value:m,onChange:X=>b(X.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"Введите имя студента"}),e.jsx("button",{onClick:()=>he(c.resource),disabled:j,className:"mt-2 px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:j?"Бронирую...":"Забронировать слот"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Ученик:"}),e.jsx("p",{className:"text-xs text-gray-900",children:c.studentName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Статус:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:c.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Формат:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:c.format})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Цена:"}),e.jsxs("p",{className:"text-xs text-gray-900",children:[c.price," ₽"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Время:"}),e.jsxs("p",{className:"text-gray-900 text-xs",children:[We(c.start,"HH:mm")," - ",We(c.end,"HH:mm")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Дата:"}),e.jsx("p",{className:"text-gray-900 text-xs",children:We(c.start,"dd MMMM yyyy",{locale:ft})})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:fe,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Закрыть"})})]})}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-sm w-full p-4 transform transition-all duration-300 scale-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Создать новый слот"}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Предмет *"}),e.jsx("input",{type:"text",value:x.subject,onChange:X=>S({...x,subject:X.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"Например: Математика",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Время начала"}),e.jsx("input",{type:"time",value:x.startTime,onChange:X=>S({...x,startTime:X.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Время окончания"}),e.jsx("input",{type:"time",value:x.endTime,onChange:X=>S({...x,endTime:X.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Тип урока"}),e.jsxs("select",{value:x.lessonType,onChange:X=>S({...x,lessonType:X.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"regular",children:"Обычный"}),e.jsx("option",{value:"trial",children:"Пробный"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Формат"}),e.jsxs("select",{value:x.format,onChange:X=>S({...x,format:X.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"online",children:"Онлайн"}),e.jsx("option",{value:"offline",children:"Офлайн"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Цена (₽)"}),e.jsx("input",{type:"number",value:x.price,onChange:X=>S({...x,price:parseInt(X.target.value)||0}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"1000",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Опыт"}),e.jsxs("select",{value:x.experience,onChange:X=>S({...x,experience:X.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>w(!1),className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Отмена"}),e.jsx("button",{onClick:ve,disabled:v||!x.subject.trim(),className:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:v?"Создаю...":"Создать слот"})]})]})}),t==="assign"&&r&&P&&!P.isBooked&&e.jsx("button",{onClick:()=>$e(P),disabled:H,style:{marginTop:12,padding:"6px 16px",fontSize:14},children:H?"Назначение...":`Забронировать для ${r.name}`}),z&&e.jsx("div",{style:{color:"green",marginTop:8,fontSize:14},children:z})]})},E4={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},D4={background:"#fff",borderRadius:12,boxShadow:"0 2px 16px rgba(0,0,0,0.15)",padding:24,minWidth:320,maxHeight:"90vh",overflowY:"auto",position:"relative"},T4={position:"absolute",top:12,right:16,fontSize:24,background:"none",border:"none",cursor:"pointer",color:"#888"},hr=({open:t,onClose:r,children:s,style:n})=>t?e.jsx("div",{style:E4,onClick:r,children:e.jsxs("div",{style:{...D4,...n},onClick:a=>a.stopPropagation(),children:[e.jsx("button",{style:T4,onClick:r,"aria-label":"Закрыть",children:"×"}),s]})}):null,Ja=({onSubmit:t,onCancel:r,initialText:s="",isEditing:n=!1,userName:a="U",userAvatar:i})=>{const[o,l]=E.useState(s),[c,d]=E.useState([]),[f,g]=E.useState([]),m=E.useRef(null),b=w=>{const x=Array.from(w.target.files||[]);if(x.length===0)return;const S=[...c,...x];d(S);const v=x.map(D=>URL.createObjectURL(D));g([...f,...v]),m.current&&(m.current.value="")},j=w=>{const x=c.filter((v,D)=>D!==w),S=f.filter((v,D)=>D!==w);d(x),g(S)},h=()=>{if(!o.trim()&&c.length===0)return;const w=c.length>0?c.some(S=>S.type.startsWith("video/"))?"video":"image":"text",x={text:o.trim(),media:c,type:w};t(x),f.forEach(S=>URL.revokeObjectURL(S))},u=!o.trim()&&c.length===0;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center overflow-hidden",children:i?e.jsx("img",{src:i,alt:a,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:a.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{value:o,onChange:w=>l(w.target.value),placeholder:n?"Редактировать запись...":"Что нового?",className:"w-full border-none resize-none focus:ring-0 text-gray-900 placeholder-gray-500",rows:3}),f.length>0&&e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2",children:f.map((w,x)=>{var S;return e.jsxs("div",{className:"relative group",children:[(S=c[x])!=null&&S.type.startsWith("video/")?e.jsx("video",{src:w,className:"w-full h-24 object-cover rounded-lg",controls:!0}):e.jsx("img",{src:w,alt:"Preview",className:"w-full h-24 object-cover rounded-lg"}),e.jsx("button",{onClick:()=>j(x),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(et,{className:"w-3 h-3"})})]},x)})}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{var w;return(w=m.current)==null?void 0:w.click()},className:"p-2 text-gray-500 hover:text-blue-500 transition-colors",title:"Добавить фото или видео",children:e.jsx(_n,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-500 hover:text-blue-500 transition-colors",children:e.jsx(ra,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Отмена"}),e.jsx("button",{onClick:h,disabled:u,className:`px-4 py-2 rounded-lg font-medium transition-colors ${u?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:n?"Сохранить":"Опубликовать"})]})]})]})]}),e.jsx("input",{ref:m,type:"file",multiple:!0,accept:"image/*,video/*",onChange:b,className:"hidden"})]})},Qn=({post:t,onReaction:r,onComment:s,onShare:n,onBookmark:a,onEdit:i,onDelete:o})=>{const[l,c]=E.useState(!1),[d,f]=E.useState(""),[g,m]=E.useState(!1),[b,j]=E.useState(!1),h=v=>{r(t.id,v),j(!1)},u=()=>{d.trim()&&(s(t.id,d.trim()),f(""))},w=v=>{i&&(i(t.id,v),m(!1))},x=()=>{o&&o(t.id)},S=v=>{const D=new Date(v),A=Math.floor((new Date().getTime()-D.getTime())/(1e3*60*60));return A<1?"только что":A<24?`${A}ч назад`:A<48?"вчера":D.toLocaleDateString("ru-RU")};return t.reactions.reduce((v,D)=>v+D.count,0),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 mb-4",children:[e.jsx("div",{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:t.userAvatar?e.jsx("img",{src:t.userAvatar,alt:t.userName,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:t.userName.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.userName}),e.jsx("div",{className:"text-sm text-gray-500",children:S(t.date)})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Xo,{className:"w-5 h-5"})}),e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10",children:[i&&e.jsx("button",{onClick:()=>m(!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50",children:"Редактировать"}),o&&e.jsx("button",{onClick:x,className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50",children:"Удалить"})]})]})]})}),g&&i&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx(Ja,{onSubmit:({text:v})=>w(v),onCancel:()=>m(!1),initialText:t.text,isEditing:!0})}),!g&&e.jsxs(e.Fragment,{children:[t.text&&e.jsxs("div",{className:"px-4 pb-3",children:[e.jsx("p",{className:"text-gray-900 whitespace-pre-line",children:t.text}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:t.tags.map(v=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-700 font-medium",children:["#",v]},v))})]}),t.media&&t.media.length>0&&e.jsx("div",{className:"px-4 pb-3",children:t.type==="video"?e.jsxs("div",{className:"relative",children:[e.jsx("video",{src:t.media[0],className:"w-full rounded-lg",controls:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(_d,{className:"w-12 h-12 text-white opacity-80"})})]}):e.jsx("div",{className:`grid gap-2 ${t.media.length===1?"grid-cols-1":t.media.length===2?"grid-cols-2":"grid-cols-3"}`,children:t.media.map((v,D)=>e.jsx("div",{className:"relative aspect-square",children:e.jsx("img",{src:v,alt:"Post media",className:"w-full h-full object-cover rounded-lg"})},D))})}),(t.likes&&t.likes>0||t.comments.length>0||t.views&&t.views>0)&&e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[t.likes&&t.likes>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(xt,{className:"w-4 h-4 text-red-500 fill-current"}),e.jsx("span",{children:t.likes})]}),t.comments.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:t.comments.length})]}),t.views&&t.views>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(gr,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:t.views})]})]}),t.editedAt&&e.jsx("span",{className:"text-xs text-gray-400",children:"ред."})]})}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>j(!b),className:`flex items-center space-x-1 px-3 py-1 rounded-full transition-colors ${t.reactions.some(v=>v.userReacted)?"text-red-500 bg-red-50":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx(xt,{className:`w-5 h-5 ${t.reactions.some(v=>v.userReacted)?"fill-current":""}`}),e.jsx("span",{className:"text-sm",children:"Нравится"})]}),b&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>h("like"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Нравится",children:e.jsx(rl,{className:"w-6 h-6 text-blue-500"})}),e.jsx("button",{onClick:()=>h("love"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Любовь",children:e.jsx(xt,{className:"w-6 h-6 text-red-500"})}),e.jsx("button",{onClick:()=>h("smile"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Улыбка",children:e.jsx(ra,{className:"w-6 h-6 text-yellow-500"})})]})]}),e.jsxs("button",{onClick:()=>c(!l),className:"flex items-center space-x-1 px-3 py-1 rounded-full text-gray-500 hover:bg-gray-50 transition-colors",children:[e.jsx(Ae,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Комментировать"})]}),e.jsxs("button",{onClick:()=>n(t.id),className:"flex items-center space-x-1 px-3 py-1 rounded-full text-gray-500 hover:bg-gray-50 transition-colors",children:[e.jsx(Ad,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Поделиться"})]})]}),e.jsx("button",{onClick:()=>a(t.id),className:`p-2 rounded-full transition-colors ${t.isBookmarked?"text-blue-500 bg-blue-50":"text-gray-500 hover:bg-gray-50"}`,children:e.jsx(qs,{className:`w-5 h-5 ${t.isBookmarked?"fill-current":""}`})})]})}),l&&e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50",children:[e.jsx("div",{className:"space-y-3 mb-3",children:t.comments.map(v=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:v.userAvatar?e.jsx("img",{src:v.userAvatar,alt:v.userName,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-xs font-medium",children:v.userName.charAt(0).toUpperCase()})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"bg-white rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:v.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:S(v.date)})]}),e.jsx("p",{className:"text-sm text-gray-800",children:v.text})]})})]},v.id))}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:"U"})}),e.jsxs("div",{className:"flex-1 flex items-center space-x-2 bg-white rounded-full px-3 py-2",children:[e.jsx("input",{type:"text",value:d,onChange:v=>f(v.target.value),placeholder:"Написать комментарий...",className:"flex-1 border-none outline-none text-sm",onKeyPress:v=>v.key==="Enter"&&u()}),e.jsx("button",{onClick:u,disabled:!d.trim(),className:`p-1 rounded-full transition-colors ${d.trim()?"text-blue-500 hover:bg-blue-50":"text-gray-400"}`,children:e.jsx(Zo,{className:"w-4 h-4"})})]})]})]})]})]})},O4=({onSearchResults:t,onClose:r,className:s=""})=>{var V;const{posts:n,searchPosts:a}=ct(),[i,o]=E.useState(""),[l,c]=E.useState([]),[d,f]=E.useState("all"),[g,m]=E.useState(""),[b,j]=E.useState(""),[h,u]=E.useState(""),[w,x]=E.useState("date"),[S,v]=E.useState(!1),[D,P]=E.useState([]),[A,H]=E.useState(!1),O=E.useRef(),z=Array.from(new Set(n.flatMap(I=>I.tags||[]))).sort(),R=Array.from(new Set(n.map(I=>({id:I.userId,name:I.userName})))).filter((I,W,J)=>W===J.findIndex(L=>L.id===I.id)),K=()=>{H(!0);const I={query:i.trim()||void 0,tags:l.length>0?l:void 0,userId:g||void 0,dateFrom:b||void 0,dateTo:h||void 0,type:d==="all"?void 0:d,limit:50};let W=[...n];if(I.query){const J=I.query.toLowerCase();W=W.filter(L=>L.text.toLowerCase().includes(J)||L.userName.toLowerCase().includes(J))}I.tags&&I.tags.length>0&&(W=W.filter(J=>J.tags&&I.tags.some(L=>J.tags.includes(L)))),I.userId&&(W=W.filter(J=>J.userId===I.userId)),I.type&&(W=W.filter(J=>J.type===I.type)),I.dateFrom&&(W=W.filter(J=>J.date>=I.dateFrom)),I.dateTo&&(W=W.filter(J=>J.date<=I.dateTo)),W.sort((J,L)=>{switch(w){case"likes":return(L.likes||0)-(J.likes||0);case"comments":return L.comments.length-J.comments.length;case"views":return(L.views||0)-(J.views||0);case"date":default:return new Date(L.date).getTime()-new Date(J.date).getTime()}}),P(W),H(!1),t&&t(W),a(I)};E.useEffect(()=>(O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{i.trim()||l.length>0||g||d!=="all"||b||h?K():(P([]),t&&t([]))},300),()=>{O.current&&clearTimeout(O.current)}),[i,l,g,d,b,h,w]);const Y=()=>{o(""),c([]),m(""),f("all"),j(""),u(""),x("date"),P([]),t&&t([])},ee=I=>{c(W=>W.includes(I)?W.filter(J=>J!==I):[...W,I])},B=I=>{const W=new Date(I),L=Math.floor((new Date().getTime()-W.getTime())/(1e3*60*60));return L<1?"только что":L<24?`${L}ч назад`:L<48?"вчера":W.toLocaleDateString("ru-RU")};return e.jsxs("div",{className:`bg-white rounded-2xl shadow-lg border border-gray-200 ${s}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Поиск записей"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>v(!S),className:`p-2 rounded-full transition-colors ${S?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,title:"Фильтры",children:e.jsx(ea,{className:"w-5 h-5"})}),e.jsx("button",{onClick:Y,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Очистить поиск",children:e.jsx(et,{className:"w-5 h-5"})}),r&&e.jsx("button",{onClick:r,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Закрыть",children:e.jsx(et,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mt-4 relative",children:[e.jsx(zr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:i,onChange:I=>o(I.target.value),placeholder:"Поиск по записям...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),A&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"})})]}),(l.length>0||g||d!=="all"||b||h)&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[l.map(I=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-700",children:[e.jsx(Sd,{className:"w-3 h-3 mr-1"}),I,e.jsx("button",{onClick:()=>ee(I),className:"ml-2 hover:bg-blue-200 rounded-full p-0.5",children:e.jsx(et,{className:"w-3 h-3"})})]},I)),g&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-700",children:[e.jsx(ye,{className:"w-3 h-3 mr-1"}),((V=R.find(I=>I.id===g))==null?void 0:V.name)||g,e.jsx("button",{onClick:()=>m(""),className:"ml-2 hover:bg-green-200 rounded-full p-0.5",children:e.jsx(et,{className:"w-3 h-3"})})]}),d!=="all"&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 text-purple-700",children:[d==="text"&&e.jsx(er,{className:"w-3 h-3 mr-1"}),d==="image"&&e.jsx(_n,{className:"w-3 h-3 mr-1"}),d==="video"&&e.jsx(At,{className:"w-3 h-3 mr-1"}),d==="text"?"Текст":d==="image"?"Изображения":"Видео",e.jsx("button",{onClick:()=>f("all"),className:"ml-2 hover:bg-purple-200 rounded-full p-0.5",children:e.jsx(et,{className:"w-3 h-3"})})]})]})]}),S&&e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тип контента"}),e.jsxs("select",{value:d,onChange:I=>f(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Все типы"}),e.jsx("option",{value:"text",children:"Только текст"}),e.jsx("option",{value:"image",children:"С изображениями"}),e.jsx("option",{value:"video",children:"С видео"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Автор"}),e.jsxs("select",{value:g,onChange:I=>m(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Все авторы"}),R.map(I=>e.jsx("option",{value:I.id,children:I.name},I.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Сортировка"}),e.jsxs("select",{value:w,onChange:I=>x(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"date",children:"По дате"}),e.jsx("option",{value:"likes",children:"По лайкам"}),e.jsx("option",{value:"comments",children:"По комментариям"}),e.jsx("option",{value:"views",children:"По просмотрам"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата от"}),e.jsx("input",{type:"date",value:b,onChange:I=>j(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата до"}),e.jsx("input",{type:"date",value:h,onChange:I=>u(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),z.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Популярные теги"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:z.slice(0,10).map(I=>e.jsxs("button",{onClick:()=>ee(I),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${l.includes(I)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["#",I]},I))})]})]}),D.length>0&&e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Найдено ",D.length," записей"]})}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:D.map(I=>e.jsx("div",{className:"p-3 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center flex-shrink-0",children:I.userAvatar?e.jsx("img",{src:I.userAvatar,alt:I.userName,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:I.userName.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:I.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:B(I.date)}),I.type!=="text"&&e.jsx("span",{className:"text-xs text-gray-500",children:I.type==="image"?e.jsx(_n,{className:"w-3 h-3 inline"}):e.jsx(At,{className:"w-3 h-3 inline"})})]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2 mb-2",children:I.text}),I.tags&&I.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[I.tags.slice(0,3).map(W=>e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["#",W]},W)),I.tags.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",I.tags.length-3]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(xt,{className:"w-3 h-3"}),e.jsx("span",{children:I.likes||0})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"w-3 h-3"}),e.jsx("span",{children:I.comments.length})]}),I.views&&e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(gr,{className:"w-3 h-3"}),e.jsx("span",{children:I.views})]})]})]})]})},I.id))})]}),i.trim()&&D.length===0&&!A&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(zr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"По вашему запросу ничего не найдено"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Попробуйте изменить параметры поиска"})]})]})},M4=({className:t=""})=>{const{notifications:r,markNotificationAsRead:s,markAllNotificationsAsRead:n,deleteNotification:a}=ct(),{user:i}=tt(),[o,l]=E.useState(!1),[c,d]=E.useState(!1),[f,g]=E.useState("all"),m=E.useRef(null),b=r.filter(v=>!v.isRead).length;E.useEffect(()=>{const v=D=>{m.current&&!m.current.contains(D.target)&&l(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const j=r.filter(v=>f==="unread"?!v.isRead:f==="read"?v.isRead:!0),h=c?j:j.slice(0,5),u=v=>{switch(v){case"new_post":return e.jsx(er,{className:"w-5 h-5 text-blue-500"});case"reaction":return e.jsx(xt,{className:"w-5 h-5 text-red-500"});case"comment":return e.jsx(Ae,{className:"w-5 h-5 text-green-500"});case"new_message":return e.jsx(Ae,{className:"w-5 h-5 text-blue-500"});case"follow":return e.jsx(sa,{className:"w-5 h-5 text-purple-500"});case"lesson_reminder":return e.jsx(Ke,{className:"w-5 h-5 text-orange-500"});case"system":return e.jsx(Ys,{className:"w-5 h-5 text-gray-500"});default:return e.jsx(Ur,{className:"w-5 h-5 text-gray-500"})}},w=v=>{const D=new Date(v),A=Math.floor((new Date().getTime()-D.getTime())/(1e3*60));return A<1?"только что":A<60?`${A}м назад`:A<1440?`${Math.floor(A/60)}ч назад`:D.toLocaleDateString("ru-RU")},x=()=>{i&&n(i.id)},S=v=>{var D,P;v.isRead||s(v.id),v.type==="new_message"&&((D=v.data)!=null&&D.chatId)?(window.location.href=`#chat-${v.data.chatId}`,l(!1)):(P=v.data)!=null&&P.postId};return e.jsxs("div",{className:`relative ${t}`,ref:m,children:[e.jsxs("button",{onClick:()=>l(!o),className:"relative p-2 rounded-full hover:bg-gray-100 transition-colors",children:[e.jsx(Ur,{className:"w-6 h-6 text-gray-600"}),b>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:b>99?"99+":b})]}),o&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 bg-white rounded-2xl shadow-2xl border border-gray-200 z-50 max-h-[600px] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Уведомления"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[b>0&&e.jsx("button",{onClick:x,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Отметить все как прочитанные"}),e.jsx("button",{onClick:()=>l(!1),className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(et,{className:"w-4 h-4 text-gray-500"})})]})]}),e.jsx("div",{className:"flex items-center space-x-2 mt-3",children:[{key:"all",label:"Все",count:r.length},{key:"unread",label:"Непрочитанные",count:b},{key:"read",label:"Прочитанные",count:r.length-b}].map(({key:v,label:D,count:P})=>e.jsxs("button",{onClick:()=>g(v),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${f===v?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[D," (",P,")"]},v))})]}),e.jsx("div",{className:"overflow-y-auto max-h-[400px]",children:h.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Ur,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsxs("p",{className:"text-gray-500",children:[f==="all"&&"Нет уведомлений",f==="unread"&&"Нет непрочитанных уведомлений",f==="read"&&"Нет прочитанных уведомлений"]})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:h.map(v=>e.jsx("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${v.isRead?"":"bg-blue-50"}`,onClick:()=>S(v),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:u(v.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:v.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:v.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:w(v.createdAt)})]}),!v.isRead&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center space-x-1",children:[!v.isRead&&e.jsx("button",{onClick:D=>{D.stopPropagation(),s(v.id)},className:"p-1 rounded-full hover:bg-green-100 transition-colors",title:"Отметить как прочитанное",children:e.jsx(bd,{className:"w-4 h-4 text-green-600"})}),e.jsx("button",{onClick:D=>{D.stopPropagation(),a(v.id)},className:"p-1 rounded-full hover:bg-red-100 transition-colors",title:"Удалить",children:e.jsx(Gr,{className:"w-4 h-4 text-red-600"})})]})]})},v.id))})}),j.length>5&&e.jsx("div",{className:"p-4 border-t border-gray-100",children:e.jsx("button",{onClick:()=>d(!c),className:"w-full flex items-center justify-center space-x-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:c?e.jsxs(e.Fragment,{children:[e.jsx(jd,{className:"w-4 h-4"}),e.jsx("span",{children:"Показать меньше"})]}):e.jsxs(e.Fragment,{children:[e.jsx(yd,{className:"w-4 h-4"}),e.jsxs("span",{children:["Показать все (",j.length,")"]})]})})})]})]})},_4=({posts:t,currentUserId:r,currentUserName:s,currentUserAvatar:n,onCreatePost:a,onReaction:i,onComment:o,onShare:l,onBookmark:c,onEdit:d,onDelete:f,showCreateButton:g=!0,title:m="Записи",showSearch:b=!0,showNotifications:j=!0,showTrending:h=!0,showBookmarks:u=!0})=>{const[w,x]=E.useState(!1),[S,v]=E.useState(!1),[D,P]=E.useState("all"),[A,H]=E.useState(t),[O,z]=E.useState([]);E.useEffect(()=>{let K=t;D==="my"?K=t.filter(Y=>Y.userId===r):D==="others"?K=t.filter(Y=>Y.userId!==r):D==="trending"?K=[...t].sort((Y,ee)=>{const B=(Y.likes||0)+Y.comments.length;return(ee.likes||0)+ee.comments.length-B}).slice(0,20):D==="bookmarks"&&(K=t.filter(Y=>{var ee;return(ee=Y.bookmarks)==null?void 0:ee.includes(r)})),H(K)},[t,D,r]);const R=K=>{a(K),x(!1)};return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:m}),e.jsxs("div",{className:"flex items-center space-x-2",children:[j&&e.jsx(M4,{className:"mr-2"}),b&&e.jsx("button",{onClick:()=>v(!S),className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Поиск",children:e.jsx(zr,{className:"w-5 h-5"})}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:D,onChange:K=>P(K.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg px-3 py-2 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Все записи"}),e.jsx("option",{value:"my",children:"Мои записи"}),e.jsx("option",{value:"others",children:"Записи других"}),h&&e.jsx("option",{value:"trending",children:"Популярные"}),u&&e.jsx("option",{value:"bookmarks",children:"Закладки"})]}),e.jsx(ea,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]}),g&&e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(pr,{className:"w-4 h-4"}),e.jsx("span",{children:"Создать запись"})]})]})]}),S&&e.jsx("div",{className:"mb-6",children:e.jsx(O4,{onSearchResults:z,onClose:()=>v(!1)})}),w&&e.jsx("div",{className:"mb-6",children:e.jsx(Ja,{onSubmit:R,onCancel:()=>x(!1),userName:s,userAvatar:n})}),e.jsxs("div",{className:"space-y-4",children:[O.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Результаты поиска (",O.length,")"]}),e.jsx("div",{className:"space-y-4",children:O.map(K=>e.jsx(Qn,{post:K,currentUserId:r,onReaction:i,onComment:o,onShare:l,onBookmark:c,onEdit:d,onDelete:f},K.id))})]}),A.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"text-gray-400 text-lg mb-2",children:[D==="all"&&"Пока нет записей",D==="my"&&"У вас пока нет записей",D==="others"&&"Пока нет записей от других",D==="trending"&&"Пока нет популярных записей",D==="bookmarks"&&"У вас пока нет закладок"]}),e.jsxs("p",{className:"text-gray-500",children:[D==="my"&&g&&"Создайте первую запись!",D==="others"&&"Записи от других пользователей появятся здесь",D==="trending"&&"Популярные записи появятся здесь",D==="bookmarks"&&"Добавляйте записи в закладки!"]})]}):A.map(K=>e.jsx(Qn,{post:K,currentUserId:r,onReaction:i,onComment:o,onShare:l,onBookmark:c,onEdit:d,onDelete:f},K.id))]})]})},P4=({userId:t,onClose:r,onMessage:s,onBookLesson:n,isModal:a=!1})=>{const{user:i}=tt(),{posts:o,createPost:l,addReaction:c,addComment:d,sharePost:f,bookmarkPost:g,editPost:m,deletePost:b,allUsers:j}=ct(),[h,u]=E.useState(!1),[w,x]=E.useState(!1),[S,v]=E.useState(!1),[D,P]=E.useState("posts"),A=j.find(B=>B.id===t),H=(i==null?void 0:i.id)===t,O=(A==null?void 0:A.role)==="teacher",z=o.filter(B=>B.userId===t),R=A==null?void 0:A.profile,K=B=>{switch(B){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return B}},Y=B=>{switch(B){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return B}};if(!A)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ye,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пользователь не найден"}),e.jsx("p",{className:"text-gray-500",children:"Пользователь с таким ID не существует"})]})});const ee=()=>{var B;return e.jsx("div",{className:`${a?"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4":""}`,children:e.jsxs("div",{className:`bg-white rounded-3xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto relative ${a?"":"border border-gray-200"}`,children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[r&&e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Zn,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!H&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>x(!w),className:`p-2 rounded-full transition-colors ${w?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(qs,{className:`w-5 h-5 ${w?"fill-current":""}`})}),e.jsx("button",{onClick:()=>u(!h),className:`p-2 rounded-full transition-colors ${h?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(xt,{className:`w-5 h-5 ${h?"fill-current":""}`})})]}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Bt,{className:"w-5 h-5"})}),H&&e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ys,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsxs("div",{className:"h-56 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"}),e.jsx("div",{className:"absolute bottom-6 left-8 right-8",children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"text-white flex-1 mr-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 leading-tight",children:(R==null?void 0:R.name)||A.name||"Пользователь"}),e.jsxs("div",{className:"flex items-center space-x-4 flex-wrap",children:[O&&(R==null?void 0:R.experience)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Wt,{className:"h-4 w-4 text-yellow-300"}),e.jsx("span",{className:"font-semibold text-xs",children:K(R.experience)})]}),(R==null?void 0:R.rating)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx($t,{className:"h-4 w-4 text-yellow-300 fill-current"}),e.jsx("span",{className:"font-semibold text-xs",children:R.rating})]}),(R==null?void 0:R.city)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-xs",children:R.city})]})]})]}),e.jsxs("div",{className:"text-right text-white/90 flex-shrink-0",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:z.length}),e.jsx("div",{className:"text-sm opacity-80",children:"записей"})]})]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start mt-8",children:[e.jsxs("div",{className:"flex-shrink-0 -mt-12 ml-8 relative",children:[e.jsxs("div",{className:"w-36 h-36 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-6 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-3 border-white rounded-full shadow-lg"}),R!=null&&R.avatar&&R.avatar.trim()!==""?e.jsx("img",{src:R.avatar,alt:A.name,className:"w-36 h-36 object-cover rounded-full",onError:V=>{var W;const I=V.target;I.style.display="none",(W=I.nextElementSibling)==null||W.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-36 h-36 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${R!=null&&R.avatar&&R.avatar.trim()!==""?"hidden":""}`,children:e.jsx(ye,{className:"h-20 w-20 text-white"})})]}),!H&&e.jsxs("div",{className:"absolute -bottom-2 -right-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>u(!h),className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${h?"bg-red-500 text-white scale-110":"bg-white text-gray-600 hover:bg-red-50 hover:text-red-500"}`,children:e.jsx(xt,{className:`w-5 h-5 ${h?"fill-current":""}`})}),e.jsx("button",{className:"w-10 h-10 rounded-full bg-white text-gray-600 hover:bg-gray-50 shadow-lg transition-all duration-200 flex items-center justify-center",children:e.jsx(Bt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-wrap gap-4 mt-12 lg:mt-0",children:[!H&&e.jsxs(e.Fragment,{children:[O&&n&&e.jsxs("button",{onClick:()=>n(A.id),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Be,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Записаться на урок"})]}),s&&e.jsxs("button",{onClick:()=>s(A.id),className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-2xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ae,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Написать сообщение"})]}),e.jsxs("button",{onClick:()=>v(!S),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(gr,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Контактная информация"})]})]}),H&&e.jsxs("button",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(el,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Редактировать профиль"})]})]})]})]}),S&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 mb-8 mt-8 border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-lg",children:"Контактная информация"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[A.phone&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(xr,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:A.phone})]}),A.email&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(ta,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:A.email})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6 mt-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:z.length}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Записей"})]}),O&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(R==null?void 0:R.lessonsCount)||0}),e.jsx("div",{className:"text-green-100 text-xs",children:"Проведено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:((B=R==null?void 0:R.students)==null?void 0:B.length)||0}),e.jsx("div",{className:"text-purple-100 text-xs",children:"Учеников"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 to-orange-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(R==null?void 0:R.rating)||0}),e.jsx("div",{className:"text-orange-100 text-xs",children:"Рейтинг"})]})]}),!O&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-green-100 text-xs",children:"Посещено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-purple-100 text-xs",children:"Преподавателей"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 to-orange-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-orange-100 text-xs",children:"Дней в системе"})]})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8 mt-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"posts",label:"Записи",count:z.length},{id:"about",label:"О пользователе",count:null},{id:"lessons",label:O?"Расписание":"Мои уроки",count:0},{id:"reviews",label:"Отзывы",count:0}].map(V=>e.jsxs("button",{onClick:()=>P(V.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${D===V.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[V.label,V.count!==null&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2 rounded-full text-xs",children:V.count})]},V.id))})}),e.jsxs("div",{className:"min-h-[400px]",children:[D==="posts"&&e.jsx("div",{className:"space-y-6",children:e.jsx(_4,{posts:z,currentUserId:(i==null?void 0:i.id)||"",currentUserName:(i==null?void 0:i.name)||"",currentUserAvatar:i==null?void 0:i.avatar,onCreatePost:l,onReaction:c,onComment:d,onShare:f,onBookmark:g,onEdit:m,onDelete:b,showCreateButton:H,title:`Записи ${(R==null?void 0:R.name)||A.name}`,showSearch:!0,showNotifications:!1,showTrending:!1,showBookmarks:!0})}),D==="about"&&e.jsxs("div",{className:"space-y-3",children:[(R==null?void 0:R.bio)&&e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-indigo-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-indigo-500 to-purple-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"О пользователе"]}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm rounded-md p-2 border border-indigo-200/50",children:e.jsx("p",{className:"text-indigo-800 leading-relaxed whitespace-pre-line text-xs",children:R.bio})})]}),O&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[(R==null?void 0:R.subjects)&&R.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Предметы"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:R.subjects.map((V,I)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium border border-blue-200/50 shadow-sm",children:V},I))})]}),(R==null?void 0:R.grades)&&R.grades.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-emerald-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 to-teal-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Классы"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:R.grades.map((V,I)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-emerald-800 px-2 py-0.5 rounded-md text-xs font-medium border border-emerald-200/50 shadow-sm",children:V},I))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2.5",children:[(R==null?void 0:R.hourlyRate)&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-200 rounded-lg p-2.5 text-center shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-purple-900 mb-1.5 flex items-center justify-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-purple-500 to-violet-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Стоимость"]}),e.jsxs("div",{className:"text-base font-bold text-purple-700 bg-white/60 backdrop-blur-sm rounded-md py-1 px-1.5 border border-purple-200/50",children:[R.hourlyRate," ₽/час"]})]}),(R==null?void 0:R.formats)&&R.formats.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-orange-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-orange-500 to-amber-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Форматы"]}),e.jsx("div",{className:"space-y-1",children:R.formats.map((V,I)=>e.jsxs("div",{className:"flex items-center space-x-1.5 p-1 bg-white/60 backdrop-blur-sm rounded border border-orange-200/50",children:[e.jsx(Ht,{className:"h-3 w-3 text-orange-600"}),e.jsx("span",{className:"text-orange-800 text-xs font-medium",children:Y(V)})]},I))})]}),(R==null?void 0:R.durations)&&R.durations.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 border border-cyan-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-cyan-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-cyan-500 to-blue-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Длительность"]}),e.jsx("div",{className:"space-y-1",children:R.durations.map((V,I)=>e.jsxs("div",{className:"flex items-center space-x-1.5 p-1 bg-white/60 backdrop-blur-sm rounded border border-cyan-200/50",children:[e.jsx(Ht,{className:"h-3 w-3 text-cyan-600"}),e.jsxs("span",{className:"text-cyan-800 text-xs font-medium",children:[V," минут"]})]},I))})]})]})]}),!O&&R&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[R.subjects&&R.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Интересуется предметами"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:R.subjects.map((V,I)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium border border-blue-200/50 shadow-sm",children:V},I))})]}),R.grade&&e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-emerald-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 to-teal-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Класс"]}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm text-emerald-800 px-2 py-1 rounded-md text-xs font-medium border border-emerald-200/50 shadow-sm",children:R.grade})]})]})]}),D==="lessons"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ke,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:O?"Расписание пока не настроено":"Уроки пока не запланированы"}),e.jsx("p",{className:"text-gray-500",children:O?"Настройте расписание для проведения уроков":"Запишитесь на уроки к преподавателям"})]}),D==="reviews"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx($t,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пока нет отзывов"}),e.jsx("p",{className:"text-gray-500",children:"Отзывы о пользователе появятся здесь"})]})]})]})]})})};return a?e.jsx(ee,{}):e.jsx(ee,{})},A4=()=>{const{lessons:t,studentProfiles:r,createSlot:s,bookLesson:n}=ct(),{user:a}=tt(),[i,o]=E.useState(),[l,c]=E.useState(!1),[d,f]=E.useState(!1),[g,m]=E.useState(null),[b,j]=E.useState({subject:"",date:"",startTime:"",endTime:"",duration:60,lessonType:"regular",format:"online",price:1e3,experience:"beginner",grades:[],goals:[]}),[h,u]=E.useState(!1),[w,x]=E.useState(""),[S,v]=E.useState(!1),[D,P]=E.useState(null),[A,H]=E.useState(null),O=t.filter(W=>W.teacherId===(a==null?void 0:a.id)),z={};O.forEach(W=>{z[W.studentId]||(z[W.studentId]={studentName:W.studentName,studentId:W.studentId,lessons:[]}),z[W.studentId].lessons.push(W)});const R=Object.values(z),K=(W,J)=>{alert(`Чат с ${J} открыт! Перейдите в раздел 'Чаты' для общения.`)},Y=W=>{o(W),c(!0)},ee=()=>{c(!1),o(null)},B=W=>{P(W),v(!0)},V=async()=>{if(!(!a||!g)){u(!0),x("");try{await s({...b,teacherId:a.id,teacherName:a.name},g.id,g.name,{mode:"assign"}),f(!1)}catch{x("Ошибка при создании или бронировании слота")}finally{u(!1)}}},I=i?r[i.studentId]:void 0;return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Ученики"}),e.jsx("p",{className:"text-gray-600",children:"Здесь отображаются все ученики, которые бронировали у вас уроки, и история ваших занятий с ними"})]}),R.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(ye,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Пока нет учеников"}),e.jsx("p",{className:"text-gray-600",children:"Ученики появятся здесь после бронирования уроков"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:R.map(W=>e.jsx("div",{className:"card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden cursor-pointer",onClick:()=>Y(W),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:e.jsx(ye,{className:"h-6 w-6 text-white"})}),e.jsx("div",{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:W.studentName})}),e.jsxs("div",{className:"ml-auto flex items-center space-x-1",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-blue-600",title:"Просмотреть записи",onClick:J=>{J.stopPropagation(),H(W.studentId)},children:e.jsx(er,{className:"h-5 w-5"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-blue-600",title:"Подробнее о профиле",onClick:J=>{J.stopPropagation(),Y(W)},children:e.jsx(Cd,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-md font-bold text-gray-800 mb-2 flex items-center",children:[e.jsx(Ke,{className:"h-4 w-4 mr-1 text-blue-500"}),"Забронированные уроки"]}),W.lessons.length===0?e.jsx("div",{className:"text-gray-500 text-sm",children:"Нет уроков"}):e.jsx("ul",{className:"space-y-2",children:W.lessons.map(J=>e.jsxs("li",{className:"flex items-center justify-between bg-gray-50 rounded px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:J.subject}),e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:[J.date," ",J.startTime,"-",J.endTime]}),e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",J.status==="completed"?"Завершен":"Запланирован",")"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:L=>{L.stopPropagation(),K(W.studentId,W.studentName)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded-full",title:"Чат с учеником",children:e.jsx(Ae,{className:"h-4 w-4"})})})]},J.id))})]})]})},W.studentId))}),l&&i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:ee,title:"Закрыть",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[I!=null&&I.avatar&&I.avatar.trim()!==""?e.jsx("img",{src:I.avatar,alt:"avatar",className:"w-20 h-20 rounded-full object-cover mb-2",onError:W=>{var L;const J=W.target;J.style.display="none",(L=J.nextElementSibling)==null||L.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-20 h-20 rounded-full bg-gradient-to-r from-blue-400 to-indigo-500 flex items-center justify-center mb-2 ${I!=null&&I.avatar&&I.avatar.trim()!==""?"hidden":""}`,children:e.jsx(ye,{className:"h-10 w-10 text-white"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:i.studentName})]}),e.jsxs("div",{className:"space-y-2",children:[(I==null?void 0:I.grade)&&e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx("span",{className:"font-semibold mr-2",children:"Класс:"})," ",I.grade]}),(I==null?void 0:I.subjects)&&I.subjects.length>0&&e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx("span",{className:"font-semibold mr-2",children:"Предметы:"})," ",I.subjects.join(", ")]}),(I==null?void 0:I.bio)&&e.jsxs("div",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold mr-2",children:"О себе:"})," ",I.bio]}),!I&&e.jsx("div",{className:"text-gray-400 text-sm",children:"Профиль не заполнен"}),e.jsx("button",{onClick:()=>B({id:i.studentId,name:i.studentName}),className:"btn btn-primary mt-4",children:"Назначить урок"})]})]})}),d&&g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:()=>f(!1),title:"Закрыть",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("h3",{children:["Назначить урок для ",g.name]}),e.jsxs("form",{className:"flex flex-col gap-2",children:[e.jsx("input",{type:"text",placeholder:"Предмет",value:b.subject,onChange:W=>j({...b,subject:W.target.value}),required:!0}),e.jsx("input",{type:"date",value:b.date,onChange:W=>j({...b,date:W.target.value}),required:!0}),e.jsx("input",{type:"time",value:b.startTime,onChange:W=>j({...b,startTime:W.target.value}),required:!0}),e.jsx("input",{type:"time",value:b.endTime,onChange:W=>j({...b,endTime:W.target.value}),required:!0}),e.jsx("input",{type:"number",placeholder:"Цена",value:b.price,onChange:W=>j({...b,price:Number(W.target.value)})}),e.jsxs("select",{value:b.lessonType,onChange:W=>j({...b,lessonType:W.target.value}),children:[e.jsx("option",{value:"regular",children:"Обычный"}),e.jsx("option",{value:"trial",children:"Пробный"})]}),e.jsxs("select",{value:b.format,onChange:W=>j({...b,format:W.target.value}),children:[e.jsx("option",{value:"online",children:"Онлайн"}),e.jsx("option",{value:"offline",children:"Оффлайн"})]}),e.jsxs("select",{value:b.experience,onChange:W=>j({...b,experience:W.target.value}),children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"})]}),w&&e.jsx("div",{className:"text-red-500",children:w}),e.jsx("button",{type:"button",className:"btn btn-success mt-2",onClick:V,disabled:h,children:h?"Назначение...":"Назначить"})]})]})}),S&&D&&e.jsx(hr,{open:S,onClose:()=>v(!1),children:e.jsxs("div",{style:{minWidth:1100,minHeight:600,maxWidth:"98vw"},children:[e.jsxs("h2",{style:{marginBottom:16},children:["Назначить урок для ",D.name]}),e.jsx(Vc,{mode:"assign",student:D,onAssign:()=>v(!1)})]})}),A&&e.jsx(P4,{userId:A,onClose:()=>H(null),onMessage:W=>{H(null)},onBookLesson:W=>{H(null)},isModal:!0})]})},R4=({setActiveTab:t})=>{const{lessons:r,cancelLesson:s,rescheduleLesson:n,getOrCreateChat:a}=ct(),{user:i}=tt(),[o,l]=E.useState(!1),[c,d]=E.useState(null),[f,g]=E.useState(""),[m,b]=E.useState(""),j=r.filter(O=>O.studentId===(i==null?void 0:i.id)),h=j.filter(O=>O.status==="scheduled"),u=j.filter(O=>O.status==="completed"),w=(O,z)=>{i&&a(i.id,O,i.name,z)},x=O=>{window.confirm("Вы уверены, что хотите отменить урок?")&&s(O)},S=()=>{c&&f&&m&&(n(c.id,f,m),l(!1),d(null),g(""),b(""))},v=O=>{d(O),g(O.date),b(O.startTime),l(!0)},D=O=>{switch(O){case"online":return e.jsx(At,{className:"h-4 w-4"});case"offline":return e.jsx(Ct,{className:"h-4 w-4"});case"mini-group":return e.jsx(sa,{className:"h-4 w-4"});default:return e.jsx(At,{className:"h-4 w-4"})}},P=O=>{switch(O){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return O}},A=O=>O==="scheduled"?e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-sm",children:[e.jsx(Rd,{className:"h-4 w-4 mr-2"}),"Запланирован"]}):e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-green-500 to-green-600 text-white shadow-sm",children:[e.jsx(Wr,{className:"h-4 w-4 mr-2"}),"Завершен"]}),H=({lesson:O,isScheduled:z})=>e.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden border border-gray-100 hover:border-blue-200",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 p-4 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white opacity-10 rounded-full -translate-y-12 translate-x-12"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 bg-white opacity-10 rounded-full translate-y-8 -translate-x-8"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold mb-1",children:O.subject}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-200"}),e.jsx("span",{className:"text-blue-100 text-sm font-medium",children:O.teacherName})]})]}),A(O.status)]}),e.jsxs("div",{className:"flex items-center space-x-3 text-blue-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[D(O.format),e.jsx("span",{className:"text-xs font-medium",children:P(O.format)})]}),O.lessonType==="trial"&&e.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-400 bg-opacity-20 px-2 py-1 rounded-full",children:[e.jsx($t,{className:"h-3 w-3 text-yellow-300"}),e.jsx("span",{className:"text-yellow-200 text-xs font-medium",children:"Пробный"})]})]})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-md",children:e.jsx(Ke,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Дата"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:O.date})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 rounded-md",children:e.jsx(Ht,{className:"h-4 w-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Время"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[O.startTime," - ",O.endTime]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-green-100 rounded-md",children:e.jsx(Id,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Длительность"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[O.duration," мин"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Стоимость"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[O.price,"₽"]})]})]}),z&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>w(O.teacherId,O.teacherName),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg text-sm font-medium hover:from-blue-600 hover:to-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Чат"})]}),O.format==="online"&&e.jsxs("button",{className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg text-sm font-medium hover:from-purple-600 hover:to-purple-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:[e.jsx(At,{className:"h-4 w-4"}),e.jsx("span",{children:"Видеозвонок"})]})]}),e.jsxs("div",{className:"flex space-x-2 pt-2 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>v(O),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 text-orange-600 bg-orange-50 hover:bg-orange-100 rounded-lg text-sm font-medium transition-all duration-200 border border-orange-200 hover:border-orange-300",children:[e.jsx(el,{className:"h-3 w-3"}),e.jsx("span",{children:"Перенести"})]}),e.jsxs("button",{onClick:()=>x(O.id),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm font-medium transition-all duration-200 border border-red-200 hover:border-red-300",children:[e.jsx(Gr,{className:"h-3 w-3"}),e.jsx("span",{children:"Отменить"})]})]})]}),!z&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 py-2 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[e.jsx(Wr,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-700 text-sm font-medium",children:"Урок успешно завершен"})]})]}),e.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-3 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent",children:"Мои уроки"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed",children:"Управляйте вашими запланированными и завершенными уроками. Отслеживайте прогресс и достигайте новых высот в обучении."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ke,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:h.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Запланировано"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Wr,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:u.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Завершено"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(sl,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:j.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Всего уроков"})]})]})})]}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ke,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Запланированные уроки"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ваши предстоящие занятия"})]})]}),h.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(O=>e.jsx(H,{lesson:O,isScheduled:!0},O.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md border border-gray-100",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ke,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Нет запланированных уроков"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"Забронируйте свой первый урок на главной странице и начните свой путь к знаниям"}),e.jsxs("button",{onClick:()=>{console.log("🎯 Переход к главной странице для бронирования урока"),t("home")},className:"inline-flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[e.jsx(Wd,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать урок"})]})]})]}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Wt,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Завершенные уроки"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ваши достижения и пройденный материал"})]})]}),u.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(O=>e.jsx(H,{lesson:O,isScheduled:!1},O.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md border border-gray-100",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-green-100 to-emerald-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Wt,{className:"h-8 w-8 text-green-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Нет завершенных уроков"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"После завершения уроков здесь будут отображаться ваши достижения и прогресс"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-medium",children:[e.jsx(tl,{className:"h-4 w-4"}),e.jsx("span",{children:"Достижения появятся здесь"})]})]})]}),e.jsx("div",{className:"text-center py-12 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-2xl text-white shadow-xl",children:e.jsxs("div",{className:"max-w-xl mx-auto px-6",children:[e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Готовы к следующему уроку?"}),e.jsx("p",{className:"text-lg text-blue-100 mb-6",children:"Продолжайте обучение и достигайте новых высот вместе с нашими преподавателями"}),e.jsxs("button",{onClick:()=>{console.log("🔍 Переход к главной странице для поиска преподавателя"),t("home")},className:"inline-flex items-center space-x-2 px-6 py-3 bg-white text-blue-600 rounded-lg font-semibold text-base hover:bg-gray-50 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[e.jsx(Md,{className:"h-5 w-5"}),e.jsx("span",{children:"Найти преподавателя"})]})]})})]}),o&&c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full shadow-2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Перенести урок"}),e.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(et,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Урок:"})," ",c.subject," с ",c.teacherName]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Новая дата"}),e.jsx("input",{type:"date",value:f,onChange:O=>g(O.target.value),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Новое время"}),e.jsx("input",{type:"time",value:m,onChange:O=>b(O.target.value),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-8",children:[e.jsx("button",{onClick:S,disabled:!f||!m,className:"flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 px-6 rounded-xl font-semibold hover:from-blue-600 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Перенести урок"}),e.jsx("button",{onClick:()=>l(!1),className:"px-8 py-4 border-2 border-gray-300 rounded-xl text-gray-700 font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"Отмена"})]})]})})})]})},I4=()=>{const{chats:t,sendMessage:r,sendMessageToUser:s,allUsers:n,setAllUsers:a,teacherProfiles:i,studentProfiles:o,lessons:l,deleteChat:c,markChatAsRead:d,clearChatMessages:f,archiveChat:g,unarchiveChat:m,getOrCreateChat:b,loadChatsFromServer:j}=ct(),{user:h}=tt(),[u,w]=E.useState(null),[x,S]=E.useState(""),[v,D]=E.useState(""),[P,A]=E.useState(!1),[H,O]=E.useState(null),[z,R]=E.useState([]),[K,Y]=E.useState(null),[ee,B]=E.useState(null),[V,I]=E.useState(!1),[W,J]=E.useState(!1),[L,fe]=E.useState(!1),[he,xe]=E.useState(!1),[ve,$e]=E.useState(!1),[X,be]=E.useState(""),Ee=E.useRef(null),te=E.useRef(null),{socketRef:Ne}=ct(),ke=()=>{var F;(F=Ee.current)==null||F.scrollIntoView({behavior:"smooth"})};E.useEffect(()=>{ke()},[u,t]),E.useEffect(()=>{h&&(console.log("ChatList: Loading chats for user:",h.id),j())},[h,j]),E.useEffect(()=>{if(t.length>0&&!u){const F=t.find(Z=>Z.participants.includes((h==null?void 0:h.id)||"")&&!Z.archived);F&&w(F.id)}},[t,u,h]),E.useEffect(()=>{var F;if(u&&h){const Z=t.find(me=>me.id===u);Z&&((F=Z.messages)!=null&&F.some(k=>k.senderId!==h.id&&!k.isRead))&&d(u)}},[u,t,h,d]);const rt=F=>{let Z=n.find(me=>me.id===F);if(!Z){const me=i?i[F]:null;me&&(Z={id:F,role:"teacher",profile:me,avatar:me.avatar||"",name:me.name||"",email:me.email||"",nickname:""});const k=o?o[F]:null;if(!Z&&k&&(Z={id:F,role:"student",profile:k,avatar:k.avatar||"",name:k.name||"",email:k.email||"",nickname:""}),Z){const G=[...n,Z];a(G),localStorage.setItem("tutoring_users",JSON.stringify(G))}}return Z||null},st=t.filter(F=>F.participants.includes((h==null?void 0:h.id)||""));console.log("🔍 ChatList DEBUG INFO:"),console.log("- Current user:",{id:h==null?void 0:h.id,name:h==null?void 0:h.name,role:h==null?void 0:h.role}),console.log("- All chats count:",t.length),console.log("- User chats count:",st.length),t.length>0&&(console.log("- All chats details:"),t.forEach((F,Z)=>{var me;console.log(`  Chat ${Z+1}:`,{id:F.id,participants:F.participants,participantNames:F.participantNames,includesUser:F.participants.includes((h==null?void 0:h.id)||""),messagesCount:((me=F.messages)==null?void 0:me.length)||0})}));const He=st.filter(F=>{if(F.archived&&!he||!F.archived&&he)return!1;const Z=F.participantNames.find(me=>me!==(h==null?void 0:h.name));return Z==null?void 0:Z.toLowerCase().includes(v.toLowerCase())});console.log("- Filtered chats count:",He.length),console.log("🔍 END DEBUG INFO");const q=u?t.find(F=>F.id===u):null,pe=()=>{!x.trim()||!u||!h||(r(u,h.id,h.name,x.trim()),S(""),I(!1))},ue=(F,Z)=>{if(!X.trim()||!h)return;console.log("🔍 ChatList handleSendMessageToUser DEBUG:"),console.log("- Sender:",{id:h.id,name:h.name}),console.log("- Receiver:",{id:F,name:Z}),console.log("- Message:",X.trim());const me=s(h.id,h.name,F,Z,X.trim());console.log("- Chat created/opened with ID:",me),w(me),be(""),$e(!1),console.log("🔍 END ChatList handleSendMessageToUser DEBUG")},je=F=>{F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),pe())},Ie=F=>F.participantNames.find(Z=>Z!==(h==null?void 0:h.name))||"Неизвестный пользователь",Oe=F=>F.participants.find(Z=>Z!==(h==null?void 0:h.id))||"",ze=F=>{try{const Z=new Date(F);return Lo(Z)?We(Z,"HH:mm",{locale:ft}):Fo(Z)?"Вчера":BC(Z)?We(Z,"EEEE",{locale:ft}):We(Z,"dd.MM.yyyy",{locale:ft})}catch{return""}},nt=F=>{try{const Z=new Date(F);return Lo(Z)?We(Z,"HH:mm",{locale:ft}):Fo(Z)?"Вчера":We(Z,"dd.MM",{locale:ft})}catch{return""}},$=F=>{console.log("handleDeleteChat called with chatId:",F),console.log("Current chats in component:",t.length);const Z=t.find(k=>k.id===F),me=Z?Ie(Z):"пользователем";if(confirm(`Вы уверены, что хотите удалить чат с ${me}? Это действие нельзя отменить.`))try{console.log("User confirmed deletion. Deleting chat:",F),c(F),u===F&&(console.log("Removing selection from deleted chat"),w(null)),Y(null),B(null),setTimeout(()=>{console.log("Forcing state update after chat deletion"),Y(null)},100),console.log("Chat deletion process completed")}catch(k){console.error("Error deleting chat:",k),alert("Ошибка при удалении чата. Попробуйте еще раз.")}else console.log("User cancelled chat deletion")},U=F=>{console.log("handleMarkAsRead called with chatId:",F);try{d(F),Y(null),console.log("Chat marked as read successfully")}catch(Z){console.error("Error marking chat as read:",Z),alert("Ошибка при отметке чата как прочитанного.")}},p=F=>{var k;console.log("handleClearMessages called with chatId:",F);const Z=t.find(G=>G.id===F),me=((k=Z==null?void 0:Z.messages)==null?void 0:k.length)||0;if(me===0){alert("В этом чате нет сообщений для очистки."),Y(null);return}if(confirm(`Вы уверены, что хотите очистить все ${me} сообщений в этом чате? Это действие нельзя отменить.`))try{console.log("Clearing messages for chat:",F),f(F),Y(null),console.log("Messages cleared successfully")}catch(G){console.error("Error clearing messages:",G),alert("Ошибка при очистке сообщений.")}},N=F=>{console.log("handleArchiveChat called with chatId:",F);try{g(F),Y(null),u===F&&w(null),console.log("Chat archived successfully")}catch(Z){console.error("Error archiving chat:",Z),alert("Ошибка при архивировании чата.")}},y=F=>{console.log("handleUnarchiveChat called with chatId:",F);try{m(F),Y(null),console.log("Chat unarchived successfully")}catch(Z){console.error("Error unarchiving chat:",Z),alert("Ошибка при восстановлении чата.")}},T=()=>{alert("Функция создания нового чата будет добавлена в следующем обновлении.")},C=F=>{const Z=F.target.files;Z&&Z.length>0&&console.log("Files to upload:",Z),fe(!1)},M=F=>{console.log("handleShowProfile called with chatId:",F);try{const Z=t.find(me=>me.id===F);if(console.log("Found chat:",Z),Z){const me=Oe(Z);console.log("Other participant ID:",me),me?(O(me),A(!0),console.log("Profile modal opened for user:",me)):alert("Не удалось определить пользователя для показа профиля.")}else alert("Чат не найден.");Y(null)}catch(Z){console.error("Error showing profile:",Z),alert("Ошибка при открытии профиля пользователя."),Y(null)}},ae=()=>{t.filter(Z=>{var me;return Z.participants.includes((h==null?void 0:h.id)||"")&&!Z.archived&&((me=Z.messages)==null?void 0:me.some(k=>k.senderId!==(h==null?void 0:h.id)&&!k.isRead))}).forEach(Z=>{d(Z.id)})};E.useEffect(()=>{const F=Z=>{const me=Z.target,k=me.closest('button[onClick*="setShowChatMenu"]'),G=me.closest(".chat-menu");K&&!k&&!G&&(console.log("Click outside menu detected, closing menu"),Y(null))};return document.addEventListener("mousedown",F),()=>{document.removeEventListener("mousedown",F)}},[K]);const Me=t.filter(F=>{var Z;return F.participants.includes((h==null?void 0:h.id)||"")&&!F.archived&&((Z=F.messages)==null?void 0:Z.some(me=>me.senderId!==(h==null?void 0:h.id)&&!me.isRead))}).length;return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-3 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"МОИ ЧАТЫ"}),e.jsx("p",{className:"text-gray-600 text-xs",children:Me>0?`${Me} непрочитанных сообщений`:"Общайтесь с преподавателями и учениками"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[Me>0&&e.jsx("button",{onClick:ae,className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:"Отметить все как прочитанные"}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Ys,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>xe(!he),className:`px-3 py-1 text-sm rounded-lg transition-colors ${he?"bg-gray-200 text-gray-700":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:he?"Активные":"Архив"}),e.jsx("button",{onClick:T,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Создать новый чат",children:e.jsx(pr,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden min-h-0",children:[e.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col flex-shrink-0",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 space-y-2 flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx(zr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Поиск чатов...",value:v,onChange:F=>D(F.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("button",{onClick:()=>$e(!0),className:"w-full bg-gradient-to-r from-green-600 to-green-700 text-white px-4 py-2 rounded-lg font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(pr,{className:"h-4 w-4"}),e.jsx("span",{children:"Новый чат"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:He.length>0?He.map(F=>{var se,de;const Z=Oe(F),me=rt(Z),k=u===F.id,G=(se=F.messages)==null?void 0:se.some(ie=>ie.senderId!==(h==null?void 0:h.id)&&!ie.isRead);return e.jsxs("div",{className:`relative p-4 hover:bg-gray-50 cursor-pointer transition-colors chat-menu ${k?"bg-blue-50 border-r-2 border-blue-500":""}`,onClick:()=>w(F.id),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[me!=null&&me.avatar?e.jsx("img",{src:me.avatar,alt:"avatar",className:"h-12 w-12 rounded-full object-cover",onError:ie=>{var ge;const ne=ie.target;ne.style.display="none",(ge=ne.nextElementSibling)==null||ge.classList.remove("hidden")}}):e.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:Ie(F).charAt(0).toUpperCase()})}),G&&e.jsx("div",{className:"absolute -top-1 -right-1 h-4 w-4 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:((de=F.messages)==null?void 0:de.filter(ie=>ie.senderId!==(h==null?void 0:h.id)&&!ie.isRead).length)||0})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:[Ie(F),F.archived&&e.jsx("span",{className:"ml-2 text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded",children:"Архив"})]}),F.lastMessage&&e.jsx("span",{className:"text-xs text-gray-400",children:nt(F.lastMessage.timestamp)})]}),F.lastMessage?e.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:F.lastMessage.content}):e.jsx("p",{className:"text-sm text-gray-400 italic mt-1",children:"Нет сообщений"})]}),e.jsx("button",{onClick:ie=>{console.log("Menu button clicked for chat:",F.id),ie.stopPropagation(),Y(K===F.id?null:F.id)},className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Xo,{className:"w-4 h-4"})})]}),K===F.id&&e.jsxs("div",{className:"absolute right-2 top-12 bg-white border border-gray-200 rounded-lg shadow-xl py-1 z-50 min-w-[180px]",children:[e.jsxs("button",{onClick:ie=>{console.log("Profile button clicked for chat:",F.id),ie.preventDefault(),ie.stopPropagation(),M(F.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{children:"Профиль"})]}),e.jsxs("button",{onClick:ie=>{console.log("Mark as read button clicked for chat:",F.id),ie.preventDefault(),ie.stopPropagation(),U(F.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(gr,{className:"w-4 h-4"}),e.jsx("span",{children:"Отметить как прочитанное"})]}),e.jsxs("button",{onClick:ie=>{console.log("Archive button clicked for chat:",F.id),ie.preventDefault(),ie.stopPropagation(),N(F.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(si,{className:"w-4 h-4"}),e.jsx("span",{children:"Архивировать"})]}),F.archived&&e.jsxs("button",{onClick:ie=>{console.log("Unarchive button clicked for chat:",F.id),ie.preventDefault(),ie.stopPropagation(),y(F.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(si,{className:"w-4 h-4"}),e.jsx("span",{children:"Восстановить"})]}),e.jsxs("button",{onClick:ie=>{console.log("Clear messages button clicked for chat:",F.id),ie.preventDefault(),ie.stopPropagation(),p(F.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Gr,{className:"w-4 h-4"}),e.jsx("span",{children:"Очистить сообщения"})]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:ie=>{console.log("Delete chat button clicked for chat:",F.id),ie.preventDefault(),ie.stopPropagation(),$(F.id)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Gr,{className:"w-4 h-4"}),e.jsx("span",{children:"Удалить чат"})]})]})]},F.id)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx(Ae,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Нет чатов"}),e.jsx("p",{className:"text-sm text-center",children:"Начните общение с преподавателями или учениками"})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-white min-h-0",children:q?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[(()=>{const F=Oe(q),Z=rt(F);return Z!=null&&Z.avatar?e.jsx("img",{src:Z.avatar,alt:"avatar",className:"h-10 w-10 rounded-full object-cover"}):e.jsx("div",{className:"h-10 w-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:Ie(q).charAt(0).toUpperCase()})})})(),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:Ie(q)}),e.jsx("p",{className:"text-sm text-gray-500",children:(()=>{const F=Oe(q),Z=rt(F);return(Z==null?void 0:Z.role)==="teacher"?"Преподаватель":"Ученик"})()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(xr,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(At,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{const F=Oe(q);O(F),A(!0)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ye,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 min-h-0",children:[q.messages&&q.messages.length>0?q.messages.map(F=>e.jsx("div",{className:`flex ${F.senderId===(h==null?void 0:h.id)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${F.senderId===(h==null?void 0:h.id)?"bg-blue-600 text-white":"bg-white text-gray-900 shadow-sm"}`,children:[e.jsx("p",{className:"text-sm",children:F.content}),e.jsxs("div",{className:`flex items-center justify-end mt-1 space-x-1 ${F.senderId===(h==null?void 0:h.id)?"text-blue-100":"text-gray-400"}`,children:[e.jsx("span",{className:"text-xs",children:ze(F.timestamp)}),F.senderId===(h==null?void 0:h.id)&&e.jsx(vd,{className:"w-3 h-3"})]})]})},F.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx(Ae,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Начните общение"}),e.jsx("p",{className:"text-sm text-center",children:"Отправьте первое сообщение"})]}),e.jsx("div",{ref:Ee})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-end space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("textarea",{value:x,onChange:F=>{S(F.target.value),I(F.target.value.length>0)},onKeyPress:je,placeholder:"Введите сообщение...",className:"w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:1,style:{minHeight:"44px",maxHeight:"120px"}}),e.jsxs("div",{className:"absolute right-3 bottom-3 flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>J(!W),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ra,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>fe(!L),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ni,{className:"w-5 h-5"})})]})]}),e.jsx("button",{onClick:pe,disabled:!x.trim(),className:"p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:e.jsx(Zo,{className:"w-5 h-5"})})]}),L&&e.jsx("div",{className:"mt-2 p-2 bg-white border border-gray-200 rounded-lg shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>{var F;return(F=te.current)==null?void 0:F.click()},className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx(ni,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Файл"})]}),e.jsxs("button",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx(Dd,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Голосовое"})]})]})}),e.jsx("input",{ref:te,type:"file",multiple:!0,onChange:C,className:"hidden"})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500",children:[e.jsx(Ae,{className:"w-24 h-24 mb-6 text-gray-300"}),e.jsx("h2",{className:"text-2xl font-medium mb-2",children:"Выберите чат"}),e.jsx("p",{className:"text-center",children:"Выберите чат из списка слева, чтобы начать общение"})]})})]}),P&&H&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Профиль пользователя"}),e.jsx("button",{onClick:()=>A(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Zn,{className:"w-5 h-5"})})]}),(()=>{var Z;const F=rt(H);return F?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[F.avatar?e.jsx("img",{src:F.avatar,alt:"avatar",className:"h-16 w-16 rounded-full object-cover"}):e.jsx("div",{className:"h-16 w-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium text-lg",children:((Z=F.name)==null?void 0:Z.charAt(0).toUpperCase())||"U"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:F.name||"Неизвестный пользователь"}),e.jsx("p",{className:"text-gray-500",children:F.role==="teacher"?"Преподаватель":"Ученик"}),F.email&&e.jsx("p",{className:"text-sm text-gray-400",children:F.email})]})]}),F.profile&&e.jsxs("div",{className:"space-y-4",children:[F.profile.bio&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"О себе"}),e.jsx("p",{className:"text-gray-600",children:F.profile.bio})]}),F.profile.subjects&&F.profile.subjects.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Предметы"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:F.profile.subjects.map((me,k)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:me},k))})]}),F.profile.experience&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Опыт"}),e.jsxs("p",{className:"text-gray-600",children:[F.profile.experience==="beginner"&&"Начинающий",F.profile.experience==="experienced"&&"Опытный",F.profile.experience==="professional"&&"Профессионал"]})]}),F.profile.city&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Город"}),e.jsx("p",{className:"text-gray-600",children:F.profile.city})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[e.jsxs("button",{onClick:()=>{A(!1)},className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(xr,{className:"w-4 h-4"}),e.jsx("span",{children:"Позвонить"})]}),e.jsxs("button",{onClick:()=>{A(!1)},className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(At,{className:"w-4 h-4"}),e.jsx("span",{children:"Видео"})]})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Профиль пользователя не найден"})})})()]})})}),ve&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Новый чат"}),e.jsx("button",{onClick:()=>$e(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(et,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Сообщение"}),e.jsx("textarea",{value:X,onChange:F=>be(F.target.value),placeholder:"Введите ваше сообщение...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Выберите получателя"}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-lg",children:n.filter(F=>F.id!==(h==null?void 0:h.id)).map(F=>e.jsxs("button",{onClick:()=>ue(F.id,F.name),className:"w-full p-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold",children:F.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:F.name}),e.jsx("div",{className:"text-sm text-gray-500 capitalize",children:F.role==="teacher"?"Преподаватель":"Ученик"})]})]},F.id))})]})]})]})})]})},L4=()=>{var Ee,te,Ne,ke,rt,st,He,q,pe,ue,je,Ie,Oe,ze,nt,$,U;const{user:t,updateProfile:r,deleteAccount:s}=tt(),{updateStudentProfile:n,updateTeacherProfile:a,lessons:i,posts:o,createPost:l,addReaction:c,addComment:d,sharePost:f,bookmarkPost:g,editPost:m,deletePost:b}=ct(),[j,h]=E.useState(!1),[u,w]=E.useState({grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""}),[x,S]=E.useState({subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,teacherType:"private",education:{university:"",degree:"",graduationYear:void 0,courses:[]}}),[v,D]=E.useState(!1),[P,A]=E.useState(!1),[H,O]=E.useState(!1),[z,R]=E.useState(!1),[K]=E.useState([{id:1,avatar:((Ee=t==null?void 0:t.profile)==null?void 0:Ee.avatar)||"",name:(t==null?void 0:t.name)||""}]),[Y,ee]=E.useState(!1),[B,V]=E.useState(()=>typeof window<"u"&&localStorage.getItem("theme")||"light"),I=["Математика","Русский язык","Английский язык"],W=["1","2","3","4","5","6","7","8","9","10","11","Студент","Взрослый"],J=["подготовка к экзаменам","помощь с домашним заданием","углубленное изучение","разговорная практика"],L=["beginner","experienced","professional"],fe=[45,60],he=["online","offline","mini-group"];E.useEffect(()=>{if(t!=null&&t.profile)if(t.role==="student"){const p=t.profile;w({...u,...p,goals:p.goals||[],interests:p.interests||[],preferredFormats:p.preferredFormats||[],preferredDurations:p.preferredDurations||[]})}else{const p=t.profile;S({...x,...p,formats:p.formats||[],subjects:p.subjects||[],grades:p.grades||[],goals:p.goals||[],lessonTypes:p.lessonTypes||[],durations:p.durations||[],education:p.education||{university:"",degree:"",graduationYear:void 0,courses:[]}})}else if(t&&!t.profile){const p=t.role==="teacher"?{subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,teacherType:"private",education:{university:"",degree:"",graduationYear:void 0,courses:[]}}:{grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""};r(p)}},[t]);const xe=()=>{if(!t)return;const p=t.role==="student"?u:x;r(p),t.role==="student"?n(t.id,u):t.role==="teacher"&&a(t.id,{...x,name:t.name,email:t.email}),h(!1),alert("Профиль сохранен!")},ve=p=>{switch(p){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return p}};let $e=0,X=0;if(t&&t.role==="student"&&Array.isArray(i)){const p=i.filter(N=>N.studentId===t.id);$e=p.length,X=Array.from(new Set(p.map(N=>N.teacherId))).length}if(!t)return null;const be=p=>{var y;const N=(y=p.target.files)==null?void 0:y[0];if(N){if(N.size>5*1024*1024){alert("Размер файла не должен превышать 5MB");return}if(!N.type.startsWith("image/")){alert("Пожалуйста, выберите изображение");return}const T=new FileReader;T.onload=C=>{var M;try{const ae=(M=C.target)==null?void 0:M.result;if(t.role==="student"){const ce={...u,avatar:ae};w(ce),r(ce),n(t.id,ce),console.log("✅ Аватар студента сохранен")}else{const ce={...x,avatar:ae};S(ce),r(ce),a(t.id,{...ce,name:t.name,email:t.email}),console.log("✅ Аватар преподавателя сохранен")}}catch(ae){console.error("❌ Ошибка при сохранении аватара:",ae),alert("Ошибка при сохранении фото. Попробуйте еще раз.")}},T.onerror=()=>{console.error("❌ Ошибка чтения файла"),alert("Ошибка при чтении файла. Попробуйте выбрать другое изображение.")},T.readAsDataURL(N)}};return e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 relative",children:[e.jsx("div",{className:"h-20 w-20 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center overflow-hidden shadow-lg",children:(te=t.profile)!=null&&te.avatar?e.jsx("img",{src:t.profile.avatar,alt:"Avatar",className:"h-20 w-20 rounded-full object-cover"}):e.jsx(ye,{className:"h-10 w-10 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:t?t.name:""}),t&&t.nickname&&e.jsxs("span",{className:"text-gray-400 text-sm",children:["@",t.nickname]})]}),t&&t.role==="student"&&e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[e.jsx(Be,{className:"w-5 h-5 text-blue-500 mr-1"}),$e]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Пройдено уроков"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[e.jsx(ye,{className:"w-5 h-5 text-green-500 mr-1"}),X]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Учителей"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("button",{className:"btn-primary text-sm px-3 py-2",onClick:()=>h(!0),children:"Редактировать"}),e.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-500 hover:text-blue-600 rounded-full p-2 shadow transition-colors duration-150 focus:outline-none",style:{width:36,height:36},"aria-label":"Настройки",onClick:()=>A(!0),children:e.jsx(Ys,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow p-4 mb-6 text-sm flex flex-col gap-2 card-gradient",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1 space-y-1"})})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-5 mb-6 card-gradient",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-3",children:"О себе"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-line leading-relaxed mb-4 text-sm",children:t.role==="student"?u.bio||"—":((Ne=t.profile)==null?void 0:Ne.bio)||"—"}),t.role==="student"&&e.jsxs("div",{className:"space-y-3",children:[u.subjects&&u.subjects.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Предметы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.subjects.map((p,N)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:p},N))})]}),(u.age||u.school||u.city)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[u.age&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Возраст:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[u.age," лет"]})]}),u.school&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Школа:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:u.school})]}),u.city&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Город:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:u.city})]})]}),u.goals&&u.goals.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Цели обучения:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.goals.map((p,N)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:p},N))})]}),u.interests&&u.interests.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Интересы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.interests.map((p,N)=>e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:p},N))})]}),(u.learningStyle||u.experience)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[u.learningStyle&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Стиль обучения:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:u.learningStyle==="visual"?"Визуальный":u.learningStyle==="auditory"?"Аудиальный":u.learningStyle==="kinesthetic"?"Кинестетический":"Смешанный"})]}),u.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Уровень:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:u.experience==="beginner"?"Начинающий":u.experience==="intermediate"?"Средний":"Продвинутый"})]})]}),(u.preferredFormats&&u.preferredFormats.length>0||u.preferredDurations&&u.preferredDurations.length>0)&&e.jsxs("div",{className:"space-y-2",children:[u.preferredFormats&&u.preferredFormats.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Форматы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.preferredFormats.map((p,N)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full",children:p==="online"?"Онлайн":p==="offline"?"Оффлайн":"Мини-группа"},N))})]}),u.preferredDurations&&u.preferredDurations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Длительность:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.preferredDurations.map((p,N)=>e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full",children:[p," мин"]},N))})]})]})]}),t.role==="teacher"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Предметы:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:((rt=(ke=t.profile)==null?void 0:ke.subjects)==null?void 0:rt.join(", "))||"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Классы:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:((He=(st=t.profile)==null?void 0:st.grades)==null?void 0:He.join(", "))||"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Страна:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:((q=t.profile)==null?void 0:q.country)||"—"})]}),((pe=t.profile)==null?void 0:pe.experience)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Опыт:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:t.profile.experience})]})]})]}),e.jsxs(hr,{open:v,onClose:()=>D(!1),children:[e.jsx("div",{className:"text-base font-bold mb-2",children:"Контактная информация"}),e.jsxs("div",{className:"mb-2 text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",t.email]})]}),e.jsx(hr,{open:P,onClose:()=>A(!1),children:e.jsxs("div",{className:"w-[320px] max-w-full",children:[e.jsx("div",{className:"text-lg font-bold mb-4 text-center",children:"Настройки"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",onClick:()=>{A(!1),O(!0)},children:[e.jsx(Ur,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"flex-1",children:"Push-уведомления"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Jo,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"flex-1",children:"Конфиденциальность"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",onClick:()=>{A(!1),R(!0)},children:[e.jsx(ye,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"flex-1",children:"Аккаунт"})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Od,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"flex-1",children:"Тема"})]}),e.jsx("button",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none ${B==="dark"?"bg-gray-900":"bg-gray-300"}`,onClick:()=>{const p=B==="dark"?"light":"dark";V(p),p==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",p)},"aria-pressed":B==="dark",type:"button",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${B==="dark"?"translate-x-5":"translate-x-1"}`})})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(wd,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"flex-1",children:"Память"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Td,{className:"w-5 h-5 text-indigo-500"}),e.jsx("span",{className:"flex-1",children:"Устройства"})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Be,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{className:"flex-1",children:"База знаний"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Ae,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"flex-1",children:"Поддержка"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(er,{className:"w-5 h-5 text-blue-700"}),e.jsx("span",{className:"flex-1",children:"Документация"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx($t,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"flex-1",children:"Оценить приложение"})]})]})]})}),e.jsx(hr,{open:H,onClose:()=>O(!1),children:e.jsxs("div",{className:"w-[340px] max-w-full",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("button",{onClick:()=>O(!1),className:"mr-2 p-1 rounded hover:bg-gray-100",children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left w-5 h-5 text-gray-500",children:[e.jsx("path",{d:"M19 12H5"}),e.jsx("path",{d:"m12 19-7-7 7-7"})]})}),e.jsx("div",{className:"text-lg font-bold text-center flex-1",children:"Уведомления"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"СООБЩЕНИЯ"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Pt,{label:"Личные сообщения"}),e.jsx(Pt,{label:"Инфобот"}),e.jsx(Pt,{label:"Лиды"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ПУБЛИКАЦИИ ОТ ПОДПИСОК"}),e.jsx("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:e.jsx(Pt,{label:"Новые публикации"})}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ПОДПИСЧИКИ И ДЕЛОВЫЕ СВЯЗИ"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Pt,{label:"Новые подписчики"}),e.jsx(Pt,{label:"Установлена деловая связь"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"МАРКЕТСПЕЙС"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Pt,{label:"Отклики"}),e.jsx(Pt,{label:"Рекомендации"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ГОСЗАКУПКИ"}),e.jsx("div",{className:"bg-gray-50 rounded-xl mb-2 overflow-hidden",children:e.jsx(Pt,{label:"Подборка тендеров по ИНН"})})]})}),e.jsx(hr,{open:z,onClose:()=>R(!1),children:e.jsxs("div",{className:"w-[340px] max-w-full flex flex-col min-h-[340px]",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("button",{onClick:()=>R(!1),className:"mr-2 p-1 rounded hover:bg-gray-100",children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left w-5 h-5 text-gray-500",children:[e.jsx("path",{d:"M19 12H5"}),e.jsx("path",{d:"m12 19-7-7 7-7"})]})}),e.jsx("div",{className:"text-lg font-bold text-center flex-1",children:"Аккаунт"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"НОМЕР ТЕЛЕФОНА"}),e.jsxs("div",{className:"bg-white rounded-xl mb-4 overflow-hidden flex items-center justify-between px-4 py-3",children:[e.jsx("span",{className:"text-sm text-gray-900",children:"Изменить номер"}),e.jsx("span",{className:"text-gray-400 text-sm",children:t.phone||"+7 (999) 300-18-02"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 ml-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ЭЛЕКТРОННАЯ ПОЧТА"}),e.jsxs("div",{className:"bg-white rounded-xl mb-4 overflow-hidden flex items-center justify-between px-4 py-3",children:[e.jsx("span",{className:"text-sm text-gray-900",children:"Изменить эл. почту"}),e.jsx("span",{className:"text-gray-400 text-sm truncate max-w-[120px]",children:t.email}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 ml-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:s,className:"w-full mt-8 mb-2 py-3 rounded-xl bg-red-50 text-red-600 font-bold text-base hover:bg-red-100 transition",children:"Удалить аккаунт"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-bold text-base",children:"Истории"}),e.jsx("button",{className:"text-blue-500 text-xs font-medium hover:underline",onClick:()=>alert("Скоро можно будет добавлять истории!"),children:"Добавить"})]}),e.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-2",children:[e.jsxs("div",{className:"flex flex-col items-center cursor-pointer group",children:[e.jsxs("div",{className:"relative h-14 w-14 rounded-full bg-gradient-to-tr from-blue-400 to-purple-500 flex items-center justify-center overflow-hidden border-2 border-blue-400 group-hover:scale-105 transition",children:[(t.role==="student"?u.avatar:(ue=t.profile)!=null&&ue.avatar)?e.jsx("img",{src:t.role==="student"?u.avatar:(je=t.profile)==null?void 0:je.avatar,alt:"avatar",className:"h-14 w-14 object-cover rounded-full"}):e.jsx(ye,{className:"h-7 w-7 text-white"}),e.jsx("span",{className:"absolute bottom-0 right-0 bg-blue-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs border-2 border-white",children:"+"})]}),e.jsx("span",{className:"text-xs mt-1 text-gray-700",children:"Ваша история"})]}),K.map(p=>e.jsxs("div",{className:"flex flex-col items-center cursor-pointer group",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-gradient-to-tr from-pink-400 to-yellow-400 flex items-center justify-center overflow-hidden border-2 border-pink-400 group-hover:scale-105 transition",children:p.avatar?e.jsx("img",{src:p.avatar,alt:p.name,className:"h-14 w-14 object-cover rounded-full"}):e.jsx(ye,{className:"h-7 w-7 text-white"})}),e.jsx("span",{className:"text-xs mt-1 text-gray-700 truncate max-w-[60px]",children:p.name})]},p.id))]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"font-bold text-base",children:"Мои записи"}),e.jsxs("button",{onClick:()=>ee(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(pr,{className:"w-4 h-4"}),e.jsx("span",{children:"Создать запись"})]})]}),Y&&e.jsx("div",{className:"mb-6",children:e.jsx(Ja,{onSubmit:p=>{l(p),ee(!1)},onCancel:()=>ee(!1),userName:(t==null?void 0:t.name)||"Пользователь",userAvatar:t==null?void 0:t.avatar})}),e.jsx("div",{className:"space-y-4",children:o.filter(p=>p.userId===(t==null?void 0:t.id)).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"У вас пока нет записей"}),e.jsx("p",{className:"text-gray-500",children:"Создайте первую запись!"})]}):o.filter(p=>p.userId===(t==null?void 0:t.id)).map(p=>e.jsx(Qn,{post:p,onReaction:c,onComment:d,onShare:f,onBookmark:g,onEdit:m,onDelete:b},p.id))})]}),e.jsx(hr,{open:j,onClose:()=>h(!1),children:e.jsx("div",{className:"w-[720px] max-w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-8 p-4",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("div",{className:"h-20 w-20 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center overflow-hidden",children:(t.role==="student"?u.avatar:x.avatar)?e.jsx("img",{src:t.role==="student"?u.avatar:x.avatar,alt:"Avatar",className:"h-20 w-20 rounded-full object-cover"}):e.jsx(ye,{className:"h-10 w-10 text-white"})}),e.jsxs("div",{children:[e.jsxs("label",{className:"btn-primary cursor-pointer",children:[e.jsx(Ld,{className:"h-4 w-4"}),e.jsx("span",{children:"Загрузить фото"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:be})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Рекомендуемый размер: 200x200px"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Имя"}),e.jsx("input",{type:"text",value:t==null?void 0:t.name,disabled:!0,className:"input-modern w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Никнейм"}),e.jsx("input",{type:"text",value:`@${t==null?void 0:t.nickname}`,disabled:!0,className:"input-modern w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:t==null?void 0:t.email,disabled:!0,className:"input-modern w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Номер телефона"}),e.jsx("input",{type:"tel",value:(t==null?void 0:t.phone)||"",onChange:p=>{if(t)try{const N=JSON.parse(localStorage.getItem("tutoring_users")||"[]"),y=N.findIndex(T=>T.id===t.id);y!==-1&&(N[y].phone=p.target.value,localStorage.setItem("tutoring_users",JSON.stringify(N)))}catch{}},className:"input-modern w-full",placeholder:"+7 (999) 123-45-67"})]})]}),t.role==="teacher"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предметы, которые вы преподаете"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:I.map(p=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:x.subjects.includes(p),onChange:N=>{N.target.checked?S({...x,subjects:[...x.subjects,p]}):S({...x,subjects:x.subjects.filter(y=>y!==p)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:p})]},p))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Классы, с которыми работаете"}),e.jsx("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2",children:W.map(p=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:x.grades.includes(p),onChange:N=>{N.target.checked?S({...x,grades:[...x.grades,p]}):S({...x,grades:x.grades.filter(y=>y!==p)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:p})]},p))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Опыт преподавания"}),e.jsx("select",{value:x.experience,onChange:p=>S({...x,experience:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:L.map(p=>e.jsx("option",{value:p,children:ve(p)},p))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тип преподавателя"}),e.jsxs("select",{value:x.teacherType||"private",onChange:p=>S({...x,teacherType:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"private",children:"Частный преподаватель"}),e.jsx("option",{value:"school",children:"Преподаватель школы"}),e.jsx("option",{value:"both",children:"Частный + Школа"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Возраст"}),e.jsx("input",{type:"number",value:x.age||"",onChange:p=>S({...x,age:p.target.value?Number(p.target.value):void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"18",max:"100",placeholder:"Укажите возраст"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Лет опыта"}),e.jsx("input",{type:"number",value:x.experienceYears||"",onChange:p=>S({...x,experienceYears:p.target.value?Number(p.target.value):void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",max:"50",placeholder:"Количество лет"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Стоимость часа (₽)"}),e.jsx("input",{type:"number",value:x.hourlyRate,onChange:p=>S({...x,hourlyRate:Number(p.target.value)}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цели занятий"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:J.map(p=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:x.goals.includes(p),onChange:N=>{N.target.checked?S({...x,goals:[...x.goals,p]}):S({...x,goals:x.goals.filter(y=>y!==p)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:p})]},p))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Продолжительность уроков"}),e.jsx("div",{className:"flex space-x-4",children:fe.map(p=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:x.durations.includes(p),onChange:N=>{N.target.checked?S({...x,durations:[...x.durations,p]}):S({...x,durations:x.durations.filter(y=>y!==p)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[p," мин"]})]},p))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Форматы проведения"}),e.jsx("div",{className:"flex space-x-4",children:he.map(p=>{var N;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((N=x.formats)==null?void 0:N.includes(p))||!1,onChange:y=>{y.target.checked?S({...x,formats:[...x.formats||[],p]}):S({...x,formats:(x.formats||[]).filter(T=>T!==p)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:p==="online"?"Онлайн":p==="offline"?"Оффлайн":"Мини-группа"})]},p)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:x.offlineAvailable,onChange:p=>S({...x,offlineAvailable:p.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Провожу оффлайн занятия"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:x.overbookingEnabled,onChange:p=>S({...x,overbookingEnabled:p.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Участвую в овербукинге"})]})})]})]}),x.offlineAvailable&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Город"}),e.jsx("input",{type:"text",value:x.city,onChange:p=>S({...x,city:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Введите ваш город"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"О себе"}),e.jsx("textarea",{value:t.role==="student"?u.bio:x.bio,onChange:p=>{t.role==="student"?w({...u,bio:p.target.value}):S({...x,bio:p.target.value})},rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Расскажите о себе..."})]}),t.role==="student"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Дополнительная информация"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предметы, которые изучаете"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:I.map(p=>{var N;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((N=u.subjects)==null?void 0:N.includes(p))||!1,onChange:y=>{y.target.checked?w({...u,subjects:[...u.subjects||[],p]}):w({...u,subjects:(u.subjects||[]).filter(T=>T!==p)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:p})]},p)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Возраст"}),e.jsx("input",{type:"number",value:u.age||"",onChange:p=>w({...u,age:p.target.value?Number(p.target.value):void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"5",max:"25",placeholder:"Укажите возраст"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Школа"}),e.jsx("input",{type:"text",value:u.school||"",onChange:p=>w({...u,school:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Название школы"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Город"}),e.jsx("input",{type:"text",value:u.city||"",onChange:p=>w({...u,city:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Ваш город"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Телефон"}),e.jsx("input",{type:"tel",value:u.phone||"",onChange:p=>w({...u,phone:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Имя родителя"}),e.jsx("input",{type:"text",value:u.parentName||"",onChange:p=>w({...u,parentName:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Имя родителя"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Телефон родителя"}),e.jsx("input",{type:"tel",value:u.parentPhone||"",onChange:p=>w({...u,parentPhone:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цели обучения"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:J.map(p=>{var N;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((N=u.goals)==null?void 0:N.includes(p))||!1,onChange:y=>{y.target.checked?w({...u,goals:[...u.goals||[],p]}):w({...u,goals:(u.goals||[]).filter(T=>T!==p)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:p})]},p)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Интересы и хобби"}),e.jsx("textarea",{value:((Ie=u.interests)==null?void 0:Ie.join(", "))||"",onChange:p=>w({...u,interests:p.target.value.split(",").map(N=>N.trim()).filter(N=>N)}),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Напишите через запятую: спорт, музыка, рисование..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Стиль обучения"}),e.jsxs("select",{value:u.learningStyle||"mixed",onChange:p=>w({...u,learningStyle:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"visual",children:"Визуальный"}),e.jsx("option",{value:"auditory",children:"Аудиальный"}),e.jsx("option",{value:"kinesthetic",children:"Кинестетический"}),e.jsx("option",{value:"mixed",children:"Смешанный"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Уровень знаний"}),e.jsxs("select",{value:u.experience||"beginner",onChange:p=>w({...u,experience:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"intermediate",children:"Средний"}),e.jsx("option",{value:"advanced",children:"Продвинутый"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предпочитаемые форматы занятий"}),e.jsx("div",{className:"flex space-x-4",children:he.map(p=>{var N;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((N=u.preferredFormats)==null?void 0:N.includes(p))||!1,onChange:y=>{y.target.checked?w({...u,preferredFormats:[...u.preferredFormats||[],p]}):w({...u,preferredFormats:(u.preferredFormats||[]).filter(T=>T!==p)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:p==="online"?"Онлайн":p==="offline"?"Оффлайн":"Мини-группа"})]},p)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предпочитаемая длительность занятий"}),e.jsx("div",{className:"flex space-x-4",children:fe.map(p=>{var N;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((N=u.preferredDurations)==null?void 0:N.includes(p))||!1,onChange:y=>{y.target.checked?w({...u,preferredDurations:[...u.preferredDurations||[],p]}):w({...u,preferredDurations:(u.preferredDurations||[]).filter(T=>T!==p)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[p," мин"]})]},p)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Часовой пояс"}),e.jsx("input",{type:"text",value:u.timeZone||"",onChange:p=>w({...u,timeZone:p.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"UTC+3 (Москва)"})]})]})}),t.role==="teacher"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Образование"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Университет"}),e.jsx("input",{type:"text",value:((Oe=x.education)==null?void 0:Oe.university)||"",onChange:p=>S({...x,education:{...x.education,university:p.target.value}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Название университета"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Специальность/Степень"}),e.jsx("input",{type:"text",value:((ze=x.education)==null?void 0:ze.degree)||"",onChange:p=>S({...x,education:{...x.education,degree:p.target.value}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Ваша специальность"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Год окончания"}),e.jsx("input",{type:"number",value:((nt=x.education)==null?void 0:nt.graduationYear)||"",onChange:p=>S({...x,education:{...x.education,graduationYear:p.target.value?Number(p.target.value):void 0}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1950",max:new Date().getFullYear(),placeholder:"Год окончания"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Курсы и сертификаты"}),e.jsxs("div",{className:"space-y-4",children:[(U=($=x.education)==null?void 0:$.courses)==null?void 0:U.map((p,N)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Название курса"}),e.jsx("input",{type:"text",value:p.name,onChange:y=>{var C;const T=[...((C=x.education)==null?void 0:C.courses)||[]];T[N]={...p,name:y.target.value},S({...x,education:{...x.education,courses:T}})},className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"Название курса"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Учреждение"}),e.jsx("input",{type:"text",value:p.institution,onChange:y=>{var C;const T=[...((C=x.education)==null?void 0:C.courses)||[]];T[N]={...p,institution:y.target.value},S({...x,education:{...x.education,courses:T}})},className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"Название учреждения"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Год прохождения"}),e.jsx("input",{type:"number",value:p.year,onChange:y=>{var C;const T=[...((C=x.education)==null?void 0:C.courses)||[]];T[N]={...p,year:Number(y.target.value)},S({...x,education:{...x.education,courses:T}})},className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"1950",max:new Date().getFullYear(),placeholder:"Год"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ссылка на сертификат"}),e.jsx("input",{type:"url",value:p.certificate||"",onChange:y=>{var C;const T=[...((C=x.education)==null?void 0:C.courses)||[]];T[N]={...p,certificate:y.target.value},S({...x,education:{...x.education,courses:T}})},className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com/certificate.pdf"})]})]}),e.jsx("button",{type:"button",onClick:()=>{var T,C;const y=((C=(T=x.education)==null?void 0:T.courses)==null?void 0:C.filter((M,ae)=>ae!==N))||[];S({...x,education:{...x.education,courses:y}})},className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Удалить курс"})]},N)),e.jsxs("button",{type:"button",onClick:()=>{var N;const p={name:"",institution:"",year:new Date().getFullYear(),certificate:""};S({...x,education:{...x.education,courses:[...((N=x.education)==null?void 0:N.courses)||[],p]}})},className:"w-full p-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-gray-400 hover:text-gray-800 transition-colors flex items-center justify-center gap-2",children:[e.jsx(pr,{className:"h-5 w-5"}),"Добавить курс"]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsxs("button",{onClick:xe,className:"btn-primary flex items-center gap-2",children:[e.jsx(Pd,{className:"h-5 w-5"}),e.jsx("span",{children:"Сохранить профиль"})]}),e.jsx("button",{onClick:()=>h(!1),className:"btn-secondary",children:"Отмена"})]})]})})})]})},Pt=({label:t})=>{const[r,s]=E.useState(!0);return e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b last:border-b-0",children:[e.jsx("span",{className:"text-sm text-gray-900",children:t}),e.jsx("button",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none ${r?"bg-green-500":"bg-gray-300"}`,onClick:()=>s(n=>!n),"aria-pressed":r,type:"button",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${r?"translate-x-5":"translate-x-1"}`})})]})},F4=()=>{const[t,r]=E.useState(null),[s,n]=E.useState(!0),[a,i]=E.useState(!1);try{const{user:o}=tt(),[l,c]=E.useState((o==null?void 0:o.role)==="teacher"?"slots":"home");if(E.useEffect(()=>{if(o&&!a){const f=o.role==="teacher"?"slots":"home";c(f),i(!0)}n(!1)},[o,a]),s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Загрузка приложения..."})]})});if(!o)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Добро пожаловать в Nauchi"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Платформа для репетиторов и учеников"}),e.jsx(Bd,{onSuccess:()=>{}})]})});const d=()=>{try{switch(l){case"home":return o.role==="student"?e.jsx(On,{setActiveTab:c}):e.jsx(Mn,{});case"slots":return o.role==="teacher"?e.jsx(Mn,{}):e.jsx(On,{setActiveTab:c});case"calendar":return o.role==="student"?e.jsx(Yc,{onClose:()=>c("home")}):e.jsx(Vc,{});case"lessons":return o.role==="student"?e.jsx(R4,{setActiveTab:c}):null;case"students":return o.role==="teacher"?e.jsx(A4,{}):null;case"chats":return e.jsx(I4,{});case"profile":return e.jsx(L4,{});default:return o.role==="student"?e.jsx(On,{setActiveTab:c}):e.jsx(Mn,{})}}catch(f){return console.error("Error rendering content:",f),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Ошибка загрузки контента"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Попробуйте перезагрузить страницу"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Перезагрузить"})]})})}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Hd,{activeTab:l,onTabChange:c}),e.jsx("main",{className:l==="chats"?"h-[calc(100vh-64px)]":"container mx-auto px-4 py-8",children:d()})]})}catch(o){return console.error("Error in AppContent:",o),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Ошибка загрузки"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Произошла ошибка при загрузке приложения"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Перезагрузить страницу"})]})})}},U4=()=>e.jsx("div",{className:"App",children:e.jsx(hd,{children:e.jsx(fd,{children:e.jsxs(Xc,{children:[e.jsx(ei,{path:"/teacher/:teacherId",element:e.jsx(qc,{teacher:{},onClose:()=>{},onBookLesson:()=>{}})}),e.jsx(ei,{path:"*",element:e.jsx(F4,{})})]})})})});qo(document.getElementById("root")).render(e.jsx(E.StrictMode,{children:e.jsx(Qc,{children:e.jsx(U4,{})})}));
