import{r as E,a as td,R,g as jt,c as pt,b as Vo}from"./vendor-tAaa2TlE.js";import{l as Ko}from"./socket-TjCxX7sJ.js";import{R as rd,a as ai,B as sd}from"./router-Skg1zGfq.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var Jo={exports:{}},Js={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ad=E,nd=Symbol.for("react.element"),id=Symbol.for("react.fragment"),od=Object.prototype.hasOwnProperty,ld=ad.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cd={key:!0,ref:!0,__self:!0,__source:!0};function Xo(t,r,s){var a,n={},i=null,o=null;s!==void 0&&(i=""+s),r.key!==void 0&&(i=""+r.key),r.ref!==void 0&&(o=r.ref);for(a in r)od.call(r,a)&&!cd.hasOwnProperty(a)&&(n[a]=r[a]);if(t&&t.defaultProps)for(a in r=t.defaultProps,r)n[a]===void 0&&(n[a]=r[a]);return{$$typeof:nd,type:t,key:i,ref:o,props:n,_owner:ld.current}}Js.Fragment=id;Js.jsx=Xo;Js.jsxs=Xo;Jo.exports=Js;var e=Jo.exports,Qo,ni=td;Qo=ni.createRoot,ni.hydrateRoot;const qe=[];for(let t=0;t<256;++t)qe.push((t+256).toString(16).slice(1));function dd(t,r=0){return(qe[t[r+0]]+qe[t[r+1]]+qe[t[r+2]]+qe[t[r+3]]+"-"+qe[t[r+4]]+qe[t[r+5]]+"-"+qe[t[r+6]]+qe[t[r+7]]+"-"+qe[t[r+8]]+qe[t[r+9]]+"-"+qe[t[r+10]]+qe[t[r+11]]+qe[t[r+12]]+qe[t[r+13]]+qe[t[r+14]]+qe[t[r+15]]).toLowerCase()}let Na;const ud=new Uint8Array(16);function md(){if(!Na){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Na=crypto.getRandomValues.bind(crypto)}return Na(ud)}const hd=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ii={randomUUID:hd};function fd(t,r,s){var n;if(ii.randomUUID&&!t)return ii.randomUUID();t=t||{};const a=t.random??((n=t.rng)==null?void 0:n.call(t))??md();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,dd(a)}const He="https://nauchi.onrender.com",gd="https://nauchi.onrender.com",xd={transports:["websocket","polling"],timeout:1e4,forceNew:!0,upgrade:!0,rememberUpgrade:!0},Zo=E.createContext(void 0),Ye=()=>{const t=E.useContext(Zo);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},hr=()=>{try{const t=localStorage.getItem("tutoring_users");return t?JSON.parse(t):[]}catch{return[]}},Ns=t=>{try{localStorage.setItem("tutoring_users",JSON.stringify(t)),window.dispatchEvent(new StorageEvent("storage",{key:"tutoring_users",newValue:JSON.stringify(t),oldValue:localStorage.getItem("tutoring_users"),storageArea:localStorage})),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_users",newValue:JSON.stringify(t),oldValue:localStorage.getItem("tutoring_users")}}))}catch{}},Ss=t=>{try{localStorage.setItem("tutoring_currentUser",JSON.stringify(t))}catch{}},pd=()=>{try{const t=localStorage.getItem("tutoring_currentUser");return t?JSON.parse(t):null}catch{return null}},vd=({children:t})=>{const[r,s]=E.useState(()=>{try{return pd()}catch{return null}}),[a,n]=E.useState(!1);let i=null;try{const f=R.useContext(require("./DataContext").DataContext);f&&(i=f.deleteUserData)}catch{}if(E.useEffect(()=>{const m=setTimeout(()=>{try{const y=hr();n(!0)}catch{n(!0)}},100);return()=>clearTimeout(m)},[]),!a)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Инициализация авторизации..."})]})});const o=async(f,m)=>{await new Promise(x=>setTimeout(x,1e3));const h=hr().find(x=>x.email===f);return h?(s(h),Ss(h),!0):(alert("Пользователь с таким email не найден. Пожалуйста, зарегистрируйтесь."),!1)},l=async(f,m,y,h,x,w)=>{try{const u=await fetch(`${He}/api/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f,password:m,name:y,nickname:h,role:x,phone:w})});if(!u.ok){const _=await u.text();try{const P=JSON.parse(_);alert(P.error||"Ошибка регистрации на сервере")}catch{alert("Ошибка регистрации на сервере. Используется локальная регистрация.")}throw new Error("Server registration failed")}const N=await u.json(),S=[...hr(),N];Ns(S),s(N),Ss(N);try{const _=await fetch(`${He}/api/sync`);if(_.ok){const P=await _.json();console.log("✅ Данные синхронизированы после регистрации"),P.teacherProfiles&&localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(P.teacherProfiles)),P.studentProfiles&&localStorage.setItem("tutoring_studentProfiles",JSON.stringify(P.studentProfiles));const B=[];P.teacherProfiles&&Object.entries(P.teacherProfiles).forEach(([T,z])=>{B.push({id:T,email:z.email||"",name:z.name||"",nickname:z.nickname||"",role:"teacher",phone:z.phone||"",profile:z})}),P.studentProfiles&&Object.entries(P.studentProfiles).forEach(([T,z])=>{B.push({id:T,email:z.email||"",name:z.name||"",nickname:z.nickname||"",role:"student",phone:z.phone||"",profile:z})}),localStorage.setItem("tutoring_users",JSON.stringify(B)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_users",newValue:JSON.stringify(B)}}))}}catch(_){console.warn("⚠️ Не удалось синхронизировать данные после регистрации:",_)}return!0}catch{const N=hr(),v=N.some(T=>T.email===f),S=N.some(T=>T.nickname===h);if(v)return alert("Пользователь с таким email уже существует"),!1;if(S)return alert("Пользователь с таким никнеймом уже существует"),!1;const _=x==="teacher"?{subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,education:{university:"",degree:"",graduationYear:void 0,courses:[]}}:{grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""},P={id:fd(),email:f,name:y,nickname:h,role:x,phone:w,profile:_,avatar:_.avatar},B=[...N,P];if(Ns(B),s(P),Ss(P),x==="teacher"){const T=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");T[P.id]=_,localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(T)),console.log("✅ Профиль преподавателя сохранен локально:",P.id),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_teacherProfiles",newValue:JSON.stringify(T)}}))}if(x==="student"){const T=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");T[P.id]=_,localStorage.setItem("tutoring_studentProfiles",JSON.stringify(T)),console.log("✅ Профиль студента сохранен локально:",P.id),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_studentProfiles",newValue:JSON.stringify(T)}}))}try{const T=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}"),z=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}"),L=JSON.parse(localStorage.getItem("tutoring_users")||"[]");if(Object.keys(T).length>0||Object.keys(z).length>0){const K=await fetch(`${He}/api/upload-local-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherProfiles:T,studentProfiles:z,users:L})});if(K.ok){const q=await K.json();console.log("✅ Локальные данные загружены на сервер:",q),alert("Регистрация выполнена локально и данные синхронизированы с сервером!")}else console.warn("⚠️ Не удалось загрузить локальные данные на сервер"),alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}else alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}catch(T){console.warn("⚠️ Ошибка загрузки локальных данных на сервер:",T),alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}return!0}},c=()=>{s(null),localStorage.removeItem("tutoring_currentUser")},d=f=>{if(r){const m={...r,profile:f,avatar:f.avatar};s(m),Ss(m);const h=hr().map(x=>x.id===r.id?m:x);Ns(h),typeof window<"u"&&window.location.hostname!=="localhost"&&fetch("https://tutoring-platform-1756666331-zjfl.onrender.com/api/updateProfile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.id,profileData:f,role:r.role})}).then(x=>{if(x.ok){console.log("Profile updated successfully on server");const w=window.socket;w&&w.emit("profileUpdated",{userId:r.id,profileData:f,role:r.role})}else console.error("Failed to update profile on server:",x.status)}).catch(x=>{console.error("Failed to update profile on server:",x)})}},g=()=>{s(null),localStorage.removeItem("tutoring_users"),localStorage.removeItem("tutoring_currentUser")},p=async()=>{if(!r)return alert("Пользователь не найден"),!1;if(!window.confirm("Вы уверены, что хотите удалить свой аккаунт? Это действие нельзя отменить. Все ваши данные будут безвозвратно удалены."))return!1;try{(await fetch(`${He}/api/delete-user`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.id,role:r.role})})).ok||console.warn("Не удалось удалить пользователя с сервера, продолжаем локальное удаление");const h=hr().filter(x=>x.id!==r.id);if(Ns(h),r.role==="teacher"){const x=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");delete x[r.id],localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(x)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_teacherProfiles",newValue:JSON.stringify(x)}}))}else if(r.role==="student"){const x=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");delete x[r.id],localStorage.setItem("tutoring_studentProfiles",JSON.stringify(x)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_studentProfiles",newValue:JSON.stringify(x)}}))}if(i)i(r.id);else{const w=JSON.parse(localStorage.getItem("tutoring_timeSlots")||"[]").filter(z=>z.teacherId!==r.id);localStorage.setItem("tutoring_timeSlots",JSON.stringify(w));const N=JSON.parse(localStorage.getItem("tutoring_lessons")||"[]").filter(z=>z.teacherId!==r.id&&z.studentId!==r.id);localStorage.setItem("tutoring_lessons",JSON.stringify(N));const S=JSON.parse(localStorage.getItem("tutoring_chats")||"[]").filter(z=>!z.participants.includes(r.id));localStorage.setItem("tutoring_chats",JSON.stringify(S));const P=JSON.parse(localStorage.getItem("tutoring_posts")||"[]").filter(z=>z.userId!==r.id);localStorage.setItem("tutoring_posts",JSON.stringify(P));const T=JSON.parse(localStorage.getItem("tutoring_notifications")||"[]").filter(z=>z.userId!==r.id);localStorage.setItem("tutoring_notifications",JSON.stringify(T))}return c(),alert("Аккаунт успешно удален"),!0}catch(m){return console.error("Ошибка при удалении аккаунта:",m),alert("Произошла ошибка при удалении аккаунта"),!1}};return e.jsx(Zo.Provider,{value:{user:r,login:o,register:l,logout:c,updateProfile:d,clearAllUsers:g,deleteAccount:p},children:t})},el=E.createContext(void 0),ct=()=>{const t=E.useContext(el);if(!t)throw new Error("useData must be used within a DataProvider");return t},ft=(t,r)=>{try{const s=localStorage.getItem(t);if(s){const a=JSON.parse(s);return Array.isArray(a)?a:r}}catch{}return r},Q=(t,r)=>{try{localStorage.setItem(t,JSON.stringify(r))}catch{}},ks=()=>{const t=new Date,r=new Date(t);r.setDate(r.getDate()+1);const s=new Date(t);s.setDate(s.getDate()+2);const a=new Date(t);return a.setDate(a.getDate()+7),{timeSlots:[],lessons:[],chats:[],studentProfiles:{},teacherProfiles:{}}},bd=({children:t})=>{const r=E.useRef(null),[s,a]=E.useState(!1),[n,i]=E.useState(!1),{user:o}=Ye(),l=(o==null?void 0:o.role)==="student";E.useEffect(()=>{l?(i(!0),console.log("🎓 Студент обнаружен - включен офлайн режим")):(i(!1),console.log("👨‍🏫 Преподаватель обнаружен - онлайн режим"))},[l]);const[c,d]=E.useState(()=>{const O=ft("tutoring_timeSlots",[]);if(O.length>0)return O;const b=ks();return Q("tutoring_timeSlots",b.timeSlots),b.timeSlots}),[g,p]=E.useState(()=>ft("tutoring_lessons",[])),[f,m]=E.useState(()=>ft("tutoring_chats",[])),[y,h]=E.useState(()=>{const O=ft("tutoring_studentProfiles",{});if(Object.keys(O).length>0)return O;const b=ks();return Q("tutoring_studentProfiles",b.studentProfiles),b.studentProfiles}),[x,w]=E.useState(()=>{const O=ft("tutoring_teacherProfiles",{});if(Object.keys(O).length>0)return console.log("📱 Загружены локальные профили преподавателей:",Object.keys(O).length),O;const b=ks();return Q("tutoring_teacherProfiles",b.teacherProfiles),b.teacherProfiles}),[u,N]=E.useState(()=>{try{return JSON.parse(localStorage.getItem("tutoring_users")||"[]")}catch{return[]}}),[v,S]=E.useState(()=>ft("tutoring_posts",[])),[_,P]=E.useState(()=>ft("tutoring_notifications",[])),{updateProfile:B}=Ye(),T=()=>{const O=ft("tutoring_timeSlots",[]),b=ft("tutoring_lessons",[]),$=ft("tutoring_chats",[]),D=ks(),I=(O.length>0?O:D.timeSlots).filter((M,F,ne)=>F===ne.findIndex(ce=>ce.id===M.id));d(I),p(b),m($),h(D.studentProfiles),Q("tutoring_timeSlots",I),Q("tutoring_lessons",b),Q("tutoring_chats",$),Q("tutoring_studentProfiles",D.studentProfiles),Je()},z=async()=>{try{console.log("🔄 Загружаем пользователей с сервера...");const O=await fetch(`${He}/api/users`);if(!O.ok)return console.warn("⚠️ Не удалось загрузить пользователей с сервера:",O.status),[];const b=await O.json();console.log("✅ Пользователи загружены с сервера:",b.length);const $=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("📱 Локальные пользователи:",$.length);const j=[...$,...b].filter((I,M,F)=>M===F.findIndex(ne=>ne.id===I.id));return console.log("✅ Уникальные пользователи:",j.length),console.log("👨‍🏫 Преподаватели:",j.filter(I=>I.role==="teacher").length),console.log("👨‍🎓 Студенты:",j.filter(I=>I.role==="student").length),N(j),localStorage.setItem("tutoring_users",JSON.stringify(j)),j}catch(O){return console.error("❌ Ошибка загрузки пользователей с сервера:",O),[]}},L=async()=>{try{console.log("Loading lessons from server...");const O=await fetch(`${He}/api/lessons`);if(!O.ok)return console.error("Failed to load lessons from server:",O.status),[];const b=await O.json();console.log("Loaded lessons from server:",b.length,b);const $=JSON.parse(localStorage.getItem("tutoring_lessons")||"[]");console.log("Local lessons:",$.length,$);const j=[...$,...b].filter((I,M,F)=>M===F.findIndex(ne=>ne.id===I.id));return console.log("Setting lessons in context:",j.length,j),p(j),Q("tutoring_lessons",j),j}catch(O){return console.error("Error loading lessons from server:",O),[]}},K=()=>{try{const O=JSON.parse(localStorage.getItem("tutoring_users")||"[]");N(O)}catch{N([])}},q=()=>{z(),L(),r.current&&s&&(r.current.emit("requestAllSlots"),r.current.emit("requestAllUsers"))},te=async()=>{try{console.log("🔄 Принудительная синхронизация данных с сервера..."),await z();const O=await fetch(`${He}/api/sync`,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(1e4)});if(!O.ok){console.warn("⚠️ Не удалось синхронизировать данные с сервера:",O.status,O.statusText);return}const b=O.headers.get("content-type");if(!b||!b.includes("application/json")){console.warn("⚠️ Сервер вернул не-JSON ответ:",b);return}const $=await O.json();console.log("✅ Данные синхронизации получены:",Object.keys($)),$.timeSlots&&(d($.timeSlots),Q("tutoring_timeSlots",$.timeSlots),console.log("✅ Слоты обновлены:",$.timeSlots.length)),$.lessons&&(p($.lessons),Q("tutoring_lessons",$.lessons),console.log("✅ Уроки обновлены:",$.lessons.length)),$.chats&&(m($.chats),Q("tutoring_chats",$.chats),console.log("✅ Чаты обновлены:",$.chats.length)),$.posts&&(S($.posts),Q("tutoring_posts",$.posts),console.log("✅ Посты обновлены:",$.posts.length));const D=[];$.teacherProfiles&&Object.entries($.teacherProfiles).forEach(([j,I])=>{const M=I;D.push({id:j,email:String(M.email||""),name:String(M.name||""),nickname:String(M.nickname||""),role:"teacher",phone:String(M.phone||""),profile:M})}),$.studentProfiles&&Object.entries($.studentProfiles).forEach(([j,I])=>{const M=I;D.push({id:j,email:String(M.email||""),name:String(M.name||""),nickname:String(M.nickname||""),role:"student",phone:String(M.phone||""),profile:M})}),N(D),Q("tutoring_users",D),console.log("Data sync completed successfully")}catch(O){console.warn("Error syncing data (continuing with local data):",O)}},se=async()=>{try{console.log("📤 Загружаем локальные данные на сервер...");const O=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}"),b=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}"),$=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("📊 Локальные данные:"),console.log(`   👨‍🏫 Преподаватели: ${Object.keys(O).length}`),console.log(`   👨‍🎓 Студенты: ${Object.keys(b).length}`),console.log(`   👥 Пользователи: ${$.length}`);const D=await fetch(`${He}/api/upload-local-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherProfiles:O,studentProfiles:b,users:$})});if(!D.ok){const I=await D.json();throw new Error(I.error||"Ошибка загрузки данных на сервер")}const j=await D.json();return console.log("✅ Локальные данные успешно загружены на сервер:",j),await te(),j}catch(O){throw console.error("❌ Ошибка загрузки локальных данных на сервер:",O),O}};E.useEffect(()=>{const O=async()=>{try{const $=await fetch(`${He}/api/health`,{method:"GET",signal:AbortSignal.timeout(5e3)});if($.ok){const D=await $.json();return console.log("Server health check passed:",D),!0}return!1}catch($){return console.warn("Server not available, working in offline mode:",$),!1}};(async()=>{if(l&&n){console.log("🎓 Студент в офлайн режиме - пропускаем подключение к серверу"),T(),L();return}if(!await O()){console.log("Server not available, loading local data only"),T(),L();return}console.log("Server is available, initializing Socket.IO connection...");const D=Ko(He,{...xd,reconnection:!0,reconnectionAttempts:3,reconnectionDelay:2e3,timeout:1e4});return r.current=D,D.on("connect",()=>{a(!0),console.log("✅ Connected to server via Socket.IO"),console.log(`🌐 Server URL: ${He}`),console.log(`🔌 Socket ID: ${D.id}`),z(),L();const j=ft("tutoring_timeSlots",[]);j.length>0&&j.forEach(I=>{r.current&&r.current.emit("createSlot",I)}),r.current&&(r.current.emit("requestAllPosts"),o&&(r.current.emit("requestUserNotifications",o.id),r.current.emit("subscribeNotifications",o.id)))}),D.on("disconnect",()=>{a(!1),console.log("🔌 Disconnected from server")}),D.on("reconnect",j=>{a(!0),console.log(`🔄 Reconnected to server after ${j} attempts`)}),D.on("reconnect_attempt",j=>{console.log(`🔄 Reconnection attempt ${j}`)}),D.on("connect_error",j=>{a(!1),console.warn("❌ Socket.IO connection error:",j),console.warn("🔧 Working in offline mode until reconnection..."),T(),L()}),D.on("initialData",j=>{const F=[...ft("tutoring_timeSlots",[]),...j.timeSlots].filter((ne,ce,U)=>ce===U.findIndex(V=>V.id===ne.id));d(F),p(j.lessons),Q("tutoring_timeSlots",F),Q("tutoring_lessons",j.lessons),j.chats&&(m(j.chats),Q("tutoring_chats",j.chats))}),D.on("allSlots",j=>{d(j),Q("tutoring_timeSlots",j)}),D.on("allUsers",j=>{N(j),Q("tutoring_users",j)}),r.current&&s&&(r.current.emit("requestAllSlots"),r.current.emit("requestAllUsers")),D.on("slotCreated",j=>{console.log("Slot created via WebSocket:",j),d(I=>{if(I.find(F=>F.id===j.id)){const F=I.map(ne=>ne.id===j.id?j:ne);return Q("tutoring_timeSlots",F),console.log("Existing slot updated, total slots:",F.length),F}else{const F=[...I,j];return Q("tutoring_timeSlots",F),console.log("New slot added, total slots:",F.length),F}})}),D.on("slotBooked",j=>{console.log("Slot booked via WebSocket:",j),d(I=>{const M=I.map(F=>F.id===j.slotId?{...F,isBooked:!0,bookedStudentId:j.bookedStudentId||j.lesson.studentId}:F);return Q("tutoring_timeSlots",M),M}),p(I=>{if(!I.find(F=>F.id===j.lesson.id)){const F=[...I,j.lesson];return Q("tutoring_lessons",F),console.log("New lesson added, total lessons:",F.length),F}return I})}),D.on("slotCancelled",j=>{console.log("Slot cancelled via WebSocket:",j),d(I=>{const M=I.map(F=>F.id===j.slotId?{...F,isBooked:!1,bookedStudentId:void 0}:F);return Q("tutoring_timeSlots",M),M}),p(I=>{const M=I.filter(F=>F.id!==j.lessonId);return Q("tutoring_lessons",M),console.log("Lesson removed, total lessons:",M.length),M})}),D.on("chatCreated",j=>{m(I=>{if(!I.find(F=>F.id===j.id)){const F=[...I,j];return Q("tutoring_chats",F),F}return I})}),D.on("receiveMessage",j=>{m(I=>I.map(M=>{if(M.id===j.chatId){const F={...M,messages:[...M.messages,j.message],lastMessage:j.message};return Q("tutoring_chats",I.map(ne=>ne.id===M.id?F:ne)),F}return M}))}),D.on("chatDeleted",j=>{console.log("chatDeleted event received:",j),m(I=>{const M=I.filter(F=>F.id!==j.chatId);return console.log(`Chat ${j.chatId} removed from state. Total chats: ${M.length}`),Q("tutoring_chats",M),M})}),D.on("chatMarkedAsRead",j=>{m(I=>{const M=I.map(F=>F.id===j.chatId?{...F,messages:F.messages.map(ne=>({...ne,isRead:!0}))}:F);return Q("tutoring_chats",M),M})}),D.on("chatMessagesCleared",j=>{m(I=>{const M=I.map(F=>F.id===j.chatId?{...F,messages:[]}:F);return Q("tutoring_chats",M),M})}),D.on("chatArchived",j=>{m(I=>{const M=I.map(F=>F.id===j.chatId?{...F,archived:!0}:F);return Q("tutoring_chats",M),M})}),D.on("chatUnarchived",j=>{m(I=>{const M=I.map(F=>F.id===j.chatId?{...F,archived:!1}:F);return Q("tutoring_chats",M),M})}),D.on("newNotification",j=>{P(I=>{const M=[...I,j];return Q("tutoring_notifications",M),M})}),D.on("slotDeleted",j=>{console.log("Slot deleted via WebSocket:",j),d(I=>{const M=I.filter(F=>F.id!==j.slotId);return Q("tutoring_timeSlots",M),console.log("Slot removed, total slots:",M.length),M})}),D.on("allSlots",j=>{console.log("Received all slots from server:",j.length),d(j),Q("tutoring_timeSlots",j)}),D.on("allLessons",j=>{console.log("Received all lessons from server:",j.length),p(j),Q("tutoring_lessons",j)}),D.on("dataUpdated",j=>{if(console.log("Received dataUpdated event:",j.type),j.timeSlots&&(d(j.timeSlots),Q("tutoring_timeSlots",j.timeSlots),console.log("Slots updated via dataUpdated:",j.timeSlots.length)),j.lessons&&(p(j.lessons),Q("tutoring_lessons",j.lessons),console.log("Lessons updated via dataUpdated:",j.lessons.length)),j.teacherProfiles){w(j.teacherProfiles),Q("tutoring_teacherProfiles",j.teacherProfiles);const M=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(F=>F.role==="teacher"&&j.teacherProfiles[F.id]?{...F,profile:j.teacherProfiles[F.id]}:F);N(M),Q("tutoring_users",M)}if(j.studentProfiles){h(j.studentProfiles),Q("tutoring_studentProfiles",j.studentProfiles);const M=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(F=>F.role==="student"&&j.studentProfiles[F.id]?{...F,profile:j.studentProfiles[F.id]}:F);N(M),Q("tutoring_users",M)}}),D.on("userRegistered",j=>{N(I=>{if(!I.find(F=>F.id===j.id)){const F=[...I,j];return Q("tutoring_users",F),F}return I})}),r.current&&r.current.on("lessonCompleted",j=>{if(p(I=>{const M=I.map(F=>F.id===j.lesson.id?j.lesson:F);return Q("tutoring_lessons",M),M}),o&&o.role==="teacher"&&j.lesson.status==="completed"){const I={...o.profile};I.lessonsCount=(I.lessonsCount||0)+1,B(I)}}),D.on("studentProfiles",j=>{h(j||{});const M=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(j).forEach(([F,ne])=>{const ce=M.findIndex(U=>U.id===F);ce>=0?M[ce]={...M[ce],profile:ne}:M.push({id:F,email:ne.email||"",name:ne.name||"",nickname:ne.nickname||"",role:"student",phone:ne.phone||"",profile:ne})}),localStorage.setItem("tutoring_users",JSON.stringify(M)),N(M)}),D.on("teacherProfiles",j=>{w(j),Q("tutoring_teacherProfiles",j);const M=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(j).forEach(([F,ne])=>{const ce=M.findIndex(U=>U.id===F);ce>=0?M[ce]={...M[ce],profile:ne}:M.push({id:F,email:ne.email||"",name:ne.name||"",nickname:ne.nickname||"",role:"teacher",phone:ne.phone||"",profile:ne})}),localStorage.setItem("tutoring_users",JSON.stringify(M)),N(M)}),D.on("studentProfiles",j=>{h(j),Q("tutoring_studentProfiles",j);const M=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(j).forEach(([F,ne])=>{const ce=M.findIndex(U=>U.id===F);ce>=0?M[ce]={...M[ce],profile:ne}:M.push({id:F,email:ne.email||"",name:ne.name||"",nickname:ne.nickname||"",role:"student",phone:ne.phone||"",profile:ne})}),localStorage.setItem("tutoring_users",JSON.stringify(M)),N(M)}),D.on("studentProfileUpdated",j=>{h(I=>({...I,[j.studentId]:j.profile}))}),D.on("teacherProfileUpdated",j=>{try{const M=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(F=>F.id===j.teacherId?{...F,profile:j.profile,avatar:j.profile.avatar}:F);localStorage.setItem("tutoring_users",JSON.stringify(M)),N(M)}catch{}}),D.on("profileUpdated",j=>{try{const I=JSON.parse(localStorage.getItem("tutoring_users")||"[]");let M=!1;const F="userId"in j?j.userId:j.id,ne="type"in j?j.type:j.role,ce=j.profile,U=I.map(V=>V.id===F?(M=!0,{...V,profile:ce,avatar:ce.avatar,name:ce.name||V.name,email:ce.email||V.email}):V);M||U.push({id:F,role:ne,profile:ce,avatar:ce.avatar,name:ce.name||"",email:ce.email||""}),localStorage.setItem("tutoring_users",JSON.stringify(U)),N(U),ne==="teacher"?w(V=>({...V,[F]:ce})):ne==="student"&&h(V=>({...V,[F]:ce})),console.log("Profile updated via WebSocket:",{userId:F,role:ne,profile:ce})}catch(I){console.error("Error processing profileUpdated event:",I)}}),D.on("userRegistered",j=>{try{const I=JSON.parse(localStorage.getItem("tutoring_users")||"[]"),M=I.findIndex(F=>F.id===j.id);M>=0?I[M]=j:I.push(j),localStorage.setItem("tutoring_users",JSON.stringify(I)),N(I)}catch{}}),D.on("allPosts",j=>{S(j),Q("tutoring_posts",j)}),D.on("postCreated",j=>{S(I=>{const M=[j,...I];return Q("tutoring_posts",M),M})}),D.on("postReactionUpdated",j=>{S(I=>{const M=I.map(F=>F.id===j.postId?{...F,reactions:j.reactions,likes:j.likes}:F);return Q("tutoring_posts",M),M})}),D.on("postCommentAdded",j=>{S(I=>{const M=I.map(F=>F.id===j.postId?{...F,comments:[...F.comments,j.comment]}:F);return Q("tutoring_posts",M),M})}),D.on("postEdited",j=>{S(I=>{const M=I.map(F=>F.id===j.postId?{...F,text:j.text,tags:j.tags,editedAt:j.editedAt}:F);return Q("tutoring_posts",M),M})}),D.on("postDeleted",j=>{S(I=>{const M=I.filter(F=>F.id!==j.postId);return Q("tutoring_posts",M),M})}),D.on("postBookmarkUpdated",j=>{S(I=>{const M=I.map(F=>F.id===j.postId?{...F,bookmarks:j.bookmarks}:F);return Q("tutoring_posts",M),M})}),D.on("searchResults",j=>{}),D.on("userNotifications",j=>{P(j),Q("tutoring_notifications",j)}),D.on("newNotification",j=>{P(I=>{const M=[j,...I];return Q("tutoring_notifications",M),M})}),D.on("notificationMarkedAsRead",j=>{P(I=>{const M=I.map(F=>F.id===j.notificationId?{...F,isRead:!0,readAt:new Date().toISOString()}:F);return Q("tutoring_notifications",M),M})}),D.on("allNotificationsMarkedAsRead",j=>{P(I=>{const M=I.map(F=>F.userId===j.userId?{...F,isRead:!0,readAt:new Date().toISOString()}:F);return Q("tutoring_notifications",M),M})}),()=>{D.close(),r.current=null}})()},[l,n]),E.useEffect(()=>{const O=$=>{if($.key==="tutoring_users")try{const D=JSON.parse($.newValue||"[]");N(D)}catch{N([])}},b=$=>{var D,j,I;if(((D=$.detail)==null?void 0:D.key)==="tutoring_users")try{const M=JSON.parse($.detail.newValue||"[]");N(M),console.log("🔄 Пользователи обновлены через customStorage:",M.length)}catch{N([])}if(((j=$.detail)==null?void 0:j.key)==="tutoring_teacherProfiles")try{const M=JSON.parse($.detail.newValue||"{}");w(M),console.log("🔄 Профили преподавателей обновлены через customStorage:",Object.keys(M).length)}catch(M){console.error("❌ Ошибка обновления профилей преподавателей:",M)}if(((I=$.detail)==null?void 0:I.key)==="tutoring_studentProfiles")try{const M=JSON.parse($.detail.newValue||"{}");h(M),console.log("🔄 Профили студентов обновлены через customStorage:",Object.keys(M).length)}catch(M){console.error("❌ Ошибка обновления профилей студентов:",M)}};return window.addEventListener("storage",O),window.addEventListener("customStorage",b),()=>{window.removeEventListener("storage",O),window.removeEventListener("customStorage",b)}},[]),E.useEffect(()=>{Q("tutoring_timeSlots",c)},[c]),E.useEffect(()=>{Q("tutoring_lessons",g)},[g]),E.useEffect(()=>{Q("tutoring_chats",f)},[f]),E.useEffect(()=>{Q("tutoring_posts",v)},[v]),E.useEffect(()=>{Q("tutoring_notifications",_)},[_]),E.useEffect(()=>{o&&r.current&&s&&(r.current.emit("subscribeNotifications",o.id),r.current.emit("requestUserNotifications",o.id))},[o,s]);const re=O=>{const b={...O,id:`slot_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};d($=>{const D=[...$,b];return Q("tutoring_timeSlots",D),D}),r.current&&s&&r.current.emit("createSlot",b)},k=async(O,b,$,D)=>new Promise((j,I)=>{if((D==null?void 0:D.mode)==="assign"&&(!b||!$)){alert("Ошибка: не выбран ученик для назначения урока!"),I(new Error("createSlot: assign mode without studentId/studentName"));return}const M=!!b,F={...O,id:`slot_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,isBooked:M,...M?{bookedStudentId:b}:{}};if(d(ne=>{const ce=[...ne,F];return Q("tutoring_timeSlots",ce),ce}),r.current&&s&&r.current.emit("createSlot",F),M&&b&&$){const ne={id:`lesson_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,studentId:b,teacherId:F.teacherId,studentName:$,teacherName:F.teacherName,subject:F.subject,date:F.date,startTime:F.startTime,endTime:F.endTime,duration:F.duration,format:F.format,status:"scheduled",price:F.price,lessonType:F.lessonType};if(p(ce=>[...ce,ne]),me(b,F.teacherId,$,F.teacherName),o&&o.role==="teacher"){const ce={...o.profile};ce.students||(ce.students=[]),ce.students.includes(b)||ce.students.push(b),B(ce)}r.current&&s&&r.current.emit("bookSlot",{slotId:F.id,lesson:ne,bookedStudentId:b})}j(F)}),H=(O,b,$,D)=>{const j=c.find(M=>M.id===O);if(!j||j.isBooked)return;if(o&&o.role==="teacher"){const M={...o.profile};M.students||(M.students=[]),M.students.includes(b)||M.students.push(b),B(M)}d(M=>M.map(F=>F.id===O?{...F,isBooked:!0,bookedStudentId:b}:F));const I={id:`lesson_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,studentId:b,teacherId:j.teacherId,studentName:$,teacherName:j.teacherName,subject:j.subject,date:j.date,startTime:j.startTime,endTime:j.endTime,duration:j.duration,format:j.format,status:"scheduled",price:j.price,lessonType:j.lessonType,comment:D||""};p(M=>[...M,I]),me(b,j.teacherId,$,j.teacherName),r.current&&s&&r.current.emit("bookSlot",{slotId:O,lesson:I,bookedStudentId:b})},Y=O=>{const b=g.find(D=>D.id===O);if(!b)return;const $=c.find(D=>D.teacherId===b.teacherId&&D.date===b.date&&D.startTime===b.startTime);p(D=>D.filter(j=>j.id!==O)),$&&(d(D=>D.map(j=>j.id===$.id?{...j,isBooked:!1,bookedStudentId:void 0}:j)),r.current&&s&&r.current.emit("cancelSlot",{slotId:$.id,lessonId:O}))},A=(O,b,$)=>{const D=g.find(I=>I.id===O);if(!D)return;const j=new Date(`2000-01-01T${$}`);j.setMinutes(j.getMinutes()+D.duration),p(I=>I.map(M=>M.id===O?{...M,date:b,startTime:$,endTime:j.toTimeString().slice(0,5)}:M)),d(I=>I.map(M=>M.teacherId===D.teacherId&&M.date===D.date&&M.startTime===D.startTime?{...M,isBooked:!1,bookedStudentId:void 0}:M))},ae=O=>c.filter($=>{var I;if($.isBooked)return!1;const D=new Date($.date),j=new Date;if(j.setHours(0,0,0,0),D<j||O.grade&&O.grade!==""&&(!$.grades||!$.grades.includes(O.grade))||O.subject&&O.subject!==""&&$.subject!==O.subject||O.experience&&O.experience!==""&&$.experience!==O.experience||O.lessonType&&O.lessonType!==""&&$.lessonType!==O.lessonType||O.duration&&O.duration>0&&$.duration!==O.duration||O.format&&O.format!==""&&$.format!==O.format||O.minRating&&O.minRating>0&&($.rating||0)<O.minRating||O.goals&&O.goals.length>0&&(!$.goals||!O.goals.some(M=>$.goals.includes(M))))return!1;if(O.city&&O.city!==""){const M=u.find(ne=>ne.id===$.teacherId),F=((I=M==null?void 0:M.profile)==null?void 0:I.city)||"";if(F&&!F.toLowerCase().includes(O.city.toLowerCase()))return!1}return!0}),me=(O,b,$,D)=>{console.log("🔍 getOrCreateChat DEBUG:"),console.log("- Participant 1:",{id:O,name:$}),console.log("- Participant 2:",{id:b,name:D}),console.log("- Current chats count:",f.length);const j=f.find(M=>M.participants.includes(O)&&M.participants.includes(b));if(j)return console.log("✅ Found existing chat:",j.id),j.id;console.log("🆕 Creating new chat...");const I={id:`chat_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,participants:[O,b],participantNames:[$,D],messages:[]};if(console.log("📝 New chat created:",I.id),m(M=>{const F=[...M,I];return Q("tutoring_chats",F),console.log("💾 Chat saved to localStorage, total chats:",F.length),F}),r.current&&s){console.log("📡 Sending chat to server..."),r.current.emit("createChat",I);const M={id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:b,type:"new_chat",title:"Новый чат",message:`${$} создал с вами чат`,isRead:!1,timestamp:new Date().toISOString(),data:{chatId:I.id,studentId:O,studentName:$}};r.current.emit("createNotification",M),console.log("📬 Notification sent to server")}else console.log("⚠️ Socket not connected, chat not sent to server");return console.log("🔍 END getOrCreateChat DEBUG"),I.id},he=(O,b,$,D)=>{console.log("🔍 sendMessage DEBUG:"),console.log("- Chat ID:",O),console.log("- Sender:",{id:b,name:$}),console.log("- Content:",D);const j=f.find(ne=>ne.id===O);if(!j){console.error("❌ Chat not found:",O);return}console.log("✅ Chat found:",{id:j.id,participants:j.participants,participantNames:j.participantNames});const I=j.participants.find(ne=>ne!==b),M=j.participantNames.find((ne,ce)=>j.participants[ce]!==b);if(!I){console.error("❌ Receiver not found in chat participants");return}console.log("📬 Receiver:",{id:I,name:M});const F={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,senderId:b,senderName:$,receiverId:I,receiverName:M||"Неизвестный пользователь",content:D,timestamp:new Date().toISOString(),isRead:!1};console.log("📝 Message created:",F.id),m(ne=>ne.map(ce=>{if(ce.id===O){const U={...ce,messages:[...ce.messages,F],lastMessage:F};return Q("tutoring_chats",ne.map(V=>V.id===ce.id?U:V)),console.log("💾 Message saved locally, total messages in chat:",U.messages.length),U}return ce})),r.current&&s?(console.log("📡 Sending message to server..."),r.current.emit("sendMessage",{chatId:O,message:F}),console.log("✅ Message sent to server")):console.log("⚠️ Socket not connected, message not sent to server"),console.log("🔍 END sendMessage DEBUG")},ge=(O,b,$,D,j)=>{if(console.log("🔍 sendMessageToUser DEBUG:"),console.log("- Sender:",{id:O,name:b}),console.log("- Receiver:",{id:$,name:D}),console.log("- Content:",j),!O||!b||!$||!D||!j)return console.error("❌ Missing required parameters for sendMessageToUser"),"";const I=me(O,$,b,D);return console.log("- Chat ID:",I),I?(he(I,O,b,j),console.log("✅ Message sent successfully to chat:",I),console.log("🔍 END sendMessageToUser DEBUG"),I):(console.error("❌ Failed to create or find chat"),"")},ye=O=>{r.current&&s&&r.current.emit("lessonCompleted",{lessonId:O})},J=(O,b)=>{r.current&&r.current.emit("updateStudentProfile",{studentId:O,profile:b}),h($=>({...$,[O]:b}))},pe=O=>{d(b=>{const $=b.map(D=>D.id===O?{...D,isDeleted:!0}:D);return Q("tutoring_timeSlots",$),$}),r.current&&s&&r.current.emit("deleteSlot",{slotId:O})},Ee=()=>{d([]),p([]),m([]),localStorage.removeItem("tutoring_timeSlots"),localStorage.removeItem("tutoring_lessons"),localStorage.removeItem("tutoring_chats"),localStorage.removeItem("tutoring_users"),localStorage.removeItem("tutoring_currentUser")},Z=(O,b)=>{r.current&&s&&r.current.emit("updateTeacherProfile",{teacherId:O,profile:b});try{const D=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(j=>j.id===O?{...j,profile:b,avatar:b.avatar}:j);localStorage.setItem("tutoring_users",JSON.stringify(D))}catch{}},Ne=O=>{if(!o)return;const b=j=>{if(!j)return[];const I=/#[\wа-яё]+/gi,M=j.match(I);return M?[...new Set(M.map(F=>F.toLowerCase()))]:[]},$=O.media.map(j=>URL.createObjectURL(j)),D={id:`post_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:o.id,userName:o.name,userAvatar:o.avatar,text:O.text,media:$,type:O.type,date:new Date().toISOString(),reactions:[],comments:[],isBookmarked:!1,tags:b(O.text),likes:0,views:0,bookmarks:[]};S(j=>{const I=[D,...j];return Q("tutoring_posts",I),I}),r.current&&s&&r.current.emit("createPost",D)},Oe=(O,b)=>{o&&(S($=>{const D=$.map(j=>{if(j.id===O){const I=j.reactions.find(ne=>ne.userId===o.id);let M=[...j.reactions],F=j.likes||0;return I?I.type===b?(M=j.reactions.filter(ne=>ne.userId!==o.id),F=Math.max(0,F-1)):I.type=b:(M.push({id:`reaction_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:o.id,type:b,date:new Date().toISOString()}),F++),{...j,reactions:M,likes:F}}return j});return Q("tutoring_posts",D),D}),r.current&&s&&r.current.emit("addReaction",{postId:O,reactionType:b,userId:o.id}))},tt=(O,b)=>{if(!o)return;const $={id:`comment_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:o.id,userName:o.name,userAvatar:o.avatar,text:b,date:new Date().toISOString()};S(D=>{const j=D.map(I=>I.id===O?{...I,comments:[...I.comments,$]}:I);return Q("tutoring_posts",j),j}),r.current&&s&&r.current.emit("addComment",{postId:O,comment:$})},Ke=O=>{},Me=O=>{o&&(S(b=>{const $=b.map(D=>{if(D.id===O){const j=D.bookmarks||[],I=j.indexOf(o.id);let M=[...j];return I===-1?M.push(o.id):M.splice(I,1),{...D,bookmarks:M}}return D});return Q("tutoring_posts",$),$}),r.current&&s&&r.current.emit("bookmarkPost",{postId:O,userId:o.id}))},G=(O,b)=>{const $=D=>{if(!D)return[];const j=/#[\wа-яё]+/gi,I=D.match(j);return I?[...new Set(I.map(M=>M.toLowerCase()))]:[]};S(D=>{const j=D.map(I=>I.id===O?{...I,text:b,tags:$(b),editedAt:new Date().toISOString()}:I);return Q("tutoring_posts",j),j}),r.current&&s&&r.current.emit("editPost",{postId:O,newText:b})},je=O=>{S(b=>{const $=b.filter(D=>D.id!==O);return Q("tutoring_posts",$),$}),r.current&&s&&r.current.emit("deletePost",{postId:O})},ue=O=>{console.log("deleteChat called with chatId:",O),console.log("Current chats count:",f.length),m(b=>{if(!b.find(j=>j.id===O))return console.warn("Chat not found for deletion:",O),b;const D=b.filter(j=>j.id!==O);return console.log(`Chat ${O} removed. New count: ${D.length}`),Q("tutoring_chats",D),D}),r.current&&s?(console.log("Sending deleteChat event to server"),r.current.emit("deleteChat",{chatId:O})):console.warn("Socket not connected, chat deletion not synced to server")},Le=O=>{m(b=>{const $=b.map(D=>D.id===O?{...D,messages:D.messages.map(j=>({...j,isRead:!0}))}:D);return Q("tutoring_chats",$),$}),r.current&&s&&r.current.emit("markChatAsRead",{chatId:O})},_e=O=>{m(b=>{const $=b.map(D=>D.id===O?{...D,messages:[]}:D);return Q("tutoring_chats",$),$}),r.current&&s&&r.current.emit("clearChatMessages",{chatId:O})},xe=O=>{m(b=>{const $=b.map(D=>D.id===O?{...D,archived:!0}:D);return Q("tutoring_chats",$),$}),r.current&&s&&r.current.emit("archiveChat",{chatId:O})},Fe=O=>{m(b=>{const $=b.map(D=>D.id===O?{...D,archived:!1}:D);return Q("tutoring_chats",$),$}),r.current&&s&&r.current.emit("unarchiveChat",{chatId:O})},Je=async()=>{try{console.log("🔄 Loading chats from server:",`${He}/api/sync`);const O=await fetch(`${He}/api/sync`);if(O.ok){const b=O.headers.get("content-type");if(b&&b.includes("application/json")){const $=await O.json();$.chats&&(console.log("✅ Loaded chats from server:",$.chats.length),m($.chats),Q("tutoring_chats",$.chats))}else console.warn("⚠️ Server returned non-JSON response, using local chats")}else console.error("❌ Failed to load chats from server:",O.status,O.statusText)}catch(O){console.warn("⚠️ Error loading chats from server, using local chats:",O)}},Nt=O=>{console.log("🗑️ Удаляем все данные пользователя:",O),d(b=>{const $=b.filter(D=>D.teacherId!==O);return Q("tutoring_timeSlots",$),$}),p(b=>{const $=b.filter(D=>D.teacherId!==O&&D.studentId!==O);return Q("tutoring_lessons",$),$}),m(b=>{const $=b.filter(D=>!D.participants.includes(O));return Q("tutoring_chats",$),$}),S(b=>{const $=b.filter(D=>D.userId!==O);return Q("tutoring_posts",$),$}),P(b=>{const $=b.filter(D=>D.userId!==O);return Q("tutoring_notifications",$),$}),(o==null?void 0:o.role)==="teacher"?w(b=>{const $={...b};return delete $[O],Q("tutoring_teacherProfiles",$),$}):(o==null?void 0:o.role)==="student"&&h(b=>{const $={...b};return delete $[O],Q("tutoring_studentProfiles",$),$}),N(b=>{const $=b.filter(D=>D.id!==O);return Q("tutoring_users",$),$}),console.log("✅ Все данные пользователя удалены")};return e.jsx(el.Provider,{value:{timeSlots:c,lessons:g,chats:f,posts:v,createTimeSlot:re,bookLesson:H,cancelLesson:Y,rescheduleLesson:A,getFilteredSlots:ae,sendMessage:he,sendMessageToUser:ge,getOrCreateChat:me,clearAllData:Ee,isConnected:s,isOfflineMode:n,completeLesson:ye,studentProfiles:y,updateStudentProfile:J,deleteSlot:pe,createSlot:k,allUsers:u,setAllUsers:O=>{N(O),localStorage.setItem("tutoring_users",JSON.stringify(O))},refreshUsers:K,refreshAllData:q,forceSyncData:te,uploadLocalDataToServer:se,teacherProfiles:x,updateTeacherProfile:Z,socketRef:r,loadInitialData:T,createPost:Ne,addReaction:Oe,addComment:tt,sharePost:Ke,bookmarkPost:Me,editPost:G,deletePost:je,searchPosts:O=>{r.current&&s&&r.current.emit("searchPosts",O)},getPostsByUser:O=>v.filter(b=>b.userId===O),getBookmarkedPosts:O=>v.filter(b=>{var $;return($=b.bookmarks)==null?void 0:$.includes(O)}),notifications:_,subscribeToNotifications:O=>{r.current&&s&&r.current.emit("subscribeNotifications",O)},unsubscribeFromNotifications:O=>{r.current&&s&&r.current.emit("unsubscribeNotifications",O)},markNotificationAsRead:O=>{P(b=>{const $=b.map(D=>D.id===O?{...D,isRead:!0,readAt:new Date().toISOString()}:D);return Q("tutoring_notifications",$),$}),r.current&&s&&r.current.emit("markNotificationAsRead",O)},markAllNotificationsAsRead:O=>{P(b=>{const $=b.map(D=>D.userId===O?{...D,isRead:!0,readAt:new Date().toISOString()}:D);return Q("tutoring_notifications",$),$}),r.current&&s&&r.current.emit("markAllNotificationsAsRead",O)},deleteNotification:O=>{P(b=>{const $=b.filter(D=>D.id!==O);return Q("tutoring_notifications",$),$})},deleteChat:ue,markChatAsRead:Le,clearChatMessages:_e,archiveChat:xe,unarchiveChat:Fe,loadChatsFromServer:Je,deleteUserData:Nt},children:t})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),oe=(t,r)=>{const s=E.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},g)=>E.createElement("svg",{ref:g,...yd,width:n,height:n,stroke:a,strokeWidth:o?Number(i)*24/Number(n):i,className:["lucide",`lucide-${jd(t)}`,l].join(" "),...d},[...r.map(([p,f])=>E.createElement(p,f)),...Array.isArray(c)?c:[c]]));return s.displayName=`${t}`,s};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=oe("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=oe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=oe("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=oe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=oe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=oe("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=oe("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=oe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=oe("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=oe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=oe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=oe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=oe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=oe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=oe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=oe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=oe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=oe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=oe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=oe("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dd=oe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=oe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=oe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=oe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=oe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=oe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=oe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=oe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=oe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=oe("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=oe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=oe("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=oe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=oe("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=oe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=oe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=oe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=oe("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=oe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=oe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=oe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=oe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=oe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=oe("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=oe("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=oe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=oe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=oe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=oe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=oe("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bd=oe("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=oe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hd=oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=oe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=oe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=oe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=oe("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=oe("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=oe("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=oe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),qd=({onSuccess:t})=>{const[r,s]=E.useState(!0),[a,n]=E.useState(""),[i,o]=E.useState(""),[l,c]=E.useState(""),[d,g]=E.useState(""),[p,f]=E.useState(""),[m,y]=E.useState("student"),[h,x]=E.useState(!1),[w,u]=E.useState(!1),{login:N,register:v}=Ye(),S=async _=>{_.preventDefault(),x(!0);try{if(r)await N(a,i),t();else{if(!w){u(!0),x(!1);return}if(!p.trim()){alert("Пожалуйста, введите никнейм"),x(!1);return}if(!d.trim()){alert("Пожалуйста, введите номер телефона"),x(!1);return}await v(a,i,l,p,m,d)&&t()}}catch{}finally{x(!1)}};return!r&&w?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-[#0D3C69] rounded-xl flex items-center justify-center mb-4",children:e.jsx(Ge,{className:"h-6 w-6 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Выберите роль"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Кто вы на нашей платформе?"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>y("student"),className:`w-full p-6 rounded-xl border-2 transition-all duration-200 ${m==="student"?"border-[#0D3C69] bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${m==="student"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(be,{className:`h-6 w-6 ${m==="student"?"text-[#0D3C69]":"text-gray-600"}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Ученик"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ищу репетитора для обучения"})]})]})}),e.jsx("button",{onClick:()=>y("teacher"),className:`w-full p-6 rounded-xl border-2 transition-all duration-200 ${m==="teacher"?"border-[#0D3C69] bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${m==="teacher"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(zd,{className:`h-6 w-6 ${m==="teacher"?"text-[#0D3C69]":"text-gray-600"}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Преподаватель"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Провожу уроки и делюсь знаниями"})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nickname",className:"block text-sm font-medium text-gray-700 mb-1",children:"Никнейм"}),e.jsx("input",{id:"nickname",type:"text",value:p,onChange:_=>f(_.target.value),required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200",placeholder:"Введите никнейм"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Номер телефона"}),e.jsxs("div",{className:"relative",children:[e.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",type:"tel",value:d,onChange:_=>g(_.target.value),required:!0,className:"w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsx("button",{onClick:S,disabled:h||!p.trim()||!d.trim(),className:"w-full bg-[#0D3C69] hover:bg-[#0A2F56] text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Создание аккаунта...":"Завершить регистрацию"}),e.jsx("button",{onClick:()=>u(!1),className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-4 rounded-lg transition-colors duration-200",children:"Назад"})]})]})}):e.jsxs("div",{className:"min-h-screen flex",children:[e.jsx("div",{className:"flex-1 bg-white flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Добро пожаловать"}),e.jsx("p",{className:"text-lg text-gray-600",children:r?"Войдите в свой аккаунт":"Создайте новый аккаунт"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[!r&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Имя"}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"name",type:"text",value:l,onChange:_=>c(_.target.value),required:!r,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"Введите ваше имя"})]})]}),!r&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Номер телефона"}),e.jsxs("div",{className:"relative",children:[e.jsx(br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",type:"tel",value:d,onChange:_=>g(_.target.value),required:!r,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(on,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"email",type:"email",value:a,onChange:_=>n(_.target.value),required:!0,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"Введите ваш email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Пароль"}),e.jsxs("div",{className:"relative",children:[e.jsx(rl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"password",type:"password",value:i,onChange:_=>o(_.target.value),required:!0,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:r?"Введите пароль":"Создайте пароль"})]})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-[#0D3C69] hover:bg-[#0A2F56] text-white font-bold py-4 px-6 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-lg shadow-lg hover:shadow-xl transform hover:scale-105",children:h?r?"Вход...":"Создание аккаунта...":r?"Войти":"Создать аккаунт"})]}),e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["Продолжая, вы соглашаетесь с"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Условиями использования"})," ","и"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Политикой конфиденциальности"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-gray-600",children:r?"Нет аккаунта? ":"Уже есть аккаунт? "}),e.jsx("button",{onClick:()=>{s(!r),u(!1),n(""),o(""),c(""),g(""),f("")},className:"text-[#0D3C69] hover:text-[#0A2F56] font-medium",children:r?"Зарегистрироваться":"Войти"})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"text-[#0D3C69] hover:text-[#0A2F56] text-sm",children:"Получить помощь"})}),e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["Этот сайт защищен reCAPTCHA Enterprise и применяются"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Политика конфиденциальности"})," ","и"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Условия использования"})," ","Google."]})]})}),e.jsxs("div",{className:"flex-1 bg-gray-900 flex flex-col items-center justify-center p-8 relative overflow-hidden",children:[e.jsx("h2",{className:"text-5xl font-bold text-white mb-8 text-center",children:"Платформа для обучения"}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("blockquote",{className:"text-xl text-gray-300 italic leading-relaxed",children:'"Важно не количество знаний, а качество их. Можно знать очень многое не зная самого нужного."'}),e.jsx("cite",{className:"text-sm text-gray-400 mt-4 block",children:"— Л. Толстой"})]}),e.jsxs("div",{className:"relative w-full h-64 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-blue-900 via-purple-900 to-black"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 opacity-20"})}),e.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((_,P)=>e.jsx("div",{className:"absolute w-1 h-1 bg-yellow-300 rounded-full animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`}},P))})]})]})]})},Yd=({activeTab:t,onTabChange:r})=>{const{user:s,logout:a}=Ye(),n=[{id:"home",label:"Главная",icon:Td},{id:"lessons",label:"Мои уроки",icon:Qe},{id:"chats",label:"Чаты",icon:Ie},{id:"profile",label:"Профиль",icon:be}],i=[{id:"slots",label:"Слоты",icon:Qe},{id:"calendar",label:"Календарь",icon:wd},{id:"students",label:"Ученики",icon:be},{id:"chats",label:"Чаты",icon:Ie},{id:"profile",label:"Профиль",icon:be}],o=(s==null?void 0:s.role)==="teacher"?i:n;return e.jsx("nav",{className:"bg-card-light dark:bg-card-dark shadow-lg border-b border-border-light dark:border-border-dark transition-colors",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-8",children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-xl flex items-center justify-center shadow-md",style:{background:"#175b8c"},children:e.jsx("span",{className:"text-white font-bold text-lg",style:{fontFamily:"Inter, sans-serif",fontSize:28},children:"Na"})}),e.jsx("span",{className:"ml-3 text-2xl font-bold",style:{color:"#175b8c",fontFamily:"Inter, sans-serif"},children:"uchi"})]}),e.jsx("div",{className:"hidden md:flex space-x-8",children:o.map(l=>{const c=l.icon;return e.jsxs("button",{onClick:()=>r(l.id),className:`flex items-center gap-2 px-5 py-3 rounded-xl text-base font-semibold transition-all duration-200 shadow-none ${t===l.id?"bg-primary-light/10 text-primary-light dark:bg-primary-dark/20 dark:text-primary-dark shadow-md":"text-textSecondary-light dark:text-textSecondary-dark hover:bg-border-light dark:hover:bg-border-dark hover:text-primary-light dark:hover:text-primary-dark"}`,children:[e.jsx(c,{className:"h-5 w-5"}),e.jsx("span",{children:l.label})]},l.id)})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:s==null?void 0:s.nickname.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:s==null?void 0:s.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["@",s==null?void 0:s.nickname]})]}),e.jsx("span",{className:"hidden md:block text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full",children:(s==null?void 0:s.role)==="teacher"?"Преподаватель":"Ученик"})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg transition-all duration-200",title:"Выйти",children:e.jsx(Md,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"md:hidden border-t border-border-light dark:border-border-dark",children:e.jsx("div",{className:"flex space-x-1 py-2 overflow-x-auto",children:o.map(l=>{const c=l.icon;return e.jsxs("button",{onClick:()=>r(l.id),className:`flex-shrink-0 flex flex-col items-center gap-1 px-4 py-3 rounded-xl text-xs font-semibold transition-all duration-200 ${t===l.id?"bg-primary-light/10 text-primary-light dark:bg-primary-dark/20 dark:text-primary-dark shadow-md":"text-textSecondary-light dark:text-textSecondary-dark hover:bg-border-light dark:hover:bg-border-dark hover:text-primary-light dark:hover:text-primary-dark"}`,children:[e.jsx(c,{className:"h-5 w-5"}),e.jsx("span",{children:l.label})]},l.id)})})})]})})};function Lt(t){"@babel/helpers - typeof";return Lt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Lt(t)}function Vd(t,r){if(Lt(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var a=s.call(t,r);if(Lt(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function cl(t){var r=Vd(t,"string");return Lt(r)=="symbol"?r:r+""}function Zt(t,r,s){return(r=cl(r))in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function ui(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,a)}return s}function Ce(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?ui(Object(s),!0).forEach(function(a){Zt(t,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ui(Object(s)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(s,a))})}return t}function ea(t,r){if(t==null)return{};var s={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(r.indexOf(a)!==-1)continue;s[a]=t[a]}return s}function Mt(t,r){if(t==null)return{};var s,a,n=ea(t,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function Ue(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function mi(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,cl(a.key),a)}}function We(t,r,s){return r&&mi(t.prototype,r),s&&mi(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function Is(t){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Is(t)}function dl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dl=function(){return!!t})()}function Kd(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jd(t,r){if(r&&(Lt(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kd(t)}function Ze(t,r,s){return r=Is(r),Jd(t,dl()?Reflect.construct(r,s||[],Is(t).constructor):r.apply(t,s))}function Ls(t,r){return Ls=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},Ls(t,r)}function et(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&Ls(t,r)}function ul(t){if(Array.isArray(t))return t}function Xd(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var a,n,i,o,l=[],c=!0,d=!1;try{if(i=(s=s.call(t)).next,r!==0)for(;!(c=(a=i.call(s)).done)&&(l.push(a.value),l.length!==r);c=!0);}catch(g){d=!0,n=g}finally{try{if(!c&&s.return!=null&&(o=s.return(),Object(o)!==o))return}finally{if(d)throw n}}return l}}function Fa(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,a=Array(r);s<r;s++)a[s]=t[s];return a}function cn(t,r){if(t){if(typeof t=="string")return Fa(t,r);var s={}.toString.call(t).slice(8,-1);return s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set"?Array.from(t):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Fa(t,r):void 0}}function ml(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sr(t,r){return ul(t)||Xd(t,r)||cn(t,r)||ml()}function hl(t){var r,s,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t))for(r=0;r<t.length;r++)t[r]&&(s=hl(t[r]))&&(a&&(a+=" "),a+=s);else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Re(){for(var t,r,s=0,a="";s<arguments.length;)(t=arguments[s++])&&(r=hl(t))&&(a&&(a+=" "),a+=r);return a}function Ae(){return Ae=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},Ae.apply(null,arguments)}var Qd=function(t,r,s,a,n,i,o,l){if(!t){var c;if(r===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[s,a,n,i,o,l],g=0;c=new Error(r.replace(/%s/g,function(){return d[g++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}},Zd=Qd;const Xr=jt(Zd);var eu=function(){};function tu(t,r){var s={};return Object.keys(t).forEach(function(a){s[Ms(a)]=eu}),s}function hi(t,r){return t[r]!==void 0}function Ms(t){return"default"+t.charAt(0).toUpperCase()+t.substr(1)}function ru(t){return!!t&&(typeof t!="function"||t.prototype&&t.prototype.isReactComponent)}function su(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,Ls(t,r)}function fl(){var t=this.constructor.getDerivedStateFromProps(this.props,this.state);t!=null&&this.setState(t)}function gl(t){function r(s){var a=this.constructor.getDerivedStateFromProps(t,s);return a??null}this.setState(r.bind(this))}function xl(t,r){try{var s=this.props,a=this.state;this.props=t,this.state=r,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(s,a)}finally{this.props=s,this.state=a}}fl.__suppressDeprecationWarning=!0;gl.__suppressDeprecationWarning=!0;xl.__suppressDeprecationWarning=!0;function au(t){var r=t.prototype;if(!r||!r.isReactComponent)throw new Error("Can only polyfill class components");if(typeof t.getDerivedStateFromProps!="function"&&typeof r.getSnapshotBeforeUpdate!="function")return t;var s=null,a=null,n=null;if(typeof r.componentWillMount=="function"?s="componentWillMount":typeof r.UNSAFE_componentWillMount=="function"&&(s="UNSAFE_componentWillMount"),typeof r.componentWillReceiveProps=="function"?a="componentWillReceiveProps":typeof r.UNSAFE_componentWillReceiveProps=="function"&&(a="UNSAFE_componentWillReceiveProps"),typeof r.componentWillUpdate=="function"?n="componentWillUpdate":typeof r.UNSAFE_componentWillUpdate=="function"&&(n="UNSAFE_componentWillUpdate"),s!==null||a!==null||n!==null){var i=t.displayName||t.name,o=typeof t.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+i+" uses "+o+" but also contains the following legacy lifecycles:"+(s!==null?`
  `+s:"")+(a!==null?`
  `+a:"")+(n!==null?`
  `+n:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof t.getDerivedStateFromProps=="function"&&(r.componentWillMount=fl,r.componentWillReceiveProps=gl),typeof r.getSnapshotBeforeUpdate=="function"){if(typeof r.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");r.componentWillUpdate=xl;var l=r.componentDidUpdate;r.componentDidUpdate=function(d,g,p){var f=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:p;l.call(this,d,g,f)}}return t}var nu="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function pl(t,r,s){s===void 0&&(s=[]);var a=t.displayName||t.name||"Component",n=ru(t),i=Object.keys(r),o=i.map(Ms);n||!s.length||Xr(!1);var l=function(d){su(g,d);function g(){for(var f,m=arguments.length,y=new Array(m),h=0;h<m;h++)y[h]=arguments[h];f=d.call.apply(d,[this].concat(y))||this,f.handlers=Object.create(null),i.forEach(function(w){var u=r[w],N=function(S){if(f.props[u]){var _;f._notifying=!0;for(var P=arguments.length,B=new Array(P>1?P-1:0),T=1;T<P;T++)B[T-1]=arguments[T];(_=f.props)[u].apply(_,[S].concat(B)),f._notifying=!1}f.unmounted||f.setState(function(z){var L,K=z.values;return{values:Ae(Object.create(null),K,(L={},L[w]=S,L))}})};f.handlers[u]=N}),s.length&&(f.attachRef=function(w){f.inner=w});var x=Object.create(null);return i.forEach(function(w){x[w]=f.props[Ms(w)]}),f.state={values:x,prevProps:{}},f}var p=g.prototype;return p.shouldComponentUpdate=function(){return!this._notifying},g.getDerivedStateFromProps=function(m,y){var h=y.values,x=y.prevProps,w={values:Ae(Object.create(null),h),prevProps:{}};return i.forEach(function(u){w.prevProps[u]=m[u],!hi(m,u)&&hi(x,u)&&(w.values[u]=m[Ms(u)])}),w},p.componentWillUnmount=function(){this.unmounted=!0},p.render=function(){var m=this,y=this.props,h=y.innerRef,x=ea(y,["innerRef"]);o.forEach(function(u){delete x[u]});var w={};return i.forEach(function(u){var N=m.props[u];w[u]=N!==void 0?N:m.state.values[u]}),R.createElement(t,Ae({},x,w,this.handlers,{ref:h||this.attachRef}))},g}(R.Component);au(l),l.displayName="Uncontrolled("+a+")",l.propTypes=Ae({innerRef:function(){}},tu(r)),s.forEach(function(d){l.prototype[d]=function(){var p;return(p=this.inner)[d].apply(p,arguments)}});var c=l;return R.forwardRef&&(c=R.forwardRef(function(d,g){return R.createElement(l,Ae({},d,{innerRef:g,__source:{fileName:nu,lineNumber:128},__self:this}))}),c.propTypes=l.propTypes),c.ControlledComponent=t,c.deferControlTo=function(d,g,p){return g===void 0&&(g={}),pl(d,Ae({},r,g),p)},c}var vl={exports:{}},iu="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ou=iu,lu=ou;function bl(){}function yl(){}yl.resetWarningCache=bl;var cu=function(){function t(a,n,i,o,l,c){if(c!==lu){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function r(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:yl,resetWarningCache:bl};return s.PropTypes=s,s};vl.exports=cu();var du=vl.exports;const ee=jt(du);var Fs="milliseconds",Qr="seconds",Zr="minutes",es="hours",ar="day",jr="week",ts="month",nr="year",ir="decade",or="century",jl={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},uu={month:1,year:12,decade:10*12,century:100*12};function mu(t){return[31,hu(t),31,30,31,30,31,31,30,31,30,31]}function hu(t){return t%4===0&&t%100!==0||t%400===0?29:28}function St(t,r,s){switch(t=new Date(t),s){case Fs:case Qr:case Zr:case es:case ar:case jr:return fu(t,r*jl[s]);case ts:case nr:case ir:case or:return gu(t,r*uu[s])}throw new TypeError('Invalid units: "'+s+'"')}function fu(t,r){var s=new Date(+t+r);return xu(t,s)}function gu(t,r){var s=t.getFullYear(),a=t.getMonth(),n=t.getDate(),i=s*12+a+r,o=Math.trunc(i/12),l=i%12,c=Math.min(n,mu(o)[l]),d=new Date(t);return d.setFullYear(o),d.setDate(1),d.setMonth(l),d.setDate(c),d}function xu(t,r){var s=t.getTimezoneOffset(),a=r.getTimezoneOffset(),n=a-s;return new Date(+r+n*jl.minutes)}function rs(t,r,s){return St(t,-r,s)}function Ve(t,r,s){switch(t=new Date(t),r){case or:case ir:case nr:t=Ws(t,0);case ts:t=Cl(t,1);case jr:case ar:t=ns(t,0);case es:t=wr(t,0);case Zr:t=as(t,0);case Qr:t=ss(t,0)}return r===ir&&(t=rs(t,lr(t)%10,"year")),r===or&&(t=rs(t,lr(t)%100,"year")),r===jr&&(t=$l(t,0,s)),t}function Us(t,r,s){switch(t=new Date(t),t=Ve(t,r,s),r){case or:case ir:case nr:case ts:case jr:t=St(t,1,r),t=rs(t,1,ar),t.setHours(23,59,59,999);break;case ar:t.setHours(23,59,59,999);break;case es:case Zr:case Qr:t=St(t,1,r),t=rs(t,1,Fs)}return t}var $r=Dr(function(t,r){return t===r}),dn=Dr(function(t,r){return t!==r}),ta=Dr(function(t,r){return t>r}),us=Dr(function(t,r){return t>=r}),un=Dr(function(t,r){return t<r}),Er=Dr(function(t,r){return t<=r});function wl(){return new Date(Math.min.apply(Math,arguments))}function Nl(){return new Date(Math.max.apply(Math,arguments))}function Sl(t,r,s,a){return a=a||"day",(!r||us(t,r,a))&&(!s||Er(t,s,a))}var ss=Vt("Milliseconds"),as=Vt("Seconds"),wr=Vt("Minutes"),ns=Vt("Hours"),kl=Vt("Day"),Cl=Vt("Date"),Ws=Vt("Month"),lr=Vt("FullYear");function pu(t,r){return r===void 0?lr(Ve(t,ir)):St(t,r+10,nr)}function vu(t,r){return r===void 0?lr(Ve(t,or)):St(t,r+100,nr)}function $l(t,r,s){var a=(kl(t)+7-(s||0))%7;return r===void 0?a:St(t,r-a,ar)}function bu(t,r,s,a){var n,i,o;switch(s){case Fs:case Qr:case Zr:case es:case ar:case jr:n=r.getTime()-t.getTime();break;case ts:case nr:case ir:case or:n=(lr(r)-lr(t))*12+Ws(r)-Ws(t);break;default:throw new TypeError('Invalid units: "'+s+'"')}switch(s){case Fs:i=1;break;case Qr:i=1e3;break;case Zr:i=1e3*60;break;case es:i=1e3*60*60;break;case ar:i=1e3*60*60*24;break;case jr:i=1e3*60*60*24*7;break;case ts:i=1;break;case nr:i=12;break;case ir:i=120;break;case or:i=1200;break;default:throw new TypeError('Invalid units: "'+s+'"')}return o=n/i,a?o:Math.round(o)}function Vt(t){var r=function(s){switch(s){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(t);return function(s,a){if(a===void 0)return s["get"+t]();var n=new Date(s);return n["set"+t](a),r&&n["get"+t]()!=a&&(t==="Hours"||a>=r&&n.getHours()-s.getHours()<Math.floor(a/r))&&n["set"+t](a+r),n}}function Dr(t){return function(r,s,a){return t(+Ve(r,a),+Ve(s,a))}}const fi=Object.freeze(Object.defineProperty({__proto__:null,add:St,century:vu,date:Cl,day:kl,decade:pu,diff:bu,endOf:Us,eq:$r,gt:ta,gte:us,hours:ns,inRange:Sl,lt:un,lte:Er,max:Nl,milliseconds:ss,min:wl,minutes:wr,month:Ws,neq:dn,seconds:as,startOf:Ve,subtract:rs,weekday:$l,year:lr},Symbol.toStringTag,{value:"Module"}));function yu(t){if(Array.isArray(t))return Fa(t)}function El(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ju(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _s(t){return yu(t)||El(t)||cn(t)||ju()}function wu(t,r,s){var a=-1,n=t.length;r<0&&(r=-r>n?0:n+r),s=s>n?n:s,s<0&&(s+=n),n=r>s?0:s-r>>>0,r>>>=0;for(var i=Array(n);++a<n;)i[a]=t[a+r];return i}var Dl=wu;function Nu(t,r){return t===r||t!==t&&r!==r}var ms=Nu,Su=typeof pt=="object"&&pt&&pt.Object===Object&&pt,Tl=Su,ku=Tl,Cu=typeof self=="object"&&self&&self.Object===Object&&self,$u=ku||Cu||Function("return this")(),Pt=$u,Eu=Pt,Du=Eu.Symbol,Tr=Du,gi=Tr,Ol=Object.prototype,Tu=Ol.hasOwnProperty,Ou=Ol.toString,Fr=gi?gi.toStringTag:void 0;function Mu(t){var r=Tu.call(t,Fr),s=t[Fr];try{t[Fr]=void 0;var a=!0}catch{}var n=Ou.call(t);return a&&(r?t[Fr]=s:delete t[Fr]),n}var _u=Mu,Pu=Object.prototype,Au=Pu.toString;function Ru(t){return Au.call(t)}var Iu=Ru,xi=Tr,Lu=_u,Fu=Iu,Uu="[object Null]",Wu="[object Undefined]",pi=xi?xi.toStringTag:void 0;function Bu(t){return t==null?t===void 0?Wu:Uu:pi&&pi in Object(t)?Lu(t):Fu(t)}var Or=Bu;function Hu(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var Wt=Hu,zu=Or,Gu=Wt,qu="[object AsyncFunction]",Yu="[object Function]",Vu="[object GeneratorFunction]",Ku="[object Proxy]";function Ju(t){if(!Gu(t))return!1;var r=zu(t);return r==Yu||r==Vu||r==qu||r==Ku}var mn=Ju,Xu=9007199254740991;function Qu(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Xu}var hn=Qu,Zu=mn,em=hn;function tm(t){return t!=null&&em(t.length)&&!Zu(t)}var hs=tm,rm=9007199254740991,sm=/^(?:0|[1-9]\d*)$/;function am(t,r){var s=typeof t;return r=r??rm,!!r&&(s=="number"||s!="symbol"&&sm.test(t))&&t>-1&&t%1==0&&t<r}var fn=am,nm=ms,im=hs,om=fn,lm=Wt;function cm(t,r,s){if(!lm(s))return!1;var a=typeof r;return(a=="number"?im(s)&&om(r,s.length):a=="string"&&r in s)?nm(s[r],t):!1}var ra=cm,dm=/\s/;function um(t){for(var r=t.length;r--&&dm.test(t.charAt(r)););return r}var mm=um,hm=mm,fm=/^\s+/;function gm(t){return t&&t.slice(0,hm(t)+1).replace(fm,"")}var xm=gm;function pm(t){return t!=null&&typeof t=="object"}var Kt=pm,vm=Or,bm=Kt,ym="[object Symbol]";function jm(t){return typeof t=="symbol"||bm(t)&&vm(t)==ym}var fs=jm,wm=xm,vi=Wt,Nm=fs,bi=NaN,Sm=/^[-+]0x[0-9a-f]+$/i,km=/^0b[01]+$/i,Cm=/^0o[0-7]+$/i,$m=parseInt;function Em(t){if(typeof t=="number")return t;if(Nm(t))return bi;if(vi(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=vi(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=wm(t);var s=km.test(t);return s||Cm.test(t)?$m(t.slice(2),s?2:8):Sm.test(t)?bi:+t}var Dm=Em,Tm=Dm,yi=1/0,Om=17976931348623157e292;function Mm(t){if(!t)return t===0?t:0;if(t=Tm(t),t===yi||t===-yi){var r=t<0?-1:1;return r*Om}return t===t?t:0}var Ml=Mm,_m=Ml;function Pm(t){var r=_m(t),s=r%1;return r===r?s?r-s:r:0}var _l=Pm,Am=Dl,Rm=ra,Im=_l,Lm=Math.ceil,Fm=Math.max;function Um(t,r,s){(s?Rm(t,r,s):r===void 0)?r=1:r=Fm(Im(r),0);var a=t==null?0:t.length;if(!a||r<1)return[];for(var n=0,i=0,o=Array(Lm(a/r));n<a;)o[i++]=Am(t,n,n+=r);return o}var Wm=Um;const Bm=jt(Wm);function gs(t){return t&&t.ownerDocument||document}function Hm(t){var r=gs(t);return r&&r.defaultView||window}function zm(t,r){return Hm(t).getComputedStyle(t,r)}var Gm=/([A-Z])/g;function qm(t){return t.replace(Gm,"-$1").toLowerCase()}var Ym=/^ms-/;function Cs(t){return qm(t).replace(Ym,"-ms-")}var Vm=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Km(t){return!!(t&&Vm.test(t))}function gr(t,r){var s="",a="";if(typeof r=="string")return t.style.getPropertyValue(Cs(r))||zm(t).getPropertyValue(Cs(r));Object.keys(r).forEach(function(n){var i=r[n];!i&&i!==0?t.style.removeProperty(Cs(n)):Km(n)?a+=n+"("+i+") ":s+=Cs(n)+": "+i+";"}),a&&(s+="transform: "+a+";"),t.style.cssText+=";"+s}function is(t,r){if(t.contains)return t.contains(r);if(t.compareDocumentPosition)return t===r||!!(t.compareDocumentPosition(r)&16)}function Jm(t){return"nodeType"in t&&t.nodeType===document.DOCUMENT_NODE}function gn(t){return"window"in t&&t.window===t?t:Jm(t)&&t.defaultView||!1}function Pl(t){var r=t==="pageXOffset"?"scrollLeft":"scrollTop";function s(a,n){var i=gn(a);if(n===void 0)return i?i[t]:a[r];i?i.scrollTo(i[t],n):a[r]=n}return s}const Al=Pl("pageXOffset"),Rl=Pl("pageYOffset");function er(t){var r=gs(t),s={top:0,left:0,height:0,width:0},a=r&&r.documentElement;return!a||!is(a,t)||(t.getBoundingClientRect!==void 0&&(s=t.getBoundingClientRect()),s={top:s.top+Rl(a)-(a.clientTop||0),left:s.left+Al(a)-(a.clientLeft||0),width:s.width,height:s.height}),s}var Xm=function(r){return!!r&&"offsetParent"in r};function Qm(t){for(var r=gs(t),s=t&&t.offsetParent;Xm(s)&&s.nodeName!=="HTML"&&gr(s,"position")==="static";)s=s.offsetParent;return s||r.documentElement}var Zm=function(r){return r.nodeName&&r.nodeName.toLowerCase()};function Il(t,r){var s={top:0,left:0},a;if(gr(t,"position")==="fixed")a=t.getBoundingClientRect();else{var n=r||Qm(t);a=er(t),Zm(n)!=="html"&&(s=er(n));var i=String(gr(n,"borderTopWidth")||0);s.top+=parseInt(i,10)-Rl(n)||0;var o=String(gr(n,"borderLeftWidth")||0);s.left+=parseInt(o,10)-Al(n)||0}var l=String(gr(t,"marginTop")||0),c=String(gr(t,"marginLeft")||0);return Ae({},a,{top:a.top-s.top-(parseInt(l,10)||0),left:a.left-s.left-(parseInt(c,10)||0)})}const xn=!!(typeof window<"u"&&window.document&&window.document.createElement);var ji=new Date().getTime();function eh(t){var r=new Date().getTime(),s=Math.max(0,16-(r-ji)),a=setTimeout(t,s);return ji=r,a}var th=["","webkit","moz","o","ms"],Ua="clearTimeout",Wa=eh,wi=function(r,s){return r+(r?s[0].toUpperCase()+s.substr(1):s)+"AnimationFrame"};xn&&th.some(function(t){var r=wi(t,"request");return r in window&&(Ua=wi(t,"cancel"),Wa=function(a){return window[r](a)}),!!Wa});var Ni=function(r){typeof window[Ua]=="function"&&window[Ua](r)},Ll=Wa,Sa;function rh(t,r){if(!Sa){var s=document.body,a=s.matches||s.matchesSelector||s.webkitMatchesSelector||s.mozMatchesSelector||s.msMatchesSelector;Sa=function(i,o){return a.call(i,o)}}return Sa(t,r)}var sh=Function.prototype.bind.call(Function.prototype.call,[].slice);function ah(t,r){return sh(t.querySelectorAll(r))}var Ba=!1,Ha=!1;try{var ka={get passive(){return Ba=!0},get once(){return Ha=Ba=!0}};xn&&(window.addEventListener("test",ka,ka),window.removeEventListener("test",ka,!0))}catch{}function nh(t,r,s,a){if(a&&typeof a!="boolean"&&!Ha){var n=a.once,i=a.capture,o=s;!Ha&&n&&(o=s.__once||function l(c){this.removeEventListener(r,l,i),s.call(this,c)},s.__once=o),t.addEventListener(r,o,Ba?a:i)}t.addEventListener(r,s,a)}function ih(t){const r=E.useRef(t);return E.useEffect(()=>{r.current=t},[t]),r}function Si(t){const r=ih(t);return E.useCallback(function(...s){return r.current&&r.current(...s)},[r])}function ki(){return E.useState(null)}function oh(){const t=E.useRef(!0),r=E.useRef(()=>t.current);return E.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),r.current}function lh(t){const r=oh();return[t[0],E.useCallback(s=>{if(r())return t[1](s)},[r,t[1]])]}var it="top",bt="bottom",yt="right",ot="left",pn="auto",xs=[it,bt,yt,ot],Nr="start",os="end",ch="clippingParents",Fl="viewport",Ur="popper",dh="reference",Ci=xs.reduce(function(t,r){return t.concat([r+"-"+Nr,r+"-"+os])},[]),vn=[].concat(xs,[pn]).reduce(function(t,r){return t.concat([r,r+"-"+Nr,r+"-"+os])},[]),uh="beforeRead",mh="read",hh="afterRead",fh="beforeMain",gh="main",xh="afterMain",ph="beforeWrite",vh="write",bh="afterWrite",yh=[uh,mh,hh,fh,gh,xh,ph,vh,bh];function Tt(t){return t.split("-")[0]}function ut(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var r=t.ownerDocument;return r&&r.defaultView||window}return t}function cr(t){var r=ut(t).Element;return t instanceof r||t instanceof Element}function Ot(t){var r=ut(t).HTMLElement;return t instanceof r||t instanceof HTMLElement}function bn(t){if(typeof ShadowRoot>"u")return!1;var r=ut(t).ShadowRoot;return t instanceof r||t instanceof ShadowRoot}var tr=Math.max,Bs=Math.min,Sr=Math.round;function za(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function Ul(){return!/^((?!chrome|android).)*safari/i.test(za())}function kr(t,r,s){r===void 0&&(r=!1),s===void 0&&(s=!1);var a=t.getBoundingClientRect(),n=1,i=1;r&&Ot(t)&&(n=t.offsetWidth>0&&Sr(a.width)/t.offsetWidth||1,i=t.offsetHeight>0&&Sr(a.height)/t.offsetHeight||1);var o=cr(t)?ut(t):window,l=o.visualViewport,c=!Ul()&&s,d=(a.left+(c&&l?l.offsetLeft:0))/n,g=(a.top+(c&&l?l.offsetTop:0))/i,p=a.width/n,f=a.height/i;return{width:p,height:f,top:g,right:d+p,bottom:g+f,left:d,x:d,y:g}}function yn(t){var r=kr(t),s=t.offsetWidth,a=t.offsetHeight;return Math.abs(r.width-s)<=1&&(s=r.width),Math.abs(r.height-a)<=1&&(a=r.height),{x:t.offsetLeft,y:t.offsetTop,width:s,height:a}}function Wl(t,r){var s=r.getRootNode&&r.getRootNode();if(t.contains(r))return!0;if(s&&bn(s)){var a=r;do{if(a&&t.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function qt(t){return t?(t.nodeName||"").toLowerCase():null}function Ft(t){return ut(t).getComputedStyle(t)}function jh(t){return["table","td","th"].indexOf(qt(t))>=0}function Jt(t){return((cr(t)?t.ownerDocument:t.document)||window.document).documentElement}function sa(t){return qt(t)==="html"?t:t.assignedSlot||t.parentNode||(bn(t)?t.host:null)||Jt(t)}function $i(t){return!Ot(t)||Ft(t).position==="fixed"?null:t.offsetParent}function wh(t){var r=/firefox/i.test(za()),s=/Trident/i.test(za());if(s&&Ot(t)){var a=Ft(t);if(a.position==="fixed")return null}var n=sa(t);for(bn(n)&&(n=n.host);Ot(n)&&["html","body"].indexOf(qt(n))<0;){var i=Ft(n);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||r&&i.willChange==="filter"||r&&i.filter&&i.filter!=="none")return n;n=n.parentNode}return null}function ps(t){for(var r=ut(t),s=$i(t);s&&jh(s)&&Ft(s).position==="static";)s=$i(s);return s&&(qt(s)==="html"||qt(s)==="body"&&Ft(s).position==="static")?r:s||wh(t)||r}function jn(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Yr(t,r,s){return tr(t,Bs(r,s))}function Nh(t,r,s){var a=Yr(t,r,s);return a>s?s:a}function Bl(){return{top:0,right:0,bottom:0,left:0}}function Hl(t){return Object.assign({},Bl(),t)}function zl(t,r){return r.reduce(function(s,a){return s[a]=t,s},{})}var Sh=function(r,s){return r=typeof r=="function"?r(Object.assign({},s.rects,{placement:s.placement})):r,Hl(typeof r!="number"?r:zl(r,xs))};function kh(t){var r,s=t.state,a=t.name,n=t.options,i=s.elements.arrow,o=s.modifiersData.popperOffsets,l=Tt(s.placement),c=jn(l),d=[ot,yt].indexOf(l)>=0,g=d?"height":"width";if(!(!i||!o)){var p=Sh(n.padding,s),f=yn(i),m=c==="y"?it:ot,y=c==="y"?bt:yt,h=s.rects.reference[g]+s.rects.reference[c]-o[c]-s.rects.popper[g],x=o[c]-s.rects.reference[c],w=ps(i),u=w?c==="y"?w.clientHeight||0:w.clientWidth||0:0,N=h/2-x/2,v=p[m],S=u-f[g]-p[y],_=u/2-f[g]/2+N,P=Yr(v,_,S),B=c;s.modifiersData[a]=(r={},r[B]=P,r.centerOffset=P-_,r)}}function Ch(t){var r=t.state,s=t.options,a=s.element,n=a===void 0?"[data-popper-arrow]":a;n!=null&&(typeof n=="string"&&(n=r.elements.popper.querySelector(n),!n)||Wl(r.elements.popper,n)&&(r.elements.arrow=n))}const $h={name:"arrow",enabled:!0,phase:"main",fn:kh,effect:Ch,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Cr(t){return t.split("-")[1]}var Eh={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Dh(t,r){var s=t.x,a=t.y,n=r.devicePixelRatio||1;return{x:Sr(s*n)/n||0,y:Sr(a*n)/n||0}}function Ei(t){var r,s=t.popper,a=t.popperRect,n=t.placement,i=t.variation,o=t.offsets,l=t.position,c=t.gpuAcceleration,d=t.adaptive,g=t.roundOffsets,p=t.isFixed,f=o.x,m=f===void 0?0:f,y=o.y,h=y===void 0?0:y,x=typeof g=="function"?g({x:m,y:h}):{x:m,y:h};m=x.x,h=x.y;var w=o.hasOwnProperty("x"),u=o.hasOwnProperty("y"),N=ot,v=it,S=window;if(d){var _=ps(s),P="clientHeight",B="clientWidth";if(_===ut(s)&&(_=Jt(s),Ft(_).position!=="static"&&l==="absolute"&&(P="scrollHeight",B="scrollWidth")),_=_,n===it||(n===ot||n===yt)&&i===os){v=bt;var T=p&&_===S&&S.visualViewport?S.visualViewport.height:_[P];h-=T-a.height,h*=c?1:-1}if(n===ot||(n===it||n===bt)&&i===os){N=yt;var z=p&&_===S&&S.visualViewport?S.visualViewport.width:_[B];m-=z-a.width,m*=c?1:-1}}var L=Object.assign({position:l},d&&Eh),K=g===!0?Dh({x:m,y:h},ut(s)):{x:m,y:h};if(m=K.x,h=K.y,c){var q;return Object.assign({},L,(q={},q[v]=u?"0":"",q[N]=w?"0":"",q.transform=(S.devicePixelRatio||1)<=1?"translate("+m+"px, "+h+"px)":"translate3d("+m+"px, "+h+"px, 0)",q))}return Object.assign({},L,(r={},r[v]=u?h+"px":"",r[N]=w?m+"px":"",r.transform="",r))}function Th(t){var r=t.state,s=t.options,a=s.gpuAcceleration,n=a===void 0?!0:a,i=s.adaptive,o=i===void 0?!0:i,l=s.roundOffsets,c=l===void 0?!0:l,d={placement:Tt(r.placement),variation:Cr(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:n,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,Ei(Object.assign({},d,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:o,roundOffsets:c})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,Ei(Object.assign({},d,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}const Oh={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Th,data:{}};var $s={passive:!0};function Mh(t){var r=t.state,s=t.instance,a=t.options,n=a.scroll,i=n===void 0?!0:n,o=a.resize,l=o===void 0?!0:o,c=ut(r.elements.popper),d=[].concat(r.scrollParents.reference,r.scrollParents.popper);return i&&d.forEach(function(g){g.addEventListener("scroll",s.update,$s)}),l&&c.addEventListener("resize",s.update,$s),function(){i&&d.forEach(function(g){g.removeEventListener("scroll",s.update,$s)}),l&&c.removeEventListener("resize",s.update,$s)}}const _h={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Mh,data:{}};var Ph={left:"right",right:"left",bottom:"top",top:"bottom"};function Ps(t){return t.replace(/left|right|bottom|top/g,function(r){return Ph[r]})}var Ah={start:"end",end:"start"};function Di(t){return t.replace(/start|end/g,function(r){return Ah[r]})}function wn(t){var r=ut(t),s=r.pageXOffset,a=r.pageYOffset;return{scrollLeft:s,scrollTop:a}}function Nn(t){return kr(Jt(t)).left+wn(t).scrollLeft}function Rh(t,r){var s=ut(t),a=Jt(t),n=s.visualViewport,i=a.clientWidth,o=a.clientHeight,l=0,c=0;if(n){i=n.width,o=n.height;var d=Ul();(d||!d&&r==="fixed")&&(l=n.offsetLeft,c=n.offsetTop)}return{width:i,height:o,x:l+Nn(t),y:c}}function Ih(t){var r,s=Jt(t),a=wn(t),n=(r=t.ownerDocument)==null?void 0:r.body,i=tr(s.scrollWidth,s.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=tr(s.scrollHeight,s.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),l=-a.scrollLeft+Nn(t),c=-a.scrollTop;return Ft(n||s).direction==="rtl"&&(l+=tr(s.clientWidth,n?n.clientWidth:0)-i),{width:i,height:o,x:l,y:c}}function Sn(t){var r=Ft(t),s=r.overflow,a=r.overflowX,n=r.overflowY;return/auto|scroll|overlay|hidden/.test(s+n+a)}function Gl(t){return["html","body","#document"].indexOf(qt(t))>=0?t.ownerDocument.body:Ot(t)&&Sn(t)?t:Gl(sa(t))}function Vr(t,r){var s;r===void 0&&(r=[]);var a=Gl(t),n=a===((s=t.ownerDocument)==null?void 0:s.body),i=ut(a),o=n?[i].concat(i.visualViewport||[],Sn(a)?a:[]):a,l=r.concat(o);return n?l:l.concat(Vr(sa(o)))}function Ga(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Lh(t,r){var s=kr(t,!1,r==="fixed");return s.top=s.top+t.clientTop,s.left=s.left+t.clientLeft,s.bottom=s.top+t.clientHeight,s.right=s.left+t.clientWidth,s.width=t.clientWidth,s.height=t.clientHeight,s.x=s.left,s.y=s.top,s}function Ti(t,r,s){return r===Fl?Ga(Rh(t,s)):cr(r)?Lh(r,s):Ga(Ih(Jt(t)))}function Fh(t){var r=Vr(sa(t)),s=["absolute","fixed"].indexOf(Ft(t).position)>=0,a=s&&Ot(t)?ps(t):t;return cr(a)?r.filter(function(n){return cr(n)&&Wl(n,a)&&qt(n)!=="body"}):[]}function Uh(t,r,s,a){var n=r==="clippingParents"?Fh(t):[].concat(r),i=[].concat(n,[s]),o=i[0],l=i.reduce(function(c,d){var g=Ti(t,d,a);return c.top=tr(g.top,c.top),c.right=Bs(g.right,c.right),c.bottom=Bs(g.bottom,c.bottom),c.left=tr(g.left,c.left),c},Ti(t,o,a));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function ql(t){var r=t.reference,s=t.element,a=t.placement,n=a?Tt(a):null,i=a?Cr(a):null,o=r.x+r.width/2-s.width/2,l=r.y+r.height/2-s.height/2,c;switch(n){case it:c={x:o,y:r.y-s.height};break;case bt:c={x:o,y:r.y+r.height};break;case yt:c={x:r.x+r.width,y:l};break;case ot:c={x:r.x-s.width,y:l};break;default:c={x:r.x,y:r.y}}var d=n?jn(n):null;if(d!=null){var g=d==="y"?"height":"width";switch(i){case Nr:c[d]=c[d]-(r[g]/2-s[g]/2);break;case os:c[d]=c[d]+(r[g]/2-s[g]/2);break}}return c}function ls(t,r){r===void 0&&(r={});var s=r,a=s.placement,n=a===void 0?t.placement:a,i=s.strategy,o=i===void 0?t.strategy:i,l=s.boundary,c=l===void 0?ch:l,d=s.rootBoundary,g=d===void 0?Fl:d,p=s.elementContext,f=p===void 0?Ur:p,m=s.altBoundary,y=m===void 0?!1:m,h=s.padding,x=h===void 0?0:h,w=Hl(typeof x!="number"?x:zl(x,xs)),u=f===Ur?dh:Ur,N=t.rects.popper,v=t.elements[y?u:f],S=Uh(cr(v)?v:v.contextElement||Jt(t.elements.popper),c,g,o),_=kr(t.elements.reference),P=ql({reference:_,element:N,placement:n}),B=Ga(Object.assign({},N,P)),T=f===Ur?B:_,z={top:S.top-T.top+w.top,bottom:T.bottom-S.bottom+w.bottom,left:S.left-T.left+w.left,right:T.right-S.right+w.right},L=t.modifiersData.offset;if(f===Ur&&L){var K=L[n];Object.keys(z).forEach(function(q){var te=[yt,bt].indexOf(q)>=0?1:-1,se=[it,bt].indexOf(q)>=0?"y":"x";z[q]+=K[se]*te})}return z}function Wh(t,r){r===void 0&&(r={});var s=r,a=s.placement,n=s.boundary,i=s.rootBoundary,o=s.padding,l=s.flipVariations,c=s.allowedAutoPlacements,d=c===void 0?vn:c,g=Cr(a),p=g?l?Ci:Ci.filter(function(y){return Cr(y)===g}):xs,f=p.filter(function(y){return d.indexOf(y)>=0});f.length===0&&(f=p);var m=f.reduce(function(y,h){return y[h]=ls(t,{placement:h,boundary:n,rootBoundary:i,padding:o})[Tt(h)],y},{});return Object.keys(m).sort(function(y,h){return m[y]-m[h]})}function Bh(t){if(Tt(t)===pn)return[];var r=Ps(t);return[Di(t),r,Di(r)]}function Hh(t){var r=t.state,s=t.options,a=t.name;if(!r.modifiersData[a]._skip){for(var n=s.mainAxis,i=n===void 0?!0:n,o=s.altAxis,l=o===void 0?!0:o,c=s.fallbackPlacements,d=s.padding,g=s.boundary,p=s.rootBoundary,f=s.altBoundary,m=s.flipVariations,y=m===void 0?!0:m,h=s.allowedAutoPlacements,x=r.options.placement,w=Tt(x),u=w===x,N=c||(u||!y?[Ps(x)]:Bh(x)),v=[x].concat(N).reduce(function(ge,ye){return ge.concat(Tt(ye)===pn?Wh(r,{placement:ye,boundary:g,rootBoundary:p,padding:d,flipVariations:y,allowedAutoPlacements:h}):ye)},[]),S=r.rects.reference,_=r.rects.popper,P=new Map,B=!0,T=v[0],z=0;z<v.length;z++){var L=v[z],K=Tt(L),q=Cr(L)===Nr,te=[it,bt].indexOf(K)>=0,se=te?"width":"height",re=ls(r,{placement:L,boundary:g,rootBoundary:p,altBoundary:f,padding:d}),k=te?q?yt:ot:q?bt:it;S[se]>_[se]&&(k=Ps(k));var H=Ps(k),Y=[];if(i&&Y.push(re[K]<=0),l&&Y.push(re[k]<=0,re[H]<=0),Y.every(function(ge){return ge})){T=L,B=!1;break}P.set(L,Y)}if(B)for(var A=y?3:1,ae=function(ye){var J=v.find(function(pe){var Ee=P.get(pe);if(Ee)return Ee.slice(0,ye).every(function(Z){return Z})});if(J)return T=J,"break"},me=A;me>0;me--){var he=ae(me);if(he==="break")break}r.placement!==T&&(r.modifiersData[a]._skip=!0,r.placement=T,r.reset=!0)}}const zh={name:"flip",enabled:!0,phase:"main",fn:Hh,requiresIfExists:["offset"],data:{_skip:!1}};function Oi(t,r,s){return s===void 0&&(s={x:0,y:0}),{top:t.top-r.height-s.y,right:t.right-r.width+s.x,bottom:t.bottom-r.height+s.y,left:t.left-r.width-s.x}}function Mi(t){return[it,yt,bt,ot].some(function(r){return t[r]>=0})}function Gh(t){var r=t.state,s=t.name,a=r.rects.reference,n=r.rects.popper,i=r.modifiersData.preventOverflow,o=ls(r,{elementContext:"reference"}),l=ls(r,{altBoundary:!0}),c=Oi(o,a),d=Oi(l,n,i),g=Mi(c),p=Mi(d);r.modifiersData[s]={referenceClippingOffsets:c,popperEscapeOffsets:d,isReferenceHidden:g,hasPopperEscaped:p},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":g,"data-popper-escaped":p})}const qh={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Gh};function Yh(t,r,s){var a=Tt(t),n=[ot,it].indexOf(a)>=0?-1:1,i=typeof s=="function"?s(Object.assign({},r,{placement:t})):s,o=i[0],l=i[1];return o=o||0,l=(l||0)*n,[ot,yt].indexOf(a)>=0?{x:l,y:o}:{x:o,y:l}}function Vh(t){var r=t.state,s=t.options,a=t.name,n=s.offset,i=n===void 0?[0,0]:n,o=vn.reduce(function(g,p){return g[p]=Yh(p,r.rects,i),g},{}),l=o[r.placement],c=l.x,d=l.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=c,r.modifiersData.popperOffsets.y+=d),r.modifiersData[a]=o}const Kh={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Vh};function Jh(t){var r=t.state,s=t.name;r.modifiersData[s]=ql({reference:r.rects.reference,element:r.rects.popper,placement:r.placement})}const Xh={name:"popperOffsets",enabled:!0,phase:"read",fn:Jh,data:{}};function Qh(t){return t==="x"?"y":"x"}function Zh(t){var r=t.state,s=t.options,a=t.name,n=s.mainAxis,i=n===void 0?!0:n,o=s.altAxis,l=o===void 0?!1:o,c=s.boundary,d=s.rootBoundary,g=s.altBoundary,p=s.padding,f=s.tether,m=f===void 0?!0:f,y=s.tetherOffset,h=y===void 0?0:y,x=ls(r,{boundary:c,rootBoundary:d,padding:p,altBoundary:g}),w=Tt(r.placement),u=Cr(r.placement),N=!u,v=jn(w),S=Qh(v),_=r.modifiersData.popperOffsets,P=r.rects.reference,B=r.rects.popper,T=typeof h=="function"?h(Object.assign({},r.rects,{placement:r.placement})):h,z=typeof T=="number"?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),L=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,K={x:0,y:0};if(_){if(i){var q,te=v==="y"?it:ot,se=v==="y"?bt:yt,re=v==="y"?"height":"width",k=_[v],H=k+x[te],Y=k-x[se],A=m?-B[re]/2:0,ae=u===Nr?P[re]:B[re],me=u===Nr?-B[re]:-P[re],he=r.elements.arrow,ge=m&&he?yn(he):{width:0,height:0},ye=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:Bl(),J=ye[te],pe=ye[se],Ee=Yr(0,P[re],ge[re]),Z=N?P[re]/2-A-Ee-J-z.mainAxis:ae-Ee-J-z.mainAxis,Ne=N?-P[re]/2+A+Ee+pe+z.mainAxis:me+Ee+pe+z.mainAxis,Oe=r.elements.arrow&&ps(r.elements.arrow),tt=Oe?v==="y"?Oe.clientTop||0:Oe.clientLeft||0:0,Ke=(q=L==null?void 0:L[v])!=null?q:0,Me=k+Z-Ke-tt,G=k+Ne-Ke,je=Yr(m?Bs(H,Me):H,k,m?tr(Y,G):Y);_[v]=je,K[v]=je-k}if(l){var ue,Le=v==="x"?it:ot,_e=v==="x"?bt:yt,xe=_[S],Fe=S==="y"?"height":"width",Je=xe+x[Le],Nt=xe-x[_e],O=[it,ot].indexOf(w)!==-1,b=(ue=L==null?void 0:L[S])!=null?ue:0,$=O?Je:xe-P[Fe]-B[Fe]-b+z.altAxis,D=O?xe+P[Fe]+B[Fe]-b-z.altAxis:Nt,j=m&&O?Nh($,xe,D):Yr(m?$:Je,xe,m?D:Nt);_[S]=j,K[S]=j-xe}r.modifiersData[a]=K}}const ef={name:"preventOverflow",enabled:!0,phase:"main",fn:Zh,requiresIfExists:["offset"]};function tf(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function rf(t){return t===ut(t)||!Ot(t)?wn(t):tf(t)}function sf(t){var r=t.getBoundingClientRect(),s=Sr(r.width)/t.offsetWidth||1,a=Sr(r.height)/t.offsetHeight||1;return s!==1||a!==1}function af(t,r,s){s===void 0&&(s=!1);var a=Ot(r),n=Ot(r)&&sf(r),i=Jt(r),o=kr(t,n,s),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(a||!a&&!s)&&((qt(r)!=="body"||Sn(i))&&(l=rf(r)),Ot(r)?(c=kr(r,!0),c.x+=r.clientLeft,c.y+=r.clientTop):i&&(c.x=Nn(i))),{x:o.left+l.scrollLeft-c.x,y:o.top+l.scrollTop-c.y,width:o.width,height:o.height}}function nf(t){var r=new Map,s=new Set,a=[];t.forEach(function(i){r.set(i.name,i)});function n(i){s.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(l){if(!s.has(l)){var c=r.get(l);c&&n(c)}}),a.push(i)}return t.forEach(function(i){s.has(i.name)||n(i)}),a}function of(t){var r=nf(t);return yh.reduce(function(s,a){return s.concat(r.filter(function(n){return n.phase===a}))},[])}function lf(t){var r;return function(){return r||(r=new Promise(function(s){Promise.resolve().then(function(){r=void 0,s(t())})})),r}}function cf(t){var r=t.reduce(function(s,a){var n=s[a.name];return s[a.name]=n?Object.assign({},n,a,{options:Object.assign({},n.options,a.options),data:Object.assign({},n.data,a.data)}):a,s},{});return Object.keys(r).map(function(s){return r[s]})}var _i={placement:"bottom",modifiers:[],strategy:"absolute"};function Pi(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return!r.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function df(t){t===void 0&&(t={});var r=t,s=r.defaultModifiers,a=s===void 0?[]:s,n=r.defaultOptions,i=n===void 0?_i:n;return function(l,c,d){d===void 0&&(d=i);var g={placement:"bottom",orderedModifiers:[],options:Object.assign({},_i,i),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},p=[],f=!1,m={state:g,setOptions:function(w){var u=typeof w=="function"?w(g.options):w;h(),g.options=Object.assign({},i,g.options,u),g.scrollParents={reference:cr(l)?Vr(l):l.contextElement?Vr(l.contextElement):[],popper:Vr(c)};var N=of(cf([].concat(a,g.options.modifiers)));return g.orderedModifiers=N.filter(function(v){return v.enabled}),y(),m.update()},forceUpdate:function(){if(!f){var w=g.elements,u=w.reference,N=w.popper;if(Pi(u,N)){g.rects={reference:af(u,ps(N),g.options.strategy==="fixed"),popper:yn(N)},g.reset=!1,g.placement=g.options.placement,g.orderedModifiers.forEach(function(z){return g.modifiersData[z.name]=Object.assign({},z.data)});for(var v=0;v<g.orderedModifiers.length;v++){if(g.reset===!0){g.reset=!1,v=-1;continue}var S=g.orderedModifiers[v],_=S.fn,P=S.options,B=P===void 0?{}:P,T=S.name;typeof _=="function"&&(g=_({state:g,options:B,name:T,instance:m})||g)}}}},update:lf(function(){return new Promise(function(x){m.forceUpdate(),x(g)})}),destroy:function(){h(),f=!0}};if(!Pi(l,c))return m;m.setOptions(d).then(function(x){!f&&d.onFirstUpdate&&d.onFirstUpdate(x)});function y(){g.orderedModifiers.forEach(function(x){var w=x.name,u=x.options,N=u===void 0?{}:u,v=x.effect;if(typeof v=="function"){var S=v({state:g,name:w,instance:m,options:N}),_=function(){};p.push(S||_)}})}function h(){p.forEach(function(x){return x()}),p=[]}return m}}var uf=df({defaultModifiers:[qh,Xh,Oh,_h,Kh,zh,ef,$h]}),Ai=function(r){return{position:r,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},mf={name:"applyStyles",enabled:!1},hf={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(r){var s=r.state;return function(){var a=s.elements,n=a.reference,i=a.popper;if("removeAttribute"in n){var o=(n.getAttribute("aria-describedby")||"").split(",").filter(function(l){return l.trim()!==i.id});o.length?n.setAttribute("aria-describedby",o.join(",")):n.removeAttribute("aria-describedby")}}},fn:function(r){var s,a=r.state,n=a.elements,i=n.popper,o=n.reference,l=(s=i.getAttribute("role"))==null?void 0:s.toLowerCase();if(i.id&&l==="tooltip"&&"setAttribute"in o){var c=o.getAttribute("aria-describedby");if(c&&c.split(",").indexOf(i.id)!==-1)return;o.setAttribute("aria-describedby",c?c+","+i.id:i.id)}}},ff=[];function gf(t,r,s){var a=s===void 0?{}:s,n=a.enabled,i=n===void 0?!0:n,o=a.placement,l=o===void 0?"bottom":o,c=a.strategy,d=c===void 0?"absolute":c,g=a.modifiers,p=g===void 0?ff:g,f=ea(a,["enabled","placement","strategy","modifiers"]),m=E.useRef(),y=E.useCallback(function(){var v;(v=m.current)==null||v.update()},[]),h=E.useCallback(function(){var v;(v=m.current)==null||v.forceUpdate()},[]),x=lh(E.useState({placement:l,update:y,forceUpdate:h,attributes:{},styles:{popper:Ai(d),arrow:{}}})),w=x[0],u=x[1],N=E.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(S){var _=S.state,P={},B={};Object.keys(_.elements).forEach(function(T){P[T]=_.styles[T],B[T]=_.attributes[T]}),u({state:_,styles:P,attributes:B,update:y,forceUpdate:h,placement:_.placement})}}},[y,h,u]);return E.useEffect(function(){!m.current||!i||m.current.setOptions({placement:l,strategy:d,modifiers:[].concat(p,[N,mf])})},[d,l,N,i]),E.useEffect(function(){if(!(!i||t==null||r==null))return m.current=uf(t,r,Ae({},f,{placement:l,strategy:d,modifiers:[].concat(p,[hf,N])})),function(){m.current!=null&&(m.current.destroy(),m.current=void 0,u(function(v){return Ae({},v,{attributes:{},styles:{popper:Ai(d)}})}))}},[i,t,r]),w}function xf(t,r,s,a){var n=a&&typeof a!="boolean"?a.capture:a;t.removeEventListener(r,s,n),s.__once&&t.removeEventListener(r,s.__once,n)}function zr(t,r,s,a){return nh(t,r,s,a),function(){xf(t,r,s,a)}}var pf=function(){},vf=pf;const bf=jt(vf);function yf(t){return t&&"setState"in t?Vo.findDOMNode(t):t??null}const jf=function(t){return gs(yf(t))};var wf=27,Ri=function(){};function Nf(t){return t.button===0}function Sf(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}var Ii=function(r){return r&&("current"in r?r.current:r)};function kf(t,r,s){var a=s===void 0?{}:s,n=a.disabled,i=a.clickTrigger,o=i===void 0?"click":i,l=E.useRef(!1),c=r||Ri,d=E.useCallback(function(f){var m,y=Ii(t);bf(!!y,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),l.current=!y||Sf(f)||!Nf(f)||!!is(y,(m=f.composedPath==null?void 0:f.composedPath()[0])!=null?m:f.target)},[t]),g=Si(function(f){l.current||c(f)}),p=Si(function(f){f.keyCode===wf&&c(f)});E.useEffect(function(){if(!(n||t==null)){var f=window.event,m=jf(Ii(t)),y=zr(m,o,d,!0),h=zr(m,o,function(u){if(u===f){f=void 0;return}g(u)}),x=zr(m,"keyup",function(u){if(u===f){f=void 0;return}p(u)}),w=[];return"ontouchstart"in m.documentElement&&(w=[].slice.call(m.body.children).map(function(u){return zr(u,"mousemove",Ri)})),function(){y(),h(),x(),w.forEach(function(u){return u()})}}},[t,n,o,d,g,p])}function Cf(t){var r={};return Array.isArray(t)?(t==null||t.forEach(function(s){r[s.name]=s}),r):t||r}function $f(t){return t===void 0&&(t={}),Array.isArray(t)?t:Object.keys(t).map(function(r){return t[r].name=r,t[r]})}function Ef(t){var r,s,a,n,i=t.enabled,o=t.enableEvents,l=t.placement,c=t.flip,d=t.offset,g=t.fixed,p=t.containerPadding,f=t.arrowElement,m=t.popperConfig,y=m===void 0?{}:m,h=Cf(y.modifiers);return Ae({},y,{placement:l,enabled:i,strategy:g?"fixed":y.strategy,modifiers:$f(Ae({},h,{eventListeners:{enabled:o},preventOverflow:Ae({},h.preventOverflow,{options:p?Ae({padding:p},(r=h.preventOverflow)==null?void 0:r.options):(s=h.preventOverflow)==null?void 0:s.options}),offset:{options:Ae({offset:d},(a=h.offset)==null?void 0:a.options)},arrow:Ae({},h.arrow,{enabled:!!f,options:Ae({},(n=h.arrow)==null?void 0:n.options,{element:f})}),flip:Ae({enabled:!!c},h.flip)}))})}function Df(t,r){return t.classList?t.classList.contains(r):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+r+" ")!==-1}function Tf(t,r){t.classList?t.classList.add(r):Df(t,r)||(typeof t.className=="string"?t.className=t.className+" "+r:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+r))}function Li(t,r){return t.replace(new RegExp("(^|\\s)"+r+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Of(t,r){t.classList?t.classList.remove(r):typeof t.className=="string"?t.className=Li(t.className,r):t.setAttribute("class",Li(t.className&&t.className.baseVal||"",r))}var Es;function kn(t){if((!Es&&Es!==0||t)&&xn){var r=document.createElement("div");r.style.position="absolute",r.style.top="-9999px",r.style.width="50px",r.style.height="50px",r.style.overflow="scroll",document.body.appendChild(r),Es=r.offsetWidth-r.clientWidth,document.body.removeChild(r)}return Es}var Ca=function(r){var s;return typeof document>"u"?null:r==null?gs().body:(typeof r=="function"&&(r=r()),r&&"current"in r&&(r=r.current),(s=r)!=null&&s.nodeType&&r||null)};function Fi(t,r){var s=E.useState(function(){return Ca(t)}),a=s[0],n=s[1];if(!a){var i=Ca(t);i&&n(i)}return E.useEffect(function(){},[r,a]),E.useEffect(function(){var o=Ca(t);o!==a&&n(o)},[t,a]),a}const Ui=t=>!t||typeof t=="function"?t:r=>{t.current=r};function Mf(t,r){const s=Ui(t),a=Ui(r);return n=>{s&&s(n),a&&a(n)}}function _f(t,r){return E.useMemo(()=>Mf(t,r),[t,r])}var Cn=R.forwardRef(function(t,r){var s=t.flip,a=t.offset,n=t.placement,i=t.containerPadding,o=i===void 0?5:i,l=t.popperConfig,c=l===void 0?{}:l,d=t.transition,g=ki(),p=g[0],f=g[1],m=ki(),y=m[0],h=m[1],x=_f(f,r),w=Fi(t.container),u=Fi(t.target),N=E.useState(!t.show),v=N[0],S=N[1],_=gf(u,p,Ef({placement:n,enableEvents:!!t.show,containerPadding:o||5,flip:s,offset:a,arrowElement:y,popperConfig:c})),P=_.styles,B=_.attributes,T=ea(_,["styles","attributes"]);t.show?v&&S(!1):!t.transition&&!v&&S(!0);var z=function(){S(!0),t.onExited&&t.onExited.apply(t,arguments)},L=t.show||d&&!v;if(kf(p,t.onHide,{disabled:!t.rootClose||t.rootCloseDisabled,clickTrigger:t.rootCloseEvent}),!L)return null;var K=t.children(Ae({},T,{show:!!t.show,props:Ae({},B.popper,{style:P.popper,ref:x}),arrowProps:Ae({},B.arrow,{style:P.arrow,ref:h})}));if(d){var q=t.onExit,te=t.onExiting,se=t.onEnter,re=t.onEntering,k=t.onEntered;K=R.createElement(d,{in:t.show,appear:!0,onExit:q,onExiting:te,onExited:z,onEnter:se,onEntering:re,onEntered:k},K)}return w?Vo.createPortal(K,w):null});Cn.displayName="Overlay";Cn.propTypes={show:ee.bool,placement:ee.oneOf(vn),target:ee.any,container:ee.any,flip:ee.bool,children:ee.func.isRequired,containerPadding:ee.number,popperConfig:ee.object,rootClose:ee.bool,rootCloseEvent:ee.oneOf(["click","mousedown"]),rootCloseDisabled:ee.bool,onHide:function(r){for(var s=arguments.length,a=new Array(s>1?s-1:0),n=1;n<s;n++)a[n-1]=arguments[n];if(r.rootClose){var i;return(i=ee.func).isRequired.apply(i,[r].concat(a))}return ee.func.apply(ee,[r].concat(a))},transition:ee.elementType,onEnter:ee.func,onEntering:ee.func,onEntered:ee.func,onExit:ee.func,onExiting:ee.func,onExited:ee.func};function Pf(){this.__data__=[],this.size=0}var Af=Pf,Rf=ms;function If(t,r){for(var s=t.length;s--;)if(Rf(t[s][0],r))return s;return-1}var aa=If,Lf=aa,Ff=Array.prototype,Uf=Ff.splice;function Wf(t){var r=this.__data__,s=Lf(r,t);if(s<0)return!1;var a=r.length-1;return s==a?r.pop():Uf.call(r,s,1),--this.size,!0}var Bf=Wf,Hf=aa;function zf(t){var r=this.__data__,s=Hf(r,t);return s<0?void 0:r[s][1]}var Gf=zf,qf=aa;function Yf(t){return qf(this.__data__,t)>-1}var Vf=Yf,Kf=aa;function Jf(t,r){var s=this.__data__,a=Kf(s,t);return a<0?(++this.size,s.push([t,r])):s[a][1]=r,this}var Xf=Jf,Qf=Af,Zf=Bf,eg=Gf,tg=Vf,rg=Xf;function Mr(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var a=t[r];this.set(a[0],a[1])}}Mr.prototype.clear=Qf;Mr.prototype.delete=Zf;Mr.prototype.get=eg;Mr.prototype.has=tg;Mr.prototype.set=rg;var na=Mr,sg=na;function ag(){this.__data__=new sg,this.size=0}var ng=ag;function ig(t){var r=this.__data__,s=r.delete(t);return this.size=r.size,s}var og=ig;function lg(t){return this.__data__.get(t)}var cg=lg;function dg(t){return this.__data__.has(t)}var ug=dg,mg=Pt,hg=mg["__core-js_shared__"],fg=hg,$a=fg,Wi=function(){var t=/[^.]+$/.exec($a&&$a.keys&&$a.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function gg(t){return!!Wi&&Wi in t}var xg=gg,pg=Function.prototype,vg=pg.toString;function bg(t){if(t!=null){try{return vg.call(t)}catch{}try{return t+""}catch{}}return""}var Yl=bg,yg=mn,jg=xg,wg=Wt,Ng=Yl,Sg=/[\\^$.*+?()[\]{}|]/g,kg=/^\[object .+?Constructor\]$/,Cg=Function.prototype,$g=Object.prototype,Eg=Cg.toString,Dg=$g.hasOwnProperty,Tg=RegExp("^"+Eg.call(Dg).replace(Sg,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Og(t){if(!wg(t)||jg(t))return!1;var r=yg(t)?Tg:kg;return r.test(Ng(t))}var Mg=Og;function _g(t,r){return t==null?void 0:t[r]}var Pg=_g,Ag=Mg,Rg=Pg;function Ig(t,r){var s=Rg(t,r);return Ag(s)?s:void 0}var ur=Ig,Lg=ur,Fg=Pt,Ug=Lg(Fg,"Map"),$n=Ug,Wg=ur,Bg=Wg(Object,"create"),ia=Bg,Bi=ia;function Hg(){this.__data__=Bi?Bi(null):{},this.size=0}var zg=Hg;function Gg(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var qg=Gg,Yg=ia,Vg="__lodash_hash_undefined__",Kg=Object.prototype,Jg=Kg.hasOwnProperty;function Xg(t){var r=this.__data__;if(Yg){var s=r[t];return s===Vg?void 0:s}return Jg.call(r,t)?r[t]:void 0}var Qg=Xg,Zg=ia,ex=Object.prototype,tx=ex.hasOwnProperty;function rx(t){var r=this.__data__;return Zg?r[t]!==void 0:tx.call(r,t)}var sx=rx,ax=ia,nx="__lodash_hash_undefined__";function ix(t,r){var s=this.__data__;return this.size+=this.has(t)?0:1,s[t]=ax&&r===void 0?nx:r,this}var ox=ix,lx=zg,cx=qg,dx=Qg,ux=sx,mx=ox;function _r(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var a=t[r];this.set(a[0],a[1])}}_r.prototype.clear=lx;_r.prototype.delete=cx;_r.prototype.get=dx;_r.prototype.has=ux;_r.prototype.set=mx;var hx=_r,Hi=hx,fx=na,gx=$n;function xx(){this.size=0,this.__data__={hash:new Hi,map:new(gx||fx),string:new Hi}}var px=xx;function vx(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}var bx=vx,yx=bx;function jx(t,r){var s=t.__data__;return yx(r)?s[typeof r=="string"?"string":"hash"]:s.map}var oa=jx,wx=oa;function Nx(t){var r=wx(this,t).delete(t);return this.size-=r?1:0,r}var Sx=Nx,kx=oa;function Cx(t){return kx(this,t).get(t)}var $x=Cx,Ex=oa;function Dx(t){return Ex(this,t).has(t)}var Tx=Dx,Ox=oa;function Mx(t,r){var s=Ox(this,t),a=s.size;return s.set(t,r),this.size+=s.size==a?0:1,this}var _x=Mx,Px=px,Ax=Sx,Rx=$x,Ix=Tx,Lx=_x;function Pr(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var a=t[r];this.set(a[0],a[1])}}Pr.prototype.clear=Px;Pr.prototype.delete=Ax;Pr.prototype.get=Rx;Pr.prototype.has=Ix;Pr.prototype.set=Lx;var En=Pr,Fx=na,Ux=$n,Wx=En,Bx=200;function Hx(t,r){var s=this.__data__;if(s instanceof Fx){var a=s.__data__;if(!Ux||a.length<Bx-1)return a.push([t,r]),this.size=++s.size,this;s=this.__data__=new Wx(a)}return s.set(t,r),this.size=s.size,this}var zx=Hx,Gx=na,qx=ng,Yx=og,Vx=cg,Kx=ug,Jx=zx;function Ar(t){var r=this.__data__=new Gx(t);this.size=r.size}Ar.prototype.clear=qx;Ar.prototype.delete=Yx;Ar.prototype.get=Vx;Ar.prototype.has=Kx;Ar.prototype.set=Jx;var Dn=Ar,Xx="__lodash_hash_undefined__";function Qx(t){return this.__data__.set(t,Xx),this}var Zx=Qx;function ep(t){return this.__data__.has(t)}var tp=ep,rp=En,sp=Zx,ap=tp;function Hs(t){var r=-1,s=t==null?0:t.length;for(this.__data__=new rp;++r<s;)this.add(t[r])}Hs.prototype.add=Hs.prototype.push=sp;Hs.prototype.has=ap;var np=Hs;function ip(t,r){for(var s=-1,a=t==null?0:t.length;++s<a;)if(r(t[s],s,t))return!0;return!1}var op=ip;function lp(t,r){return t.has(r)}var cp=lp,dp=np,up=op,mp=cp,hp=1,fp=2;function gp(t,r,s,a,n,i){var o=s&hp,l=t.length,c=r.length;if(l!=c&&!(o&&c>l))return!1;var d=i.get(t),g=i.get(r);if(d&&g)return d==r&&g==t;var p=-1,f=!0,m=s&fp?new dp:void 0;for(i.set(t,r),i.set(r,t);++p<l;){var y=t[p],h=r[p];if(a)var x=o?a(h,y,p,r,t,i):a(y,h,p,t,r,i);if(x!==void 0){if(x)continue;f=!1;break}if(m){if(!up(r,function(w,u){if(!mp(m,u)&&(y===w||n(y,w,s,a,i)))return m.push(u)})){f=!1;break}}else if(!(y===h||n(y,h,s,a,i))){f=!1;break}}return i.delete(t),i.delete(r),f}var Vl=gp,xp=Pt,pp=xp.Uint8Array,Kl=pp;function vp(t){var r=-1,s=Array(t.size);return t.forEach(function(a,n){s[++r]=[n,a]}),s}var bp=vp;function yp(t){var r=-1,s=Array(t.size);return t.forEach(function(a){s[++r]=a}),s}var jp=yp,zi=Tr,Gi=Kl,wp=ms,Np=Vl,Sp=bp,kp=jp,Cp=1,$p=2,Ep="[object Boolean]",Dp="[object Date]",Tp="[object Error]",Op="[object Map]",Mp="[object Number]",_p="[object RegExp]",Pp="[object Set]",Ap="[object String]",Rp="[object Symbol]",Ip="[object ArrayBuffer]",Lp="[object DataView]",qi=zi?zi.prototype:void 0,Ea=qi?qi.valueOf:void 0;function Fp(t,r,s,a,n,i,o){switch(s){case Lp:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case Ip:return!(t.byteLength!=r.byteLength||!i(new Gi(t),new Gi(r)));case Ep:case Dp:case Mp:return wp(+t,+r);case Tp:return t.name==r.name&&t.message==r.message;case _p:case Ap:return t==r+"";case Op:var l=Sp;case Pp:var c=a&Cp;if(l||(l=kp),t.size!=r.size&&!c)return!1;var d=o.get(t);if(d)return d==r;a|=$p,o.set(t,r);var g=Np(l(t),l(r),a,n,i,o);return o.delete(t),g;case Rp:if(Ea)return Ea.call(t)==Ea.call(r)}return!1}var Up=Fp;function Wp(t,r){for(var s=-1,a=r.length,n=t.length;++s<a;)t[n+s]=r[s];return t}var Tn=Wp,Bp=Array.isArray,wt=Bp,Hp=Tn,zp=wt;function Gp(t,r,s){var a=r(t);return zp(t)?a:Hp(a,s(t))}var Jl=Gp;function qp(t,r){for(var s=-1,a=t==null?0:t.length,n=0,i=[];++s<a;){var o=t[s];r(o,s,t)&&(i[n++]=o)}return i}var Yp=qp;function Vp(){return[]}var Xl=Vp,Kp=Yp,Jp=Xl,Xp=Object.prototype,Qp=Xp.propertyIsEnumerable,Yi=Object.getOwnPropertySymbols,Zp=Yi?function(t){return t==null?[]:(t=Object(t),Kp(Yi(t),function(r){return Qp.call(t,r)}))}:Jp,On=Zp;function e0(t,r){for(var s=-1,a=Array(t);++s<t;)a[s]=r(s);return a}var t0=e0,r0=Or,s0=Kt,a0="[object Arguments]";function n0(t){return s0(t)&&r0(t)==a0}var i0=n0,Vi=i0,o0=Kt,Ql=Object.prototype,l0=Ql.hasOwnProperty,c0=Ql.propertyIsEnumerable,d0=Vi(function(){return arguments}())?Vi:function(t){return o0(t)&&l0.call(t,"callee")&&!c0.call(t,"callee")},Mn=d0,zs={exports:{}};function u0(){return!1}var m0=u0;zs.exports;(function(t,r){var s=Pt,a=m0,n=r&&!r.nodeType&&r,i=n&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===n,l=o?s.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||a;t.exports=d})(zs,zs.exports);var la=zs.exports,h0=Or,f0=hn,g0=Kt,x0="[object Arguments]",p0="[object Array]",v0="[object Boolean]",b0="[object Date]",y0="[object Error]",j0="[object Function]",w0="[object Map]",N0="[object Number]",S0="[object Object]",k0="[object RegExp]",C0="[object Set]",$0="[object String]",E0="[object WeakMap]",D0="[object ArrayBuffer]",T0="[object DataView]",O0="[object Float32Array]",M0="[object Float64Array]",_0="[object Int8Array]",P0="[object Int16Array]",A0="[object Int32Array]",R0="[object Uint8Array]",I0="[object Uint8ClampedArray]",L0="[object Uint16Array]",F0="[object Uint32Array]",De={};De[O0]=De[M0]=De[_0]=De[P0]=De[A0]=De[R0]=De[I0]=De[L0]=De[F0]=!0;De[x0]=De[p0]=De[D0]=De[v0]=De[T0]=De[b0]=De[y0]=De[j0]=De[w0]=De[N0]=De[S0]=De[k0]=De[C0]=De[$0]=De[E0]=!1;function U0(t){return g0(t)&&f0(t.length)&&!!De[h0(t)]}var W0=U0;function B0(t){return function(r){return t(r)}}var ca=B0,Gs={exports:{}};Gs.exports;(function(t,r){var s=Tl,a=r&&!r.nodeType&&r,n=a&&!0&&t&&!t.nodeType&&t,i=n&&n.exports===a,o=i&&s.process,l=function(){try{var c=n&&n.require&&n.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();t.exports=l})(Gs,Gs.exports);var _n=Gs.exports,H0=W0,z0=ca,Ki=_n,Ji=Ki&&Ki.isTypedArray,G0=Ji?z0(Ji):H0,Pn=G0,q0=t0,Y0=Mn,V0=wt,K0=la,J0=fn,X0=Pn,Q0=Object.prototype,Z0=Q0.hasOwnProperty;function ev(t,r){var s=V0(t),a=!s&&Y0(t),n=!s&&!a&&K0(t),i=!s&&!a&&!n&&X0(t),o=s||a||n||i,l=o?q0(t.length,String):[],c=l.length;for(var d in t)(r||Z0.call(t,d))&&!(o&&(d=="length"||n&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||J0(d,c)))&&l.push(d);return l}var Zl=ev,tv=Object.prototype;function rv(t){var r=t&&t.constructor,s=typeof r=="function"&&r.prototype||tv;return t===s}var An=rv;function sv(t,r){return function(s){return t(r(s))}}var ec=sv,av=ec,nv=av(Object.keys,Object),iv=nv,ov=An,lv=iv,cv=Object.prototype,dv=cv.hasOwnProperty;function uv(t){if(!ov(t))return lv(t);var r=[];for(var s in Object(t))dv.call(t,s)&&s!="constructor"&&r.push(s);return r}var mv=uv,hv=Zl,fv=mv,gv=hs;function xv(t){return gv(t)?hv(t):fv(t)}var vs=xv,pv=Jl,vv=On,bv=vs;function yv(t){return pv(t,bv,vv)}var tc=yv,Xi=tc,jv=1,wv=Object.prototype,Nv=wv.hasOwnProperty;function Sv(t,r,s,a,n,i){var o=s&jv,l=Xi(t),c=l.length,d=Xi(r),g=d.length;if(c!=g&&!o)return!1;for(var p=c;p--;){var f=l[p];if(!(o?f in r:Nv.call(r,f)))return!1}var m=i.get(t),y=i.get(r);if(m&&y)return m==r&&y==t;var h=!0;i.set(t,r),i.set(r,t);for(var x=o;++p<c;){f=l[p];var w=t[f],u=r[f];if(a)var N=o?a(u,w,f,r,t,i):a(w,u,f,t,r,i);if(!(N===void 0?w===u||n(w,u,s,a,i):N)){h=!1;break}x||(x=f=="constructor")}if(h&&!x){var v=t.constructor,S=r.constructor;v!=S&&"constructor"in t&&"constructor"in r&&!(typeof v=="function"&&v instanceof v&&typeof S=="function"&&S instanceof S)&&(h=!1)}return i.delete(t),i.delete(r),h}var kv=Sv,Cv=ur,$v=Pt,Ev=Cv($v,"DataView"),Dv=Ev,Tv=ur,Ov=Pt,Mv=Tv(Ov,"Promise"),_v=Mv,Pv=ur,Av=Pt,Rv=Pv(Av,"Set"),Iv=Rv,Lv=ur,Fv=Pt,Uv=Lv(Fv,"WeakMap"),Wv=Uv,qa=Dv,Ya=$n,Va=_v,Ka=Iv,Ja=Wv,rc=Or,Rr=Yl,Qi="[object Map]",Bv="[object Object]",Zi="[object Promise]",eo="[object Set]",to="[object WeakMap]",ro="[object DataView]",Hv=Rr(qa),zv=Rr(Ya),Gv=Rr(Va),qv=Rr(Ka),Yv=Rr(Ja),Xt=rc;(qa&&Xt(new qa(new ArrayBuffer(1)))!=ro||Ya&&Xt(new Ya)!=Qi||Va&&Xt(Va.resolve())!=Zi||Ka&&Xt(new Ka)!=eo||Ja&&Xt(new Ja)!=to)&&(Xt=function(t){var r=rc(t),s=r==Bv?t.constructor:void 0,a=s?Rr(s):"";if(a)switch(a){case Hv:return ro;case zv:return Qi;case Gv:return Zi;case qv:return eo;case Yv:return to}return r});var da=Xt,Da=Dn,Vv=Vl,Kv=Up,Jv=kv,so=da,ao=wt,no=la,Xv=Pn,Qv=1,io="[object Arguments]",oo="[object Array]",Ds="[object Object]",Zv=Object.prototype,lo=Zv.hasOwnProperty;function eb(t,r,s,a,n,i){var o=ao(t),l=ao(r),c=o?oo:so(t),d=l?oo:so(r);c=c==io?Ds:c,d=d==io?Ds:d;var g=c==Ds,p=d==Ds,f=c==d;if(f&&no(t)){if(!no(r))return!1;o=!0,g=!1}if(f&&!g)return i||(i=new Da),o||Xv(t)?Vv(t,r,s,a,n,i):Kv(t,r,c,s,a,n,i);if(!(s&Qv)){var m=g&&lo.call(t,"__wrapped__"),y=p&&lo.call(r,"__wrapped__");if(m||y){var h=m?t.value():t,x=y?r.value():r;return i||(i=new Da),n(h,x,s,a,i)}}return f?(i||(i=new Da),Jv(t,r,s,a,n,i)):!1}var tb=eb,rb=tb,co=Kt;function sc(t,r,s,a,n){return t===r?!0:t==null||r==null||!co(t)&&!co(r)?t!==t&&r!==r:rb(t,r,s,a,sc,n)}var Rn=sc,sb=Rn;function ab(t,r){return sb(t,r)}var nb=ab;const ib=jt(nb);function Ta(t,r){var s=gn(t);return s?s.innerHeight:er(t).height}function ac(t,r,s){t.closest&&!s&&t.closest(r);var a=t;do{if(rh(a,r))return a;a=a.parentElement}while(a&&a!==s&&a.nodeType===document.ELEMENT_NODE);return null}function ob(t,r,s,a){for(var n=t.length,i=s+(a?1:-1);a?i--:++i<n;)if(r(t[i],i,t))return i;return-1}var lb=ob,cb=Dn,db=Rn,ub=1,mb=2;function hb(t,r,s,a){var n=s.length,i=n,o=!a;if(t==null)return!i;for(t=Object(t);n--;){var l=s[n];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++n<i;){l=s[n];var c=l[0],d=t[c],g=l[1];if(o&&l[2]){if(d===void 0&&!(c in t))return!1}else{var p=new cb;if(a)var f=a(d,g,c,t,r,p);if(!(f===void 0?db(g,d,ub|mb,a,p):f))return!1}}return!0}var fb=hb,gb=Wt;function xb(t){return t===t&&!gb(t)}var nc=xb,pb=nc,vb=vs;function bb(t){for(var r=vb(t),s=r.length;s--;){var a=r[s],n=t[a];r[s]=[a,n,pb(n)]}return r}var yb=bb;function jb(t,r){return function(s){return s==null?!1:s[t]===r&&(r!==void 0||t in Object(s))}}var ic=jb,wb=fb,Nb=yb,Sb=ic;function kb(t){var r=Nb(t);return r.length==1&&r[0][2]?Sb(r[0][0],r[0][1]):function(s){return s===t||wb(s,t,r)}}var Cb=kb,$b=wt,Eb=fs,Db=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tb=/^\w*$/;function Ob(t,r){if($b(t))return!1;var s=typeof t;return s=="number"||s=="symbol"||s=="boolean"||t==null||Eb(t)?!0:Tb.test(t)||!Db.test(t)||r!=null&&t in Object(r)}var In=Ob,oc=En,Mb="Expected a function";function Ln(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(Mb);var s=function(){var a=arguments,n=r?r.apply(this,a):a[0],i=s.cache;if(i.has(n))return i.get(n);var o=t.apply(this,a);return s.cache=i.set(n,o)||i,o};return s.cache=new(Ln.Cache||oc),s}Ln.Cache=oc;var _b=Ln,Pb=_b,Ab=500;function Rb(t){var r=Pb(t,function(a){return s.size===Ab&&s.clear(),a}),s=r.cache;return r}var Ib=Rb,Lb=Ib,Fb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ub=/\\(\\)?/g,Wb=Lb(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(Fb,function(s,a,n,i){r.push(n?i.replace(Ub,"$1"):a||s)}),r}),Bb=Wb;function Hb(t,r){for(var s=-1,a=t==null?0:t.length,n=Array(a);++s<a;)n[s]=r(t[s],s,t);return n}var Fn=Hb,uo=Tr,zb=Fn,Gb=wt,qb=fs,mo=uo?uo.prototype:void 0,ho=mo?mo.toString:void 0;function lc(t){if(typeof t=="string")return t;if(Gb(t))return zb(t,lc)+"";if(qb(t))return ho?ho.call(t):"";var r=t+"";return r=="0"&&1/t==-1/0?"-0":r}var Yb=lc,Vb=Yb;function Kb(t){return t==null?"":Vb(t)}var Jb=Kb,Xb=wt,Qb=In,Zb=Bb,ey=Jb;function ty(t,r){return Xb(t)?t:Qb(t,r)?[t]:Zb(ey(t))}var ua=ty,ry=fs;function sy(t){if(typeof t=="string"||ry(t))return t;var r=t+"";return r=="0"&&1/t==-1/0?"-0":r}var bs=sy,ay=ua,ny=bs;function iy(t,r){r=ay(r,t);for(var s=0,a=r.length;t!=null&&s<a;)t=t[ny(r[s++])];return s&&s==a?t:void 0}var ma=iy,oy=ma;function ly(t,r,s){var a=t==null?void 0:oy(t,r);return a===void 0?s:a}var cy=ly;function dy(t,r){return t!=null&&r in Object(t)}var uy=dy,my=ua,hy=Mn,fy=wt,gy=fn,xy=hn,py=bs;function vy(t,r,s){r=my(r,t);for(var a=-1,n=r.length,i=!1;++a<n;){var o=py(r[a]);if(!(i=t!=null&&s(t,o)))break;t=t[o]}return i||++a!=n?i:(n=t==null?0:t.length,!!n&&xy(n)&&gy(o,n)&&(fy(t)||hy(t)))}var by=vy,yy=uy,jy=by;function wy(t,r){return t!=null&&jy(t,r,yy)}var Ny=wy,Sy=Rn,ky=cy,Cy=Ny,$y=In,Ey=nc,Dy=ic,Ty=bs,Oy=1,My=2;function _y(t,r){return $y(t)&&Ey(r)?Dy(Ty(t),r):function(s){var a=ky(s,t);return a===void 0&&a===r?Cy(s,t):Sy(r,a,Oy|My)}}var Py=_y;function Ay(t){return t}var ha=Ay;function Ry(t){return function(r){return r==null?void 0:r[t]}}var Iy=Ry,Ly=ma;function Fy(t){return function(r){return Ly(r,t)}}var Uy=Fy,Wy=Iy,By=Uy,Hy=In,zy=bs;function Gy(t){return Hy(t)?Wy(zy(t)):By(t)}var qy=Gy,Yy=Cb,Vy=Py,Ky=ha,Jy=wt,Xy=qy;function Qy(t){return typeof t=="function"?t:t==null?Ky:typeof t=="object"?Jy(t)?Vy(t[0],t[1]):Yy(t):Xy(t)}var fa=Qy,Zy=lb,ej=fa,tj=_l,rj=Math.max;function sj(t,r,s){var a=t==null?0:t.length;if(!a)return-1;var n=s==null?0:tj(s);return n<0&&(n=rj(a+n,0)),Zy(t,ej(r),n)}var aj=sj;const nj=jt(aj);var ij=Math.ceil,oj=Math.max;function lj(t,r,s,a){for(var n=-1,i=oj(ij((r-t)/(s||1)),0),o=Array(i);i--;)o[a?i:++n]=t,t+=s;return o}var cj=lj,dj=cj,uj=ra,Oa=Ml;function mj(t){return function(r,s,a){return a&&typeof a!="number"&&uj(r,s,a)&&(s=a=void 0),r=Oa(r),s===void 0?(s=r,r=0):s=Oa(s),a=a===void 0?r<s?1:-1:Oa(a),dj(r,s,a,t)}}var hj=mj,fj=hj,gj=fj(),xj=gj;const pj=jt(xj);var fo=Number.isNaN||function(r){return typeof r=="number"&&r!==r};function vj(t,r){return!!(t===r||fo(t)&&fo(r))}function bj(t,r){if(t.length!==r.length)return!1;for(var s=0;s<t.length;s++)if(!vj(t[s],r[s]))return!1;return!0}function cc(t,r){r===void 0&&(r=bj);var s=null;function a(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(s&&s.lastThis===this&&r(n,s.lastArgs))return s.lastResult;var o=t.apply(this,n);return s={lastResult:o,lastArgs:n,lastThis:this},o}return a.clear=function(){s=null},a}function Xa(t,r){var s=gn(t);return s?s.innerWidth:er(t).width}var go=Tr,yj=Mn,jj=wt,xo=go?go.isConcatSpreadable:void 0;function wj(t){return jj(t)||yj(t)||!!(xo&&t&&t[xo])}var Nj=wj,Sj=Tn,kj=Nj;function dc(t,r,s,a,n){var i=-1,o=t.length;for(s||(s=kj),n||(n=[]);++i<o;){var l=t[i];r>0&&s(l)?r>1?dc(l,r-1,s,a,n):Sj(n,l):a||(n[n.length]=l)}return n}var uc=dc;function Cj(t){return function(r,s,a){for(var n=-1,i=Object(r),o=a(r),l=o.length;l--;){var c=o[t?l:++n];if(s(i[c],c,i)===!1)break}return r}}var $j=Cj,Ej=$j,Dj=Ej(),Tj=Dj,Oj=Tj,Mj=vs;function _j(t,r){return t&&Oj(t,r,Mj)}var Un=_j,Pj=hs;function Aj(t,r){return function(s,a){if(s==null)return s;if(!Pj(s))return t(s,a);for(var n=s.length,i=r?n:-1,o=Object(s);(r?i--:++i<n)&&a(o[i],i,o)!==!1;);return s}}var Rj=Aj,Ij=Un,Lj=Rj,Fj=Lj(Ij),Uj=Fj,Wj=Uj,Bj=hs;function Hj(t,r){var s=-1,a=Bj(t)?Array(t.length):[];return Wj(t,function(n,i,o){a[++s]=r(n,i,o)}),a}var zj=Hj;function Gj(t,r){var s=t.length;for(t.sort(r);s--;)t[s]=t[s].value;return t}var qj=Gj,po=fs;function Yj(t,r){if(t!==r){var s=t!==void 0,a=t===null,n=t===t,i=po(t),o=r!==void 0,l=r===null,c=r===r,d=po(r);if(!l&&!d&&!i&&t>r||i&&o&&c&&!l&&!d||a&&o&&c||!s&&c||!n)return 1;if(!a&&!i&&!d&&t<r||d&&s&&n&&!a&&!i||l&&s&&n||!o&&n||!c)return-1}return 0}var Vj=Yj,Kj=Vj;function Jj(t,r,s){for(var a=-1,n=t.criteria,i=r.criteria,o=n.length,l=s.length;++a<o;){var c=Kj(n[a],i[a]);if(c){if(a>=l)return c;var d=s[a];return c*(d=="desc"?-1:1)}}return t.index-r.index}var Xj=Jj,Ma=Fn,Qj=ma,Zj=fa,ew=zj,tw=qj,rw=ca,sw=Xj,aw=ha,nw=wt;function iw(t,r,s){r.length?r=Ma(r,function(i){return nw(i)?function(o){return Qj(o,i.length===1?i[0]:i)}:i}):r=[aw];var a=-1;r=Ma(r,rw(Zj));var n=ew(t,function(i,o,l){var c=Ma(r,function(d){return d(i)});return{criteria:c,index:++a,value:i}});return tw(n,function(i,o){return sw(i,o,s)})}var ow=iw;function lw(t,r,s){switch(s.length){case 0:return t.call(r);case 1:return t.call(r,s[0]);case 2:return t.call(r,s[0],s[1]);case 3:return t.call(r,s[0],s[1],s[2])}return t.apply(r,s)}var cw=lw,dw=cw,vo=Math.max;function uw(t,r,s){return r=vo(r===void 0?t.length-1:r,0),function(){for(var a=arguments,n=-1,i=vo(a.length-r,0),o=Array(i);++n<i;)o[n]=a[r+n];n=-1;for(var l=Array(r+1);++n<r;)l[n]=a[n];return l[r]=s(o),dw(t,this,l)}}var mc=uw;function mw(t){return function(){return t}}var hw=mw,fw=ur,gw=function(){try{var t=fw(Object,"defineProperty");return t({},"",{}),t}catch{}}(),hc=gw,xw=hw,bo=hc,pw=ha,vw=bo?function(t,r){return bo(t,"toString",{configurable:!0,enumerable:!1,value:xw(r),writable:!0})}:pw,bw=vw,yw=800,jw=16,ww=Date.now;function Nw(t){var r=0,s=0;return function(){var a=ww(),n=jw-(a-s);if(s=a,n>0){if(++r>=yw)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}var Sw=Nw,kw=bw,Cw=Sw,$w=Cw(kw),fc=$w,Ew=ha,Dw=mc,Tw=fc;function Ow(t,r){return Tw(Dw(t,r,Ew),t+"")}var gc=Ow,Mw=uc,_w=ow,Pw=gc,yo=ra,Aw=Pw(function(t,r){if(t==null)return[];var s=r.length;return s>1&&yo(t,r[0],r[1])?r=[]:s>2&&yo(r[0],r[1],r[2])&&(r=[r[0]]),_w(t,Mw(r,1),[])}),Rw=Aw;const Iw=jt(Rw);function xc(t){return ul(t)||El(t)||cn(t)||ml()}function Lw(t){var r=[];if(t!=null)for(var s in Object(t))r.push(s);return r}var Fw=Lw,Uw=Wt,Ww=An,Bw=Fw,Hw=Object.prototype,zw=Hw.hasOwnProperty;function Gw(t){if(!Uw(t))return Bw(t);var r=Ww(t),s=[];for(var a in t)a=="constructor"&&(r||!zw.call(t,a))||s.push(a);return s}var qw=Gw,Yw=Zl,Vw=qw,Kw=hs;function Jw(t){return Kw(t)?Yw(t,!0):Vw(t)}var ga=Jw,Xw=gc,Qw=ms,Zw=ra,eN=ga,pc=Object.prototype,tN=pc.hasOwnProperty,rN=Xw(function(t,r){t=Object(t);var s=-1,a=r.length,n=a>2?r[2]:void 0;for(n&&Zw(r[0],r[1],n)&&(a=1);++s<a;)for(var i=r[s],o=eN(i),l=-1,c=o.length;++l<c;){var d=o[l],g=t[d];(g===void 0||Qw(g,pc[d])&&!tN.call(t,d))&&(t[d]=i[d])}return t}),sN=rN;const aN=jt(sN);var jo=hc;function nN(t,r,s){r=="__proto__"&&jo?jo(t,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):t[r]=s}var Wn=nN,iN=Wn,oN=Un,lN=fa;function cN(t,r){var s={};return r=lN(r),oN(t,function(a,n,i){iN(s,n,r(a,n,i))}),s}var dN=cN;const uN=jt(dN);function mN(t,r){for(var s=-1,a=t==null?0:t.length;++s<a&&r(t[s],s,t)!==!1;);return t}var vc=mN,hN=Wn,fN=ms,gN=Object.prototype,xN=gN.hasOwnProperty;function pN(t,r,s){var a=t[r];(!(xN.call(t,r)&&fN(a,s))||s===void 0&&!(r in t))&&hN(t,r,s)}var bc=pN,vN=bc,bN=Wn;function yN(t,r,s,a){var n=!s;s||(s={});for(var i=-1,o=r.length;++i<o;){var l=r[i],c=a?a(s[l],t[l],l,s,t):void 0;c===void 0&&(c=t[l]),n?bN(s,l,c):vN(s,l,c)}return s}var ys=yN,jN=ys,wN=vs;function NN(t,r){return t&&jN(r,wN(r),t)}var SN=NN,kN=ys,CN=ga;function $N(t,r){return t&&kN(r,CN(r),t)}var EN=$N,qs={exports:{}};qs.exports;(function(t,r){var s=Pt,a=r&&!r.nodeType&&r,n=a&&!0&&t&&!t.nodeType&&t,i=n&&n.exports===a,o=i?s.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(d,g){if(g)return d.slice();var p=d.length,f=l?l(p):new d.constructor(p);return d.copy(f),f}t.exports=c})(qs,qs.exports);var DN=qs.exports;function TN(t,r){var s=-1,a=t.length;for(r||(r=Array(a));++s<a;)r[s]=t[s];return r}var ON=TN,MN=ys,_N=On;function PN(t,r){return MN(t,_N(t),r)}var AN=PN,RN=ec,IN=RN(Object.getPrototypeOf,Object),xa=IN,LN=Tn,FN=xa,UN=On,WN=Xl,BN=Object.getOwnPropertySymbols,HN=BN?function(t){for(var r=[];t;)LN(r,UN(t)),t=FN(t);return r}:WN,yc=HN,zN=ys,GN=yc;function qN(t,r){return zN(t,GN(t),r)}var YN=qN,VN=Jl,KN=yc,JN=ga;function XN(t){return VN(t,JN,KN)}var jc=XN,QN=Object.prototype,ZN=QN.hasOwnProperty;function e1(t){var r=t.length,s=new t.constructor(r);return r&&typeof t[0]=="string"&&ZN.call(t,"index")&&(s.index=t.index,s.input=t.input),s}var t1=e1,wo=Kl;function r1(t){var r=new t.constructor(t.byteLength);return new wo(r).set(new wo(t)),r}var Bn=r1,s1=Bn;function a1(t,r){var s=r?s1(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.byteLength)}var n1=a1,i1=/\w*$/;function o1(t){var r=new t.constructor(t.source,i1.exec(t));return r.lastIndex=t.lastIndex,r}var l1=o1,No=Tr,So=No?No.prototype:void 0,ko=So?So.valueOf:void 0;function c1(t){return ko?Object(ko.call(t)):{}}var d1=c1,u1=Bn;function m1(t,r){var s=r?u1(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.length)}var h1=m1,f1=Bn,g1=n1,x1=l1,p1=d1,v1=h1,b1="[object Boolean]",y1="[object Date]",j1="[object Map]",w1="[object Number]",N1="[object RegExp]",S1="[object Set]",k1="[object String]",C1="[object Symbol]",$1="[object ArrayBuffer]",E1="[object DataView]",D1="[object Float32Array]",T1="[object Float64Array]",O1="[object Int8Array]",M1="[object Int16Array]",_1="[object Int32Array]",P1="[object Uint8Array]",A1="[object Uint8ClampedArray]",R1="[object Uint16Array]",I1="[object Uint32Array]";function L1(t,r,s){var a=t.constructor;switch(r){case $1:return f1(t);case b1:case y1:return new a(+t);case E1:return g1(t,s);case D1:case T1:case O1:case M1:case _1:case P1:case A1:case R1:case I1:return v1(t,s);case j1:return new a;case w1:case k1:return new a(t);case N1:return x1(t);case S1:return new a;case C1:return p1(t)}}var F1=L1,U1=Wt,Co=Object.create,W1=function(){function t(){}return function(r){if(!U1(r))return{};if(Co)return Co(r);t.prototype=r;var s=new t;return t.prototype=void 0,s}}(),wc=W1,B1=wc,H1=xa,z1=An;function G1(t){return typeof t.constructor=="function"&&!z1(t)?B1(H1(t)):{}}var q1=G1,Y1=da,V1=Kt,K1="[object Map]";function J1(t){return V1(t)&&Y1(t)==K1}var X1=J1,Q1=X1,Z1=ca,$o=_n,Eo=$o&&$o.isMap,e2=Eo?Z1(Eo):Q1,t2=e2,r2=da,s2=Kt,a2="[object Set]";function n2(t){return s2(t)&&r2(t)==a2}var i2=n2,o2=i2,l2=ca,Do=_n,To=Do&&Do.isSet,c2=To?l2(To):o2,d2=c2,u2=Dn,m2=vc,h2=bc,f2=SN,g2=EN,x2=DN,p2=ON,v2=AN,b2=YN,y2=tc,j2=jc,w2=da,N2=t1,S2=F1,k2=q1,C2=wt,$2=la,E2=t2,D2=Wt,T2=d2,O2=vs,M2=ga,_2=1,P2=2,A2=4,Nc="[object Arguments]",R2="[object Array]",I2="[object Boolean]",L2="[object Date]",F2="[object Error]",Sc="[object Function]",U2="[object GeneratorFunction]",W2="[object Map]",B2="[object Number]",kc="[object Object]",H2="[object RegExp]",z2="[object Set]",G2="[object String]",q2="[object Symbol]",Y2="[object WeakMap]",V2="[object ArrayBuffer]",K2="[object DataView]",J2="[object Float32Array]",X2="[object Float64Array]",Q2="[object Int8Array]",Z2="[object Int16Array]",eS="[object Int32Array]",tS="[object Uint8Array]",rS="[object Uint8ClampedArray]",sS="[object Uint16Array]",aS="[object Uint32Array]",$e={};$e[Nc]=$e[R2]=$e[V2]=$e[K2]=$e[I2]=$e[L2]=$e[J2]=$e[X2]=$e[Q2]=$e[Z2]=$e[eS]=$e[W2]=$e[B2]=$e[kc]=$e[H2]=$e[z2]=$e[G2]=$e[q2]=$e[tS]=$e[rS]=$e[sS]=$e[aS]=!0;$e[F2]=$e[Sc]=$e[Y2]=!1;function As(t,r,s,a,n,i){var o,l=r&_2,c=r&P2,d=r&A2;if(s&&(o=n?s(t,a,n,i):s(t)),o!==void 0)return o;if(!D2(t))return t;var g=C2(t);if(g){if(o=N2(t),!l)return p2(t,o)}else{var p=w2(t),f=p==Sc||p==U2;if($2(t))return x2(t,l);if(p==kc||p==Nc||f&&!n){if(o=c||f?{}:k2(t),!l)return c?b2(t,g2(o,t)):v2(t,f2(o,t))}else{if(!$e[p])return n?t:{};o=S2(t,p,l)}}i||(i=new u2);var m=i.get(t);if(m)return m;i.set(t,o),T2(t)?t.forEach(function(x){o.add(As(x,r,s,x,t,i))}):E2(t)&&t.forEach(function(x,w){o.set(w,As(x,r,s,w,t,i))});var y=d?c?j2:y2:c?M2:O2,h=g?void 0:y(t);return m2(h||t,function(x,w){h&&(w=x,x=t[w]),h2(o,w,As(x,r,s,w,t,i))}),o}var nS=As;function iS(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}var oS=iS,lS=ma,cS=Dl;function dS(t,r){return r.length<2?t:lS(t,cS(r,0,-1))}var uS=dS,mS=ua,hS=oS,fS=uS,gS=bs;function xS(t,r){return r=mS(r,t),t=fS(t,r),t==null||delete t[gS(hS(r))]}var pS=xS,vS=Or,bS=xa,yS=Kt,jS="[object Object]",wS=Function.prototype,NS=Object.prototype,Cc=wS.toString,SS=NS.hasOwnProperty,kS=Cc.call(Object);function CS(t){if(!yS(t)||vS(t)!=jS)return!1;var r=bS(t);if(r===null)return!0;var s=SS.call(r,"constructor")&&r.constructor;return typeof s=="function"&&s instanceof s&&Cc.call(s)==kS}var $S=CS,ES=$S;function DS(t){return ES(t)?void 0:t}var TS=DS,OS=uc;function MS(t){var r=t==null?0:t.length;return r?OS(t,1):[]}var _S=MS,PS=_S,AS=mc,RS=fc;function IS(t){return RS(AS(t,void 0,PS),t+"")}var LS=IS,FS=Fn,US=nS,WS=pS,BS=ua,HS=ys,zS=TS,GS=LS,qS=jc,YS=1,VS=2,KS=4,JS=GS(function(t,r){var s={};if(t==null)return s;var a=!1;r=FS(r,function(i){return i=BS(i,t),a||(a=i.length>1),i}),HS(t,qS(t),s),a&&(s=US(s,YS|VS|KS,zS));for(var n=r.length;n--;)WS(s,r[n]);return s}),XS=JS;const QS=jt(XS);var ZS=vc,ek=wc,tk=Un,rk=fa,sk=xa,ak=wt,nk=la,ik=mn,ok=Wt,lk=Pn;function ck(t,r,s){var a=ak(t),n=a||nk(t)||lk(t);if(r=rk(r),s==null){var i=t&&t.constructor;n?s=a?new i:[]:ok(t)?s=ik(i)?ek(sk(t)):{}:s={}}return(n?ZS:tk)(t,function(o,l,c){return r(s,o,l,c)}),s}var dk=ck;const uk=jt(dk);var mk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(pt,function(){return function(s,a,n){a.prototype.isBetween=function(i,o,l,c){var d=n(i),g=n(o),p=(c=c||"()")[0]==="(",f=c[1]===")";return(p?this.isAfter(d,l):!this.isBefore(d,l))&&(f?this.isBefore(g,l):!this.isAfter(g,l))||(p?this.isBefore(d,l):!this.isAfter(d,l))&&(f?this.isAfter(g,l):!this.isBefore(g,l))}}})})(mk);var hk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(pt,function(){return function(s,a){a.prototype.isSameOrAfter=function(n,i){return this.isSame(n,i)||this.isAfter(n,i)}}})})(hk);var fk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(pt,function(){return function(s,a){a.prototype.isSameOrBefore=function(n,i){return this.isSame(n,i)||this.isBefore(n,i)}}})})(fk);var gk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(pt,function(){return function(s,a,n){var i=a.prototype,o=function(p){return p&&(p.indexOf?p:p.s)},l=function(p,f,m,y,h){var x=p.name?p:p.$locale(),w=o(x[f]),u=o(x[m]),N=w||u.map(function(S){return S.slice(0,y)});if(!h)return N;var v=x.weekStart;return N.map(function(S,_){return N[(_+(v||0))%7]})},c=function(){return n.Ls[n.locale()]},d=function(p,f){return p.formats[f]||function(m){return m.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(y,h,x){return h||x.slice(1)})}(p.formats[f.toUpperCase()])},g=function(){var p=this;return{months:function(f){return f?f.format("MMMM"):l(p,"months")},monthsShort:function(f){return f?f.format("MMM"):l(p,"monthsShort","months",3)},firstDayOfWeek:function(){return p.$locale().weekStart||0},weekdays:function(f){return f?f.format("dddd"):l(p,"weekdays")},weekdaysMin:function(f){return f?f.format("dd"):l(p,"weekdaysMin","weekdays",2)},weekdaysShort:function(f){return f?f.format("ddd"):l(p,"weekdaysShort","weekdays",3)},longDateFormat:function(f){return d(p.$locale(),f)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return g.bind(this)()},n.localeData=function(){var p=c();return{firstDayOfWeek:function(){return p.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(f){return d(p,f)},meridiem:p.meridiem,ordinal:p.ordinal}},n.months=function(){return l(c(),"months")},n.monthsShort=function(){return l(c(),"monthsShort","months",3)},n.weekdays=function(p){return l(c(),"weekdays",null,null,p)},n.weekdaysShort=function(p){return l(c(),"weekdaysShort","weekdays",3,p)},n.weekdaysMin=function(p){return l(c(),"weekdaysMin","weekdays",2,p)}}})})(gk);var xk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(pt,function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(a,n,i){var o=n.prototype,l=o.format;i.en.formats=s,o.format=function(c){c===void 0&&(c="YYYY-MM-DDTHH:mm:ssZ");var d=this.$locale().formats,g=function(p,f){return p.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(m,y,h){var x=h&&h.toUpperCase();return y||f[h]||s[h]||f[x].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(w,u,N){return u||N.slice(1)})})}(c,d===void 0?{}:d);return l.call(this,g)}}})})(xk);var pk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(pt,function(){return function(s,a,n){var i=function(o,l){if(!l||!l.length||l.length===1&&!l[0]||l.length===1&&Array.isArray(l[0])&&!l[0].length)return null;var c;l.length===1&&l[0].length>0&&(l=l[0]),c=(l=l.filter(function(g){return g}))[0];for(var d=1;d<l.length;d+=1)l[d].isValid()&&!l[d][o](c)||(c=l[d]);return c};n.max=function(){var o=[].slice.call(arguments,0);return i("isAfter",o)},n.min=function(){var o=[].slice.call(arguments,0);return i("isBefore",o)}}})})(pk);var vk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(pt,function(){var s="minute",a=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(i,o,l){var c=o.prototype;l.utc=function(h){var x={date:h,utc:!0,args:arguments};return new o(x)},c.utc=function(h){var x=l(this.toDate(),{locale:this.$L,utc:!0});return h?x.add(this.utcOffset(),s):x},c.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var d=c.parse;c.parse=function(h){h.utc&&(this.$u=!0),this.$utils().u(h.$offset)||(this.$offset=h.$offset),d.call(this,h)};var g=c.init;c.init=function(){if(this.$u){var h=this.$d;this.$y=h.getUTCFullYear(),this.$M=h.getUTCMonth(),this.$D=h.getUTCDate(),this.$W=h.getUTCDay(),this.$H=h.getUTCHours(),this.$m=h.getUTCMinutes(),this.$s=h.getUTCSeconds(),this.$ms=h.getUTCMilliseconds()}else g.call(this)};var p=c.utcOffset;c.utcOffset=function(h,x){var w=this.$utils().u;if(w(h))return this.$u?0:w(this.$offset)?p.call(this):this.$offset;if(typeof h=="string"&&(h=function(S){S===void 0&&(S="");var _=S.match(a);if(!_)return null;var P=(""+_[0]).match(n)||["-",0,0],B=P[0],T=60*+P[1]+ +P[2];return T===0?0:B==="+"?T:-T}(h),h===null))return this;var u=Math.abs(h)<=16?60*h:h,N=this;if(x)return N.$offset=u,N.$u=h===0,N;if(h!==0){var v=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(N=this.local().add(u+v,s)).$offset=u,N.$x.$localOffset=v}else N=this.utc();return N};var f=c.format;c.format=function(h){var x=h||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return f.call(this,x)},c.valueOf=function(){var h=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*h},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var m=c.toDate;c.toDate=function(h){return h==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var y=c.diff;c.diff=function(h,x,w){if(h&&this.$u===h.$u)return y.call(this,h,x,w);var u=this.local(),N=l(h).local();return y.call(u,N,x,w)}}})})(vk);var bk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(pt,function(){return function(s,a){a.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}}})})(bk);function kt(t){return t.children}var lt={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},st={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},Oo=Object.keys(st).map(function(t){return st[t]});ee.oneOfType([ee.string,ee.func]);ee.any;ee.func;ee.oneOfType([ee.arrayOf(ee.oneOf(Oo)),ee.objectOf(function(t,r){var s=Oo.indexOf(r)!==-1&&typeof t[r]=="boolean";if(s)return null;for(var a=arguments.length,n=new Array(a>2?a-2:0),i=2;i<a;i++)n[i-2]=arguments[i];return ee.elementType.apply(ee,[t,r].concat(n))})]);ee.oneOfType([ee.oneOf(["overlap","no-overlap"]),ee.func]);var Mo={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function $c(t,r){var s=Ve(t,"month");return Ve(s,"week",r.startOfWeek())}function Ec(t,r){var s=Us(t,"month");return Us(s,"week",r.startOfWeek())}function yk(t,r){for(var s=$c(t,r),a=Ec(t,r),n=[];Er(s,a,"day");)n.push(s),s=St(s,1,"day");return n}function jk(t,r){var s=Ve(t,r);return $r(s,t)?s:St(s,1,r)}function wk(t,r){for(var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",a=t,n=[];Er(a,r,s);)n.push(a),a=St(a,1,s);return n}function Nk(t,r){return r==null&&t==null?null:(r==null&&(r=new Date),t==null&&(t=new Date),t=Ve(t,"day"),t=ns(t,ns(r)),t=wr(t,wr(r)),t=as(t,as(r)),ss(t,ss(r)))}function _o(t){return ns(t)===0&&wr(t)===0&&as(t)===0&&ss(t)===0}function Sk(t,r,s,a){return s==="day"&&(s="date"),Math.abs(fi[s](t,void 0,a)-fi[s](r,void 0,a))}function Hn(t,r,s){return!s||s==="milliseconds"?Math.abs(+t-+r):Math.round(Math.abs(+Ve(t,s)/Mo[s]-+Ve(r,s)/Mo[s]))}var kk=ee.oneOfType([ee.string,ee.func]);function Ck(t,r,s,a,n){var i=typeof a=="function"?a(s,n,t):r.call(t,s,a,n);return Xr(i==null||typeof i=="string","`localizer format(..)` must return a string, null, or undefined"),i}function $k(t,r,s){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,r+s,0,0)}function zn(t,r){return t.getTimezoneOffset()-r.getTimezoneOffset()}function Ek(t,r){return Hn(t,r,"minutes")+zn(t,r)}function Dk(t){var r=Ve(t,"day");return Hn(r,t,"minutes")+zn(r,t)}function Tk(t,r){return un(t,r,"day")}function Ok(t,r,s){var a=$r(t,r,"minutes");return a?us(r,s,"minutes"):ta(r,s,"minutes")}function Qa(t,r){return Sk(t,r,"day")}function Mk(t){var r=t.evtA,s=r.start,a=r.end,n=r.allDay,i=t.evtB,o=i.start,l=i.end,c=i.allDay,d=+Ve(s,"day")-+Ve(o,"day"),g=Qa(s,a),p=Qa(o,l);return d||p-g||!!c-!!n||+s-+o||+a-+l}function _k(t){var r=t.event,s=r.start,a=r.end,n=t.range,i=n.start,o=n.end,l=Ve(s,"day"),c=Er(l,o,"day"),d=dn(l,a,"minutes"),g=d?ta(a,i,"minutes"):us(a,i,"minutes");return c&&g}function Pk(t,r){return $r(t,r,"day")}function Ak(t,r){return _o(t)&&_o(r)}var Rk=We(function t(r){var s=this;Ue(this,t),Xr(typeof r.format=="function","date localizer `format(..)` must be a function"),Xr(typeof r.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=r.propType||kk,this.formats=r.formats,this.format=function(){for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return Ck.apply(void 0,[s,r.format].concat(n))},this.startOfWeek=r.firstOfWeek,this.merge=r.merge||Nk,this.inRange=r.inRange||Sl,this.lt=r.lt||un,this.lte=r.lte||Er,this.gt=r.gt||ta,this.gte=r.gte||us,this.eq=r.eq||$r,this.neq=r.neq||dn,this.startOf=r.startOf||Ve,this.endOf=r.endOf||Us,this.add=r.add||St,this.range=r.range||wk,this.diff=r.diff||Hn,this.ceil=r.ceil||jk,this.min=r.min||wl,this.max=r.max||Nl,this.minutes=r.minutes||wr,this.daySpan=r.daySpan||Qa,this.firstVisibleDay=r.firstVisibleDay||$c,this.lastVisibleDay=r.lastVisibleDay||Ec,this.visibleDays=r.visibleDays||yk,this.getSlotDate=r.getSlotDate||$k,this.getTimezoneOffset=r.getTimezoneOffset||function(a){return a.getTimezoneOffset()},this.getDstOffset=r.getDstOffset||zn,this.getTotalMin=r.getTotalMin||Ek,this.getMinutesFromMidnight=r.getMinutesFromMidnight||Dk,this.continuesPrior=r.continuesPrior||Tk,this.continuesAfter=r.continuesAfter||Ok,this.sortEvents=r.sortEvents||Mk,this.inEventRange=r.inEventRange||_k,this.isSameDate=r.isSameDate||Pk,this.startAndEndAreDateOnly=r.startAndEndAreDateOnly||Ak,this.segmentOffset=r.browserTZOffset?r.browserTZOffset():0});function Ik(t,r,s,a){var n=Ce(Ce({},t.formats),s);return Ce(Ce({},t),{},{messages:a,startOfWeek:function(){return t.startOfWeek(r)},format:function(o,l){return t.format(o,n[l]||l,r)}})}var Lk=function(t){function r(){var s;Ue(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=Ze(this,r,[].concat(n)),s.navigate=function(o){s.props.onNavigate(o)},s.view=function(o){s.props.onView(o)},s}return et(r,t),We(r,[{key:"render",value:function(){var a=this.props,n=a.localizer.messages,i=a.label;return R.createElement("div",{className:"rbc-toolbar"},R.createElement("span",{className:"rbc-btn-group"},R.createElement("button",{type:"button",onClick:this.navigate.bind(null,lt.TODAY)},n.today),R.createElement("button",{type:"button",onClick:this.navigate.bind(null,lt.PREVIOUS)},n.previous),R.createElement("button",{type:"button",onClick:this.navigate.bind(null,lt.NEXT)},n.next)),R.createElement("span",{className:"rbc-toolbar-label"},i),R.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(n)))}},{key:"viewNamesGroup",value:function(a){var n=this,i=this.props.views,o=this.props.view;if(i.length>1)return i.map(function(l){return R.createElement("button",{type:"button",key:l,className:Re({"rbc-active":o===l}),onClick:n.view.bind(null,l)},a[l])})}}])}(R.Component);function Te(t,r){t&&t.apply(null,[].concat(r))}var Fk={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(r){return"+".concat(r," more")}};function Uk(t){return Ce(Ce({},Fk),t)}function Wk(t){var r=t.ref,s=t.callback;E.useEffect(function(){var a=function(i){r.current&&!r.current.contains(i.target)&&s()};return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[r,s])}var Bk=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],Dc=function(t){function r(){return Ue(this,r),Ze(this,r,arguments)}return et(r,t),We(r,[{key:"render",value:function(){var a=this.props,n=a.style,i=a.className,o=a.event,l=a.selected,c=a.isAllDay,d=a.onSelect,g=a.onDoubleClick,p=a.onKeyPress,f=a.localizer,m=a.continuesPrior,y=a.continuesAfter,h=a.accessors,x=a.getters,w=a.children,u=a.components,N=u.event,v=u.eventWrapper,S=a.slotStart,_=a.slotEnd,P=Mt(a,Bk);delete P.resizable;var B=h.title(o),T=h.tooltip(o),z=h.end(o),L=h.start(o),K=h.allDay(o),q=c||K||f.diff(L,f.ceil(z,"day"),"day")>1,te=x.eventProp(o,L,z,l),se=R.createElement("div",{className:"rbc-event-content",title:T||void 0},N?R.createElement(N,{event:o,continuesPrior:m,continuesAfter:y,title:B,isAllDay:K,localizer:f,slotStart:S,slotEnd:_}):B);return R.createElement(v,Object.assign({},this.props,{type:"date"}),R.createElement("div",Object.assign({},P,{style:Ce(Ce({},te.style),n),className:Re("rbc-event",i,te.className,{"rbc-selected":l,"rbc-event-allday":q,"rbc-event-continues-prior":m,"rbc-event-continues-after":y}),onClick:function(k){return d&&d(o,k)},onDoubleClick:function(k){return g&&g(o,k)},onKeyDown:function(k){return p&&p(o,k)}}),typeof w=="function"?w(se):se))}}])}(R.Component);function pa(t,r){return!t||r==null?!1:ib(t,r)}function Tc(t,r){var s=t.right-t.left,a=s/r;return a}function Oc(t,r,s,a){var n=Tc(t,a);return s?a-1-Math.floor((r-t.left)/n):Math.floor((r-t.left)/n)}function Hk(t,r){var s=r.x,a=r.y;return a>=t.top&&a<=t.bottom&&s>=t.left&&s<=t.right}function zk(t,r,s,a,n){var i=-1,o=-1,l=a-1,c=Tc(r,a),d=Oc(r,s.x,n,a),g=r.top<s.y&&r.bottom>s.y,p=r.top<t.y&&r.bottom>t.y,f=t.y>r.bottom,m=r.top>t.y,y=s.top<r.top&&s.bottom>r.bottom;return y&&(i=0,o=l),g&&(m?(i=0,o=d):f&&(i=d,o=l)),p&&(i=o=n?l-Math.floor((t.x-r.left)/c):Math.floor((t.x-r.left)/c),g?d<i?i=d:o=d:t.y<s.y?o=l:i=0),{startIdx:i,endIdx:o}}function Gk(t){var r=t.target,s=t.offset,a=t.container,n=t.box,i=er(r),o=i.top,l=i.left,c=i.width,d=i.height,g=er(a),p=g.top,f=g.left,m=g.width,y=g.height,h=er(n),x=h.width,w=h.height,u=p+y,N=f+m,v=o+w,S=l+x,_=s.x,P=s.y,B=v>u?o-w-P:o+P+d,T=S>N?l+_-x+c:l+_;return{topOffset:B,leftOffset:T}}function qk(t){var r=t.containerRef,s=t.accessors,a=t.getters,n=t.selected,i=t.components,o=t.localizer,l=t.position,c=t.show,d=t.events,g=t.slotStart,p=t.slotEnd,f=t.onSelect,m=t.onDoubleClick,y=t.onKeyPress,h=t.handleDragStart,x=t.popperRef,w=t.target,u=t.offset;Wk({ref:x,callback:c}),E.useLayoutEffect(function(){var S=Gk({target:w,offset:u,container:r.current,box:x.current}),_=S.topOffset,P=S.leftOffset;x.current.style.top="".concat(_,"px"),x.current.style.left="".concat(P,"px")},[u.x,u.y,w]);var N=l.width,v={minWidth:N+N/2};return R.createElement("div",{style:v,className:"rbc-overlay",ref:x},R.createElement("div",{className:"rbc-overlay-header"},o.format(g,"dayHeaderFormat")),d.map(function(S,_){return R.createElement(Dc,{key:_,type:"popup",localizer:o,event:S,getters:a,onSelect:f,accessors:s,components:i,onDoubleClick:m,onKeyPress:y,continuesPrior:o.lt(s.end(S),g,"day"),continuesAfter:o.gte(s.start(S),p,"day"),slotStart:g,slotEnd:p,selected:pa(S,n),draggable:!0,onDragStart:function(){return h(S)},onDragEnd:function(){return c()}})}))}var Mc=R.forwardRef(function(t,r){return R.createElement(qk,Object.assign({},t,{popperRef:r}))});Mc.propTypes={accessors:ee.object.isRequired,getters:ee.object.isRequired,selected:ee.object,components:ee.object.isRequired,localizer:ee.object.isRequired,position:ee.object.isRequired,show:ee.func.isRequired,events:ee.array.isRequired,slotStart:ee.instanceOf(Date).isRequired,slotEnd:ee.instanceOf(Date),onSelect:ee.func,onDoubleClick:ee.func,onKeyPress:ee.func,handleDragStart:ee.func,style:ee.object,offset:ee.shape({x:ee.number,y:ee.number})};function Yk(t){var r=t.containerRef,s=t.popupOffset,a=s===void 0?5:s,n=t.overlay,i=t.accessors,o=t.localizer,l=t.components,c=t.getters,d=t.selected,g=t.handleSelectEvent,p=t.handleDoubleClickEvent,f=t.handleKeyPressEvent,m=t.handleDragStart,y=t.onHide,h=t.overlayDisplay,x=E.useRef(null);if(!n.position)return null;var w=a;isNaN(a)||(w={x:a,y:a});var u=n.position,N=n.events,v=n.date,S=n.end;return R.createElement(Cn,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:y,target:n.target},function(_){var P=_.props;return R.createElement(Mc,Object.assign({},P,{containerRef:r,ref:x,target:n.target,offset:w,accessors:i,getters:c,selected:d,components:l,localizer:o,position:u,show:h,events:N,slotStart:v,slotEnd:S,onSelect:g,onDoubleClick:p,onKeyPress:f,handleDragStart:m}))})}var Gn=R.forwardRef(function(t,r){return R.createElement(Yk,Object.assign({},t,{containerRef:r}))});Gn.propTypes={popupOffset:ee.oneOfType([ee.number,ee.shape({x:ee.number,y:ee.number})]),overlay:ee.shape({position:ee.object,events:ee.array,date:ee.instanceOf(Date),end:ee.instanceOf(Date)}),accessors:ee.object.isRequired,localizer:ee.object.isRequired,components:ee.object.isRequired,getters:ee.object.isRequired,selected:ee.object,handleSelectEvent:ee.func,handleDoubleClickEvent:ee.func,handleKeyPressEvent:ee.func,handleDragStart:ee.func,onHide:ee.func,overlayDisplay:ee.func};function Xe(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return zr(s,t,r,{passive:!1})}function Vk(t,r,s){return!t||is(t,document.elementFromPoint(r,s))}function Kk(t,r){var s=r.clientX,a=r.clientY,n=document.elementFromPoint(s,a);return ac(n,".rbc-event",t)}function Jk(t,r){var s=r.clientX,a=r.clientY,n=document.elementFromPoint(s,a);return ac(n,".rbc-show-more",t)}function Ys(t,r){return!!Kk(t,r)}function Xk(t,r){return!!Jk(t,r)}function Wr(t){var r=t;return t.touches&&t.touches.length&&(r=t.touches[0]),{clientX:r.clientX,clientY:r.clientY,pageX:r.pageX,pageY:r.pageY}}var Po=5,Qk=250,_c=function(){function t(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.global,n=a===void 0?!1:a,i=s.longPressThreshold,o=i===void 0?250:i,l=s.validContainers,c=l===void 0?[]:l;Ue(this,t),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=r,this.globalMouse=!r||n,this.longPressThreshold=o,this.validContainers=c,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Xe("touchmove",function(){},window),this._removeKeyDownListener=Xe("keydown",this._keyListener),this._removeKeyUpListener=Xe("keyup",this._keyListener),this._removeDropFromOutsideListener=Xe("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Xe("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return We(t,[{key:"on",value:function(s,a){var n=this._listeners[s]||(this._listeners[s]=[]);return n.push(a),{remove:function(){var o=n.indexOf(a);o!==-1&&n.splice(o,1)}}}},{key:"emit",value:function(s){for(var a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];var o,l=this._listeners[s]||[];return l.forEach(function(c){o===void 0&&(o=c.apply(void 0,n))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(s){var a=this._selectRect;return!a||!this.selecting?!1:Ao(a,dr(s))}},{key:"filter",value:function(s){var a=this._selectRect;return!a||!this.selecting?[]:s.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(s,a){var n=this,i=null,o=null,l=null,c=function(f){i=setTimeout(function(){g(),s(f)},n.longPressThreshold),o=Xe("touchmove",function(){return g()}),l=Xe("touchend",function(){return g()})},d=Xe("touchstart",c),g=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return a&&c(a),function(){g(),d()}}},{key:"_addInitialEventListener",value:function(){var s=this,a=Xe("mousedown",function(i){s._removeInitialEventListener(),s._handleInitialEvent(i),s._removeInitialEventListener=Xe("mousedown",s._handleInitialEvent)}),n=Xe("touchstart",function(i){s._removeInitialEventListener(),s._removeInitialEventListener=s._addLongPressListener(s._handleInitialEvent,i)});this._removeInitialEventListener=function(){a(),n()}}},{key:"_dropFromOutsideListener",value:function(s){var a=Wr(s),n=a.pageX,i=a.pageY,o=a.clientX,l=a.clientY;this.emit("dropFromOutside",{x:n,y:i,clientX:o,clientY:l}),s.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(s){var a=Wr(s),n=a.pageX,i=a.pageY,o=a.clientX,l=a.clientY;this.emit("dragOverFromOutside",{x:n,y:i,clientX:o,clientY:l}),s.preventDefault()}},{key:"_handleInitialEvent",value:function(s){if(this._initialEvent=s,!this.isDetached){var a=Wr(s),n=a.clientX,i=a.clientY,o=a.pageX,l=a.pageY,c=this.container(),d,g;if(!(s.which===3||s.button===2||!Vk(c,n,i))){if(!this.globalMouse&&c&&!is(c,s.target)){var p=Zk(0),f=p.top,m=p.left,y=p.bottom,h=p.right;if(g=dr(c),d=Ao({top:g.top-f,left:g.left-m,bottom:g.bottom+y,right:g.right+h},{top:l,left:o}),!d)return}var x=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(s.type),x:o,y:l,clientX:n,clientY:i});if(x!==!1)switch(s.type){case"mousedown":this._removeEndListener=Xe("mouseup",this._handleTerminatingEvent),this._onEscListener=Xe("keydown",this._handleTerminatingEvent),this._removeMoveListener=Xe("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(s),this._removeEndListener=Xe("touchend",this._handleTerminatingEvent),this._removeMoveListener=Xe("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(s){var a=s.target,n=this.validContainers;return!n||!n.length||!a?!0:n.some(function(i){return!!a.closest(i)})}},{key:"_handleTerminatingEvent",value:function(s){var a=this.selecting,n=this._selectRect;if(!a&&s.type.includes("key")&&(s=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!s){var i=!this.container||is(this.container(),s.target),o=this._isWithinValidContainer(s);return s.key==="Escape"||!o?this.emit("reset"):!a&&i?this._handleClickEvent(s):a?this.emit("select",n):this.emit("reset")}}},{key:"_handleClickEvent",value:function(s){var a=Wr(s),n=a.pageX,i=a.pageY,o=a.clientX,l=a.clientY,c=new Date().getTime();return this._lastClickData&&c-this._lastClickData.timestamp<Qk?(this._lastClickData=null,this.emit("doubleClick",{x:n,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:c},this.emit("click",{x:n,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(s){if(!(this._initialEventData===null||this.isDetached)){var a=this._initialEventData,n=a.x,i=a.y,o=Wr(s),l=o.pageX,c=o.pageY,d=Math.abs(n-l),g=Math.abs(i-c),p=Math.min(l,n),f=Math.min(c,i),m=this.selecting,y=this.isClick(l,c);y&&!m&&!(d||g)||(!m&&!y&&this.emit("selectStart",this._initialEventData),y||(this.selecting=!0,this._selectRect={top:f,left:p,x:l,y:c,right:p+d,bottom:f+g},this.emit("selecting",this._selectRect)),s.preventDefault())}}},{key:"_keyListener",value:function(s){this.ctrl=s.metaKey||s.ctrlKey}},{key:"isClick",value:function(s,a){var n=this._initialEventData,i=n.x,o=n.y,l=n.isTouch;return!l&&Math.abs(s-i)<=Po&&Math.abs(a-o)<=Po}}])}();function Zk(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return Lt(t)!=="object"&&(t={top:t,left:t,right:t,bottom:t}),t}function Ao(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=dr(t),n=a.top,i=a.left,o=a.right,l=o===void 0?i:o,c=a.bottom,d=c===void 0?n:c,g=dr(r),p=g.top,f=g.left,m=g.right,y=m===void 0?f:m,h=g.bottom,x=h===void 0?p:h;return!(d-s<p||n+s>x||l-s<f||i+s>y)}function dr(t){if(!t.getBoundingClientRect)return t;var r=t.getBoundingClientRect(),s=r.left+Ro("left"),a=r.top+Ro("top");return{top:a,left:s,right:(t.offsetWidth||0)+s,bottom:(t.offsetHeight||0)+a}}function Ro(t){if(t==="left")return window.pageXOffset||document.body.scrollLeft||0;if(t==="top")return window.pageYOffset||document.body.scrollTop||0}var e5=function(t){function r(s,a){var n;return Ue(this,r),n=Ze(this,r,[s,a]),n.state={selecting:!1},n.containerRef=E.createRef(),n}return et(r,t),We(r,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(a){!a.selectable&&this.props.selectable&&this._selectable(),a.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var a=this.props,n=a.range,i=a.getNow,o=a.getters,l=a.date,c=a.components.dateCellWrapper,d=a.localizer,g=this.state,p=g.selecting,f=g.startIdx,m=g.endIdx,y=i();return R.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},n.map(function(h,x){var w=p&&x>=f&&x<=m,u=o.dayProp(h),N=u.className,v=u.style;return R.createElement(c,{key:x,value:h,range:n},R.createElement("div",{style:v,className:Re("rbc-day-bg",N,w&&"rbc-selected-cell",d.isSameDate(h,y)&&"rbc-today",l&&d.neq(l,h,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var a=this,n=this.containerRef.current,i=this._selector=new _c(this.props.container,{longPressThreshold:this.props.longPressThreshold}),o=function(c,d){if(!Ys(n,c)&&!Xk(n,c)){var g=dr(n),p=a.props,f=p.range,m=p.rtl;if(Hk(g,c)){var y=Oc(g,c.x,m,f.length);a._selectSlot({startIdx:y,endIdx:y,action:d,box:c})}}a._initial={},a.setState({selecting:!1})};i.on("selecting",function(l){var c=a.props,d=c.range,g=c.rtl,p=-1,f=-1;if(a.state.selecting||(Te(a.props.onSelectStart,[l]),a._initial={x:l.x,y:l.y}),i.isSelected(n)){var m=dr(n),y=zk(a._initial,m,l,d.length,g);p=y.startIdx,f=y.endIdx}a.setState({selecting:!0,startIdx:p,endIdx:f})}),i.on("beforeSelect",function(l){if(a.props.selectable==="ignoreEvents")return!Ys(a.containerRef.current,l)}),i.on("click",function(l){return o(l,"click")}),i.on("doubleClick",function(l){return o(l,"doubleClick")}),i.on("select",function(l){a._selectSlot(Ce(Ce({},a.state),{},{action:"select",bounds:l})),a._initial={},a.setState({selecting:!1}),Te(a.props.onSelectEnd,[a.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(a){var n=a.endIdx,i=a.startIdx,o=a.action,l=a.bounds,c=a.box;n!==-1&&i!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:i,end:n,action:o,bounds:l,box:c,resourceId:this.props.resourceId})}}])}(R.Component),gt={propTypes:{slotMetrics:ee.object.isRequired,selected:ee.object,isAllDay:ee.bool,accessors:ee.object.isRequired,localizer:ee.object.isRequired,components:ee.object.isRequired,getters:ee.object.isRequired,onSelect:ee.func,onDoubleClick:ee.func,onKeyPress:ee.func},defaultProps:{segments:[],selected:{}},renderEvent:function(r,s){var a=r.selected;r.isAllDay;var n=r.accessors,i=r.getters,o=r.onSelect,l=r.onDoubleClick,c=r.onKeyPress,d=r.localizer,g=r.slotMetrics,p=r.components,f=r.resizable,m=g.continuesPrior(s),y=g.continuesAfter(s);return R.createElement(Dc,{event:s,getters:i,localizer:d,accessors:n,components:p,onSelect:o,onDoubleClick:l,onKeyPress:c,continuesPrior:m,continuesAfter:y,slotStart:g.first,slotEnd:g.last,selected:pa(s,a),resizable:f})},renderSpan:function(r,s,a){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(s)/r*100+"%";return R.createElement("div",{key:a,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},n)}},Pc=function(t){function r(){return Ue(this,r),Ze(this,r,arguments)}return et(r,t),We(r,[{key:"render",value:function(){var a=this,n=this.props,i=n.segments,o=n.slotMetrics.slots,l=n.className,c=1;return R.createElement("div",{className:Re(l,"rbc-row")},i.reduce(function(d,g,p){var f=g.event,m=g.left,y=g.right,h=g.span,x="_lvl_"+p,w=m-c,u=gt.renderEvent(a.props,f);return w&&d.push(gt.renderSpan(o,w,"".concat(x,"_gap"))),d.push(gt.renderSpan(o,h,x,u)),c=y+1,d},[]))}}])}(R.Component);Pc.defaultProps=Ce({},gt.defaultProps);function Ac(t){var r=t.dateRange,s=t.unit,a=s===void 0?"day":s,n=t.localizer;return{first:r[0],last:n.add(r[r.length-1],1,a)}}function t5(t,r,s,a){var n=Ac({dateRange:r,localizer:a}),i=n.first,o=n.last,l=a.diff(i,o,"day"),c=a.max(a.startOf(s.start(t),"day"),i),d=a.min(a.ceil(s.end(t),"day"),o),g=nj(r,function(f){return a.isSameDate(f,c)}),p=a.diff(c,d,"day");return p=Math.min(p,l),p=Math.max(p-a.segmentOffset,1),{event:t,span:p,left:g+1,right:Math.max(g+p,1)}}function Za(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,s,a,n,i=[],o=[];for(s=0;s<t.length;s++){for(n=t[s],a=0;a<i.length&&r5(n,i[a]);a++);a>=r?o.push(n):(i[a]||(i[a]=[])).push(n)}for(s=0;s<i.length;s++)i[s].sort(function(l,c){return l.left-c.left});return{levels:i,extra:o}}function cs(t,r,s,a,n){var i={start:a.start(t),end:a.end(t)},o={start:r,end:s};return n.inEventRange({event:i,range:o})}function r5(t,r){return r.some(function(s){return s.left<=t.right&&s.right>=t.left})}function s5(t,r,s){var a=_s(t),n=[],i=[];a.forEach(function(c){var d=r.start(c),g=r.end(c);s.daySpan(d,g)>1?n.push(c):i.push(c)});var o=n.sort(function(c,d){return en(c,d,r,s)}),l=i.sort(function(c,d){return en(c,d,r,s)});return[].concat(_s(o),_s(l))}function en(t,r,s,a){var n={start:s.start(t),end:s.end(t),allDay:s.allDay(t)},i={start:s.start(r),end:s.end(r),allDay:s.allDay(r)};return a.sortEvents({evtA:n,evtB:i})}var tn=function(r,s){return r.left<=s&&r.right>=s},_a=function(r,s){return r.filter(function(a){return tn(a,s)}).map(function(a){return a.event})},Rc=function(t){function r(){return Ue(this,r),Ze(this,r,arguments)}return et(r,t),We(r,[{key:"render",value:function(){for(var a=this.props,n=a.segments,i=a.slotMetrics.slots,o=Za(n).levels[0],l=1,c=1,d=[];l<=i;){var g="_lvl_"+l,p=o.filter(function(v){return tn(v,l)})[0]||{},f=p.event,m=p.left,y=p.right,h=p.span;if(!f){var x=this.getHiddenEventsForSlot(n,l);if(x.length>0){var w=l-c;w&&d.push(gt.renderSpan(i,w,g+"_gap")),d.push(gt.renderSpan(i,1,g,this.renderShowMore(n,l))),c=l=l+1;continue}l++;continue}var u=Math.max(0,m-c);if(this.canRenderSlotEvent(m,h)){var N=gt.renderEvent(this.props,f);u&&d.push(gt.renderSpan(i,u,g+"_gap")),d.push(gt.renderSpan(i,h,g,N)),c=l=y+1}else u&&d.push(gt.renderSpan(i,u,g+"_gap")),d.push(gt.renderSpan(i,1,g,this.renderShowMore(n,l))),c=l=l+1}return R.createElement("div",{className:"rbc-row"},d)}},{key:"getHiddenEventsForSlot",value:function(a,n){var i=_a(a,n),o=Za(a).levels[0],l=o.filter(function(c){return tn(c,n)}).map(function(c){return c.event});return i.filter(function(c){return!l.some(function(d){return d===c})})}},{key:"canRenderSlotEvent",value:function(a,n){var i=this.props.segments;return pj(a,a+n).every(function(o){var l=_a(i,o).length;return l===1})}},{key:"renderShowMore",value:function(a,n){var i=this,o=this.props,l=o.localizer,c=o.slotMetrics,d=o.components,g=c.getEventsForSlot(n),p=_a(a,n),f=p.length;if(d!=null&&d.showMore){var m=d.showMore,y=c.getDateForSlot(n-1);return f?R.createElement(m,{localizer:l,slotDate:y,slot:n,count:f,events:g,remainingEvents:p}):!1}return f?R.createElement("button",{type:"button",key:"sm_"+n,className:Re("rbc-button-link","rbc-show-more"),onClick:function(x){return i.showMore(n,x)}},l.messages.showMore(f,p,g)):!1}},{key:"showMore",value:function(a,n){n.preventDefault(),n.stopPropagation(),this.props.onShowMore(a,n.target)}}])}(R.Component);Rc.defaultProps=Ce({},gt.defaultProps);var a5=function(r){var s=r.children;return R.createElement("div",{className:"rbc-row-content-scroll-container"},s)},n5=function(r,s){return r.left<=s&&r.right>=s},i5=function(r,s){return r[0].range===s[0].range&&r[0].events===s[0].events};function Ic(){return cc(function(t){for(var r=t.range,s=t.events,a=t.maxRows,n=t.minRows,i=t.accessors,o=t.localizer,l=Ac({dateRange:r,localizer:o}),c=l.first,d=l.last,g=s.map(function(h){return t5(h,r,i,o)}),p=Za(g,Math.max(a-1,1)),f=p.levels,m=p.extra,y=m.length>0?n-1:n;f.length<y;)f.push([]);return{first:c,last:d,levels:f,extra:m,range:r,slots:r.length,clone:function(x){var w=Ic();return w(Ce(Ce({},t),x))},getDateForSlot:function(x){return r[x]},getSlotForDate:function(x){return r.find(function(w){return o.isSameDate(w,x)})},getEventsForSlot:function(x){return g.filter(function(w){return n5(w,x)}).map(function(w){return w.event})},continuesPrior:function(x){return o.continuesPrior(i.start(x),c)},continuesAfter:function(x){var w=i.start(x),u=i.end(x);return o.continuesAfter(w,u,d)}}},i5)}var ds=function(t){function r(){var s;Ue(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=Ze(this,r,[].concat(n)),s.handleSelectSlot=function(o){var l=s.props,c=l.range,d=l.onSelectSlot;d(c.slice(o.start,o.end+1),o)},s.handleShowMore=function(o,l){var c=s.props,d=c.range,g=c.onShowMore,p=s.slotMetrics(s.props),f=ah(s.containerRef.current,".rbc-row-bg")[0],m;f&&(m=f.children[o-1]);var y=p.getEventsForSlot(o);g(y,d[o-1],m,o,l)},s.getContainer=function(){var o=s.props.container;return o?o():s.containerRef.current},s.renderHeadingCell=function(o,l){var c=s.props,d=c.renderHeader,g=c.getNow,p=c.localizer;return d({date:o,key:"header_".concat(l),className:Re("rbc-date-cell",p.isSameDate(o,g())&&"rbc-now")})},s.renderDummy=function(){var o=s.props,l=o.className,c=o.range,d=o.renderHeader,g=o.showAllEvents;return R.createElement("div",{className:l,ref:s.containerRef},R.createElement("div",{className:Re("rbc-row-content",g&&"rbc-row-content-scrollable")},d&&R.createElement("div",{className:"rbc-row",ref:s.headingRowRef},c.map(s.renderHeadingCell)),R.createElement("div",{className:"rbc-row",ref:s.eventRowRef},R.createElement("div",{className:"rbc-row-segment"},R.createElement("div",{className:"rbc-event"},R.createElement("div",{className:"rbc-event-content"}," "))))))},s.containerRef=E.createRef(),s.headingRowRef=E.createRef(),s.eventRowRef=E.createRef(),s.slotMetrics=Ic(),s}return et(r,t),We(r,[{key:"getRowLimit",value:function(){var a,n=Ta(this.eventRowRef.current),i=(a=this.headingRowRef)!==null&&a!==void 0&&a.current?Ta(this.headingRowRef.current):0,o=Ta(this.containerRef.current)-i;return Math.max(Math.floor(o/n),1)}},{key:"render",value:function(){var a=this.props,n=a.date,i=a.rtl,o=a.range,l=a.className,c=a.selected,d=a.selectable,g=a.renderForMeasure,p=a.accessors,f=a.getters,m=a.components,y=a.getNow,h=a.renderHeader,x=a.onSelect,w=a.localizer,u=a.onSelectStart,N=a.onSelectEnd,v=a.onDoubleClick,S=a.onKeyPress,_=a.resourceId,P=a.longPressThreshold,B=a.isAllDay,T=a.resizable,z=a.showAllEvents;if(g)return this.renderDummy();var L=this.slotMetrics(this.props),K=L.levels,q=L.extra,te=z?a5:kt,se=m.weekWrapper,re={selected:c,accessors:p,getters:f,localizer:w,components:m,onSelect:x,onDoubleClick:v,onKeyPress:S,resourceId:_,slotMetrics:L,resizable:T};return R.createElement("div",{className:l,role:"rowgroup",ref:this.containerRef},R.createElement(e5,{localizer:w,date:n,getNow:y,rtl:i,range:o,selectable:d,container:this.getContainer,getters:f,onSelectStart:u,onSelectEnd:N,onSelectSlot:this.handleSelectSlot,components:m,longPressThreshold:P,resourceId:_}),R.createElement("div",{className:Re("rbc-row-content",z&&"rbc-row-content-scrollable"),role:"row"},h&&R.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},o.map(this.renderHeadingCell)),R.createElement(te,null,R.createElement(se,Object.assign({isAllDay:B},re,{rtl:this.props.rtl}),K.map(function(k,H){return R.createElement(Pc,Object.assign({key:H,segments:k},re))}),!!q.length&&R.createElement(Rc,Object.assign({segments:q,onShowMore:this.handleShowMore},re))))))}}])}(R.Component);ds.defaultProps={minRows:0,maxRows:1/0};var qn=function(r){var s=r.label;return R.createElement("span",{role:"columnheader","aria-sort":"none"},s)},o5=function(r){var s=r.label,a=r.drilldownView,n=r.onDrillDown;return a?R.createElement("button",{type:"button",className:"rbc-button-link",onClick:n},s):R.createElement("span",null,s)},l5=["date","className"],c5=function(r,s,a,n,i){return r.filter(function(o){return cs(o,s,a,n,i)})},va=function(t){function r(){var s;Ue(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=Ze(this,r,[].concat(n)),s.getContainer=function(){return s.containerRef.current},s.renderWeek=function(o,l){var c=s.props,d=c.events,g=c.components,p=c.selectable,f=c.getNow,m=c.selected,y=c.date,h=c.localizer,x=c.longPressThreshold,w=c.accessors,u=c.getters,N=c.showAllEvents,v=s.state,S=v.needLimitMeasure,_=v.rowLimit,P=c5(_s(d),o[0],o[o.length-1],w,h),B=s5(P,w,h);return R.createElement(ds,{key:l,ref:l===0?s.slotRowRef:void 0,container:s.getContainer,className:"rbc-month-row",getNow:f,date:y,range:o,events:B,maxRows:N?1/0:_,selected:m,selectable:p,components:g,accessors:w,getters:u,localizer:h,renderHeader:s.readerDateHeading,renderForMeasure:S,onShowMore:s.handleShowMore,onSelect:s.handleSelectEvent,onDoubleClick:s.handleDoubleClickEvent,onKeyPress:s.handleKeyPressEvent,onSelectSlot:s.handleSelectSlot,longPressThreshold:x,rtl:s.props.rtl,resizable:s.props.resizable,showAllEvents:N})},s.readerDateHeading=function(o){var l=o.date,c=o.className,d=Mt(o,l5),g=s.props,p=g.date,f=g.getDrilldownView,m=g.localizer,y=m.neq(p,l,"month"),h=m.isSameDate(l,p),x=f(l),w=m.format(l,"dateFormat"),u=s.props.components.dateHeader||o5;return R.createElement("div",Object.assign({},d,{className:Re(c,y&&"rbc-off-range",h&&"rbc-current"),role:"cell"}),R.createElement(u,{label:w,date:l,drilldownView:x,isOffRange:y,onDrillDown:function(v){return s.handleHeadingClick(l,x,v)}}))},s.handleSelectSlot=function(o,l){s._pendingSelection=s._pendingSelection.concat(o),clearTimeout(s._selectTimer),s._selectTimer=setTimeout(function(){return s.selectDates(l)})},s.handleHeadingClick=function(o,l,c){c.preventDefault(),s.clearSelection(),Te(s.props.onDrillDown,[o,l])},s.handleSelectEvent=function(){s.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onSelectEvent,l)},s.handleDoubleClickEvent=function(){s.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onDoubleClickEvent,l)},s.handleKeyPressEvent=function(){s.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onKeyPressEvent,l)},s.handleShowMore=function(o,l,c,d,g){var p=s.props,f=p.popup,m=p.onDrillDown,y=p.onShowMore,h=p.getDrilldownView,x=p.doShowMoreDrillDown;if(s.clearSelection(),f){var w=Il(c,s.containerRef.current);s.setState({overlay:{date:l,events:o,position:w,target:g}})}else x&&Te(m,[l,h(l)||st.DAY]);Te(y,[o,l,d])},s.overlayDisplay=function(){s.setState({overlay:null})},s.state={rowLimit:5,needLimitMeasure:!0,date:null},s.containerRef=E.createRef(),s.slotRowRef=E.createRef(),s._bgRows=[],s._pendingSelection=[],s}return et(r,t),We(r,[{key:"componentDidMount",value:function(){var a=this,n;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){n||Ll(function(){n=!1,a.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.className,l=i.visibleDays(n,i),c=Bm(l,7);return this._weekCount=c.length,R.createElement("div",{className:Re("rbc-month-view",o),role:"table","aria-label":"Month View",ref:this.containerRef},R.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(c[0])),c.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(a){var n=this.props,i=n.localizer,o=n.components,l=a[0],c=a[a.length-1],d=o.header||qn;return i.range(l,c,"day").map(function(g,p){return R.createElement("div",{key:"header_"+p,className:"rbc-header"},R.createElement(d,{date:g,localizer:i,label:i.format(g,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var a,n,i=this,o=(a=(n=this.state)===null||n===void 0?void 0:n.overlay)!==null&&a!==void 0?a:{},l=this.props,c=l.accessors,d=l.localizer,g=l.components,p=l.getters,f=l.selected,m=l.popupOffset,y=l.handleDragStart,h=function(){return i.setState({overlay:null})};return R.createElement(Gn,{overlay:o,accessors:c,localizer:d,components:g,getters:p,selected:f,popupOffset:m,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:y,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:h})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(a){var n=this._pendingSelection.slice();this._pendingSelection=[],n.sort(function(l,c){return+l-+c});var i=new Date(n[0]),o=new Date(n[n.length-1]);o.setDate(n[n.length-1].getDate()+1),Te(this.props.onSelectSlot,{slots:n,start:i,end:o,action:a.action,bounds:a.bounds,box:a.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(a,n){var i=a.date,o=a.localizer;return{date:i,needLimitMeasure:o.neq(i,n.date,"month")}}}])}(R.Component);va.range=function(t,r){var s=r.localizer,a=s.firstVisibleDay(t,s),n=s.lastVisibleDay(t,s);return{start:a,end:n}};va.navigate=function(t,r,s){var a=s.localizer;switch(r){case lt.PREVIOUS:return a.add(t,-1,"month");case lt.NEXT:return a.add(t,1,"month");default:return t}};va.title=function(t,r){var s=r.localizer;return s.format(t,"monthHeaderFormat")};var Io=function(r){var s=r.min,a=r.max,n=r.step,i=r.slots,o=r.localizer;return"".concat(+o.startOf(s,"minutes"))+"".concat(+o.startOf(a,"minutes"))+"".concat(n,"-").concat(i)};function Yn(t){for(var r=t.min,s=t.max,a=t.step,n=t.timeslots,i=t.localizer,o=Io({step:a,localizer:i}),l=1+i.getTotalMin(r,s),c=i.getMinutesFromMidnight(r),d=Math.ceil((l-1)/(a*n)),g=d*n,p=new Array(d),f=new Array(g),m=0;m<d;m++){p[m]=new Array(n);for(var y=0;y<n;y++){var h=m*n+y,x=h*a;f[h]=p[m][y]=i.getSlotDate(r,c,x)}}var w=f.length*a;f.push(i.getSlotDate(r,c,w));function u(N){var v=i.diff(r,N,"minutes")+i.getDstOffset(r,N);return Math.min(v,l)}return{groups:p,update:function(v){return Io(v)!==o?Yn(v):this},dateIsInGroup:function(v,S){var _=p[S+1];return i.inRange(v,p[S][0],_?_[0]:s,"minutes")},nextSlot:function(v){var S=f[Math.min(f.findIndex(function(_){return _===v||i.eq(_,v)})+1,f.length-1)];return i.eq(S,v)&&(S=i.add(v,a,"minutes")),S},closestSlotToPosition:function(v){var S=Math.min(f.length-1,Math.max(0,Math.floor(v*g)));return f[S]},closestSlotFromPoint:function(v,S){var _=Math.abs(S.top-S.bottom);return this.closestSlotToPosition((v.y-S.top)/_)},closestSlotFromDate:function(v){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(i.lt(v,r,"minutes"))return f[0];if(i.gt(v,s,"minutes"))return f[f.length-1];var _=i.diff(r,v,"minutes");return f[(_-_%a)/a+S]},startsBeforeDay:function(v){return i.lt(v,r,"day")},startsAfterDay:function(v){return i.gt(v,s,"day")},startsBefore:function(v){return i.lt(i.merge(r,v),r,"minutes")},startsAfter:function(v){return i.gt(i.merge(s,v),s,"minutes")},getRange:function(v,S,_,P){_||(v=i.min(s,i.max(r,v))),P||(S=i.min(s,i.max(r,S)));var B=u(v),T=u(S),z=T>a*g&&!i.eq(s,S)?(B-a)/(a*g)*100:B/(a*g)*100;return{top:z,height:T/(a*g)*100-z,start:u(v),startDate:v,end:u(S),endDate:S}},getCurrentTimePosition:function(v){var S=u(v),_=S/(a*g)*100;return _}}}var d5=function(){function t(r,s){var a=s.accessors,n=s.slotMetrics;Ue(this,t);var i=n.getRange(a.start(r),a.end(r)),o=i.start,l=i.startDate,c=i.end,d=i.endDate,g=i.top,p=i.height;this.start=o,this.end=c,this.startMs=+l,this.endMs=+d,this.top=g,this.height=p,this.data=r}return We(t,[{key:"_width",get:function(){if(this.rows){var s=this.rows.reduce(function(n,i){return Math.max(n,i.leaves.length+1)},0)+1;return 100/s}if(this.leaves){var a=100-this.container._width;return a/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var s=this._width,a=Math.min(100,this._width*1.7);if(this.rows)return a;if(this.leaves)return this.leaves.length>0?a:s;var n=this.row.leaves,i=n.indexOf(this);return i===n.length-1?s:a}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var s=this.row,a=s.leaves,n=s.xOffset,i=s._width,o=a.indexOf(this)+1;return n+o*i}}])}();function u5(t,r,s){return Math.abs(r.start-t.start)<s||r.start>t.start&&r.start<t.end}function m5(t){for(var r=Iw(t,["startMs",function(l){return-l.endMs}]),s=[];r.length>0;){var a=r.shift();s.push(a);for(var n=0;n<r.length;n++){var i=r[n];if(!(a.endMs>i.startMs)){if(n>0){var o=r.splice(n,1)[0];s.push(o)}break}}}return s}function Lc(t){for(var r=t.events,s=t.minimumStartDifference,a=t.slotMetrics,n=t.accessors,i=r.map(function(g){return new d5(g,{slotMetrics:a,accessors:n})}),o=m5(i),l=[],c=function(){var p=o[d],f=l.find(function(h){return h.end>p.start||Math.abs(p.start-h.start)<s});if(!f)return p.rows=[],l.push(p),1;p.container=f;for(var m=null,y=f.rows.length-1;!m&&y>=0;y--)u5(f.rows[y],p,s)&&(m=f.rows[y]);m?(m.leaves.push(p),p.row=m):(p.leaves=[],f.rows.push(p))},d=0;d<o.length;d++)c();return o.map(function(g){return{event:g.data,style:{top:g.top,height:g.height,width:g.width,xOffset:Math.max(0,g.xOffset)}}})}function Fc(t,r,s){for(var a=0;a<t.friends.length;++a)if(!(s.indexOf(t.friends[a])>-1)){r=r>t.friends[a].idx?r:t.friends[a].idx,s.push(t.friends[a]);var n=Fc(t.friends[a],r,s);r=r>n?r:n}return r}function h5(t){var r=t.events,s=t.minimumStartDifference,a=t.slotMetrics,n=t.accessors,i=Lc({events:r,minimumStartDifference:s,slotMetrics:a,accessors:n});i.sort(function(se,re){return se=se.style,re=re.style,se.top!==re.top?se.top>re.top?1:-1:se.height!==re.height?se.top+se.height<re.top+re.height?1:-1:0});for(var o=0;o<i.length;++o)i[o].friends=[],delete i[o].style.left,delete i[o].style.left,delete i[o].idx,delete i[o].size;for(var l=0;l<i.length-1;++l)for(var c=i[l],d=c.style.top,g=c.style.top+c.style.height,p=l+1;p<i.length;++p){var f=i[p],m=f.style.top,y=f.style.top+f.style.height;(m>=d&&y<=g||y>d&&y<=g||m>=d&&m<g)&&(c.friends.push(f),f.friends.push(c))}for(var h=0;h<i.length;++h){for(var x=i[h],w=[],u=0;u<100;++u)w.push(1);for(var N=0;N<x.friends.length;++N)x.friends[N].idx!==void 0&&(w[x.friends[N].idx]=0);x.idx=w.indexOf(1)}for(var v=0;v<i.length;++v){var S=0;if(!i[v].size){var _=[],P=Fc(i[v],0,_);S=100/(P+1),i[v].size=S;for(var B=0;B<_.length;++B)_[B].size=S}}for(var T=0;T<i.length;++T){var z=i[T];z.style.left=z.idx*z.size;for(var L=0,K=0;K<z.friends.length;++K){var q=z.friends[K].idx;L=L>q?L:q}L<=z.idx&&(z.size=100-z.idx*z.size);var te=z.idx===0?0:3;z.style.width="calc(".concat(z.size,"% - ").concat(te,"px)"),z.style.height="calc(".concat(z.style.height,"% - 2px)"),z.style.xOffset="calc(".concat(z.style.left,"% + ").concat(te,"px)")}return i}var Lo={overlap:Lc,"no-overlap":h5};function f5(t){return!!(t&&t.constructor&&t.call&&t.apply)}function g5(t){t.events,t.minimumStartDifference,t.slotMetrics,t.accessors;var r=t.dayLayoutAlgorithm,s=r;return r in Lo&&(s=Lo[r]),f5(s)?s.apply(this,arguments):[]}var Uc=function(t){function r(){return Ue(this,r),Ze(this,r,arguments)}return et(r,t),We(r,[{key:"render",value:function(){var a=this.props,n=a.renderSlot,i=a.resource,o=a.group,l=a.getters,c=a.components,d=c===void 0?{}:c,g=d.timeSlotWrapper,p=g===void 0?kt:g,f=l?l.slotGroupProp(o):{};return R.createElement("div",Object.assign({className:"rbc-timeslot-group"},f),o.map(function(m,y){var h=l?l.slotProp(m,i):{};return R.createElement(p,{key:y,value:m,resource:i},R.createElement("div",Object.assign({},h,{className:Re("rbc-time-slot",h.className)}),n&&n(m,y)))}))}}])}(E.Component);function Ts(t){return typeof t=="string"?t:t+"%"}function x5(t){var r=t.style,s=t.className,a=t.event,n=t.accessors,i=t.rtl,o=t.selected,l=t.label,c=t.continuesPrior,d=t.continuesAfter,g=t.getters,p=t.onClick,f=t.onDoubleClick,m=t.isBackgroundEvent,y=t.onKeyPress,h=t.components,x=h.event,w=h.eventWrapper,u=n.title(a),N=n.tooltip(a),v=n.end(a),S=n.start(a),_=g.eventProp(a,S,v,o),P=[R.createElement("div",{key:"1",className:"rbc-event-label"},l),R.createElement("div",{key:"2",className:"rbc-event-content"},x?R.createElement(x,{event:a,title:u}):u)],B=r.height,T=r.top,z=r.width,L=r.xOffset,K=Ce(Ce({},_.style),{},Zt({top:Ts(T),height:Ts(B),width:Ts(z)},i?"right":"left",Ts(L)));return R.createElement(w,Object.assign({type:"time"},t),R.createElement("div",{role:"button",tabIndex:0,onClick:p,onDoubleClick:f,style:K,onKeyDown:y,title:N?(typeof l=="string"?l+": ":"")+N:void 0,className:Re(m?"rbc-background-event":"rbc-event",s,_.className,{"rbc-selected":o,"rbc-event-continues-earlier":c,"rbc-event-continues-later":d})},P))}var p5=function(r){var s=r.children,a=r.className,n=r.style,i=r.innerRef;return R.createElement("div",{className:a,style:n,ref:i},s)},v5=R.forwardRef(function(t,r){return R.createElement(p5,Object.assign({},t,{innerRef:r}))}),b5=["dayProp"],y5=["eventContainerWrapper","timeIndicatorWrapper"],Wc=function(t){function r(){var s;Ue(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=Ze(this,r,[].concat(n)),s.state={selecting:!1,timeIndicatorPosition:null},s.intervalTriggered=!1,s.renderEvents=function(o){var l=o.events,c=o.isBackgroundEvent,d=s.props,g=d.rtl,p=d.selected,f=d.accessors,m=d.localizer,y=d.getters,h=d.components,x=d.step,w=d.timeslots,u=d.dayLayoutAlgorithm,N=d.resizable,v=s,S=v.slotMetrics,_=m.messages,P=g5({events:l,accessors:f,slotMetrics:S,minimumStartDifference:Math.ceil(x*w/2),dayLayoutAlgorithm:u});return P.map(function(B,T){var z,L=B.event,K=B.style,q=f.end(L),te=f.start(L),se=(z=f.eventId(L))!==null&&z!==void 0?z:"evt_"+T,re="eventTimeRangeFormat",k,H=S.startsBeforeDay(te),Y=S.startsAfterDay(q);H?re="eventTimeRangeEndFormat":Y&&(re="eventTimeRangeStartFormat"),H&&Y?k=_.allDay:k=m.format({start:te,end:q},re);var A=H||S.startsBefore(te),ae=Y||S.startsAfter(q);return R.createElement(x5,{style:K,event:L,label:k,key:se,getters:y,rtl:g,components:h,continuesPrior:A,continuesAfter:ae,accessors:f,resource:s.props.resource,selected:pa(L,p),onClick:function(he){return s._select(Ce(Ce(Ce({},L),s.props.resource&&{sourceResource:s.props.resource}),c&&{isBackgroundEvent:!0}),he)},onDoubleClick:function(he){return s._doubleClick(L,he)},isBackgroundEvent:c,onKeyPress:function(he){return s._keyPress(L,he)},resizable:N})})},s._selectable=function(){var o=s.containerRef.current,l=s.props,c=l.longPressThreshold,d=l.localizer,g=s._selector=new _c(function(){return o},{longPressThreshold:c}),p=function(h){var x=s.props.onSelecting,w=s.state||{},u=f(h),N=u.startDate,v=u.endDate;x&&(d.eq(w.startDate,N,"minutes")&&d.eq(w.endDate,v,"minutes")||x({start:N,end:v,resourceId:s.props.resource})===!1)||(s.state.start!==u.start||s.state.end!==u.end||s.state.selecting!==u.selecting)&&s.setState(u)},f=function(h){var x=s.slotMetrics.closestSlotFromPoint(h,dr(o));s.state.selecting||(s._initialSlot=x);var w=s._initialSlot;d.lte(w,x)?x=s.slotMetrics.nextSlot(x):d.gt(w,x)&&(w=s.slotMetrics.nextSlot(w));var u=s.slotMetrics.getRange(d.min(w,x),d.max(w,x));return Ce(Ce({},u),{},{selecting:!0,top:"".concat(u.top,"%"),height:"".concat(u.height,"%")})},m=function(h,x){if(!Ys(s.containerRef.current,h)){var w=f(h),u=w.startDate,N=w.endDate;s._selectSlot({startDate:u,endDate:N,action:x,box:h})}s.setState({selecting:!1})};g.on("selecting",p),g.on("selectStart",p),g.on("beforeSelect",function(y){if(s.props.selectable==="ignoreEvents")return!Ys(s.containerRef.current,y)}),g.on("click",function(y){return m(y,"click")}),g.on("doubleClick",function(y){return m(y,"doubleClick")}),g.on("select",function(y){s.state.selecting&&(s._selectSlot(Ce(Ce({},s.state),{},{action:"select",bounds:y})),s.setState({selecting:!1}))}),g.on("reset",function(){s.state.selecting&&s.setState({selecting:!1})})},s._teardownSelectable=function(){s._selector&&(s._selector.teardown(),s._selector=null)},s._selectSlot=function(o){for(var l=o.startDate,c=o.endDate,d=o.action,g=o.bounds,p=o.box,f=l,m=[];s.props.localizer.lte(f,c);)m.push(f),f=new Date(+f+s.props.step*60*1e3);Te(s.props.onSelectSlot,{slots:m,start:l,end:c,resourceId:s.props.resource,action:d,bounds:g,box:p})},s._select=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onSelectEvent,l)},s._doubleClick=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onDoubleClickEvent,l)},s._keyPress=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onKeyPressEvent,l)},s.slotMetrics=Yn(s.props),s.containerRef=E.createRef(),s}return et(r,t),We(r,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(a,n){this.props.selectable&&!a.selectable&&this._selectable(),!this.props.selectable&&a.selectable&&this._teardownSelectable();var i=this.props,o=i.getNow,l=i.isNow,c=i.localizer,d=i.date,g=i.min,p=i.max,f=c.neq(a.getNow(),o(),"minutes");if(a.isNow!==l||f){if(this.clearTimeIndicatorInterval(),l){var m=!f&&c.eq(a.date,d,"minutes")&&n.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(m)}}else l&&(c.neq(a.min,g,"minutes")||c.neq(a.max,p,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var a=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!n&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){a.intervalTriggered=!0,a.positionTimeIndicator(),a.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var a=this.props,n=a.min,i=a.max,o=a.getNow,l=o();if(l>=n&&l<=i){var c=this.slotMetrics.getCurrentTimePosition(l);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:c})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var a=this.props,n=a.date,i=a.max,o=a.rtl,l=a.isNow,c=a.resource,d=a.accessors,g=a.localizer,p=a.getters,f=p.dayProp,m=Mt(p,b5),y=a.components,h=y.eventContainerWrapper,x=y.timeIndicatorWrapper,w=Mt(y,y5);this.slotMetrics=this.slotMetrics.update(this.props);var u=this.slotMetrics,N=this.state,v=N.selecting,S=N.top,_=N.height,P=N.startDate,B=N.endDate,T={start:P,end:B},z=f(i,c),L=z.className,K=z.style,q={className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}},te=w.dayColumnWrapper||v5;return R.createElement(te,{ref:this.containerRef,date:n,style:K,className:Re(L,"rbc-day-slot","rbc-time-column",l&&"rbc-now",l&&"rbc-today",v&&"rbc-slot-selecting"),slotMetrics:u,resource:c},u.groups.map(function(se,re){return R.createElement(Uc,{key:re,group:se,resource:c,getters:m,components:w})}),R.createElement(h,{localizer:g,resource:c,accessors:d,getters:m,components:w,slotMetrics:u},R.createElement("div",{className:Re("rbc-events-container",o&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),v&&R.createElement("div",{className:"rbc-slot-selection",style:{top:S,height:_}},R.createElement("span",null,g.format(T,"selectRangeFormat"))),l&&this.intervalTriggered&&R.createElement(x,q,R.createElement("div",q)))}}])}(R.Component);Wc.defaultProps={dragThroughEvents:!0,timeslots:2};var Bc=function(r){var s=r.label;return R.createElement(R.Fragment,null,s)},j5=function(t){function r(){var s;Ue(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=Ze(this,r,[].concat(n)),s.handleHeaderClick=function(o,l,c){c.preventDefault(),Te(s.props.onDrillDown,[o,l])},s.renderRow=function(o){var l=s.props,c=l.events,d=l.rtl,g=l.selectable,p=l.getNow,f=l.range,m=l.getters,y=l.localizer,h=l.accessors,x=l.components,w=l.resizable,u=h.resourceId(o),N=o?c.filter(function(v){return h.resource(v)===u}):c;return R.createElement(ds,{isAllDay:!0,rtl:d,getNow:p,minRows:2,maxRows:s.props.allDayMaxRows+1,range:f,events:N,resourceId:u,className:"rbc-allday-cell",selectable:g,selected:s.props.selected,components:x,accessors:h,getters:m,localizer:y,onSelect:s.props.onSelectEvent,onShowMore:s.props.onShowMore,onDoubleClick:s.props.onDoubleClickEvent,onKeyPress:s.props.onKeyPressEvent,onSelectSlot:s.props.onSelectSlot,longPressThreshold:s.props.longPressThreshold,resizable:w})},s}return et(r,t),We(r,[{key:"renderHeaderCells",value:function(a){var n=this,i=this.props,o=i.localizer,l=i.getDrilldownView,c=i.getNow,d=i.getters.dayProp,g=i.components.header,p=g===void 0?qn:g,f=c();return a.map(function(m,y){var h=l(m),x=o.format(m,"dayFormat"),w=d(m),u=w.className,N=w.style,v=R.createElement(p,{date:m,label:x,localizer:o});return R.createElement("div",{key:y,style:N,className:Re("rbc-header",u,o.isSameDate(m,f)&&"rbc-today")},h?R.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(_){return n.handleHeaderClick(m,h,_)}},v):R.createElement("span",null,v))})}},{key:"render",value:function(){var a=this,n=this.props,i=n.width,o=n.rtl,l=n.resources,c=n.range,d=n.events,g=n.getNow,p=n.accessors,f=n.selectable,m=n.components,y=n.getters,h=n.scrollRef,x=n.localizer,w=n.isOverflowing,u=n.components,N=u.timeGutterHeader,v=u.resourceHeader,S=v===void 0?Bc:v,_=n.resizable,P={};w&&(P[o?"marginLeft":"marginRight"]="".concat(kn()-1,"px"));var B=l.groupEvents(d);return R.createElement("div",{style:P,ref:h,className:Re("rbc-time-header",w&&"rbc-overflowing")},R.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:i,minWidth:i,maxWidth:i}},N&&R.createElement(N,null)),l.map(function(T,z){var L=sr(T,2),K=L[0],q=L[1];return R.createElement("div",{className:"rbc-time-header-content",key:K||z},q&&R.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(z)},R.createElement("div",{className:"rbc-header"},R.createElement(S,{index:z,label:p.resourceTitle(q),resource:q}))),R.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(c.length<=1?" rbc-time-header-cell-single-day":"")},a.renderHeaderCells(c)),R.createElement(ds,{isAllDay:!0,rtl:o,getNow:g,minRows:2,maxRows:a.props.allDayMaxRows+1,range:c,events:B.get(K)||[],resourceId:q&&K,className:"rbc-allday-cell",selectable:f,selected:a.props.selected,components:m,accessors:p,getters:y,localizer:x,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:_}))}))}}])}(R.Component),w5=function(t){function r(){var s;Ue(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=Ze(this,r,[].concat(n)),s.handleHeaderClick=function(o,l,c){c.preventDefault(),Te(s.props.onDrillDown,[o,l])},s}return et(r,t),We(r,[{key:"renderHeaderCells",value:function(a){var n=this,i=this.props,o=i.localizer,l=i.getDrilldownView,c=i.getNow,d=i.getters.dayProp,g=i.components,p=g.header,f=p===void 0?qn:p,m=g.resourceHeader,y=m===void 0?Bc:m,h=i.resources,x=i.accessors,w=i.events,u=i.rtl,N=i.selectable,v=i.components,S=i.getters,_=i.resizable,P=c(),B=h.groupEvents(w);return a.map(function(T,z){var L=l(T),K=o.format(T,"dayFormat"),q=d(T),te=q.className,se=q.style,re=R.createElement(f,{date:T,label:K,localizer:o});return R.createElement("div",{key:z,className:"rbc-time-header-content rbc-resource-grouping"},R.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(a.length<=1?" rbc-time-header-cell-single-day":"")},R.createElement("div",{style:se,className:Re("rbc-header",te,o.isSameDate(T,P)&&"rbc-today")},L?R.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(H){return n.handleHeaderClick(T,L,H)}},re):R.createElement("span",null,re))),R.createElement("div",{className:"rbc-row"},h.map(function(k,H){var Y=sr(k,2),A=Y[0],ae=Y[1];return R.createElement("div",{key:"resource_".concat(A,"_").concat(H),className:Re("rbc-header",te,o.isSameDate(T,P)&&"rbc-today")},R.createElement(y,{index:H,label:x.resourceTitle(ae),resource:ae}))})),R.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},h.map(function(k,H){var Y=sr(k,2),A=Y[0],ae=Y[1],me=(B.get(A)||[]).filter(function(he){return o.isSameDate(he.start,T)||o.isSameDate(he.end,T)});return R.createElement(ds,{key:"resource_".concat(A,"_").concat(H),isAllDay:!0,rtl:u,getNow:c,minRows:2,maxRows:n.props.allDayMaxRows+1,range:[T],events:me,resourceId:ae&&A,className:"rbc-allday-cell",selectable:N,selected:n.props.selected,components:v,accessors:x,getters:S,localizer:o,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:_})})))})}},{key:"render",value:function(){var a=this.props,n=a.width,i=a.rtl,o=a.range,l=a.scrollRef,c=a.isOverflowing,d=a.components.timeGutterHeader,g={};return c&&(g[i?"marginLeft":"marginRight"]="".concat(kn()-1,"px")),R.createElement("div",{style:g,ref:l,className:Re("rbc-time-header",c&&"rbc-overflowing")},R.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:n,minWidth:n,maxWidth:n}},d&&R.createElement(d,null)),this.renderHeaderCells(o))}}])}(R.Component);function N5(t){var r=t.min,s=t.max,a=t.localizer;return a.getTimezoneOffset(r)!==a.getTimezoneOffset(s)?{start:a.add(r,-1,"day"),end:a.add(s,-1,"day")}:{start:r,end:s}}var S5=function(r){var s=r.min,a=r.max,n=r.timeslots,i=r.step,o=r.localizer,l=r.getNow,c=r.resource,d=r.components,g=r.getters,p=r.gutterRef,f=d.timeGutterWrapper,m=E.useMemo(function(){return N5({min:s,max:a,localizer:o})},[s==null?void 0:s.toISOString(),a==null?void 0:a.toISOString(),o]),y=m.start,h=m.end,x=E.useState(Yn({min:y,max:h,timeslots:n,step:i,localizer:o})),w=sr(x,2),u=w[0],N=w[1];E.useEffect(function(){u&&N(u.update({min:y,max:h,timeslots:n,step:i,localizer:o}))},[y==null?void 0:y.toISOString(),h==null?void 0:h.toISOString(),n,i]);var v=E.useCallback(function(S,_){if(_)return null;var P=u.dateIsInGroup(l(),_);return R.createElement("span",{className:Re("rbc-label",P&&"rbc-now")},o.format(S,"timeGutterFormat"))},[u,o,l]);return R.createElement(f,{slotMetrics:u},R.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:p},u.groups.map(function(S,_){return R.createElement(Uc,{key:_,group:S,resource:c,components:d,renderSlot:v,getters:g})})))},k5=R.forwardRef(function(t,r){return R.createElement(S5,Object.assign({gutterRef:r},t))}),Pa={};function C5(t,r){return{map:function(a){return t?t.map(function(n,i){return a([r.resourceId(n),n],i)}):[a([Pa,null],0)]},groupEvents:function(a){var n=new Map;return t?(a.forEach(function(i){var o=r.resource(i)||Pa;if(Array.isArray(o))o.forEach(function(c){var d=n.get(c)||[];d.push(i),n.set(c,d)});else{var l=n.get(o)||[];l.push(i),n.set(o,l)}}),n):(n.set(Pa,a),n)}}}var Ir=function(t){function r(s){var a;return Ue(this,r),a=Ze(this,r,[s]),a.handleScroll=function(n){a.scrollRef.current&&(a.scrollRef.current.scrollLeft=n.target.scrollLeft)},a.handleResize=function(){Ni(a.rafHandle),a.rafHandle=Ll(a.checkOverflow)},a.handleKeyPressEvent=function(){a.clearSelection();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];Te(a.props.onKeyPressEvent,i)},a.handleSelectEvent=function(){a.clearSelection();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];Te(a.props.onSelectEvent,i)},a.handleDoubleClickEvent=function(){a.clearSelection();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];Te(a.props.onDoubleClickEvent,i)},a.handleShowMore=function(n,i,o,l,c){var d=a.props,g=d.popup,p=d.onDrillDown,f=d.onShowMore,m=d.getDrilldownView,y=d.doShowMoreDrillDown;if(a.clearSelection(),g){var h=Il(o,a.containerRef.current);a.setState({overlay:{date:i,events:n,position:Ce(Ce({},h),{},{width:"200px"}),target:c}})}else y&&Te(p,[i,m(i)||st.DAY]);Te(f,[n,i,l])},a.handleSelectAllDaySlot=function(n,i){var o=a.props.onSelectSlot,l=new Date(n[0]),c=new Date(n[n.length-1]);c.setDate(n[n.length-1].getDate()+1),Te(o,{slots:n,start:l,end:c,action:i.action,resourceId:i.resourceId})},a.overlayDisplay=function(){a.setState({overlay:null})},a.checkOverflow=function(){if(!a._updatingOverflow){var n=a.contentRef.current;if(n!=null&&n.scrollHeight){var i=n.scrollHeight>n.clientHeight;a.state.isOverflowing!==i&&(a._updatingOverflow=!0,a.setState({isOverflowing:i},function(){a._updatingOverflow=!1}))}}},a.memoizedResources=cc(function(n,i){return C5(n,i)}),a.state={gutterWidth:void 0,isOverflowing:null},a.scrollRef=R.createRef(),a.contentRef=R.createRef(),a.containerRef=R.createRef(),a._scrollRatio=null,a.gutterRef=E.createRef(),a}return et(r,t),We(r,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),Ni(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(a,n,i,o,l,c,d,g,p,f){var m=this.props,y=m.min,h=m.max,x=(o.get(n)||[]).filter(function(u){return c.inRange(a,d.start(u),d.end(u),"day")}),w=(l.get(n)||[]).filter(function(u){return c.inRange(a,d.start(u),d.end(u),"day")});return R.createElement(Wc,Object.assign({},this.props,{localizer:c,min:c.merge(a,y),max:c.merge(a,h),resource:i&&n,components:g,isNow:c.isSameDate(a,f),key:"".concat(n,"-").concat(a),date:a,events:x,backgroundEvents:w,dayLayoutAlgorithm:p}))}},{key:"renderResourcesFirst",value:function(a,n,i,o,l,c,d,g,p){var f=this;return n.map(function(m){var y=sr(m,2),h=y[0],x=y[1];return a.map(function(w){return f.renderDayColumn(w,h,x,i,o,l,c,g,p,d)})})}},{key:"renderRangeFirst",value:function(a,n,i,o,l,c,d,g,p){var f=this;return a.map(function(m){return R.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:m},n.map(function(y){var h=sr(y,2),x=h[0],w=h[1];return R.createElement("div",{style:{flex:1},key:c.resourceId(w)},f.renderDayColumn(m,x,w,i,o,l,c,g,p,d))}))})}},{key:"renderEvents",value:function(a,n,i,o){var l=this.props,c=l.accessors,d=l.localizer,g=l.resourceGroupingLayout,p=l.components,f=l.dayLayoutAlgorithm,m=this.memoizedResources(this.props.resources,c),y=m.groupEvents(n),h=m.groupEvents(i);return g?this.renderRangeFirst(a,m,y,h,d,c,o,p,f):this.renderResourcesFirst(a,m,y,h,d,c,o,p,f)}},{key:"render",value:function(){var a,n=this.props,i=n.events,o=n.backgroundEvents,l=n.range,c=n.width,d=n.rtl,g=n.selected,p=n.getNow,f=n.resources,m=n.components,y=n.accessors,h=n.getters,x=n.localizer,w=n.min,u=n.max,N=n.showMultiDayTimes,v=n.longPressThreshold,S=n.resizable,_=n.resourceGroupingLayout;c=c||this.state.gutterWidth;var P=l[0],B=l[l.length-1];this.slots=l.length;var T=[],z=[],L=[];i.forEach(function(q){if(cs(q,P,B,y,x)){var te=y.start(q),se=y.end(q);y.allDay(q)||x.startAndEndAreDateOnly(te,se)||!N&&!x.isSameDate(te,se)?T.push(q):z.push(q)}}),o.forEach(function(q){cs(q,P,B,y,x)&&L.push(q)}),T.sort(function(q,te){return en(q,te,y,x)});var K={range:l,events:T,width:c,rtl:d,getNow:p,localizer:x,selected:g,allDayMaxRows:this.props.showAllEvents?1/0:(a=this.props.allDayMaxRows)!==null&&a!==void 0?a:1/0,resources:this.memoizedResources(f,y),selectable:this.props.selectable,accessors:y,getters:h,components:m,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:v,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:S};return R.createElement("div",{className:Re("rbc-time-view",f&&"rbc-time-view-resources"),ref:this.containerRef},f&&f.length>1&&_?R.createElement(w5,K):R.createElement(j5,K),this.props.popup&&this.renderOverlay(),R.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},R.createElement(k5,{date:P,ref:this.gutterRef,localizer:x,min:x.merge(P,w),max:x.merge(P,u),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:m,className:"rbc-time-gutter",getters:h}),this.renderEvents(l,z,L,p())))}},{key:"renderOverlay",value:function(){var a,n,i=this,o=(a=(n=this.state)===null||n===void 0?void 0:n.overlay)!==null&&a!==void 0?a:{},l=this.props,c=l.accessors,d=l.localizer,g=l.components,p=l.getters,f=l.selected,m=l.popupOffset,y=l.handleDragStart,h=function(){return i.setState({overlay:null})};return R.createElement(Gn,{overlay:o,accessors:c,localizer:d,components:g,getters:p,selected:f,popupOffset:m,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:y,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:h})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var a=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var n,i=(n=a.gutterRef)!==null&&n!==void 0&&n.current?Xa(a.gutterRef.current):void 0;i&&a.state.gutterWidth!==i&&a.setState({gutterWidth:i})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var a=this.contentRef.current;a.scrollTop=a.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,n=a.min,i=a.max,o=a.scrollToTime,l=a.localizer,c=l.diff(l.merge(o,n),o,"milliseconds"),d=l.diff(n,i,"milliseconds");this._scrollRatio=c/d}}])}(E.Component);Ir.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var $5=["date","localizer","min","max","scrollToTime","enableAutoScroll"],ba=function(t){function r(){return Ue(this,r),Ze(this,r,arguments)}return et(r,t),We(r,[{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.min,l=o===void 0?i.startOf(new Date,"day"):o,c=a.max,d=c===void 0?i.endOf(new Date,"day"):c,g=a.scrollToTime,p=g===void 0?i.startOf(new Date,"day"):g,f=a.enableAutoScroll,m=f===void 0?!0:f,y=Mt(a,$5),h=r.range(n,{localizer:i});return R.createElement(Ir,Object.assign({},y,{range:h,eventOffset:10,localizer:i,min:l,max:d,scrollToTime:p,enableAutoScroll:m}))}}])}(R.Component);ba.range=function(t,r){var s=r.localizer;return[s.startOf(t,"day")]};ba.navigate=function(t,r,s){var a=s.localizer;switch(r){case lt.PREVIOUS:return a.add(t,-1,"day");case lt.NEXT:return a.add(t,1,"day");default:return t}};ba.title=function(t,r){var s=r.localizer;return s.format(t,"dayHeaderFormat")};var E5=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Yt=function(t){function r(){return Ue(this,r),Ze(this,r,arguments)}return et(r,t),We(r,[{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.min,l=o===void 0?i.startOf(new Date,"day"):o,c=a.max,d=c===void 0?i.endOf(new Date,"day"):c,g=a.scrollToTime,p=g===void 0?i.startOf(new Date,"day"):g,f=a.enableAutoScroll,m=f===void 0?!0:f,y=Mt(a,E5),h=r.range(n,this.props);return R.createElement(Ir,Object.assign({},y,{range:h,eventOffset:15,localizer:i,min:l,max:d,scrollToTime:p,enableAutoScroll:m}))}}])}(R.Component);Yt.defaultProps=Ir.defaultProps;Yt.navigate=function(t,r,s){var a=s.localizer;switch(r){case lt.PREVIOUS:return a.add(t,-1,"week");case lt.NEXT:return a.add(t,1,"week");default:return t}};Yt.range=function(t,r){var s=r.localizer,a=s.startOfWeek(),n=s.startOf(t,"week",a),i=s.endOf(t,"week",a);return s.range(n,i)};Yt.title=function(t,r){var s=r.localizer,a=Yt.range(t,{localizer:s}),n=xc(a),i=n[0],o=n.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var D5=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function Vn(t,r){return Yt.range(t,r).filter(function(s){return[6,0].indexOf(s.getDay())===-1})}var js=function(t){function r(){return Ue(this,r),Ze(this,r,arguments)}return et(r,t),We(r,[{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.min,l=o===void 0?i.startOf(new Date,"day"):o,c=a.max,d=c===void 0?i.endOf(new Date,"day"):c,g=a.scrollToTime,p=g===void 0?i.startOf(new Date,"day"):g,f=a.enableAutoScroll,m=f===void 0?!0:f,y=Mt(a,D5),h=Vn(n,this.props);return R.createElement(Ir,Object.assign({},y,{range:h,eventOffset:15,localizer:i,min:l,max:d,scrollToTime:p,enableAutoScroll:m}))}}])}(R.Component);js.defaultProps=Ir.defaultProps;js.range=Vn;js.navigate=Yt.navigate;js.title=function(t,r){var s=r.localizer,a=Vn(t,{localizer:s}),n=xc(a),i=n[0],o=n.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var ya=30;function ja(t){var r=t.accessors,s=t.components,a=t.date,n=t.events,i=t.getters,o=t.length,l=o===void 0?ya:o,c=t.localizer,d=t.onDoubleClickEvent,g=t.onSelectEvent,p=t.selected,f=E.useRef(null),m=E.useRef(null),y=E.useRef(null),h=E.useRef(null),x=E.useRef(null);E.useEffect(function(){N()});var w=function(B,T,z){var L=s.event,K=s.date;return T=T.filter(function(q){return cs(q,c.startOf(B,"day"),c.endOf(B,"day"),r,c)}),T.map(function(q,te){var se=r.title(q),re=r.end(q),k=r.start(q),H=i.eventProp(q,k,re,pa(q,p)),Y=te===0&&c.format(B,"agendaDateFormat"),A=te===0?R.createElement("td",{rowSpan:T.length,className:"rbc-agenda-date-cell"},K?R.createElement(K,{day:B,label:Y}):Y):!1;return R.createElement("tr",{key:z+"_"+te,className:H.className,style:H.style},A,R.createElement("td",{className:"rbc-agenda-time-cell"},u(B,q)),R.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(me){return g&&g(q,me)},onDoubleClick:function(me){return d&&d(q,me)}},L?R.createElement(L,{event:q,title:se}):se))},[])},u=function(B,T){var z="",L=s.time,K=c.messages.allDay,q=r.end(T),te=r.start(T);return r.allDay(T)||(c.eq(te,q)?K=c.format(te,"agendaTimeFormat"):c.isSameDate(te,q)?K=c.format({start:te,end:q},"agendaTimeRangeFormat"):c.isSameDate(B,te)?K=c.format(te,"agendaTimeFormat"):c.isSameDate(B,q)&&(K=c.format(q,"agendaTimeFormat"))),c.gt(B,te,"day")&&(z="rbc-continues-prior"),c.lt(B,q,"day")&&(z+=" rbc-continues-after"),R.createElement("span",{className:z.trim()},L?R.createElement(L,{event:T,day:B,label:K}):K)},N=function(){if(x.current){var B=f.current,T=x.current.firstChild;if(T){var z=h.current.scrollHeight>h.current.clientHeight,L=[],K=L;L=[Xa(T.children[0]),Xa(T.children[1])],(K[0]!==L[0]||K[1]!==L[1])&&(m.current.style.width=L[0]+"px",y.current.style.width=L[1]+"px"),z?(Tf(B,"rbc-header-overflowing"),B.style.marginRight=kn()+"px"):Of(B,"rbc-header-overflowing")}}},v=c.messages,S=c.add(a,l,"day"),_=c.range(a,S,"day");return n=n.filter(function(P){return cs(P,c.startOf(a,"day"),c.endOf(S,"day"),r,c)}),n.sort(function(P,B){return+r.start(P)-+r.start(B)}),R.createElement("div",{className:"rbc-agenda-view"},n.length!==0?R.createElement(R.Fragment,null,R.createElement("table",{ref:f,className:"rbc-agenda-table"},R.createElement("thead",null,R.createElement("tr",null,R.createElement("th",{className:"rbc-header",ref:m},v.date),R.createElement("th",{className:"rbc-header",ref:y},v.time),R.createElement("th",{className:"rbc-header"},v.event)))),R.createElement("div",{className:"rbc-agenda-content",ref:h},R.createElement("table",{className:"rbc-agenda-table"},R.createElement("tbody",{ref:x},_.map(function(P,B){return w(P,n,B)}))))):R.createElement("span",{className:"rbc-agenda-empty"},v.noEventsInRange))}ja.range=function(t,r){var s=r.length,a=s===void 0?ya:s,n=r.localizer,i=n.add(t,a,"day");return{start:t,end:i}};ja.navigate=function(t,r,s){var a=s.length,n=a===void 0?ya:a,i=s.localizer;switch(r){case lt.PREVIOUS:return i.add(t,-n,"day");case lt.NEXT:return i.add(t,n,"day");default:return t}};ja.title=function(t,r){var s=r.length,a=s===void 0?ya:s,n=r.localizer,i=n.add(t,a,"day");return n.format({start:t,end:i},"agendaHeaderFormat")};var Rs=Zt(Zt(Zt(Zt(Zt({},st.MONTH,va),st.WEEK,Yt),st.WORK_WEEK,js),st.DAY,ba),st.AGENDA,ja),T5=["action","date","today"];function O5(t,r){var s=r.action,a=r.date,n=r.today,i=Mt(r,T5);switch(t=typeof t=="string"?Rs[t]:t,s){case lt.TODAY:a=n||new Date;break;case lt.DATE:break;default:Xr(t&&typeof t.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),a=t.navigate(a,s,i)}return a}function M5(t,r){var s=null;return typeof r=="function"?s=r(t):typeof r=="string"&&Lt(t)==="object"&&t!=null&&r in t&&(s=t[r]),s}var At=function(r){return function(s){return M5(s,r)}},_5=["view","date","getNow","onNavigate"],P5=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function Hc(t){if(Array.isArray(t))return t;for(var r=[],s=0,a=Object.entries(t);s<a.length;s++){var n=sr(a[s],2),i=n[0],o=n[1];o&&r.push(i)}return r}function A5(t,r){var s=r.views,a=Hc(s);return a.indexOf(t)!==-1}var zc=function(t){function r(){var s;Ue(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=Ze(this,r,[].concat(n)),s.getViews=function(){var o=s.props.views;return Array.isArray(o)?uk(o,function(l,c){return l[c]=Rs[c]},{}):Lt(o)==="object"?uN(o,function(l,c){return l===!0?Rs[c]:l}):Rs},s.getView=function(){var o=s.getViews();return o[s.props.view]},s.getDrilldownView=function(o){var l=s.props,c=l.view,d=l.drilldownView,g=l.getDrilldownView;return g?g(o,c,Object.keys(s.getViews())):d},s.handleRangeChange=function(o,l,c){var d=s.props,g=d.onRangeChange,p=d.localizer;g&&l.range&&g(l.range(o,{localizer:p}),c)},s.handleNavigate=function(o,l){var c=s.props,d=c.view,g=c.date,p=c.getNow,f=c.onNavigate,m=Mt(c,_5),y=s.getView(),h=p();g=O5(y,Ce(Ce({},m),{},{action:o,date:l||g||h,today:h})),f(g,d,o),s.handleRangeChange(g,y)},s.handleViewChange=function(o){o!==s.props.view&&A5(o,s.props)&&s.props.onView(o);var l=s.getViews();s.handleRangeChange(s.props.date||s.props.getNow(),l[o],o)},s.handleSelectEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onSelectEvent,l)},s.handleDoubleClickEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onDoubleClickEvent,l)},s.handleKeyPressEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Te(s.props.onKeyPressEvent,l)},s.handleSelectSlot=function(o){Te(s.props.onSelectSlot,o)},s.handleDrillDown=function(o,l){var c=s.props.onDrillDown;if(c){c(o,l,s.drilldownView);return}l&&s.handleViewChange(l),s.handleNavigate(lt.DATE,o)},s.state={context:r.getContext(s.props)},s}return et(r,t),We(r,[{key:"render",value:function(){var a=this.props,n=a.view,i=a.toolbar,o=a.events,l=a.backgroundEvents,c=a.resourceGroupingLayout,d=a.style,g=a.className,p=a.elementProps,f=a.date,m=a.getNow,y=a.length,h=a.showMultiDayTimes,x=a.onShowMore,w=a.doShowMoreDrillDown;a.components,a.formats,a.messages,a.culture;var u=Mt(a,P5);f=f||m();var N=this.getView(),v=this.state.context,S=v.accessors,_=v.components,P=v.getters,B=v.localizer,T=v.viewNames,z=_.toolbar||Lk,L=N.title(f,{localizer:B,length:y});return R.createElement("div",Object.assign({},p,{className:Re(g,"rbc-calendar",u.rtl&&"rbc-rtl"),style:d}),i&&R.createElement(z,{date:f,view:n,views:T,label:L,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:B}),R.createElement(N,Object.assign({},u,{events:o,backgroundEvents:l,date:f,getNow:m,length:y,localizer:B,getters:P,components:_,accessors:S,showMultiDayTimes:h,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:x,doShowMoreDrillDown:w,resourceGroupingLayout:c})))}}],[{key:"getDerivedStateFromProps",value:function(a){return{context:r.getContext(a)}}},{key:"getContext",value:function(a){var n=a.startAccessor,i=a.endAccessor,o=a.allDayAccessor,l=a.tooltipAccessor,c=a.titleAccessor,d=a.resourceAccessor,g=a.resourceIdAccessor,p=a.resourceTitleAccessor,f=a.eventIdAccessor,m=a.eventPropGetter,y=a.backgroundEventPropGetter,h=a.slotPropGetter,x=a.slotGroupPropGetter,w=a.dayPropGetter,u=a.view,N=a.views,v=a.localizer,S=a.culture,_=a.messages,P=_===void 0?{}:_,B=a.components,T=B===void 0?{}:B,z=a.formats,L=z===void 0?{}:z,K=Hc(N),q=Uk(P);return{viewNames:K,localizer:Ik(v,S,L,q),getters:{eventProp:function(){return m&&m.apply(void 0,arguments)||{}},backgroundEventProp:function(){return y&&y.apply(void 0,arguments)||{}},slotProp:function(){return h&&h.apply(void 0,arguments)||{}},slotGroupProp:function(){return x&&x.apply(void 0,arguments)||{}},dayProp:function(){return w&&w.apply(void 0,arguments)||{}}},components:aN(T[u]||{},QS(T,K),{eventWrapper:kt,backgroundEventWrapper:kt,eventContainerWrapper:kt,dateCellWrapper:kt,weekWrapper:kt,timeSlotWrapper:kt,timeGutterWrapper:kt,timeIndicatorWrapper:kt}),accessors:{start:At(n),end:At(i),allDay:At(o),tooltip:At(l),title:At(c),resource:At(d),resourceId:At(g),resourceTitle:At(p),eventId:At(f)}}}}])}(R.Component);zc.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:st.MONTH,views:[st.MONTH,st.WEEK,st.DAY,st.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:st.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var Kn=pl(zc,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),R5=function(r,s,a){var n=r.start,i=r.end;return"".concat(a.format(n,"P",s)," – ").concat(a.format(i,"P",s))},Aa=function(r,s,a){var n=r.start,i=r.end;return"".concat(a.format(n,"p",s)," – ").concat(a.format(i,"p",s))},I5=function(r,s,a){var n=r.start;return"".concat(a.format(n,"h:mma",s)," – ")},L5=function(r,s,a){var n=r.end;return" – ".concat(a.format(n,"h:mma",s))},F5=function(r,s,a){var n=r.start,i=r.end;return"".concat(a.format(n,"MMMM dd",s)," – ").concat(a.format(i,$r(n,i,"month")?"dd":"MMMM dd",s))},U5={dateFormat:"dd",dayFormat:"dd eee",weekdayFormat:"ccc",selectRangeFormat:Aa,eventTimeRangeFormat:Aa,eventTimeRangeStartFormat:I5,eventTimeRangeEndFormat:L5,timeGutterFormat:"p",monthHeaderFormat:"MMMM yyyy",dayHeaderFormat:"cccc MMM dd",dayRangeHeaderFormat:F5,agendaHeaderFormat:R5,agendaDateFormat:"ccc MMM dd",agendaTimeFormat:"p",agendaTimeRangeFormat:Aa},Jn=function(r){var s=r.startOfWeek,a=r.getDay,n=r.format,i=r.locales;return new Rk({formats:U5,firstOfWeek:function(l){return a(s(new Date,{locale:i[l]}))},format:function(l,c,d){return n(new Date(l),c,{locale:i[d]})}})};function mt(t){const r=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&r==="[object Date]"?new t.constructor(+t):typeof t=="number"||r==="[object Number]"||typeof t=="string"||r==="[object String]"?new Date(t):new Date(NaN)}function Ut(t,r){return t instanceof Date?new t.constructor(r):new Date(r)}function W5(t,r){const s=mt(t);return isNaN(r)?Ut(t,NaN):(s.setDate(s.getDate()+r),s)}const Gc=6048e5,B5=864e5;let H5={};function wa(){return H5}function _t(t,r){var l,c,d,g;const s=wa(),a=(r==null?void 0:r.weekStartsOn)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??s.weekStartsOn??((g=(d=s.locale)==null?void 0:d.options)==null?void 0:g.weekStartsOn)??0,n=mt(t),i=n.getDay(),o=(i<a?7:0)+i-a;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function Vs(t){return _t(t,{weekStartsOn:1})}function qc(t){const r=mt(t),s=r.getFullYear(),a=Ut(t,0);a.setFullYear(s+1,0,4),a.setHours(0,0,0,0);const n=Vs(a),i=Ut(t,0);i.setFullYear(s,0,4),i.setHours(0,0,0,0);const o=Vs(i);return r.getTime()>=n.getTime()?s+1:r.getTime()>=o.getTime()?s:s-1}function Ks(t){const r=mt(t);return r.setHours(0,0,0,0),r}function Fo(t){const r=mt(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}function z5(t,r){const s=Ks(t),a=Ks(r),n=+s-Fo(s),i=+a-Fo(a);return Math.round((n-i)/B5)}function G5(t){const r=qc(t),s=Ut(t,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),Vs(s)}function Xn(t){return Ut(t,Date.now())}function Yc(t,r){const s=Ks(t),a=Ks(r);return+s==+a}function q5(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Y5(t){if(!q5(t)&&typeof t!="number")return!1;const r=mt(t);return!isNaN(Number(r))}function V5(t){const r=mt(t),s=Ut(t,0);return s.setFullYear(r.getFullYear(),0,1),s.setHours(0,0,0,0),s}const K5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},J5=(t,r,s)=>{let a;const n=K5[t];return typeof n=="string"?a=n:r===1?a=n.one:a=n.other.replace("{{count}}",r.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};function pr(t){return(r={})=>{const s=r.width?String(r.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const X5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Q5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Z5={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},eC={date:pr({formats:X5,defaultWidth:"full"}),time:pr({formats:Q5,defaultWidth:"full"}),dateTime:pr({formats:Z5,defaultWidth:"full"})},tC={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},rC=(t,r,s,a)=>tC[t];function Ct(t){return(r,s)=>{const a=s!=null&&s.context?String(s.context):"standalone";let n;if(a==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=s!=null&&s.width?String(s.width):o;n=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=s!=null&&s.width?String(s.width):t.defaultWidth;n=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(r):r;return n[i]}}const sC={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},aC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},nC={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},iC={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},oC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},lC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},cC=(t,r)=>{const s=Number(t),a=s%100;if(a>20||a<10)switch(a%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},dC={ordinalNumber:cC,era:Ct({values:sC,defaultWidth:"wide"}),quarter:Ct({values:aC,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ct({values:nC,defaultWidth:"wide"}),day:Ct({values:iC,defaultWidth:"wide"}),dayPeriod:Ct({values:oC,defaultWidth:"wide",formattingValues:lC,defaultFormattingWidth:"wide"})};function $t(t){return(r,s={})=>{const a=s.width,n=a&&t.matchPatterns[a]||t.matchPatterns[t.defaultMatchWidth],i=r.match(n);if(!i)return null;const o=i[0],l=a&&t.parsePatterns[a]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?mC(l,p=>p.test(o)):uC(l,p=>p.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=s.valueCallback?s.valueCallback(d):d;const g=r.slice(o.length);return{value:d,rest:g}}}function uC(t,r){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&r(t[s]))return s}function mC(t,r){for(let s=0;s<t.length;s++)if(r(t[s]))return s}function Vc(t){return(r,s={})=>{const a=r.match(t.matchPattern);if(!a)return null;const n=a[0],i=r.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=s.valueCallback?s.valueCallback(o):o;const l=r.slice(n.length);return{value:o,rest:l}}}const hC=/^(\d+)(th|st|nd|rd)?/i,fC=/\d+/i,gC={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},xC={any:[/^b/i,/^(a|c)/i]},pC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},vC={any:[/1/i,/2/i,/3/i,/4/i]},bC={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},yC={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},jC={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},wC={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},NC={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},SC={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},kC={ordinalNumber:Vc({matchPattern:hC,parsePattern:fC,valueCallback:t=>parseInt(t,10)}),era:$t({matchPatterns:gC,defaultMatchWidth:"wide",parsePatterns:xC,defaultParseWidth:"any"}),quarter:$t({matchPatterns:pC,defaultMatchWidth:"wide",parsePatterns:vC,defaultParseWidth:"any",valueCallback:t=>t+1}),month:$t({matchPatterns:bC,defaultMatchWidth:"wide",parsePatterns:yC,defaultParseWidth:"any"}),day:$t({matchPatterns:jC,defaultMatchWidth:"wide",parsePatterns:wC,defaultParseWidth:"any"}),dayPeriod:$t({matchPatterns:NC,defaultMatchWidth:"any",parsePatterns:SC,defaultParseWidth:"any"})},CC={code:"en-US",formatDistance:J5,formatLong:eC,formatRelative:rC,localize:dC,match:kC,options:{weekStartsOn:0,firstWeekContainsDate:1}};function $C(t){const r=mt(t);return z5(r,V5(r))+1}function EC(t){const r=mt(t),s=+Vs(r)-+G5(r);return Math.round(s/Gc)+1}function Kc(t,r){var g,p,f,m;const s=mt(t),a=s.getFullYear(),n=wa(),i=(r==null?void 0:r.firstWeekContainsDate)??((p=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(f=n.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=Ut(t,0);o.setFullYear(a+1,0,i),o.setHours(0,0,0,0);const l=_t(o,r),c=Ut(t,0);c.setFullYear(a,0,i),c.setHours(0,0,0,0);const d=_t(c,r);return s.getTime()>=l.getTime()?a+1:s.getTime()>=d.getTime()?a:a-1}function DC(t,r){var l,c,d,g;const s=wa(),a=(r==null?void 0:r.firstWeekContainsDate)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??s.firstWeekContainsDate??((g=(d=s.locale)==null?void 0:d.options)==null?void 0:g.firstWeekContainsDate)??1,n=Kc(t,r),i=Ut(t,0);return i.setFullYear(n,0,a),i.setHours(0,0,0,0),_t(i,r)}function TC(t,r){const s=mt(t),a=+_t(s,r)-+DC(s,r);return Math.round(a/Gc)+1}function we(t,r){const s=t<0?"-":"",a=Math.abs(t).toString().padStart(r,"0");return s+a}const Bt={y(t,r){const s=t.getFullYear(),a=s>0?s:1-s;return we(r==="yy"?a%100:a,r.length)},M(t,r){const s=t.getMonth();return r==="M"?String(s+1):we(s+1,2)},d(t,r){return we(t.getDate(),r.length)},a(t,r){const s=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h(t,r){return we(t.getHours()%12||12,r.length)},H(t,r){return we(t.getHours(),r.length)},m(t,r){return we(t.getMinutes(),r.length)},s(t,r){return we(t.getSeconds(),r.length)},S(t,r){const s=r.length,a=t.getMilliseconds(),n=Math.trunc(a*Math.pow(10,s-3));return we(n,r.length)}},fr={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Uo={G:function(t,r,s){const a=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return s.era(a,{width:"abbreviated"});case"GGGGG":return s.era(a,{width:"narrow"});case"GGGG":default:return s.era(a,{width:"wide"})}},y:function(t,r,s){if(r==="yo"){const a=t.getFullYear(),n=a>0?a:1-a;return s.ordinalNumber(n,{unit:"year"})}return Bt.y(t,r)},Y:function(t,r,s,a){const n=Kc(t,a),i=n>0?n:1-n;if(r==="YY"){const o=i%100;return we(o,2)}return r==="Yo"?s.ordinalNumber(i,{unit:"year"}):we(i,r.length)},R:function(t,r){const s=qc(t);return we(s,r.length)},u:function(t,r){const s=t.getFullYear();return we(s,r.length)},Q:function(t,r,s){const a=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(a);case"QQ":return we(a,2);case"Qo":return s.ordinalNumber(a,{unit:"quarter"});case"QQQ":return s.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,r,s){const a=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(a);case"qq":return we(a,2);case"qo":return s.ordinalNumber(a,{unit:"quarter"});case"qqq":return s.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,r,s){const a=t.getMonth();switch(r){case"M":case"MM":return Bt.M(t,r);case"Mo":return s.ordinalNumber(a+1,{unit:"month"});case"MMM":return s.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(a,{width:"wide",context:"formatting"})}},L:function(t,r,s){const a=t.getMonth();switch(r){case"L":return String(a+1);case"LL":return we(a+1,2);case"Lo":return s.ordinalNumber(a+1,{unit:"month"});case"LLL":return s.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(a,{width:"wide",context:"standalone"})}},w:function(t,r,s,a){const n=TC(t,a);return r==="wo"?s.ordinalNumber(n,{unit:"week"}):we(n,r.length)},I:function(t,r,s){const a=EC(t);return r==="Io"?s.ordinalNumber(a,{unit:"week"}):we(a,r.length)},d:function(t,r,s){return r==="do"?s.ordinalNumber(t.getDate(),{unit:"date"}):Bt.d(t,r)},D:function(t,r,s){const a=$C(t);return r==="Do"?s.ordinalNumber(a,{unit:"dayOfYear"}):we(a,r.length)},E:function(t,r,s){const a=t.getDay();switch(r){case"E":case"EE":case"EEE":return s.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(a,{width:"short",context:"formatting"});case"EEEE":default:return s.day(a,{width:"wide",context:"formatting"})}},e:function(t,r,s,a){const n=t.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return we(i,2);case"eo":return s.ordinalNumber(i,{unit:"day"});case"eee":return s.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(n,{width:"short",context:"formatting"});case"eeee":default:return s.day(n,{width:"wide",context:"formatting"})}},c:function(t,r,s,a){const n=t.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return we(i,r.length);case"co":return s.ordinalNumber(i,{unit:"day"});case"ccc":return s.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(n,{width:"narrow",context:"standalone"});case"cccccc":return s.day(n,{width:"short",context:"standalone"});case"cccc":default:return s.day(n,{width:"wide",context:"standalone"})}},i:function(t,r,s){const a=t.getDay(),n=a===0?7:a;switch(r){case"i":return String(n);case"ii":return we(n,r.length);case"io":return s.ordinalNumber(n,{unit:"day"});case"iii":return s.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(a,{width:"short",context:"formatting"});case"iiii":default:return s.day(a,{width:"wide",context:"formatting"})}},a:function(t,r,s){const n=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,r,s){const a=t.getHours();let n;switch(a===12?n=fr.noon:a===0?n=fr.midnight:n=a/12>=1?"pm":"am",r){case"b":case"bb":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,r,s){const a=t.getHours();let n;switch(a>=17?n=fr.evening:a>=12?n=fr.afternoon:a>=4?n=fr.morning:n=fr.night,r){case"B":case"BB":case"BBB":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,r,s){if(r==="ho"){let a=t.getHours()%12;return a===0&&(a=12),s.ordinalNumber(a,{unit:"hour"})}return Bt.h(t,r)},H:function(t,r,s){return r==="Ho"?s.ordinalNumber(t.getHours(),{unit:"hour"}):Bt.H(t,r)},K:function(t,r,s){const a=t.getHours()%12;return r==="Ko"?s.ordinalNumber(a,{unit:"hour"}):we(a,r.length)},k:function(t,r,s){let a=t.getHours();return a===0&&(a=24),r==="ko"?s.ordinalNumber(a,{unit:"hour"}):we(a,r.length)},m:function(t,r,s){return r==="mo"?s.ordinalNumber(t.getMinutes(),{unit:"minute"}):Bt.m(t,r)},s:function(t,r,s){return r==="so"?s.ordinalNumber(t.getSeconds(),{unit:"second"}):Bt.s(t,r)},S:function(t,r){return Bt.S(t,r)},X:function(t,r,s){const a=t.getTimezoneOffset();if(a===0)return"Z";switch(r){case"X":return Bo(a);case"XXXX":case"XX":return Qt(a);case"XXXXX":case"XXX":default:return Qt(a,":")}},x:function(t,r,s){const a=t.getTimezoneOffset();switch(r){case"x":return Bo(a);case"xxxx":case"xx":return Qt(a);case"xxxxx":case"xxx":default:return Qt(a,":")}},O:function(t,r,s){const a=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+Wo(a,":");case"OOOO":default:return"GMT"+Qt(a,":")}},z:function(t,r,s){const a=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+Wo(a,":");case"zzzz":default:return"GMT"+Qt(a,":")}},t:function(t,r,s){const a=Math.trunc(t.getTime()/1e3);return we(a,r.length)},T:function(t,r,s){const a=t.getTime();return we(a,r.length)}};function Wo(t,r=""){const s=t>0?"-":"+",a=Math.abs(t),n=Math.trunc(a/60),i=a%60;return i===0?s+String(n):s+String(n)+r+we(i,2)}function Bo(t,r){return t%60===0?(t>0?"-":"+")+we(Math.abs(t)/60,2):Qt(t,r)}function Qt(t,r=""){const s=t>0?"-":"+",a=Math.abs(t),n=we(Math.trunc(a/60),2),i=we(a%60,2);return s+n+r+i}const Ho=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},Jc=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},OC=(t,r)=>{const s=t.match(/(P+)(p+)?/)||[],a=s[1],n=s[2];if(!n)return Ho(t,r);let i;switch(a){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",Ho(a,r)).replace("{{time}}",Jc(n,r))},MC={p:Jc,P:OC},_C=/^D+$/,PC=/^Y+$/,AC=["D","DD","YY","YYYY"];function RC(t){return _C.test(t)}function IC(t){return PC.test(t)}function LC(t,r,s){const a=FC(t,r,s);if(console.warn(a),AC.includes(t))throw new RangeError(a)}function FC(t,r,s){const a=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${a} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const UC=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,WC=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,BC=/^'([^]*?)'?$/,HC=/''/g,zC=/[a-zA-Z]/;function ze(t,r,s){var g,p,f,m,y,h,x,w;const a=wa(),n=(s==null?void 0:s.locale)??a.locale??CC,i=(s==null?void 0:s.firstWeekContainsDate)??((p=(g=s==null?void 0:s.locale)==null?void 0:g.options)==null?void 0:p.firstWeekContainsDate)??a.firstWeekContainsDate??((m=(f=a.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=(s==null?void 0:s.weekStartsOn)??((h=(y=s==null?void 0:s.locale)==null?void 0:y.options)==null?void 0:h.weekStartsOn)??a.weekStartsOn??((w=(x=a.locale)==null?void 0:x.options)==null?void 0:w.weekStartsOn)??0,l=mt(t);if(!Y5(l))throw new RangeError("Invalid time value");let c=r.match(WC).map(u=>{const N=u[0];if(N==="p"||N==="P"){const v=MC[N];return v(u,n.formatLong)}return u}).join("").match(UC).map(u=>{if(u==="''")return{isToken:!1,value:"'"};const N=u[0];if(N==="'")return{isToken:!1,value:GC(u)};if(Uo[N])return{isToken:!0,value:u};if(N.match(zC))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:u}});n.localize.preprocessor&&(c=n.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:n};return c.map(u=>{if(!u.isToken)return u.value;const N=u.value;(!(s!=null&&s.useAdditionalWeekYearTokens)&&IC(N)||!(s!=null&&s.useAdditionalDayOfYearTokens)&&RC(N))&&LC(N,r,String(t));const v=Uo[N[0]];return v(l,N,n.localize,d)}).join("")}function GC(t){const r=t.match(BC);return r?r[1].replace(HC,"'"):t}function Qn(t){return mt(t).getDay()}function rn(t,r,s){const a=_t(t,s),n=_t(r,s);return+a==+n}function qC(t,r){return rn(t,Xn(t),r)}function zo(t){return Yc(t,Xn(t))}function YC(t,r){return W5(t,-1)}function Go(t){return Yc(t,YC(Xn(t)))}function Br(t,r){if(t.one!==void 0&&r===1)return t.one;const s=r%10,a=r%100;return s===1&&a!==11?t.singularNominative.replace("{{count}}",String(r)):s>=2&&s<=4&&(a<10||a>20)?t.singularGenitive.replace("{{count}}",String(r)):t.pluralGenitive.replace("{{count}}",String(r))}function rt(t){return(r,s)=>s!=null&&s.addSuffix?s.comparison&&s.comparison>0?t.future?Br(t.future,r):"через "+Br(t.regular,r):t.past?Br(t.past,r):Br(t.regular,r)+" назад":Br(t.regular,r)}const VC={lessThanXSeconds:rt({regular:{one:"меньше секунды",singularNominative:"меньше {{count}} секунды",singularGenitive:"меньше {{count}} секунд",pluralGenitive:"меньше {{count}} секунд"},future:{one:"меньше, чем через секунду",singularNominative:"меньше, чем через {{count}} секунду",singularGenitive:"меньше, чем через {{count}} секунды",pluralGenitive:"меньше, чем через {{count}} секунд"}}),xSeconds:rt({regular:{singularNominative:"{{count}} секунда",singularGenitive:"{{count}} секунды",pluralGenitive:"{{count}} секунд"},past:{singularNominative:"{{count}} секунду назад",singularGenitive:"{{count}} секунды назад",pluralGenitive:"{{count}} секунд назад"},future:{singularNominative:"через {{count}} секунду",singularGenitive:"через {{count}} секунды",pluralGenitive:"через {{count}} секунд"}}),halfAMinute:(t,r)=>r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"через полминуты":"полминуты назад":"полминуты",lessThanXMinutes:rt({regular:{one:"меньше минуты",singularNominative:"меньше {{count}} минуты",singularGenitive:"меньше {{count}} минут",pluralGenitive:"меньше {{count}} минут"},future:{one:"меньше, чем через минуту",singularNominative:"меньше, чем через {{count}} минуту",singularGenitive:"меньше, чем через {{count}} минуты",pluralGenitive:"меньше, чем через {{count}} минут"}}),xMinutes:rt({regular:{singularNominative:"{{count}} минута",singularGenitive:"{{count}} минуты",pluralGenitive:"{{count}} минут"},past:{singularNominative:"{{count}} минуту назад",singularGenitive:"{{count}} минуты назад",pluralGenitive:"{{count}} минут назад"},future:{singularNominative:"через {{count}} минуту",singularGenitive:"через {{count}} минуты",pluralGenitive:"через {{count}} минут"}}),aboutXHours:rt({regular:{singularNominative:"около {{count}} часа",singularGenitive:"около {{count}} часов",pluralGenitive:"около {{count}} часов"},future:{singularNominative:"приблизительно через {{count}} час",singularGenitive:"приблизительно через {{count}} часа",pluralGenitive:"приблизительно через {{count}} часов"}}),xHours:rt({regular:{singularNominative:"{{count}} час",singularGenitive:"{{count}} часа",pluralGenitive:"{{count}} часов"}}),xDays:rt({regular:{singularNominative:"{{count}} день",singularGenitive:"{{count}} дня",pluralGenitive:"{{count}} дней"}}),aboutXWeeks:rt({regular:{singularNominative:"около {{count}} недели",singularGenitive:"около {{count}} недель",pluralGenitive:"около {{count}} недель"},future:{singularNominative:"приблизительно через {{count}} неделю",singularGenitive:"приблизительно через {{count}} недели",pluralGenitive:"приблизительно через {{count}} недель"}}),xWeeks:rt({regular:{singularNominative:"{{count}} неделя",singularGenitive:"{{count}} недели",pluralGenitive:"{{count}} недель"}}),aboutXMonths:rt({regular:{singularNominative:"около {{count}} месяца",singularGenitive:"около {{count}} месяцев",pluralGenitive:"около {{count}} месяцев"},future:{singularNominative:"приблизительно через {{count}} месяц",singularGenitive:"приблизительно через {{count}} месяца",pluralGenitive:"приблизительно через {{count}} месяцев"}}),xMonths:rt({regular:{singularNominative:"{{count}} месяц",singularGenitive:"{{count}} месяца",pluralGenitive:"{{count}} месяцев"}}),aboutXYears:rt({regular:{singularNominative:"около {{count}} года",singularGenitive:"около {{count}} лет",pluralGenitive:"около {{count}} лет"},future:{singularNominative:"приблизительно через {{count}} год",singularGenitive:"приблизительно через {{count}} года",pluralGenitive:"приблизительно через {{count}} лет"}}),xYears:rt({regular:{singularNominative:"{{count}} год",singularGenitive:"{{count}} года",pluralGenitive:"{{count}} лет"}}),overXYears:rt({regular:{singularNominative:"больше {{count}} года",singularGenitive:"больше {{count}} лет",pluralGenitive:"больше {{count}} лет"},future:{singularNominative:"больше, чем через {{count}} год",singularGenitive:"больше, чем через {{count}} года",pluralGenitive:"больше, чем через {{count}} лет"}}),almostXYears:rt({regular:{singularNominative:"почти {{count}} год",singularGenitive:"почти {{count}} года",pluralGenitive:"почти {{count}} лет"},future:{singularNominative:"почти через {{count}} год",singularGenitive:"почти через {{count}} года",pluralGenitive:"почти через {{count}} лет"}})},KC=(t,r,s)=>VC[t](r,s),JC={full:"EEEE, d MMMM y 'г.'",long:"d MMMM y 'г.'",medium:"d MMM y 'г.'",short:"dd.MM.y"},XC={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},QC={any:"{{date}}, {{time}}"},ZC={date:pr({formats:JC,defaultWidth:"full"}),time:pr({formats:XC,defaultWidth:"full"}),dateTime:pr({formats:QC,defaultWidth:"any"})},Zn=["воскресенье","понедельник","вторник","среду","четверг","пятницу","субботу"];function e3(t){const r=Zn[t];switch(t){case 0:return"'в прошлое "+r+" в' p";case 1:case 2:case 4:return"'в прошлый "+r+" в' p";case 3:case 5:case 6:return"'в прошлую "+r+" в' p"}}function qo(t){const r=Zn[t];return t===2?"'во "+r+" в' p":"'в "+r+" в' p"}function t3(t){const r=Zn[t];switch(t){case 0:return"'в следующее "+r+" в' p";case 1:case 2:case 4:return"'в следующий "+r+" в' p";case 3:case 5:case 6:return"'в следующую "+r+" в' p"}}const r3={lastWeek:(t,r,s)=>{const a=t.getDay();return rn(t,r,s)?qo(a):e3(a)},yesterday:"'вчера в' p",today:"'сегодня в' p",tomorrow:"'завтра в' p",nextWeek:(t,r,s)=>{const a=t.getDay();return rn(t,r,s)?qo(a):t3(a)},other:"P"},s3=(t,r,s,a)=>{const n=r3[t];return typeof n=="function"?n(r,s,a):n},a3={narrow:["до н.э.","н.э."],abbreviated:["до н. э.","н. э."],wide:["до нашей эры","нашей эры"]},n3={narrow:["1","2","3","4"],abbreviated:["1-й кв.","2-й кв.","3-й кв.","4-й кв."],wide:["1-й квартал","2-й квартал","3-й квартал","4-й квартал"]},i3={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],wide:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"]},o3={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],wide:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"]},l3={narrow:["В","П","В","С","Ч","П","С"],short:["вс","пн","вт","ср","чт","пт","сб"],abbreviated:["вск","пнд","втр","срд","чтв","птн","суб"],wide:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"]},c3={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утро",afternoon:"день",evening:"вечер",night:"ночь"}},d3={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утра",afternoon:"дня",evening:"вечера",night:"ночи"}},u3=(t,r)=>{const s=Number(t),a=r==null?void 0:r.unit;let n;return a==="date"?n="-е":a==="week"||a==="minute"||a==="second"?n="-я":n="-й",s+n},m3={ordinalNumber:u3,era:Ct({values:a3,defaultWidth:"wide"}),quarter:Ct({values:n3,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ct({values:i3,defaultWidth:"wide",formattingValues:o3,defaultFormattingWidth:"wide"}),day:Ct({values:l3,defaultWidth:"wide"}),dayPeriod:Ct({values:c3,defaultWidth:"any",formattingValues:d3,defaultFormattingWidth:"wide"})},h3=/^(\d+)(-?(е|я|й|ое|ье|ая|ья|ый|ой|ий|ый))?/i,f3=/\d+/i,g3={narrow:/^((до )?н\.?\s?э\.?)/i,abbreviated:/^((до )?н\.?\s?э\.?)/i,wide:/^(до нашей эры|нашей эры|наша эра)/i},x3={any:[/^д/i,/^н/i]},p3={narrow:/^[1234]/i,abbreviated:/^[1234](-?[ыои]?й?)? кв.?/i,wide:/^[1234](-?[ыои]?й?)? квартал/i},v3={any:[/1/i,/2/i,/3/i,/4/i]},b3={narrow:/^[яфмаисонд]/i,abbreviated:/^(янв|фев|март?|апр|ма[йя]|июн[ья]?|июл[ья]?|авг|сент?|окт|нояб?|дек)\.?/i,wide:/^(январ[ья]|феврал[ья]|марта?|апрел[ья]|ма[йя]|июн[ья]|июл[ья]|августа?|сентябр[ья]|октябр[ья]|октябр[ья]|ноябр[ья]|декабр[ья])/i},y3={narrow:[/^я/i,/^ф/i,/^м/i,/^а/i,/^м/i,/^и/i,/^и/i,/^а/i,/^с/i,/^о/i,/^н/i,/^я/i],any:[/^я/i,/^ф/i,/^мар/i,/^ап/i,/^ма[йя]/i,/^июн/i,/^июл/i,/^ав/i,/^с/i,/^о/i,/^н/i,/^д/i]},j3={narrow:/^[впсч]/i,short:/^(вс|во|пн|по|вт|ср|чт|че|пт|пя|сб|су)\.?/i,abbreviated:/^(вск|вос|пнд|пон|втр|вто|срд|сре|чтв|чет|птн|пят|суб).?/i,wide:/^(воскресень[ея]|понедельника?|вторника?|сред[аы]|четверга?|пятниц[аы]|суббот[аы])/i},w3={narrow:[/^в/i,/^п/i,/^в/i,/^с/i,/^ч/i,/^п/i,/^с/i],any:[/^в[ос]/i,/^п[он]/i,/^в/i,/^ср/i,/^ч/i,/^п[ят]/i,/^с[уб]/i]},N3={narrow:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,abbreviated:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,wide:/^([дп]п|полночь|полдень|утр[оа]|день|дня|вечера?|ноч[ьи])/i},S3={any:{am:/^дп/i,pm:/^пп/i,midnight:/^полн/i,noon:/^полд/i,morning:/^у/i,afternoon:/^д[ен]/i,evening:/^в/i,night:/^н/i}},k3={ordinalNumber:Vc({matchPattern:h3,parsePattern:f3,valueCallback:t=>parseInt(t,10)}),era:$t({matchPatterns:g3,defaultMatchWidth:"wide",parsePatterns:x3,defaultParseWidth:"any"}),quarter:$t({matchPatterns:p3,defaultMatchWidth:"wide",parsePatterns:v3,defaultParseWidth:"any",valueCallback:t=>t+1}),month:$t({matchPatterns:b3,defaultMatchWidth:"wide",parsePatterns:y3,defaultParseWidth:"any"}),day:$t({matchPatterns:j3,defaultMatchWidth:"wide",parsePatterns:w3,defaultParseWidth:"any"}),dayPeriod:$t({matchPatterns:N3,defaultMatchWidth:"wide",parsePatterns:S3,defaultParseWidth:"any"})},xt={code:"ru",formatDistance:KC,formatLong:ZC,formatRelative:s3,localize:m3,match:k3,options:{weekStartsOn:1,firstWeekContainsDate:1}},ei=({isOpen:t,onClose:r,onConfirm:s,slot:a,teacher:n,student:i})=>{var y;const[o,l]=E.useState(""),[c,d]=E.useState(!1),g=async()=>{d(!0);try{await s(o),r()}catch{}finally{d(!1)}},p=h=>{switch(h){case"online":return e.jsx(Ge,{className:"h-4 w-4"});case"offline":return e.jsx(Et,{className:"h-4 w-4"});case"mini-group":return e.jsx(Zs,{className:"h-4 w-4"});default:return e.jsx(Ge,{className:"h-4 w-4"})}},f=h=>{switch(h){case"online":return"Онлайн";case"offline":return"Очно";case"mini-group":return"Мини-группа";default:return h}},m=h=>{switch(h){case"regular":return"Обычный урок";case"consultation":return"Консультация";case"exam_prep":return"Подготовка к экзамену";case"homework_help":return"Помощь с домашним заданием";default:return h}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Подтверждение бронирования"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(at,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Преподаватель"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[n!=null&&n.avatar?e.jsx("img",{src:n.avatar,alt:n.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(be,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:(n==null?void 0:n.name)||"Преподаватель"}),e.jsx("p",{className:"text-sm text-gray-600",children:a==null?void 0:a.subject}),((y=n==null?void 0:n.profile)==null?void 0:y.rating)&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-yellow-500",children:"★"}),e.jsx("span",{className:"text-sm text-gray-600 ml-1",children:n.profile.rating})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Детали урока"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Qe,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Дата: ",new Date(a==null?void 0:a.date).toLocaleDateString("ru-RU")]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Gt,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Время: ",a==null?void 0:a.startTime," - ",a==null?void 0:a.endTime]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Ge,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Предмет: ",a==null?void 0:a.subject]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[p(a==null?void 0:a.format),e.jsxs("span",{className:"text-sm",children:["Формат: ",f(a==null?void 0:a.format)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(_d,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Тип: ",m(a==null?void 0:a.lessonType)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(tl,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Стоимость: ",a==null?void 0:a.price," ₽"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Студент"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[i!=null&&i.avatar?e.jsx("img",{src:i.avatar,alt:i.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(be,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:i==null?void 0:i.name}),e.jsx("p",{className:"text-sm text-gray-600",children:"Студент"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Примечание к уроку"}),e.jsx("textarea",{value:o,onChange:h=>l(h.target.value),placeholder:"Опишите ваши цели, задачи или особые пожелания к уроку...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:4}),e.jsx("p",{className:"text-sm text-gray-500",children:"Это поможет преподавателю лучше подготовиться к уроку"})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Отмена"}),e.jsx("button",{onClick:g,disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Бронирование..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать урок"})]})})]})]})}):null},Xc=({teacher:t,onClose:r,onBookLesson:s,onMessage:a})=>{var Ee;const{user:n}=Ye(),{timeSlots:i,bookLesson:o,posts:l,createPost:c,addReaction:d,addComment:g,sharePost:p,bookmarkPost:f,editPost:m,deletePost:y}=ct(),[h,x]=E.useState(!1),[w,u]=E.useState(!1),[N,v]=E.useState(!1),[S,_]=E.useState(!1),[P,B]=E.useState(!1),[T,z]=E.useState(null),[L,K]=E.useState("about"),[q,te]=E.useState(null),[se,re]=E.useState({}),k=i.filter(Z=>Z.teacherId===t.id),H=k.filter(Z=>!Z.isBooked),Y=k.filter(Z=>Z.isBooked),A=t.profile,ae=l.filter(Z=>Z.userId===t.id),me=Z=>{switch(Z){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return Z}},he=Z=>{switch(Z){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}},ge=Z=>{switch(Z){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return Z}},ye=Z=>{z(Z),B(!0)},J=async Z=>{n&&T&&(o(T.id,n.id,n.name,Z),B(!1),z(null))},pe=(Z,Ne)=>new Date(`${Z}T${Ne}`).toLocaleDateString("ru-RU",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(an,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>u(!w),className:`p-2 rounded-full transition-colors ${w?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(Xs,{className:`w-5 h-5 ${w?"fill-current":""}`})}),e.jsx("button",{onClick:()=>x(!h),className:`p-2 rounded-full transition-colors ${h?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(vt,{className:`w-5 h-5 ${h?"fill-current":""}`})}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(zt,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsxs("div",{className:"h-56 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"}),e.jsx("div",{className:"absolute bottom-6 left-8 right-8",children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"text-white flex-1 mr-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 leading-tight",children:(A==null?void 0:A.name)||t.name||"Репетитор"}),e.jsxs("div",{className:"flex items-center space-x-4 flex-wrap",children:[(A==null?void 0:A.experience)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Ht,{className:"h-4 w-4 text-yellow-300"}),e.jsx("span",{className:"font-semibold text-xs",children:me(A.experience)})]}),(A==null?void 0:A.rating)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Dt,{className:"h-4 w-4 text-yellow-300 fill-current"}),e.jsx("span",{className:"font-semibold text-xs",children:A.rating})]}),(A==null?void 0:A.city)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Et,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-xs",children:A.city})]})]})]}),e.jsxs("div",{className:"text-right text-white/90 flex-shrink-0",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:(A==null?void 0:A.lessonsCount)||0}),e.jsx("div",{className:"text-sm opacity-80",children:"уроков"})]})]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start mt-8",children:[e.jsxs("div",{className:"flex-shrink-0 -mt-12 ml-8 relative",children:[e.jsxs("div",{className:"w-36 h-36 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-6 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-3 border-white rounded-full shadow-lg"}),A!=null&&A.avatar&&A.avatar.trim()!==""&&A.avatar!=="undefined"&&A.avatar!=="null"?e.jsx("img",{src:A.avatar,alt:(A==null?void 0:A.name)||t.name||"Репетитор",className:"w-36 h-36 object-cover rounded-full",onError:Z=>{const Ne=Z.target;Ne.style.display="none";const Oe=Ne.nextElementSibling;Oe&&Oe.classList.remove("hidden")},onLoad:Z=>{const Oe=Z.target.nextElementSibling;Oe&&Oe.classList.add("hidden")}}):null,e.jsx("div",{className:`w-36 h-36 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${A!=null&&A.avatar&&A.avatar.trim()!==""&&A.avatar!=="undefined"&&A.avatar!=="null"?"hidden":""}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(be,{className:"h-16 w-16 text-white mb-2"}),e.jsx("div",{className:"text-white text-sm font-semibold",children:((A==null?void 0:A.name)||t.name||"Репетитор").charAt(0).toUpperCase()})]})})]}),e.jsxs("div",{className:"absolute -bottom-2 -right-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>x(!h),className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${h?"bg-red-500 text-white scale-110":"bg-white text-gray-600 hover:bg-red-50 hover:text-red-500"}`,children:e.jsx(vt,{className:`w-5 h-5 ${h?"fill-current":""}`})}),e.jsx("button",{className:"w-10 h-10 rounded-full bg-white text-gray-600 hover:bg-gray-50 shadow-lg transition-all duration-200 flex items-center justify-center",children:e.jsx(zt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-wrap gap-4 mt-12 lg:mt-0",children:[e.jsxs("button",{onClick:()=>s(t.id),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ge,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Записаться на урок"})]}),a&&e.jsxs("button",{onClick:()=>a(t.id),className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-2xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ie,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Написать сообщение"})]}),e.jsxs("button",{onClick:()=>_(!S),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(Qe,{className:"h-6 w-6"}),e.jsxs("span",{className:"text-lg",children:["Слоты (",H.length,")"]})]}),e.jsxs("button",{onClick:()=>v(!N),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(vr,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Контактная информация"})]})]})]})]}),N&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 mb-8 mt-8 border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-lg",children:"Контактная информация"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.phone&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(br,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:t.phone})]}),t.email&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(on,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:t.email})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6 mt-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(A==null?void 0:A.lessonsCount)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Проведено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:((Ee=A==null?void 0:A.students)==null?void 0:Ee.length)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Учеников"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(A==null?void 0:A.rating)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Рейтинг"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:H.length}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Свободных слотов"})]})]}),ae.length>0&&e.jsxs("div",{className:"mb-8 mt-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx(rr,{className:"w-5 h-5 mr-2 text-blue-600"}),"Записи ",(A==null?void 0:A.name)||t.name,e.jsx("span",{className:"ml-2 bg-blue-100 text-blue-800 py-0.5 px-2 rounded-full text-sm",children:ae.length})]})}),e.jsxs("div",{className:"space-y-4",children:[ae.slice(0,3).map(Z=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:((A==null?void 0:A.name)||t.name).charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:(A==null?void 0:A.name)||t.name}),e.jsx("span",{className:"text-gray-500 text-sm",children:new Date(Z.date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})})]}),e.jsx("div",{className:"text-gray-700 mb-3 whitespace-pre-line",children:Z.text.length>200?`${Z.text.substring(0,200)}...`:Z.text}),Z.tags&&Z.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[Z.tags.slice(0,3).map((Ne,Oe)=>e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-1 rounded-md text-xs font-medium",children:["#",Ne]},Oe)),Z.tags.length>3&&e.jsxs("span",{className:"text-gray-500 text-xs",children:["+",Z.tags.length-3," еще"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(vt,{className:"w-4 h-4"}),e.jsx("span",{children:Z.likes||Z.reactions.length})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ie,{className:"w-4 h-4"}),e.jsx("span",{children:Z.comments.length})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(vr,{className:"w-4 h-4"}),e.jsx("span",{children:Z.views||0})]})]})]})]})},Z.id)),ae.length>3&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"text-blue-600 hover:text-blue-800 font-medium",children:["Показать все записи (",ae.length,")"]})})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8 mt-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"about",label:"О преподавателе",count:null},{id:"slots",label:"Расписание",count:H.length},{id:"reviews",label:"Отзывы",count:0}].map(Z=>e.jsxs("button",{onClick:()=>K(Z.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${L===Z.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[Z.label,Z.count!==null&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2 rounded-full text-xs",children:Z.count})]},Z.id))})}),e.jsxs("div",{className:"min-h-[400px]",children:[L==="about"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Основная информация"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(be,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Имя"}),e.jsx("div",{className:"font-semibold text-gray-900",children:(A==null?void 0:A.name)||t.name||"Репетитор"})]})]}),(A==null?void 0:A.experience)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ht,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Опыт"}),e.jsx("div",{className:"font-semibold text-gray-900",children:me(A.experience)})]})]}),(A==null?void 0:A.experienceYears)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ll,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Лет преподавания"}),e.jsx("div",{className:"font-semibold text-gray-900",children:A.experienceYears})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Os,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Тип преподавателя"}),e.jsx("div",{className:"font-semibold text-gray-900",children:he((A==null?void 0:A.teacherType)||"private")})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[(A==null?void 0:A.rating)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Dt,{className:"w-5 h-5 text-yellow-500 fill-current"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Рейтинг"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[A.rating,"/5"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ge,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Проведено уроков"}),e.jsx("div",{className:"font-semibold text-gray-900",children:(A==null?void 0:A.lessonsCount)||0})]})]}),(A==null?void 0:A.hourlyRate)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-green-600 font-bold text-lg",children:"₽"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Стоимость урока"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[A.hourlyRate," ₽/час"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(A==null?void 0:A.subjects)&&A.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-green-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-green-500 to-emerald-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Предметы"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:A.subjects.map((Z,Ne)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-green-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-green-200/50 shadow-sm",children:Z},Ne))})]}),(A==null?void 0:A.grades)&&A.grades.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-purple-500 to-pink-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Классы"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:A.grades.map((Z,Ne)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-purple-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-purple-200/50 shadow-sm",children:Z},Ne))})]})]}),(A==null?void 0:A.education)&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-orange-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-orange-500 to-red-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Образование"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[A.education.university&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"🎓"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Университет"}),e.jsx("div",{className:"font-semibold text-gray-900",children:A.education.university})]})]}),A.education.degree&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"📜"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Степень"}),e.jsx("div",{className:"font-semibold text-gray-900",children:A.education.degree})]})]}),A.education.graduationYear&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"📅"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Год выпуска"}),e.jsx("div",{className:"font-semibold text-gray-900",children:A.education.graduationYear})]})]})]})]}),(A==null?void 0:A.bio)&&e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-indigo-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-indigo-500 to-purple-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"О преподавателе"]}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm rounded-lg p-4 border border-indigo-200/50",children:e.jsx("p",{className:"text-indigo-800 leading-relaxed whitespace-pre-line",children:A.bio})})]}),(A==null?void 0:A.formats)&&A.formats.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 border border-teal-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-teal-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-teal-500 to-cyan-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Форматы обучения"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:A.formats.map((Z,Ne)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-teal-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-teal-200/50 shadow-sm",children:ge(Z)},Ne))})]})]}),L==="slots"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Доступные слоты"}),H.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:H.map(Z=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:Z.subject}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Gt,{className:"h-4 w-4"}),e.jsx("span",{children:pe(Z.date,Z.startTime)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Et,{className:"h-4 w-4"}),e.jsx("span",{children:ge(Z.format)})]})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600 mt-3",children:[Z.price," ₽"]})]})}),e.jsxs("button",{onClick:()=>ye(Z),className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать"})]})]},Z.id))}):e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-8 text-center",children:[e.jsx(Qe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg mb-2",children:"Нет доступных слотов"}),e.jsx("p",{className:"text-gray-500",children:"Попробуйте позже или свяжитесь с преподавателем"})]})]}),Y.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Забронированные уроки"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Y.map(Z=>e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:Z.subject}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Gt,{className:"h-4 w-4"}),e.jsx("span",{children:pe(Z.date,Z.startTime)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Et,{className:"h-4 w-4"}),e.jsx("span",{children:ge(Z.format)})]})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-600 mt-3",children:[Z.price," ₽"]})]})}),e.jsx("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded-xl text-sm font-medium text-center",children:"Забронировано"})]},Z.id))})]})]}),L==="reviews"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Dt,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пока нет отзывов"}),e.jsx("p",{className:"text-gray-500",children:"Будьте первым, кто оставит отзыв о преподавателе"})]})]})]})]}),P&&T&&e.jsx(ei,{isOpen:P,slot:T,onClose:()=>B(!1),onConfirm:J,teacher:t,student:n})]})},Yo="https://tutoring-platform-1756666331-zjfl.onrender.com",C3=({teacher:t,onClose:r,onBookLesson:s,onMessage:a})=>{var q,te,se,re;const{user:n}=Ye(),{timeSlots:i,posts:o,lessons:l,refreshUsers:c}=ct(),[d,g]=E.useState(!1),[p,f]=E.useState(!1),[m,y]=E.useState("about"),[h,x]=E.useState(!1),w=async()=>{var k,H;x(!0);try{const Y=await fetch(`${Yo}/api/users/${t.id}`);if(Y.ok){const A=await Y.json();console.log("Fresh teacher data from refresh button:",A);const me=JSON.parse(localStorage.getItem("allUsers")||"[]").map(ge=>ge.id===A.id?A:ge);localStorage.setItem("allUsers",JSON.stringify(me)),c();const he={...t,name:A.name||t.name,email:A.email||t.email,avatar:((k=A.profile)==null?void 0:k.avatar)||A.avatar||t.avatar,profile:{...t.profile,...A.profile,avatar:((H=A.profile)==null?void 0:H.avatar)||A.avatar||t.avatar,name:A.name||t.name,email:A.email||t.email}};console.log("Updated teacher data in modal:",he)}else console.warn("Failed to refresh teacher data:",Y.status)}catch(Y){console.error("Error refreshing teacher data:",Y)}finally{x(!1)}},u=t.profile;console.log("Teacher in modal:",t),console.log("Profile in modal:",u),E.useEffect(()=>{(async()=>{var H,Y;try{const A=await fetch(`${Yo}/api/users/${t.id}`);if(A.ok){const ae=await A.json();console.log("Fresh teacher data in modal:",ae);const he=JSON.parse(localStorage.getItem("allUsers")||"[]").map(ye=>ye.id===ae.id?ae:ye);localStorage.setItem("allUsers",JSON.stringify(he)),c();const ge={...t,name:ae.name||t.name,email:ae.email||t.email,avatar:((H=ae.profile)==null?void 0:H.avatar)||ae.avatar||t.avatar,profile:{...t.profile,...ae.profile,avatar:((Y=ae.profile)==null?void 0:Y.avatar)||ae.avatar||t.avatar,name:ae.name||t.name,email:ae.email||t.email}};console.log("Updated teacher data in modal useEffect:",ge)}else console.warn("Failed to refresh teacher data in modal:",A.status)}catch(A){console.error("Error refreshing teacher data in modal:",A)}})()},[t.id]);const N=i.filter(k=>k.teacherId===t.id),v=N.filter(k=>!k.isBooked),S=o.filter(k=>k.userId===t.id),P=l.filter(k=>k.teacherId===t.id).filter(k=>k.status==="completed");console.log("Teacher ID:",t.id),console.log("All timeSlots:",i),console.log("Teacher slots:",N),console.log("Available slots:",v);const B=k=>{switch(k){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return k}},T=k=>{switch(k){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}},z=k=>{switch(k){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return k}},L=k=>{const H=new Date(k),A=Math.floor((new Date().getTime()-H.getTime())/(1e3*60*60));return A<1?"только что":A<24?`${A}ч назад`:A<48?"вчера":H.toLocaleDateString("ru-RU")},K=k=>new Date(k).toLocaleDateString("ru-RU",{weekday:"short",month:"short",day:"numeric"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(at,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>f(!p),className:`p-2 rounded-full transition-colors ${p?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(Xs,{className:`w-5 h-5 ${p?"fill-current":""}`})}),e.jsx("button",{onClick:()=>g(!d),className:`p-2 rounded-full transition-colors ${d?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(vt,{className:`w-5 h-5 ${d?"fill-current":""}`})}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(zt,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-6 mb-6",children:[e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-lg relative",children:[e.jsx("div",{className:"absolute top-1 right-1 w-4 h-4 bg-green-500 border-2 border-white rounded-full shadow-sm"}),(()=>{const k=(u==null?void 0:u.avatar)||t.avatar;return k&&k.trim()!==""&&k!=="undefined"&&k!=="null"?e.jsx("img",{src:k,alt:t.name,className:"w-24 h-24 object-cover rounded-full",onError:Y=>{const A=Y.target;A.style.display="none";const ae=A.nextElementSibling;ae&&ae.classList.remove("hidden")},onLoad:Y=>{const ae=Y.target.nextElementSibling;ae&&ae.classList.add("hidden")}}):null})(),e.jsx("div",{className:`w-24 h-24 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${(()=>{const k=(u==null?void 0:u.avatar)||t.avatar;return k&&k.trim()!==""&&k!=="undefined"&&k!=="null"?"hidden":""})()}`,children:e.jsx(be,{className:"h-12 w-12 text-white"})})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name}),e.jsxs("p",{className:"text-gray-500",children:["@",t.id]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:w,disabled:h,className:"p-2 text-gray-400 hover:text-blue-600 transition-colors disabled:opacity-50",title:"Обновить данные",children:e.jsx(Hr,{className:`w-5 h-5 ${h?"animate-spin":""}`})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(zt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[(u==null?void 0:u.rating)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Dt,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{children:u.rating})]}),(u==null?void 0:u.lessonsCount)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ge,{className:"w-4 h-4"}),e.jsxs("span",{children:[u.lessonsCount," уроков"]})]}),(u==null?void 0:u.experienceYears)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ht,{className:"w-4 h-4"}),e.jsxs("span",{children:[u.experienceYears," лет опыта"]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-3",children:"Статистика"}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600 mb-1",children:P.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Проведено уроков"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600 mb-1",children:v.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Свободных слотов"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600 mb-1",children:S.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Записей"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600 mb-1",children:(u==null?void 0:u.reviewsCount)||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Отзывов"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>s(t.id),className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(Ge,{className:"w-5 h-5"}),e.jsx("span",{children:"Записаться на урок"})]}),e.jsxs("button",{onClick:()=>a(t.id),className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(Ie,{className:"w-5 h-5"}),e.jsx("span",{children:"Написать сообщение"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"О преподавателе"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Ge,{className:"w-3 h-3 mr-1"}),"Предметы:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((q=u==null?void 0:u.subjects)==null?void 0:q.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:u.subjects.map((k,H)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium",children:k},H))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Os,{className:"w-3 h-3 mr-1"}),"Классы:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((te=u==null?void 0:u.grades)==null?void 0:te.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:u.grades.map((k,H)=>e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs font-medium",children:k},H))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(il,{className:"w-3 h-3 mr-1"}),"Цели обучения:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((se=u==null?void 0:u.goals)==null?void 0:se.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:u.goals.map((k,H)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full text-xs font-medium",children:k},H))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Ht,{className:"w-3 h-3 mr-1"}),"Опыт:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:u!=null&&u.experience?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-0.5 rounded-full text-xs font-medium",children:B(u.experience)}),u.experienceYears&&e.jsxs("span",{className:"text-gray-600 text-xs",children:["(",u.experienceYears," лет)"]})]}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Os,{className:"w-3 h-3 mr-1"}),"Тип преподавателя:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:e.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded-full text-xs font-medium",children:T((u==null?void 0:u.teacherType)||"private")})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Et,{className:"w-3 h-3 mr-1"}),"Город:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:u!=null&&u.city?e.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-0.5 rounded-full text-xs font-medium",children:u.city}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Ed,{className:"w-3 h-3 mr-1"}),"Форматы обучения:"]}),e.jsx("div",{className:"text-base text-gray-900 mt-2",children:((re=u==null?void 0:u.formats)==null?void 0:re.length)>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:u.formats.map((k,H)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium",children:z(k)},H))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]})]})]})]}),(u==null?void 0:u.education)&&e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(Os,{className:"w-4 h-4 mr-2"}),"Образование"]}),e.jsxs("div",{className:"space-y-2",children:[u.education.university&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Университет:"}),e.jsx("div",{className:"text-sm text-gray-900",children:u.education.university})]}),u.education.degree&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Специальность:"}),e.jsx("div",{className:"text-sm text-gray-900",children:u.education.degree})]}),u.education.graduationYear&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Год выпуска:"}),e.jsx("div",{className:"text-sm text-gray-900",children:u.education.graduationYear})]}),u.education.courses&&u.education.courses.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Курсы:"}),e.jsx("div",{className:"space-y-1 mt-1",children:u.education.courses.map((k,H)=>e.jsxs("div",{className:"text-xs text-gray-700",children:["• ",k.name," (",k.institution,", ",k.year,")"]},H))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(tl,{className:"w-4 h-4 mr-2"}),"Стоимость и услуги"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Базовая стоимость:"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 mt-1",children:u!=null&&u.hourlyRate?`${u.hourlyRate} ₽/час`:"Не указана"})]}),(u==null?void 0:u.durations)&&u.durations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Длительности занятий:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.durations.map((k,H)=>e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded-lg text-xs font-medium",children:[k," мин"]},H))})]}),(u==null?void 0:u.lessonTypes)&&u.lessonTypes.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Типы уроков:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.lessonTypes.map((k,H)=>e.jsx("span",{className:"bg-green-50 text-green-700 px-2 py-0.5 rounded-lg text-xs font-medium",children:k},H))})]})]}),e.jsxs("div",{className:"space-y-3",children:[(u==null?void 0:u.rating)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Рейтинг:"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(k=>e.jsx(Dt,{className:`w-4 h-4 ${k<=(u.rating||0)?"text-yellow-400 fill-current":"text-gray-300"}`},k))}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[u.rating,"/5"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Автоподбор:"}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:u!=null&&u.overbookingEnabled?e.jsx("span",{className:"text-green-600 font-medium",children:"✓ Доступен"}):e.jsx("span",{className:"text-gray-500",children:"Недоступен"})})]})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-700",children:"💡 Стоимость может варьироваться в зависимости от формата, длительности занятия и сложности материала"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Доступные слоты (",v.length,")"]}),v.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Сводка по ценам:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Минимальная цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.min(...v.map(k=>k.price))," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Максимальная цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.max(...v.map(k=>k.price))," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Средняя цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.round(v.reduce((k,H)=>k+H.price,0)/v.length)," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Всего слотов:"}),e.jsx("div",{className:"font-semibold text-blue-600",children:v.length})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:v.slice(0,6).map(k=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:k.subject})]}),e.jsxs("span",{className:"text-base font-bold text-green-600",children:[k.price," ₽"]})]}),e.jsxs("div",{className:"space-y-1 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Gt,{className:"w-3 h-3"}),e.jsxs("span",{children:[K(k.date)," • ",k.startTime,"-",k.endTime]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Et,{className:"w-3 h-3"}),e.jsxs("span",{children:[z(k.format)," • ",k.duration," мин"]})]}),k.experience&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Ht,{className:"w-3 h-3"}),e.jsxs("span",{children:["Опыт: ",B(k.experience)]})]})]}),e.jsxs("button",{onClick:()=>s(t.id),className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-2 px-4 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 text-sm font-semibold",children:["Записаться за ",k.price," ₽"]})]},k.id))}),v.length>6&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:["И еще ",v.length-6," доступных слотов"]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Qe,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"Нет доступных слотов"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Следите за обновлениями расписания"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h3",{className:"text-base font-bold text-gray-900 flex items-center",children:[e.jsx(rr,{className:"w-4 h-4 mr-2"}),"Записи преподавателя (",S.length,")"]})}),S.length>0?e.jsxs("div",{className:"space-y-3",children:[S.slice(0,3).map(k=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center flex-shrink-0",children:e.jsx(be,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:k.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:L(k.date)})]}),e.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed text-sm",children:k.text}),k.tags&&k.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:k.tags.map((H,Y)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium",children:H},Y))}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(ol,{className:"w-3 h-3"}),e.jsx("span",{children:k.reactions.length})]}),e.jsxs("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(Ie,{className:"w-3 h-3"}),e.jsx("span",{children:k.comments.length})]}),e.jsx("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:e.jsx(zt,{className:"w-3 h-3"})})]})]})]})},k.id)),S.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs("p",{className:"text-gray-600 text-xs",children:["И еще ",S.length-3," записей"]})})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(rr,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"У преподавателя пока нет записей"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Записи появятся здесь, когда преподаватель начнет публиковать контент"})]})]})]})]})})},$3={ru:xt},E3=Jn({format:ze,startOfWeek:_t,getDay:Qn,locales:$3}),Qc=({onClose:t})=>{const{timeSlots:r,bookLesson:s}=ct(),{user:a}=Ye(),[n,i]=E.useState(null),[o,l]=E.useState(!1),[c,d]=E.useState(!1),[g,p]=E.useState(null),m=r.filter(v=>!v.isBooked).map(v=>({id:v.id,title:`${v.teacherName} - ${v.subject}`,start:new Date(`${v.date}T${v.startTime}`),end:new Date(`${v.date}T${v.endTime}`),slot:v,teacherName:v.teacherName,subject:v.subject,price:v.price,format:v.format,experience:v.experience,rating:v.rating,city:v.city,teacherAvatar:v.teacherAvatar})),y=E.useCallback(v=>{let S={backgroundColor:"#3B82F6",borderRadius:"6px",opacity:.95,color:"white",border:"0px",display:"block",padding:"3px 6px",fontSize:"11px",fontWeight:"500",margin:"1px 0",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",transition:"all 0.2s ease"};return v.format==="offline"?S.backgroundColor="#10B981":v.format==="mini-group"&&(S.backgroundColor="#8B5CF6"),{style:S}},[]),h=E.useCallback(v=>{i(v),l(!0)},[]),x=v=>{if(!a){alert("Пожалуйста, войдите в систему для бронирования");return}p(v),d(!0),l(!1)},w=async v=>{if(a&&g)try{await s(g.id,a.id,a.name,v),d(!1),p(null),window.location.reload()}catch{alert("Произошла ошибка при бронировании. Попробуйте еще раз.")}},u=v=>{switch(v){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return v}},N=v=>{switch(v){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return v}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9998] p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-7xl w-full max-h-[90vh] overflow-hidden relative",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 p-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Календарь свободных слотов"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Выберите удобное время для занятия с преподавателем"})]}),e.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(at,{className:"w-6 h-6 text-gray-600"})})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:e.jsx(Kn,{localizer:E3,events:m,startAccessor:"start",endAccessor:"end",style:{height:600},eventPropGetter:y,onSelectEvent:h,views:["month","week","day"],messages:{next:"Следующий",previous:"Предыдущий",today:"Сегодня",month:"Месяц",week:"Неделя",day:"День",noEventsInRange:"Нет свободных слотов в выбранном диапазоне",showMore:v=>`+${v} еще`}})})}),o&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:v=>{v.target===v.currentTarget&&l(!1)},children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Детали слота"}),e.jsx("button",{onClick:()=>l(!1),className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(at,{className:"w-5 h-5 text-gray-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden",children:n.teacherAvatar?e.jsx("img",{src:n.teacherAvatar,alt:n.teacherName,className:"w-12 h-12 object-cover rounded-full"}):e.jsx(be,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:n.teacherName}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[n.rating&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Dt,{className:"h-3 w-3 text-yellow-400 fill-current"}),e.jsx("span",{children:n.rating})]}),n.experience&&e.jsx("span",{className:"text-blue-600",children:u(n.experience)})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:n.subject})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Gt,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-gray-700",children:[ze(n.start,"dd MMMM yyyy, HH:mm",{locale:xt})," - ",ze(n.end,"HH:mm",{locale:xt})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Et,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:N(n.format)})]}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[n.price," ₽"]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsxs("button",{onClick:()=>x(n.slot),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать"})]}),e.jsx("button",{onClick:()=>l(!1),className:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Отмена"})]})]})]})}),c&&g&&e.jsx(ei,{slot:g,onClose:()=>d(!1),onConfirm:w})]})})},D3=({title:t,description:r,actionPrimary:s,actionSecondary:a,icon:n})=>e.jsx("div",{className:"col-span-full text-center py-14 card-gradient",children:e.jsxs("div",{className:"flex flex-col items-center",children:[n&&e.jsx("div",{className:"mb-3 text-blue-500",children:n}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),r&&e.jsx("p",{className:"text-gray-500 max-w-xl mx-auto mb-5",children:r}),e.jsxs("div",{className:"flex items-center gap-3 justify-center",children:[s&&e.jsx("button",{type:"button",onClick:s.onClick,className:`btn-primary px-5 py-2 rounded-lg ${s.variant==="secondary"?"btn-secondary":""}`,"aria-label":s.label,children:s.label}),a&&e.jsx("button",{type:"button",onClick:a.onClick,className:`btn-secondary px-5 py-2 rounded-lg ${a.variant==="primary"?"btn-primary":""}`,"aria-label":a.label,children:a.label})]})]})}),Ra=({setActiveTab:t})=>{var Lr;const{bookLesson:r,timeSlots:s,isConnected:a,isOfflineMode:n,allUsers:i,refreshUsers:o,refreshAllData:l,forceSyncData:c,uploadLocalDataToServer:d,sendMessageToUser:g,teacherProfiles:p}=ct(),{user:f}=Ye(),[m,y]=E.useState({}),[h,x]=E.useState(!1),[w,u]=E.useState(!1),[N,v]=E.useState(!1),[S,_]=E.useState({grade:"",subject:"",goals:[],experience:"",duration:60,format:"online",city:"",date:"",startTime:"",comment:""}),[P,B]=E.useState(!1),[T,z]=E.useState(null),[L,K]=E.useState(!1),[q,te]=E.useState(!1),[se,re]=E.useState(null),[k,H]=E.useState(()=>{const C=new Date,W=C.getDay(),X=C.getDate()-W+(W===0?-6:1);return new Date(C.setDate(X))}),[Y,A]=E.useState(null),[ae,me]=E.useState(null),[he,ge]=E.useState(""),ye=["Математика","Русский язык","Английский язык"],J=["1","2","3","4","5","6","7","8","9","10","11","Студент","Взрослый"],pe=["подготовка к экзаменам","помощь с домашним заданием","углубленное изучение","разговорная практика"],Ee=["beginner","experienced","professional"],Z=["online","offline","mini-group"],Ne=[45,60],tt=Jn({format:ze,startOfWeek:_t,getDay:Qn,locales:{ru:xt}}),[Ke,Me]=E.useState([]),G=async()=>{try{console.log("🔄 Загружаем всех преподавателей..."),await c();const C=await fetch(`${He}/api/users`);if(C.ok){const X=C.headers.get("content-type");if(X&&X.includes("application/json")){const le=await C.json();console.log("✅ Все пользователи загружены с сервера:",le.length);const Se=le.filter(fe=>fe.role==="teacher");console.log("✅ Преподаватели найдены:",Se.length,Se),Me(Se),o(),l()}else console.warn("⚠️ Сервер вернул не-JSON ответ для пользователей"),Me([])}else console.warn("⚠️ Не удалось загрузить пользователей с сервера:",C.status),Me([]);const W=await fetch(`${He}/api/teachers`);if(W.ok){const X=W.headers.get("content-type");if(X&&X.includes("application/json")){const le=await W.json();console.log("✅ Преподаватели загружены через /api/teachers:",le.length),Me(Se=>{const Pe=[...Se,...le].filter((ie,ve,Be)=>ve===Be.findIndex(ht=>ht.id===ie.id));return console.log("✅ Объединенные преподаватели:",Pe.length),Pe})}else console.warn("⚠️ Сервер вернул не-JSON ответ для преподавателей")}else console.warn("⚠️ Не удалось загрузить преподавателей через /api/teachers:",W.status)}catch(C){console.error("❌ Ошибка загрузки преподавателей с сервера:",C),Me([])}};E.useEffect(()=>{console.log("🚀 Компонент StudentHome смонтирован, загружаем преподавателей..."),G();const C=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");console.log("📱 Локальные профили преподавателей при монтировании:",Object.keys(C).length)},[c,o]),E.useEffect(()=>{const C=X=>{X.key==="tutoring_users"&&X.newValue&&(console.log("🔄 Обнаружены изменения в пользователях, обновляем список преподавателей"),G())},W=X=>{var le;((le=X.detail)==null?void 0:le.key)==="tutoring_users"&&(console.log("🔄 Обнаружены кастомные изменения в пользователях, обновляем список преподавателей"),G())};return window.addEventListener("storage",C),window.addEventListener("customStorage",W),()=>{window.removeEventListener("storage",C),window.removeEventListener("customStorage",W)}},[]),E.useEffect(()=>{console.log("📱 teacherProfiles изменились:",Object.keys(p).length),Object.keys(p).length>0&&console.log("✅ Найдены локальные профили преподавателей:",Object.keys(p))},[p]);const je=async()=>{u(!0);try{await c(),await G(),console.log("Force sync completed successfully")}catch(C){console.error("Error during force sync:",C)}finally{u(!1)}},ue=async()=>{u(!0);try{await G(),o(),console.log("✅ Список преподавателей обновлен")}catch(C){console.error("❌ Ошибка обновления списка преподавателей:",C)}finally{u(!1)}},Le=async()=>{u(!0);try{const C=await d();console.log("✅ Локальные данные загружены на сервер:",C),alert(`Локальные данные успешно загружены на сервер!
Загружено: ${C.uploaded} новых пользователей
Пропущено: ${C.skipped} существующих`)}catch(C){console.error("❌ Ошибка загрузки локальных данных:",C),alert("Ошибка загрузки локальных данных на сервер. Проверьте подключение к интернету.")}finally{u(!1)}},_e=R.useRef(null);R.useEffect(()=>{_e.current||(_e.current=Ko(gd),_e.current.on("slotCreated",()=>{setTimeout(()=>{xe()},100)}),_e.current.on("userRegistered",()=>{setTimeout(()=>{l(),xe()},100)}),_e.current.on("profileUpdated",C=>{console.log("Profile updated via WebSocket:",C),setTimeout(()=>{l(),xe()},100)}))},[]);const xe=()=>s.filter(W=>{if(W.isBooked)return!1;const X=new Date(W.date),le=new Date;return le.setHours(0,0,0,0),!(X<le)}),Fe=()=>{u(!0);try{let C=s.filter(W=>{if(W.isBooked)return!1;const X=new Date(W.date),le=new Date;return le.setHours(0,0,0,0),!(X<le)});if(m.grade&&m.grade!==""&&(C=C.filter(W=>W.grades&&W.grades.includes(m.grade))),m.subject&&m.subject!==""&&(C=C.filter(W=>W.subject===m.subject)),m.experience&&m.experience!==""&&(C=C.filter(W=>W.experience===m.experience)),m.format&&m.format!==""&&(C=C.filter(W=>W.format===m.format)),m.duration&&m.duration>0&&(C=C.filter(W=>W.duration===m.duration)),m.minRating&&m.minRating>0&&(C=C.filter(W=>(W.rating||0)>=m.minRating)),m.goals&&m.goals.length>0&&(C=C.filter(W=>W.goals&&m.goals.some(X=>W.goals.includes(X)))),Y){const W=ze(Y,"yyyy-MM-dd");C=C.filter(X=>X.date===W)}ae&&(C=C.filter(W=>{const X=parseInt(W.startTime.split(":")[0]),le=parseInt(ae.start.split(":")[0]),Se=parseInt(ae.end.split(":")[0]);return X>=le&&X<Se})),x(!1)}catch(C){console.error("Error applying filters:",C)}finally{u(!1)}},Je=()=>{y({}),A(null),me(null),ge(""),xe(),x(!1)},Nt=()=>{u(!0),l(),setTimeout(()=>{Object.keys(m).length===0&&!Y&&!ae?xe():Fe(),u(!1)},1e3)},O=async C=>{f&&T&&(r(T.id,f.id,f.name,C),setTimeout(()=>{Object.keys(m).length===0&&!Y&&!ae?xe():Fe()},100))},b=()=>{if(v(!1),_e.current){const C={studentId:f==null?void 0:f.id,studentName:f==null?void 0:f.name,...S};_e.current.emit("overbookingRequest",C)}alert("Заявка на овербукинг отправлена! Мы подберем лучшего преподавателя за 5 часов до занятия.")},$=C=>{switch(C){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return C}},D=R.useMemo(()=>{console.log("🔄 Собираем всех преподавателей...");const C=Ke.map(ie=>{var ve,Be,ht;return{id:ie.id,name:ie.name||((ve=ie.profile)==null?void 0:ve.name)||"Репетитор",avatar:ie.avatar||((Be=ie.profile)==null?void 0:Be.avatar)||"",rating:(ht=ie.profile)==null?void 0:ht.rating,profile:ie.profile}});console.log("📡 Преподаватели с сервера:",C.length);const W=(i==null?void 0:i.filter(ie=>ie.role==="teacher").map(ie=>{var ve,Be,ht;return{id:ie.id,name:ie.name||((ve=ie.profile)==null?void 0:ve.name)||"Репетитор",avatar:ie.avatar||((Be=ie.profile)==null?void 0:Be.avatar)||"",rating:(ht=ie.profile)==null?void 0:ht.rating,profile:ie.profile}}))||[];console.log("👥 Преподаватели из контекста:",W.length);const X=Object.entries(p).map(([ie,ve])=>({id:ie,name:ve.name||"Репетитор",avatar:ve.avatar||"",rating:ve.rating,profile:ve}));console.log("📱 Преподаватели из локальных профилей:",X.length);const le=s.filter(ie=>ie.teacherId&&ie.teacherName).map(ie=>({id:ie.teacherId,name:ie.teacherName,avatar:ie.teacherAvatar||"",rating:ie.rating,profile:{subjects:ie.subject?[ie.subject]:[],experience:ie.experience||"beginner",grades:ie.grades||[],goals:ie.goals||[],city:"",bio:"",rating:ie.rating||0,hourlyRate:ie.price||0}}));console.log("📅 Преподаватели из слотов:",le.length);const Se=[...C,...W,...X,...le];console.log("🔄 Всего источников:",Se.length);const fe=new Map;Se.forEach(ie=>{const ve=fe.get(ie.id);if(!ve)fe.set(ie.id,ie);else{const Be=ie.avatar&&ie.avatar.trim()!==""&&ie.avatar!=="undefined"&&ie.avatar!=="null",ht=ve.avatar&&ve.avatar.trim()!==""&&ve.avatar!=="undefined"&&ve.avatar!=="null",ws=ie.profile&&ie.profile.subjects&&ie.profile.subjects.length>0,mr=ve.profile&&ve.profile.subjects&&ve.profile.subjects.length>0;(Be&&!ht||ws&&!mr)&&fe.set(ie.id,ie)}});const Pe=Array.from(fe.values());return console.log("✅ Итоговые преподаватели:",Pe.length),console.log("📊 Детали преподавателей:",Pe.map(ie=>{var ve;return{id:ie.id,name:ie.name,hasAvatar:!!(ie.avatar&&ie.avatar.trim()!==""&&ie.avatar!=="undefined"&&ie.avatar!=="null"),hasProfile:!!(ie.profile&&ie.profile.subjects&&ie.profile.subjects.length>0),subjects:((ve=ie.profile)==null?void 0:ve.subjects)||[]}})),Pe},[Ke,i,s,p]),j=R.useMemo(()=>{let C=D;if((Object.keys(m).length>0||Y||ae)&&(console.log("Применяем фильтры:",m),console.log("Всего преподавателей до фильтрации:",D.length),C=D.filter(W=>{const X=W.profile;let le=!0;return m.subject&&m.subject!==""&&(!(X!=null&&X.subjects)||!X.subjects.includes(m.subject))&&(console.log(`Преподаватель ${W.name} отфильтрован: не преподает ${m.subject}`),le=!1),m.experience&&m.experience!==""&&le&&(X==null?void 0:X.experience)!==m.experience&&(console.log(`Преподаватель ${W.name} отфильтрован: опыт не совпадает`),le=!1),m.format&&m.format!==""&&le&&(!(X!=null&&X.formats)||!X.formats.includes(m.format))&&(console.log(`Преподаватель ${W.name} отфильтрован: формат не совпадает`),le=!1),m.city&&m.city!==""&&le&&(!(X!=null&&X.city)||!X.city.toLowerCase().includes(m.city.toLowerCase()))&&(console.log(`Преподаватель ${W.name} отфильтрован: город не совпадает`),le=!1),m.minRating&&m.minRating>0&&le&&((X==null?void 0:X.rating)||0)<m.minRating&&(console.log(`Преподаватель ${W.name} отфильтрован: рейтинг ниже ${m.minRating}`),le=!1),m.duration&&m.duration>0&&le&&(!(X!=null&&X.durations)||!X.durations.includes(m.duration))&&(console.log(`Преподаватель ${W.name} отфильтрован: длительность не совпадает`),le=!1),m.grade&&m.grade!==""&&le&&(!(X!=null&&X.grades)||!X.grades.includes(m.grade))&&(console.log(`Преподаватель ${W.name} отфильтрован: класс не совпадает`),le=!1),m.goals&&m.goals.length>0&&le&&(!(X!=null&&X.goals)||!m.goals.some(Se=>X.goals.includes(Se)))&&(console.log(`Преподаватель ${W.name} отфильтрован: цели не совпадают`),le=!1),le&&console.log(`Преподаватель ${W.name} прошел все фильтры`),le}),console.log("Преподавателей после фильтрации:",C.length)),he.trim()){const W=he.toLowerCase().trim();C=C.filter(X=>{const le=X.profile;return!!(X.name.toLowerCase().includes(W)||le!=null&&le.subjects&&le.subjects.some(Se=>Se.toLowerCase().includes(W))||le!=null&&le.city&&le.city.toLowerCase().includes(W))})}return C},[D,m,Y,ae,he]);function I(C){try{return JSON.parse(localStorage.getItem("tutoring_users")||"[]").find(X=>X.id===C&&X.role==="teacher")||null}catch{return null}}const[M,F]=E.useState(null),[ne,ce]=E.useState(!1),[U,V]=E.useState(!1);R.useEffect(()=>{Object.keys(m).length>0||Y||ae?Fe():xe()},[m,Y,ae,s]),R.useEffect(()=>{xe()},[i]),R.useEffect(()=>{const C=X=>{X.key==="tutoring_users"&&(o(),Me([]),fetch(`${He}/api/teachers`).then(le=>le.json()).then(le=>Me(Array.isArray(le)?le:[])).catch(()=>Me([])),xe())},W=X=>{var le;((le=X.detail)==null?void 0:le.key)==="tutoring_users"&&(o(),Me([]),fetch(`${He}/api/teachers`).then(Se=>Se.json()).then(Se=>Me(Array.isArray(Se)?Se:[])).catch(()=>Me([])),xe())};return window.addEventListener("storage",C),window.addEventListener("customStorage",W),()=>{window.removeEventListener("storage",C),window.removeEventListener("customStorage",W)}},[]),R.useEffect(()=>{xe()},[s]);const de=async C=>{var X,le,Se,fe,Pe,ie,ve,Be,ht,ws;console.log("Teacher clicked:",C);try{const mr=await fetch(`${He}/api/users/${C.id}`);if(mr.ok){const nt=await mr.json();if(console.log("Fresh teacher data from server:",nt),nt){const ed=JSON.parse(localStorage.getItem("allUsers")||"[]").map(si=>si.id===nt.id?nt:si);localStorage.setItem("allUsers",JSON.stringify(ed));const ri={id:nt.id,name:nt.name,email:nt.email,avatar:((X=nt.profile)==null?void 0:X.avatar)||nt.avatar,role:"teacher",profile:{...nt.profile,avatar:((le=nt.profile)==null?void 0:le.avatar)||nt.avatar,name:nt.name,email:nt.email}};console.log("Updated teacher data for modal:",ri),F(ri),ce(!0);return}}}catch(mr){console.error("Error fetching fresh teacher data:",mr)}let W=I(C.id);W?W={...W,name:C.name||W.name,email:((ve=C.profile)==null?void 0:ve.email)||C.email||W.email,avatar:((Be=C.profile)==null?void 0:Be.avatar)||C.avatar||W.avatar,profile:{...W.profile,...C.profile,avatar:((ht=C.profile)==null?void 0:ht.avatar)||C.avatar||W.avatar,name:C.name||W.name,email:((ws=C.profile)==null?void 0:ws.email)||C.email||W.email}}:W={id:C.id,name:C.name,email:((Se=C.profile)==null?void 0:Se.email)||C.email||"",avatar:((fe=C.profile)==null?void 0:fe.avatar)||C.avatar,role:"teacher",profile:{...C.profile,avatar:((Pe=C.profile)==null?void 0:Pe.avatar)||C.avatar,name:C.name,email:((ie=C.profile)==null?void 0:ie.email)||C.email}},console.log("Fallback teacher data for modal:",W),F(W),ce(!0)},ke=C=>{const W=i.find(X=>X.id===C);W&&(re(W),te(!0)),V(!1)},dt=C=>{console.log("🔍 StudentHome handleMessage DEBUG:"),console.log("- Student user:",{id:f==null?void 0:f.id,name:f==null?void 0:f.name,role:f==null?void 0:f.role}),console.log("- Target teacher ID:",C);const W=i.find(X=>X.id===C);if(console.log("- Found teacher:",W),W&&f){console.log("- Sending message to teacher:",{studentId:f.id,teacherId:C,studentName:f.name,teacherName:W.name});const X=g(f.id,f.name,C,W.name,`Привет! Меня зовут ${f.name}. Можете ли вы помочь мне с обучением?`);console.log("- Message sent, chat ID:",X),t("chats")}else console.log("❌ Teacher not found or user not available");console.log("🔍 END StudentHome DEBUG"),V(!1)};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-3",children:"Найди своего идеального репетитора"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Изучай профили преподавателей, связывайся с ними и записывайся на уроки"})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:n?e.jsxs("div",{className:"flex items-center space-x-2 bg-amber-50 border border-amber-200 rounded-full px-4 py-2",children:[e.jsx(ci,{className:"h-4 w-4 text-amber-600"}),e.jsx("span",{className:"text-sm font-medium text-amber-700",children:"Офлайн режим (кэшированные данные)"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"ml-2 text-xs bg-amber-100 text-amber-700 px-3 py-1 rounded-full hover:bg-amber-200 transition-colors",children:"Переподключиться"})]}):a?e.jsxs("div",{className:"flex items-center space-x-2 bg-green-50 border border-green-200 rounded-full px-4 py-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx(di,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Подключено в реальном времени"})]}):e.jsxs("div",{className:"flex items-center space-x-2 bg-red-50 border border-red-200 rounded-full px-4 py-2",children:[e.jsx(ci,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-700",children:"Нет подключения к серверу"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"ml-2 text-xs bg-red-100 text-red-700 px-3 py-1 rounded-full hover:bg-red-200 transition-colors",children:"Переподключиться"})]})})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap justify-center gap-4",children:[e.jsxs("button",{onClick:()=>v(!0),className:"group bg-gradient-to-r from-green-500 via-emerald-500 to-teal-500 text-white px-6 py-3 rounded-xl font-semibold text-base hover:from-green-600 hover:via-emerald-600 hover:to-teal-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Ge,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Овербукинг"}),e.jsx("div",{className:"text-xs opacity-90",children:"Автоподбор"})]})]}),e.jsxs("button",{onClick:()=>K(!0),className:"group bg-gradient-to-r from-purple-500 via-pink-500 to-rose-500 text-white px-6 py-3 rounded-xl font-semibold text-base hover:from-purple-600 hover:via-pink-600 hover:to-rose-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Qe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Календарь"}),e.jsx("div",{className:"text-xs opacity-90",children:"Слоты"})]})]}),e.jsxs("button",{onClick:Nt,disabled:w,className:"group bg-gradient-to-r from-blue-500 to-indigo-500 text-white px-5 py-3 rounded-xl font-semibold text-base hover:from-blue-600 hover:to-indigo-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2 disabled:opacity-50 disabled:transform-none",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Hr,{className:`h-5 w-5 ${w?"animate-spin":""}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Обновить"}),e.jsx("div",{className:"text-xs opacity-90",children:"Данные"})]})]}),e.jsxs("button",{onClick:je,disabled:w,className:"group bg-gradient-to-r from-green-500 to-emerald-500 text-white px-5 py-3 rounded-xl font-semibold text-base hover:from-green-600 hover:to-emerald-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2 disabled:opacity-50 disabled:transform-none",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(di,{className:`h-5 w-5 ${w?"animate-pulse":""}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Синхронизация"}),e.jsx("div",{className:"text-xs opacity-90",children:"Сервер"})]})]}),e.jsxs("button",{onClick:ue,disabled:w,className:"group bg-gradient-to-r from-purple-500 to-pink-500 text-white px-5 py-3 rounded-xl font-semibold text-base hover:from-purple-600 hover:to-pink-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2 disabled:opacity-50 disabled:transform-none",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Zs,{className:`h-5 w-5 ${w?"animate-pulse":""}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Обновить"}),e.jsx("div",{className:"text-xs opacity-90",children:"Репетиторов"})]})]}),e.jsxs("button",{onClick:Le,disabled:w,className:"group bg-gradient-to-r from-indigo-500 to-blue-500 text-white px-5 py-3 rounded-xl font-semibold text-base hover:from-indigo-600 hover:to-blue-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2 disabled:opacity-50 disabled:transform-none",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Hr,{className:`h-5 w-5 ${w?"animate-pulse":""}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Загрузить"}),e.jsx("div",{className:"text-xs opacity-90",children:"Локальные"})]})]}),e.jsxs("button",{onClick:()=>{console.log("🔄 Принудительное обновление компонента..."),window.location.reload()},className:"group bg-gradient-to-r from-orange-500 to-red-500 text-white px-5 py-3 rounded-xl font-semibold text-base hover:from-orange-600 hover:to-red-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Hr,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Обновить"}),e.jsx("div",{className:"text-xs opacity-90",children:"Страницу"})]})]})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative group",children:[e.jsx(Kr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{type:"text",value:he,onChange:C=>ge(C.target.value),placeholder:"🔍 Поиск по предмету, преподавателю или городу...",className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base placeholder-gray-400"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>x(!h),className:`flex items-center space-x-2 px-4 py-2.5 rounded-xl font-medium transition-all duration-200 text-sm ${h?"bg-blue-600 text-white shadow-md":"bg-white border-2 border-gray-200 text-gray-700 hover:border-blue-300 hover:bg-blue-50"}`,children:[e.jsx(nn,{className:"h-4 w-4"}),e.jsx("span",{children:"Фильтры"}),(Object.keys(m).length>0||Y||ae||he.trim())&&e.jsx("span",{className:"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded-full text-xs font-bold",children:Object.keys(m).length+(Y?1:0)+(ae?1:0)+(he.trim()?1:0)})]}),e.jsx("button",{onClick:Fe,disabled:w,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2.5 rounded-xl font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 flex items-center space-x-2 text-sm",children:w?e.jsxs(e.Fragment,{children:[e.jsx(Hr,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Применение..."})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Применить"})})}),(Object.keys(m).length>0||Y||ae||he.trim())&&e.jsx("button",{onClick:Je,className:"bg-white border-2 border-gray-300 text-gray-700 px-4 py-2.5 rounded-xl font-medium hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 text-sm",children:"Сбросить"})]})]}),h&&e.jsxs("div",{className:"bg-white p-6 rounded-2xl border-2 border-gray-100 shadow-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Класс"}),e.jsxs("select",{value:m.grade||"",onChange:C=>y({...m,grade:C.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой класс"}),J.map(C=>e.jsx("option",{value:C,children:C},C))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Предмет"}),e.jsxs("select",{value:m.subject||"",onChange:C=>y({...m,subject:C.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой предмет"}),ye.map(C=>e.jsx("option",{value:C,children:C},C))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Опыт"}),e.jsxs("select",{value:m.experience||"",onChange:C=>y({...m,experience:C.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой опыт"}),Ee.map(C=>e.jsx("option",{value:C,children:$(C)},C))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Формат"}),e.jsxs("select",{value:m.format||"",onChange:C=>y({...m,format:C.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой формат"}),Z.map(C=>e.jsx("option",{value:C,children:C==="online"?"Онлайн":C==="offline"?"Оффлайн":"Мини-группа"},C))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Длительность"}),e.jsxs("select",{value:m.duration||"",onChange:C=>y({...m,duration:C.target.value?parseInt(C.target.value):void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любая длительность"}),Ne.map(C=>e.jsxs("option",{value:C,children:[C," мин"]},C))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Мин. рейтинг"}),e.jsxs("select",{value:m.minRating||"",onChange:C=>y({...m,minRating:C.target.value?parseFloat(C.target.value):void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой рейтинг"}),e.jsx("option",{value:"4",children:"4+ звезды"}),e.jsx("option",{value:"4.5",children:"4.5+ звезды"}),e.jsx("option",{value:"5",children:"5 звезд"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Город"}),e.jsx("input",{type:"text",value:m.city||"",onChange:C=>y({...m,city:C.target.value}),placeholder:"Введите город",className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Цели обучения"}),e.jsxs("select",{value:((Lr=m.goals)==null?void 0:Lr[0])||"",onChange:C=>y({...m,goals:C.target.value?[C.target.value]:void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любые цели"}),pe.map(C=>e.jsx("option",{value:C,children:C},C))]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4 text-center",children:"Выберите дату и время"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Дата"}),e.jsx("div",{className:"border-2 border-gray-200 rounded-2xl overflow-hidden shadow-lg",children:e.jsx(Kn,{localizer:tt,events:[],startAccessor:"start",endAccessor:"end",style:{height:280},views:["month"],view:"month",selectable:!0,onSelectSlot:C=>{A(C.start)},onSelectEvent:()=>{}})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Время"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Начало"}),e.jsx("input",{type:"time",value:(ae==null?void 0:ae.start)||"",onChange:C=>me(W=>({start:C.target.value,end:(W==null?void 0:W.end)||"23:00"})),className:"w-full p-3 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Конец"}),e.jsx("input",{type:"time",value:(ae==null?void 0:ae.end)||"",onChange:C=>me(W=>({start:(W==null?void 0:W.start)||"00:00",end:C.target.value})),className:"w-full p-3 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base"})]})]}),Y&&e.jsxs("div",{className:"mt-4 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Qe,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Выбрана дата:"})]}),e.jsx("p",{className:"text-base font-medium text-blue-900",children:ze(Y,"dd MMMM yyyy",{locale:xt})})]})]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:j.length>0?`Найдено ${j.length} преподавателей`:"Преподаватели"}),e.jsx("p",{className:"text-gray-500 text-sm",children:j.length>0?"Выберите подходящего преподавателя для связи или бронирования урока":"Попробуйте изменить фильтры или воспользоваться овербукингом"}),e.jsxs("div",{className:"mt-2 text-xs text-gray-400",children:["Всего загружено: ",D.length," репетиторов | Серверных: ",Ke.length," | Из контекста: ",(i==null?void 0:i.filter(C=>C.role==="teacher").length)||0," | Локальных профилей: ",Object.keys(p).length]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:j.length===0?e.jsx(D3,{title:Object.keys(m).length>0||Y||ae?"Нет преподавателей подходящих под фильтры":"Нет зарегистрированных преподавателей",description:Object.keys(m).length>0||Y||ae?"Попробуйте изменить фильтры или воспользоваться овербукингом":"Попробуйте воспользоваться овербукингом или обратитесь к администратору",actionPrimary:{label:"Овербукинг",onClick:()=>v(!0)},actionSecondary:{label:"Сбросить фильтры",onClick:Je,variant:"secondary"}}):e.jsx(e.Fragment,{children:j.map(C=>{const W=C.profile,Se=s.filter(fe=>fe.teacherId===C.id).filter(fe=>!fe.isBooked).length>0;return e.jsxs("div",{className:"bg-white rounded-3xl border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer group overflow-hidden transform hover:-translate-y-2",onClick:()=>de(C),children:[e.jsxs("div",{className:"h-32 relative overflow-hidden",style:{background:W!=null&&W.cardBackground?W.cardBackground.startsWith("http")||W.cardBackground.startsWith("data:")?`url(${W.cardBackground}) center/cover`:W.cardBackground:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsxs("div",{className:"absolute top-3 right-3 flex items-center space-x-2",children:[e.jsx("button",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-full text-white hover:bg-white/30 transition-colors border border-white/30",onClick:fe=>{fe.stopPropagation()},children:e.jsx(vt,{className:"h-3 w-3"})}),e.jsx("button",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-full text-white hover:bg-white/30 transition-colors border border-white/30",onClick:fe=>{fe.stopPropagation()},children:e.jsx(zt,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"relative -mt-12 flex justify-center",children:e.jsxs("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-2 border-white rounded-full shadow-lg",title:"Доступен для контакта"}),(()=>{const fe=(W==null?void 0:W.avatar)||C.avatar;return fe&&fe.trim()!==""&&fe!=="undefined"&&fe!=="null"?e.jsx("img",{src:fe,alt:C.name,className:"w-32 h-32 object-cover rounded-full",onError:ie=>{const ve=ie.target;ve.style.display="none";const Be=ve.nextElementSibling;Be&&Be.classList.remove("hidden")},onLoad:ie=>{const Be=ie.target.nextElementSibling;Be&&Be.classList.add("hidden")}}):null})(),e.jsx("div",{className:`w-32 h-32 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${(()=>{const fe=(W==null?void 0:W.avatar)||C.avatar;return fe&&fe.trim()!==""&&fe!=="undefined"&&fe!=="null"?"hidden":""})()}`,children:e.jsx(be,{className:"h-16 w-16 text-white"})})]})}),e.jsxs("div",{className:"px-6 pb-6 pt-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:(W==null?void 0:W.name)||C.name||"Репетитор"}),e.jsx("p",{className:"text-sm text-gray-600",children:(W==null?void 0:W.teacherType)==="private"?"Частный преподаватель":(W==null?void 0:W.teacherType)==="school"?"Преподаватель школы":(W==null?void 0:W.teacherType)==="both"?"Частный + Школа":"Частный преподаватель"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-600 mb-4",children:[(W==null?void 0:W.age)&&e.jsxs("span",{children:["возраст ",W.age," лет"]}),(W==null?void 0:W.experienceYears)&&e.jsxs("span",{children:["стаж ",W.experienceYears," лет"]})]}),e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsxs("div",{className:"flex items-center space-x-1 bg-green-50 px-3 py-1.5 rounded-full",children:[e.jsx(Ie,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:W!=null&&W.reviewsCount&&W.reviewsCount>0?`${W.reviewsCount} отзывов`:"отзывов нет"})]})}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-sm text-gray-600",children:[e.jsx(Et,{className:"h-4 w-4"}),e.jsx("span",{children:(W==null?void 0:W.city)||"Город не указан"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:fe=>{fe.stopPropagation(),Se?(re(C),te(!0)):de(C)},className:`w-full py-3 rounded-xl font-semibold transition-all duration-200 text-base ${Se?"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1":"bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1"}`,children:Se?"Забронировать урок":"Связаться с репетитором"}),e.jsx("button",{onClick:fe=>{fe.stopPropagation(),de(C)},className:"w-full py-2 text-gray-500 hover:text-blue-600 transition-colors text-sm font-medium",children:"Подробнее →"})]})]})]},C.id)})})})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Овербукинг - Автоподбор преподавателя"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Заполните форму, и мы автоматически подберем лучшего доступного преподавателя за 5 часов до занятия"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Класс"}),e.jsxs("select",{value:S.grade,onChange:C=>_({...S,grade:C.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Выберите класс"}),J.map(C=>e.jsx("option",{value:C,children:C},C))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предмет"}),e.jsxs("select",{value:S.subject,onChange:C=>_({...S,subject:C.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Выберите предмет"}),ye.map(C=>e.jsx("option",{value:C,children:C},C))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата занятия"}),e.jsx("input",{type:"date",value:S.date,onChange:C=>_({...S,date:C.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Время начала"}),e.jsx("input",{type:"time",value:S.startTime,onChange:C=>_({...S,startTime:C.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цель занятий"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:pe.map(C=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:S.goals.includes(C),onChange:W=>{W.target.checked?_({...S,goals:[...S.goals,C]}):_({...S,goals:S.goals.filter(X=>X!==C)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:C})]},C))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Опыт преподавателя"}),e.jsxs("select",{value:S.experience,onChange:C=>_({...S,experience:C.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Любой"}),Ee.map(C=>e.jsx("option",{value:C,children:$(C)},C))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Продолжительность"}),e.jsx("select",{value:S.duration,onChange:C=>_({...S,duration:Number(C.target.value)}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Ne.map(C=>e.jsxs("option",{value:C,children:[C," мин"]},C))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Формат"}),e.jsx("select",{value:S.format,onChange:C=>_({...S,format:C.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Z.map(C=>e.jsx("option",{value:C,children:C==="online"?"Онлайн":C==="offline"?"Оффлайн":"Мини-группа"},C))})]})]}),S.format==="offline"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Город"}),e.jsx("input",{type:"text",value:S.city,onChange:C=>_({...S,city:C.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Введите ваш город"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Примечание"}),e.jsx("textarea",{value:S.comment,onChange:C=>_({...S,comment:C.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Например: хочу разобрать домашнее задание или подготовиться к контрольной..."})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-6",children:[e.jsx("button",{onClick:b,disabled:!S.grade||!S.subject||!S.date||!S.startTime,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white py-3 px-4 rounded-lg font-medium hover:from-green-600 hover:to-emerald-600 transition-all duration-200 disabled:opacity-50",children:"Отправить заявку"}),e.jsx("button",{onClick:()=>v(!1),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Отмена"})]})]})})}),ne&&M&&e.jsx(C3,{teacher:M,onClose:()=>ce(!1),onBookLesson:C=>{ce(!1),ke(C)},onMessage:C=>{ce(!1),dt(C)}}),P&&T&&f&&e.jsx(ei,{isOpen:P,onClose:()=>{B(!1),z(null)},onConfirm:O,slot:T,teacher:I(T.teacherId),student:f}),U&&M&&e.jsx(Xc,{teacher:M,onClose:()=>V(!1),onBookLesson:ke,onMessage:dt}),L&&e.jsx(Qc,{onClose:()=>K(!1)}),q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center",children:e.jsx(be,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Календарь ",(se==null?void 0:se.name)||"Преподавателя"]}),e.jsx("p",{className:"text-gray-600",children:"Выберите удобное время для занятия"})]})]}),e.jsx("button",{onClick:()=>{te(!1),re(null)},className:"p-2 rounded-full hover:bg-gray-100",children:e.jsx(at,{className:"w-5 h-5 text-gray-600"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{const C=new Date(k);C.setDate(C.getDate()-7),H(C)},className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[k.toLocaleDateString("ru-RU",{day:"numeric",month:"long"})," — ",new Date(k.getTime()+6*24*60*60*1e3).toLocaleDateString("ru-RU",{day:"numeric",month:"long"})]}),e.jsx("button",{onClick:()=>{const C=new Date(k);C.setDate(C.getDate()+7),H(C)},className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("button",{onClick:()=>{const C=new Date,W=C.getDay(),X=C.getDate()-W+(W===0?-6:1);H(new Date(C.setDate(X)))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:"Сегодня"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-200 bg-gray-50",children:[e.jsx("div",{className:"w-20 p-3 border-r border-gray-200"}),Array.from({length:7},(C,W)=>{const X=new Date(k);return X.setDate(X.getDate()+W),e.jsxs("div",{className:"flex-1 p-3 border-r border-gray-200 last:border-r-0 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.toLocaleDateString("ru-RU",{weekday:"short"})}),e.jsx("div",{className:"text-xs text-gray-600",children:X.toLocaleDateString("ru-RU",{day:"numeric",month:"short"})})]},W)})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:Array.from({length:24},(C,W)=>W).map(C=>e.jsxs("div",{className:"flex border-b border-gray-200 last:border-b-0",children:[e.jsxs("div",{className:"w-20 bg-gray-50 p-3 border-r border-gray-200 flex items-center justify-center text-sm font-medium text-gray-600 sticky left-0",children:[C.toString().padStart(2,"0"),":00"]}),Array.from({length:7},(W,X)=>{const le=new Date(k);le.setDate(le.getDate()+X);const Se=le.toISOString().split("T")[0],fe=s.filter(Pe=>Pe.teacherId===(se==null?void 0:se.id)&&!Pe.isBooked&&Pe.date===Se&&parseInt(Pe.startTime.split(":")[0])===C);return e.jsx("div",{className:"flex-1 p-3 border-r border-gray-200 last:border-r-0 min-h-[60px]",children:fe.map(Pe=>e.jsxs("div",{className:"bg-blue-100 border border-blue-300 rounded-lg p-2 mb-2 cursor-pointer hover:bg-blue-200 transition-colors",onClick:()=>{f&&(z(Pe),B(!0),te(!1),re(null))},children:[e.jsxs("div",{className:"text-xs font-medium text-blue-900",children:[Pe.startTime," - ",Pe.endTime]}),e.jsx("div",{className:"text-xs text-blue-700",children:Pe.subject}),e.jsxs("div",{className:"text-xs text-blue-600",children:[Pe.price," ₽"]})]},Pe.id))},X)})]},C))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["Доступные слоты: ",s.filter(C=>C.teacherId===(se==null?void 0:se.id)&&!C.isBooked).length]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Нажмите на любой слот в календаре для бронирования"})]})]})]})})]})},Ia=()=>{const{timeSlots:t,lessons:r,createSlot:s,cancelLesson:a,getOrCreateChat:n,completeLesson:i,deleteSlot:o,isConnected:l,socketRef:c}=ct(),{user:d}=Ye(),[g,p]=E.useState(!1),[f,m]=E.useState({date:"",startTime:"",duration:60,subject:"",lessonType:"regular",format:"online",price:1e3}),[y,h]=R.useState(null),[x,w]=R.useState(!1),[u,N]=R.useState(null),[v,S]=E.useState(!1),[_,P]=E.useState([]),[B,T]=E.useState(null),[z,L]=E.useState(!1);R.useEffect(()=>{c.current&&(d!=null&&d.id)&&l&&c.current.emit("subscribeOverbooking",d.id)},[c.current,d==null?void 0:d.id,l]),R.useEffect(()=>{if(!c.current)return;const G=()=>{d!=null&&d.id&&(d!=null&&d.profile)&&l&&c.current.emit("subscribeOverbooking",d.id)};return c.current.off("connect",G),c.current.on("connect",G),d!=null&&d.id&&(d!=null&&d.profile)&&(c.current.emit("subscribeOverbooking",d.id),c.current.on("overbookingRequests",je=>{P(je),setTimeout(()=>{},100)}),c.current.on("newOverbookingRequest",je=>{P(ue=>[...ue,je])}),c.current.on("overbookingRequestAccepted",je=>{P(ue=>ue.filter(Le=>Le.id!==je.id))})),()=>{c.current&&(c.current.off("overbookingRequests"),c.current.off("newOverbookingRequest"),c.current.off("overbookingRequestAccepted"),c.current.off("connect",G))}},[d==null?void 0:d.id,d==null?void 0:d.profile,l]),R.useEffect(()=>{d&&d.profile&&Array.isArray(d.profile.subjects)&&d.profile.subjects.length>=1&&m(G=>({...G,subject:d.profile.subjects[0]}))},[d]);const q=t.filter(G=>G.teacherId===(d==null?void 0:d.id)).filter(G=>!G.isBooked),te=r.filter(G=>G.teacherId===(d==null?void 0:d.id)),se=te.filter(G=>G.status==="scheduled"),re=te.filter(G=>G.status==="completed"),k=(G,je)=>{const ue=new Date(`${G.date}T${G.startTime}`),Le=new Date(`${je.date}T${je.startTime}`);return ue.getTime()-Le.getTime()},H=[...q].sort(k),Y=[...se].sort(k),A=[...re].sort(k),ae=()=>{if(!d||!f.date||!f.startTime||!f.subject){alert("Пожалуйста, заполните все обязательные поля");return}const G=new Date(`2000-01-01T${f.startTime}`),je=new Date(G.getTime()+f.duration*6e4);let ue;d.profile&&d.role==="teacher"&&(ue=d.profile);const Le={teacherId:d.id,teacherName:d.name,teacherAvatar:d.avatar,date:f.date,startTime:f.startTime,endTime:je.toTimeString().slice(0,5),duration:f.duration,subject:f.subject,lessonType:f.lessonType,format:f.format,price:f.price,experience:(ue==null?void 0:ue.experience)||"beginner",goals:(ue==null?void 0:ue.goals)||[],grades:(ue==null?void 0:ue.grades)||[],rating:ue==null?void 0:ue.rating,bio:(ue==null?void 0:ue.bio)||"",...f.format==="offline"&&(ue!=null&&ue.city)?{city:ue.city}:{}};s(Le),p(!1),m({date:"",startTime:"",duration:60,subject:"",lessonType:"regular",format:"online",price:1e3})},me=G=>{d&&(h(G),N(null),w(!0))},he=G=>{d&&(N(G),h(null),w(!0))},ge=()=>{w(!1),h(null),N(null)},ye=async G=>{var ue,Le,_e,xe,Fe,Je;if(!d)return;c.current&&c.current.emit("acceptOverbookingRequest",{requestId:G.id,teacherId:d.id});const je={teacherId:d.id,teacherName:d.name,teacherAvatar:d.avatar||"",date:G.date||new Date().toISOString().slice(0,10),startTime:G.startTime||"15:00",endTime:G.endTime||"16:00",duration:G.duration||60,subject:G.subject,lessonType:"regular",format:G.format,price:1e3,experience:((ue=d.profile)==null?void 0:ue.experience)||"beginner",goals:((Le=d.profile)==null?void 0:Le.goals)||[],grades:((_e=d.profile)==null?void 0:_e.grades)||[],rating:(xe=d.profile)==null?void 0:xe.rating,bio:((Fe=d.profile)==null?void 0:Fe.bio)||"",city:((Je=d.profile)==null?void 0:Je.city)||""};await s(je,G.studentId,G.studentName),S(!1),alert("Вы приняли заявку. Слот создан и забронирован!")},J=G=>{switch(G){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return G}},pe=G=>{switch(G){case"trial":return"Пробный";case"regular":return"Обычный";default:return G}},Ee=({slot:G,isBooked:je,onClick:ue})=>e.jsx("div",{className:`card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden border-l-4 ${je?"border-green-500":"border-blue-500"} cursor-pointer`,onClick:ue,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 leading-tight mb-1",children:G.subject}),e.jsxs("div",{className:"text-xs text-gray-500",children:[G.date," • ",G.startTime,"–",G.endTime]})]})}),Z=({lesson:G,status:je,onClick:ue})=>e.jsx("div",{className:`card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden border-l-4 ${je==="completed"?"border-gray-400":"border-green-500"} cursor-pointer`,onClick:ue,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 leading-tight mb-1",children:G.subject}),e.jsxs("div",{className:"text-xs text-gray-500",children:[G.date," • ",G.startTime,"–",G.endTime]})]})}),Ne=(d==null?void 0:d.profile)&&"overbookingEnabled"in d.profile&&d.profile.overbookingEnabled,Oe=d!=null&&d.profile&&"subjects"in d.profile?d.profile.subjects:[],tt=[45,60,90],Ke=["regular","trial"],Me=["online","offline","mini-group"];return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 relative",children:[Ne&&e.jsxs("button",{className:"absolute top-0 right-0 p-2 rounded-full hover:bg-gray-100 transition z-10",title:"Уведомления",onClick:()=>S(!0),children:[e.jsx(Gr,{className:"w-7 h-7 text-blue-500"}),_.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full text-xs px-1.5 py-0.5",children:_.length})]}),e.jsx("h1",{className:"text-3xl font-bold gradient-text mb-2",children:"Управление слотами"}),e.jsx("p",{className:"text-gray-600",children:"Создавайте временные слоты для уроков и управляйте своим расписанием"})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:()=>S(!1),title:"Закрыть",children:e.jsx(at,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Заявки на овербукинг"}),_.length===0?e.jsx("div",{className:"text-gray-500 text-center",children:"Нет новых заявок"}):e.jsx("div",{className:"space-y-2",children:_.map(G=>e.jsxs("div",{className:"flex items-center gap-2 border rounded-lg px-3 py-2 bg-purple-50 cursor-pointer hover:bg-purple-100 transition",onClick:()=>{T(G),L(!0)},children:[e.jsx("span",{className:"font-semibold text-purple-800",children:G.studentName}),e.jsx("span",{className:"text-xs text-gray-500",children:G.subject}),e.jsx("span",{className:"text-xs text-gray-500",children:G.startTime||"—"})]},G.id))})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>p(!0),className:"btn-primary flex items-center space-x-2",children:[e.jsx(yr,{className:"h-5 w-5"}),e.jsx("span",{children:"Создать новый слот"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700 mb-4",children:"Свободные слоты"}),H.length>0?e.jsx("div",{className:"space-y-4",children:H.map(G=>e.jsx(Ee,{slot:G,isBooked:!1,onClick:()=>me(G)},G.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет свободных слотов"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-green-700 mb-4",children:"Забронированные уроки"}),Y.length>0?e.jsx("div",{className:"space-y-4",children:Y.map(G=>e.jsx(Z,{lesson:G,status:"scheduled",onClick:()=>he(G)},G.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет забронированных уроков"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4",children:"Завершённые уроки"}),A.length>0?e.jsx("div",{className:"space-y-4",children:A.map(G=>e.jsx(Z,{lesson:G,status:"completed",onClick:()=>he(G)},G.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет завершённых уроков"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-purple-700 mb-4",children:"Овербукинг"}),e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет новых заявок"})]})]}),g&&e.jsx("div",{className:"fixed inset-0 modal-backdrop flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"modal-content bg-white rounded-2xl shadow-2xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold gradient-text",children:"Создать новый слот"}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Предмет *"}),e.jsxs("select",{value:f.subject,onChange:G=>m({...f,subject:G.target.value}),className:"input-modern w-full",children:[e.jsx("option",{value:"",children:"Выберите предмет"}),Oe.map(G=>e.jsx("option",{value:G,children:G},G))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Дата *"}),e.jsx("input",{type:"date",value:f.date,onChange:G=>m({...f,date:G.target.value}),className:"input-modern w-full",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Время начала *"}),e.jsx("input",{type:"time",value:f.startTime,onChange:G=>m({...f,startTime:G.target.value}),className:"input-modern w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Длительность"}),e.jsx("select",{value:f.duration,onChange:G=>m({...f,duration:parseInt(G.target.value)}),className:"input-modern w-full",children:tt.map(G=>e.jsxs("option",{value:G,children:[G," минут"]},G))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Цена (₽)"}),e.jsx("input",{type:"number",value:f.price,onChange:G=>m({...f,price:parseInt(G.target.value)}),className:"input-modern w-full",min:"100",step:"100"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Тип урока"}),e.jsx("select",{value:f.lessonType,onChange:G=>m({...f,lessonType:G.target.value}),className:"input-modern w-full",children:Ke.map(G=>e.jsx("option",{value:G,children:pe(G)},G))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Формат"}),e.jsx("select",{value:f.format,onChange:G=>m({...f,format:G.target.value}),className:"input-modern w-full",children:Me.map(G=>e.jsx("option",{value:G,children:J(G)},G))})]})]}),e.jsxs("div",{className:"flex space-x-4 pt-4",children:[e.jsx("button",{onClick:ae,className:"btn-primary flex-1",children:"Создать слот"}),e.jsx("button",{onClick:()=>p(!1),className:"btn-secondary flex-1",children:"Отмена"})]})]})]})})}),x&&(y||u)&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[e.jsx("button",{onClick:ge,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:y?"Детали слота":"Детали урока"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Предмет:"})," ",(y||u).subject]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Дата:"})," ",(y||u).date," ",(y||u).startTime," - ",(y||u).endTime]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Формат:"})," ",(y||u).format]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Цена:"})," ",(y||u).price,"₽"]}),y&&y.studentName&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",y.studentName]}),u&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",u.studentName]}),((u==null?void 0:u.comment)||(y==null?void 0:y.comment))&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-blue-900",children:[e.jsx("span",{className:"font-medium",children:"Комментарий ученика:"})," ",(u==null?void 0:u.comment)||(y==null?void 0:y.comment)]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[y&&y.isBooked&&y.studentId&&d&&e.jsxs("button",{onClick:()=>{n(d.id,y.studentId,d.name,y.studentName),ge()},className:"flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200",children:[e.jsx(Ie,{className:"w-5 h-5"})," Чат с учеником"]}),y&&y.isBooked&&y.format==="online"&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Видеозвонок"})]})}),y&&y.isBooked&&e.jsxs("button",{onClick:()=>{i(y.lessonId),ge()},className:"flex items-center gap-2 bg-amber-100 text-amber-700 px-4 py-2 rounded-lg hover:bg-amber-200",children:[e.jsx(qr,{className:"w-5 h-5"})," Завершить урок"]}),y&&e.jsx("button",{onClick:()=>{o(y.id),ge()},className:"absolute top-4 left-4 text-red-500 hover:text-red-700",children:e.jsx(Jr,{className:"w-6 h-6"})}),u&&u.status==="scheduled"&&d&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{n(d.id,u.studentId,d.name,u.studentName),ge()},className:"flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200",children:[e.jsx(Ie,{className:"w-5 h-5"})," Чат с учеником"]}),u.format==="online"&&e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Видеозвонок"})]}),e.jsxs("button",{onClick:()=>{i(u.id),ge()},className:"flex items-center gap-2 bg-amber-100 text-amber-700 px-4 py-2 rounded-lg hover:bg-amber-200",children:[e.jsx(qr,{className:"w-5 h-5"})," Завершить урок"]})]}),u&&u.status==="completed"&&e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg text-center text-gray-800",children:"Урок завершён"})]})]})}),z&&B&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[e.jsx("button",{onClick:()=>{L(!1),T(null)},className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Заявка на овербукинг"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",B.studentName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Предмет:"})," ",B.subject]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Класс:"})," ",B.grade]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Формат:"})," ",B.format]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Длительность:"})," ",B.duration," мин"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Время:"})," ",B.startTime||"—"," - ",B.endTime||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Цели:"})," ",Array.isArray(B.goals)?B.goals.join(", "):B.goals]}),B.comment&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-blue-900",children:[e.jsx("span",{className:"font-medium",children:"Комментарий:"})," ",B.comment]})]}),e.jsx("button",{className:"mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",onClick:()=>{ye(B),L(!1),T(null)},children:"Забронировать слот"})]})})]})},T3={ru:xt},O3=Jn({format:ze,startOfWeek:_t,getDay:Qn,locales:T3}),Zc=({mode:t,student:r,onAssign:s})=>{const{timeSlots:a,lessons:n,bookLesson:i,createSlot:o}=ct(),{user:l}=Ye(),[c,d]=E.useState(null),[g,p]=E.useState(!1),[f,m]=E.useState(""),[y,h]=E.useState(!1),[x,w]=E.useState(!1),[u,N]=E.useState({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),[v,S]=E.useState(!1),[_,P]=E.useState(null),[B,T]=E.useState(!1),[z,L]=E.useState(""),K=a.filter(J=>{if(J.teacherId!==(l==null?void 0:l.id)||J.status==="completed")return!1;if(t==="assign"&&r){if(J.isBooked&&J.bookedStudentId!==r.id)return!1}else if(J.isBooked)return!1;return!0}),q=n.filter(J=>J.teacherId===(l==null?void 0:l.id)&&J.status!=="completed"),te=t==="assign"?a.filter(J=>J.teacherId===(l==null?void 0:l.id)&&J.status!=="completed"):K,se=t==="assign"?n.filter(J=>J.teacherId===(l==null?void 0:l.id)&&J.status!=="completed"):q,re=te.map(J=>({id:J.id,title:`${J.subject} - ${J.isBooked?"Забронирован":"Свободен"}`,start:new Date(`${J.date}T${J.startTime}`),end:new Date(`${J.date}T${J.endTime}`),resource:J,type:"slot",isBooked:J.isBooked,subject:J.subject,price:J.price,format:J.format,lessonType:J.lessonType})),k=se.map(J=>({id:J.id,title:`${J.subject} - ${J.studentName}`,start:new Date(`${J.date}T${J.startTime}`),end:new Date(`${J.date}T${J.endTime}`),resource:J,type:"lesson",studentName:J.studentName,subject:J.subject,price:J.price,format:J.format,status:J.status})),H=[...re,...k],Y=E.useCallback(J=>{let pe={borderRadius:"8px",border:"none",padding:"4px 8px",fontSize:"12px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",transition:"all 0.2s ease"};return J.type==="slot"?J.isBooked?(pe.backgroundColor="#10b981",pe.color="white"):(pe.backgroundColor="#3b82f6",pe.color="white"):J.type==="lesson"&&(pe.backgroundColor="#f59e0b",pe.color="white"),{style:pe}},[]),A=E.useCallback(J=>{d(J),p(!0),m("")},[]),ae=()=>{p(!1),d(null),m("")},me=async J=>{t==="assign"&&r&&(await i(J.id,r.id,r.name),s&&s())},he=E.useCallback(J=>{const{start:pe,end:Ee}=J,Z=ze(pe,"yyyy-MM-dd"),Ne=ze(pe,"HH:mm"),Oe=ze(Ee,"HH:mm");N({date:Z,startTime:Ne,endTime:Oe,subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),w(!0)},[]),ge=async()=>{if(!l||!u.subject.trim()){alert("Пожалуйста, заполните все обязательные поля");return}if(!u.startTime||!u.endTime||u.startTime>=u.endTime){alert("Проверьте корректность времени начала и окончания");return}S(!0);try{if(t==="assign"&&r){await o({...u,teacherId:l.id,teacherName:l.name,duration:60,lessonType:u.lessonType,format:u.format,experience:u.experience,goals:u.goals||[],grades:u.grades||[]},r.id,r.name,{mode:"assign"}),w(!1),N({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]});return}await o({...u,teacherId:l.id,teacherName:l.name,duration:60,lessonType:u.lessonType,format:u.format,experience:u.experience,goals:u.goals||[],grades:u.grades||[]}),w(!1),N({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),alert("Слот успешно создан!")}catch{alert("Ошибка при создании слота")}finally{S(!1)}},ye=async J=>{if(r){T(!0);try{await i(J.id,r.id,r.name),L(`Урок назначен для ${r.name}`),setTimeout(()=>{L(""),P(null),s&&s()},1200)}catch{alert("Ошибка при бронировании слота")}finally{T(!1)}}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 p-2",children:[e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-1",children:"Календарь занятий"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Управляйте своим расписанием и отслеживайте забронированные уроки"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"p-3",children:e.jsx(Kn,{localizer:O3,events:H,startAccessor:"start",endAccessor:"end",style:{height:400},eventPropGetter:Y,onSelectEvent:A,onSelectSlot:he,selectable:!0,views:["month","week","day"],messages:{next:"Следующий",previous:"Предыдущий",today:"Сегодня",month:"Месяц",week:"Неделя",day:"День",noEventsInRange:"Нет событий в выбранном диапазоне",showMore:J=>`+${J} еще`},className:"custom-calendar"})})}),e.jsxs("div",{className:"mt-3 bg-white rounded-lg shadow-sm border border-gray-100 p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Легенда"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Свободные слоты"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Забронированные слоты"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Запланированные уроки"})]})]})]})]}),g&&c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-xs w-full p-3 transform transition-all duration-300 scale-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900",children:c.type==="slot"?"Детали слота":"Детали урока"}),e.jsx("button",{onClick:ae,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Предмет:"}),e.jsx("p",{className:"text-xs text-gray-900",children:c.subject})]}),c.type==="slot"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Статус:"}),e.jsx("p",{className:`text-xs font-medium ${c.isBooked?"text-green-600":"text-blue-600"}`,children:c.isBooked?"Забронирован":"Свободен"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Тип урока:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:c.lessonType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Формат:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:c.format})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Цена:"}),e.jsxs("p",{className:"text-xs text-gray-900",children:[c.price," ₽"]})]}),!c.isBooked&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Имя студента для бронирования:"}),e.jsx("input",{type:"text",value:f,onChange:J=>m(J.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"Введите имя студента"}),e.jsx("button",{onClick:()=>me(c.resource),disabled:y,className:"mt-2 px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:y?"Бронирую...":"Забронировать слот"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Ученик:"}),e.jsx("p",{className:"text-xs text-gray-900",children:c.studentName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Статус:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:c.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Формат:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:c.format})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Цена:"}),e.jsxs("p",{className:"text-xs text-gray-900",children:[c.price," ₽"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Время:"}),e.jsxs("p",{className:"text-gray-900 text-xs",children:[ze(c.start,"HH:mm")," - ",ze(c.end,"HH:mm")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Дата:"}),e.jsx("p",{className:"text-gray-900 text-xs",children:ze(c.start,"dd MMMM yyyy",{locale:xt})})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:ae,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Закрыть"})})]})}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-sm w-full p-4 transform transition-all duration-300 scale-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Создать новый слот"}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Предмет *"}),e.jsx("input",{type:"text",value:u.subject,onChange:J=>N({...u,subject:J.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"Например: Математика",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Время начала"}),e.jsx("input",{type:"time",value:u.startTime,onChange:J=>N({...u,startTime:J.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Время окончания"}),e.jsx("input",{type:"time",value:u.endTime,onChange:J=>N({...u,endTime:J.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Тип урока"}),e.jsxs("select",{value:u.lessonType,onChange:J=>N({...u,lessonType:J.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"regular",children:"Обычный"}),e.jsx("option",{value:"trial",children:"Пробный"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Формат"}),e.jsxs("select",{value:u.format,onChange:J=>N({...u,format:J.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"online",children:"Онлайн"}),e.jsx("option",{value:"offline",children:"Офлайн"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Цена (₽)"}),e.jsx("input",{type:"number",value:u.price,onChange:J=>N({...u,price:parseInt(J.target.value)||0}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"1000",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Опыт"}),e.jsxs("select",{value:u.experience,onChange:J=>N({...u,experience:J.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>w(!1),className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Отмена"}),e.jsx("button",{onClick:ge,disabled:v||!u.subject.trim(),className:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:v?"Создаю...":"Создать слот"})]})]})}),t==="assign"&&r&&_&&!_.isBooked&&e.jsx("button",{onClick:()=>ye(_),disabled:B,style:{marginTop:12,padding:"6px 16px",fontSize:14},children:B?"Назначение...":`Забронировать для ${r.name}`}),z&&e.jsx("div",{style:{color:"green",marginTop:8,fontSize:14},children:z})]})},M3={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},_3={background:"#fff",borderRadius:12,boxShadow:"0 2px 16px rgba(0,0,0,0.15)",padding:24,minWidth:320,maxHeight:"90vh",overflowY:"auto",position:"relative"},P3={position:"absolute",top:12,right:16,fontSize:24,background:"none",border:"none",cursor:"pointer",color:"#888"},xr=({open:t,onClose:r,children:s,style:a})=>t?e.jsx("div",{style:M3,onClick:r,children:e.jsxs("div",{style:{..._3,...a},onClick:n=>n.stopPropagation(),children:[e.jsx("button",{style:P3,onClick:r,"aria-label":"Закрыть",children:"×"}),s]})}):null,ti=({onSubmit:t,onCancel:r,initialText:s="",isEditing:a=!1,userName:n="U",userAvatar:i})=>{const[o,l]=E.useState(s),[c,d]=E.useState([]),[g,p]=E.useState([]),f=E.useRef(null),m=w=>{const u=Array.from(w.target.files||[]);if(u.length===0)return;const N=[...c,...u];d(N);const v=u.map(S=>URL.createObjectURL(S));p([...g,...v]),f.current&&(f.current.value="")},y=w=>{const u=c.filter((v,S)=>S!==w),N=g.filter((v,S)=>S!==w);d(u),p(N)},h=()=>{if(!o.trim()&&c.length===0)return;const w=c.length>0?c.some(N=>N.type.startsWith("video/"))?"video":"image":"text",u={text:o.trim(),media:c,type:w};t(u),g.forEach(N=>URL.revokeObjectURL(N))},x=!o.trim()&&c.length===0;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center overflow-hidden",children:i?e.jsx("img",{src:i,alt:n,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:n.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{value:o,onChange:w=>l(w.target.value),placeholder:a?"Редактировать запись...":"Что нового?",className:"w-full border-none resize-none focus:ring-0 text-gray-900 placeholder-gray-500",rows:3}),g.length>0&&e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2",children:g.map((w,u)=>{var N;return e.jsxs("div",{className:"relative group",children:[(N=c[u])!=null&&N.type.startsWith("video/")?e.jsx("video",{src:w,className:"w-full h-24 object-cover rounded-lg",controls:!0}):e.jsx("img",{src:w,alt:"Preview",className:"w-full h-24 object-cover rounded-lg"}),e.jsx("button",{onClick:()=>y(u),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(at,{className:"w-3 h-3"})})]},u)})}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{var w;return(w=f.current)==null?void 0:w.click()},className:"p-2 text-gray-500 hover:text-blue-500 transition-colors",title:"Добавить фото или видео",children:e.jsx(La,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-500 hover:text-blue-500 transition-colors",children:e.jsx(ln,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Отмена"}),e.jsx("button",{onClick:h,disabled:x,className:`px-4 py-2 rounded-lg font-medium transition-colors ${x?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:a?"Сохранить":"Опубликовать"})]})]})]})]}),e.jsx("input",{ref:f,type:"file",multiple:!0,accept:"image/*,video/*",onChange:m,className:"hidden"})]})},sn=({post:t,onReaction:r,onComment:s,onShare:a,onBookmark:n,onEdit:i,onDelete:o})=>{const[l,c]=E.useState(!1),[d,g]=E.useState(""),[p,f]=E.useState(!1),[m,y]=E.useState(!1),h=v=>{r(t.id,v),y(!1)},x=()=>{d.trim()&&(s(t.id,d.trim()),g(""))},w=v=>{i&&(i(t.id,v),f(!1))},u=()=>{o&&o(t.id)},N=v=>{const S=new Date(v),P=Math.floor((new Date().getTime()-S.getTime())/(1e3*60*60));return P<1?"только что":P<24?`${P}ч назад`:P<48?"вчера":S.toLocaleDateString("ru-RU")};return t.reactions.reduce((v,S)=>v+S.count,0),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 mb-4",children:[e.jsx("div",{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:t.userAvatar?e.jsx("img",{src:t.userAvatar,alt:t.userName,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:t.userName.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.userName}),e.jsx("div",{className:"text-sm text-gray-500",children:N(t.date)})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(sl,{className:"w-5 h-5"})}),e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10",children:[i&&e.jsx("button",{onClick:()=>f(!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50",children:"Редактировать"}),o&&e.jsx("button",{onClick:u,className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50",children:"Удалить"})]})]})]})}),p&&i&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx(ti,{onSubmit:({text:v})=>w(v),onCancel:()=>f(!1),initialText:t.text,isEditing:!0})}),!p&&e.jsxs(e.Fragment,{children:[t.text&&e.jsxs("div",{className:"px-4 pb-3",children:[e.jsx("p",{className:"text-gray-900 whitespace-pre-line",children:t.text}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:t.tags.map(v=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-700 font-medium",children:["#",v]},v))})]}),t.media&&t.media.length>0&&e.jsx("div",{className:"px-4 pb-3",children:t.type==="video"?e.jsxs("div",{className:"relative",children:[e.jsx("video",{src:t.media[0],className:"w-full rounded-lg",controls:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Ld,{className:"w-12 h-12 text-white opacity-80"})})]}):e.jsx("div",{className:`grid gap-2 ${t.media.length===1?"grid-cols-1":t.media.length===2?"grid-cols-2":"grid-cols-3"}`,children:t.media.map((v,S)=>e.jsx("div",{className:"relative aspect-square",children:e.jsx("img",{src:v,alt:"Post media",className:"w-full h-full object-cover rounded-lg"})},S))})}),(t.likes&&t.likes>0||t.comments.length>0||t.views&&t.views>0)&&e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[t.likes&&t.likes>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(vt,{className:"w-4 h-4 text-red-500 fill-current"}),e.jsx("span",{children:t.likes})]}),t.comments.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ie,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:t.comments.length})]}),t.views&&t.views>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(vr,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:t.views})]})]}),t.editedAt&&e.jsx("span",{className:"text-xs text-gray-400",children:"ред."})]})}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>y(!m),className:`flex items-center space-x-1 px-3 py-1 rounded-full transition-colors ${t.reactions.some(v=>v.userReacted)?"text-red-500 bg-red-50":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx(vt,{className:`w-5 h-5 ${t.reactions.some(v=>v.userReacted)?"fill-current":""}`}),e.jsx("span",{className:"text-sm",children:"Нравится"})]}),m&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>h("like"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Нравится",children:e.jsx(ol,{className:"w-6 h-6 text-blue-500"})}),e.jsx("button",{onClick:()=>h("love"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Любовь",children:e.jsx(vt,{className:"w-6 h-6 text-red-500"})}),e.jsx("button",{onClick:()=>h("smile"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Улыбка",children:e.jsx(ln,{className:"w-6 h-6 text-yellow-500"})})]})]}),e.jsxs("button",{onClick:()=>c(!l),className:"flex items-center space-x-1 px-3 py-1 rounded-full text-gray-500 hover:bg-gray-50 transition-colors",children:[e.jsx(Ie,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Комментировать"})]}),e.jsxs("button",{onClick:()=>a(t.id),className:"flex items-center space-x-1 px-3 py-1 rounded-full text-gray-500 hover:bg-gray-50 transition-colors",children:[e.jsx(Ud,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Поделиться"})]})]}),e.jsx("button",{onClick:()=>n(t.id),className:`p-2 rounded-full transition-colors ${t.isBookmarked?"text-blue-500 bg-blue-50":"text-gray-500 hover:bg-gray-50"}`,children:e.jsx(Xs,{className:`w-5 h-5 ${t.isBookmarked?"fill-current":""}`})})]})}),l&&e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50",children:[e.jsx("div",{className:"space-y-3 mb-3",children:t.comments.map(v=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:v.userAvatar?e.jsx("img",{src:v.userAvatar,alt:v.userName,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-xs font-medium",children:v.userName.charAt(0).toUpperCase()})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"bg-white rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:v.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:N(v.date)})]}),e.jsx("p",{className:"text-sm text-gray-800",children:v.text})]})})]},v.id))}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:"U"})}),e.jsxs("div",{className:"flex-1 flex items-center space-x-2 bg-white rounded-full px-3 py-2",children:[e.jsx("input",{type:"text",value:d,onChange:v=>g(v.target.value),placeholder:"Написать комментарий...",className:"flex-1 border-none outline-none text-sm",onKeyPress:v=>v.key==="Enter"&&x()}),e.jsx("button",{onClick:x,disabled:!d.trim(),className:`p-1 rounded-full transition-colors ${d.trim()?"text-blue-500 hover:bg-blue-50":"text-gray-400"}`,children:e.jsx(al,{className:"w-4 h-4"})})]})]})]})]})]})},A3=({onSearchResults:t,onClose:r,className:s=""})=>{var re;const{posts:a,searchPosts:n}=ct(),[i,o]=E.useState(""),[l,c]=E.useState([]),[d,g]=E.useState("all"),[p,f]=E.useState(""),[m,y]=E.useState(""),[h,x]=E.useState(""),[w,u]=E.useState("date"),[N,v]=E.useState(!1),[S,_]=E.useState([]),[P,B]=E.useState(!1),T=E.useRef(),z=Array.from(new Set(a.flatMap(k=>k.tags||[]))).sort(),L=Array.from(new Set(a.map(k=>({id:k.userId,name:k.userName})))).filter((k,H,Y)=>H===Y.findIndex(A=>A.id===k.id)),K=()=>{B(!0);const k={query:i.trim()||void 0,tags:l.length>0?l:void 0,userId:p||void 0,dateFrom:m||void 0,dateTo:h||void 0,type:d==="all"?void 0:d,limit:50};let H=[...a];if(k.query){const Y=k.query.toLowerCase();H=H.filter(A=>A.text.toLowerCase().includes(Y)||A.userName.toLowerCase().includes(Y))}k.tags&&k.tags.length>0&&(H=H.filter(Y=>Y.tags&&k.tags.some(A=>Y.tags.includes(A)))),k.userId&&(H=H.filter(Y=>Y.userId===k.userId)),k.type&&(H=H.filter(Y=>Y.type===k.type)),k.dateFrom&&(H=H.filter(Y=>Y.date>=k.dateFrom)),k.dateTo&&(H=H.filter(Y=>Y.date<=k.dateTo)),H.sort((Y,A)=>{switch(w){case"likes":return(A.likes||0)-(Y.likes||0);case"comments":return A.comments.length-Y.comments.length;case"views":return(A.views||0)-(Y.views||0);case"date":default:return new Date(A.date).getTime()-new Date(Y.date).getTime()}}),_(H),B(!1),t&&t(H),n(k)};E.useEffect(()=>(T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{i.trim()||l.length>0||p||d!=="all"||m||h?K():(_([]),t&&t([]))},300),()=>{T.current&&clearTimeout(T.current)}),[i,l,p,d,m,h,w]);const q=()=>{o(""),c([]),f(""),g("all"),y(""),x(""),u("date"),_([]),t&&t([])},te=k=>{c(H=>H.includes(k)?H.filter(Y=>Y!==k):[...H,k])},se=k=>{const H=new Date(k),A=Math.floor((new Date().getTime()-H.getTime())/(1e3*60*60));return A<1?"только что":A<24?`${A}ч назад`:A<48?"вчера":H.toLocaleDateString("ru-RU")};return e.jsxs("div",{className:`bg-white rounded-2xl shadow-lg border border-gray-200 ${s}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Поиск записей"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>v(!N),className:`p-2 rounded-full transition-colors ${N?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,title:"Фильтры",children:e.jsx(nn,{className:"w-5 h-5"})}),e.jsx("button",{onClick:q,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Очистить поиск",children:e.jsx(at,{className:"w-5 h-5"})}),r&&e.jsx("button",{onClick:r,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Закрыть",children:e.jsx(at,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mt-4 relative",children:[e.jsx(Kr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:i,onChange:k=>o(k.target.value),placeholder:"Поиск по записям...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),P&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"})})]}),(l.length>0||p||d!=="all"||m||h)&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[l.map(k=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-700",children:[e.jsx(Dd,{className:"w-3 h-3 mr-1"}),k,e.jsx("button",{onClick:()=>te(k),className:"ml-2 hover:bg-blue-200 rounded-full p-0.5",children:e.jsx(at,{className:"w-3 h-3"})})]},k)),p&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-700",children:[e.jsx(be,{className:"w-3 h-3 mr-1"}),((re=L.find(k=>k.id===p))==null?void 0:re.name)||p,e.jsx("button",{onClick:()=>f(""),className:"ml-2 hover:bg-green-200 rounded-full p-0.5",children:e.jsx(at,{className:"w-3 h-3"})})]}),d!=="all"&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 text-purple-700",children:[d==="text"&&e.jsx(rr,{className:"w-3 h-3 mr-1"}),d==="image"&&e.jsx(La,{className:"w-3 h-3 mr-1"}),d==="video"&&e.jsx(It,{className:"w-3 h-3 mr-1"}),d==="text"?"Текст":d==="image"?"Изображения":"Видео",e.jsx("button",{onClick:()=>g("all"),className:"ml-2 hover:bg-purple-200 rounded-full p-0.5",children:e.jsx(at,{className:"w-3 h-3"})})]})]})]}),N&&e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тип контента"}),e.jsxs("select",{value:d,onChange:k=>g(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Все типы"}),e.jsx("option",{value:"text",children:"Только текст"}),e.jsx("option",{value:"image",children:"С изображениями"}),e.jsx("option",{value:"video",children:"С видео"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Автор"}),e.jsxs("select",{value:p,onChange:k=>f(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Все авторы"}),L.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Сортировка"}),e.jsxs("select",{value:w,onChange:k=>u(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"date",children:"По дате"}),e.jsx("option",{value:"likes",children:"По лайкам"}),e.jsx("option",{value:"comments",children:"По комментариям"}),e.jsx("option",{value:"views",children:"По просмотрам"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата от"}),e.jsx("input",{type:"date",value:m,onChange:k=>y(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата до"}),e.jsx("input",{type:"date",value:h,onChange:k=>x(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),z.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Популярные теги"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:z.slice(0,10).map(k=>e.jsxs("button",{onClick:()=>te(k),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${l.includes(k)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["#",k]},k))})]})]}),S.length>0&&e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Найдено ",S.length," записей"]})}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:S.map(k=>e.jsx("div",{className:"p-3 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center flex-shrink-0",children:k.userAvatar?e.jsx("img",{src:k.userAvatar,alt:k.userName,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:k.userName.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:k.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:se(k.date)}),k.type!=="text"&&e.jsx("span",{className:"text-xs text-gray-500",children:k.type==="image"?e.jsx(La,{className:"w-3 h-3 inline"}):e.jsx(It,{className:"w-3 h-3 inline"})})]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2 mb-2",children:k.text}),k.tags&&k.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[k.tags.slice(0,3).map(H=>e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["#",H]},H)),k.tags.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",k.tags.length-3]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(vt,{className:"w-3 h-3"}),e.jsx("span",{children:k.likes||0})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(Ie,{className:"w-3 h-3"}),e.jsx("span",{children:k.comments.length})]}),k.views&&e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(vr,{className:"w-3 h-3"}),e.jsx("span",{children:k.views})]})]})]})]})},k.id))})]}),i.trim()&&S.length===0&&!P&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Kr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"По вашему запросу ничего не найдено"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Попробуйте изменить параметры поиска"})]})]})},R3=({className:t=""})=>{const{notifications:r,markNotificationAsRead:s,markAllNotificationsAsRead:a,deleteNotification:n}=ct(),{user:i}=Ye(),[o,l]=E.useState(!1),[c,d]=E.useState(!1),[g,p]=E.useState("all"),f=E.useRef(null),m=r.filter(v=>!v.isRead).length;E.useEffect(()=>{const v=S=>{f.current&&!f.current.contains(S.target)&&l(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const y=r.filter(v=>g==="unread"?!v.isRead:g==="read"?v.isRead:!0),h=c?y:y.slice(0,5),x=v=>{switch(v){case"new_post":return e.jsx(rr,{className:"w-5 h-5 text-blue-500"});case"reaction":return e.jsx(vt,{className:"w-5 h-5 text-red-500"});case"comment":return e.jsx(Ie,{className:"w-5 h-5 text-green-500"});case"new_message":return e.jsx(Ie,{className:"w-5 h-5 text-blue-500"});case"follow":return e.jsx(Zs,{className:"w-5 h-5 text-purple-500"});case"lesson_reminder":return e.jsx(Qe,{className:"w-5 h-5 text-orange-500"});case"system":return e.jsx(Qs,{className:"w-5 h-5 text-gray-500"});default:return e.jsx(Gr,{className:"w-5 h-5 text-gray-500"})}},w=v=>{const S=new Date(v),P=Math.floor((new Date().getTime()-S.getTime())/(1e3*60));return P<1?"только что":P<60?`${P}м назад`:P<1440?`${Math.floor(P/60)}ч назад`:S.toLocaleDateString("ru-RU")},u=()=>{i&&a(i.id)},N=v=>{var S,_;v.isRead||s(v.id),v.type==="new_message"&&((S=v.data)!=null&&S.chatId)?(window.location.href=`#chat-${v.data.chatId}`,l(!1)):(_=v.data)!=null&&_.postId};return e.jsxs("div",{className:`relative ${t}`,ref:f,children:[e.jsxs("button",{onClick:()=>l(!o),className:"relative p-2 rounded-full hover:bg-gray-100 transition-colors",children:[e.jsx(Gr,{className:"w-6 h-6 text-gray-600"}),m>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:m>99?"99+":m})]}),o&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 bg-white rounded-2xl shadow-2xl border border-gray-200 z-50 max-h-[600px] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Уведомления"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[m>0&&e.jsx("button",{onClick:u,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Отметить все как прочитанные"}),e.jsx("button",{onClick:()=>l(!1),className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(at,{className:"w-4 h-4 text-gray-500"})})]})]}),e.jsx("div",{className:"flex items-center space-x-2 mt-3",children:[{key:"all",label:"Все",count:r.length},{key:"unread",label:"Непрочитанные",count:m},{key:"read",label:"Прочитанные",count:r.length-m}].map(({key:v,label:S,count:_})=>e.jsxs("button",{onClick:()=>p(v),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${g===v?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[S," (",_,")"]},v))})]}),e.jsx("div",{className:"overflow-y-auto max-h-[400px]",children:h.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Gr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsxs("p",{className:"text-gray-500",children:[g==="all"&&"Нет уведомлений",g==="unread"&&"Нет непрочитанных уведомлений",g==="read"&&"Нет прочитанных уведомлений"]})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:h.map(v=>e.jsx("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${v.isRead?"":"bg-blue-50"}`,onClick:()=>N(v),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:x(v.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:v.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:v.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:w(v.createdAt)})]}),!v.isRead&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center space-x-1",children:[!v.isRead&&e.jsx("button",{onClick:S=>{S.stopPropagation(),s(v.id)},className:"p-1 rounded-full hover:bg-green-100 transition-colors",title:"Отметить как прочитанное",children:e.jsx(Sd,{className:"w-4 h-4 text-green-600"})}),e.jsx("button",{onClick:S=>{S.stopPropagation(),n(v.id)},className:"p-1 rounded-full hover:bg-red-100 transition-colors",title:"Удалить",children:e.jsx(Jr,{className:"w-4 h-4 text-red-600"})})]})]})},v.id))})}),y.length>5&&e.jsx("div",{className:"p-4 border-t border-gray-100",children:e.jsx("button",{onClick:()=>d(!c),className:"w-full flex items-center justify-center space-x-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Cd,{className:"w-4 h-4"}),e.jsx("span",{children:"Показать меньше"})]}):e.jsxs(e.Fragment,{children:[e.jsx(kd,{className:"w-4 h-4"}),e.jsxs("span",{children:["Показать все (",y.length,")"]})]})})})]})]})},I3=({posts:t,currentUserId:r,currentUserName:s,currentUserAvatar:a,onCreatePost:n,onReaction:i,onComment:o,onShare:l,onBookmark:c,onEdit:d,onDelete:g,showCreateButton:p=!0,title:f="Записи",showSearch:m=!0,showNotifications:y=!0,showTrending:h=!0,showBookmarks:x=!0})=>{const[w,u]=E.useState(!1),[N,v]=E.useState(!1),[S,_]=E.useState("all"),[P,B]=E.useState(t),[T,z]=E.useState([]);E.useEffect(()=>{let K=t;S==="my"?K=t.filter(q=>q.userId===r):S==="others"?K=t.filter(q=>q.userId!==r):S==="trending"?K=[...t].sort((q,te)=>{const se=(q.likes||0)+q.comments.length;return(te.likes||0)+te.comments.length-se}).slice(0,20):S==="bookmarks"&&(K=t.filter(q=>{var te;return(te=q.bookmarks)==null?void 0:te.includes(r)})),B(K)},[t,S,r]);const L=K=>{n(K),u(!1)};return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:f}),e.jsxs("div",{className:"flex items-center space-x-2",children:[y&&e.jsx(R3,{className:"mr-2"}),m&&e.jsx("button",{onClick:()=>v(!N),className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Поиск",children:e.jsx(Kr,{className:"w-5 h-5"})}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:S,onChange:K=>_(K.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg px-3 py-2 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Все записи"}),e.jsx("option",{value:"my",children:"Мои записи"}),e.jsx("option",{value:"others",children:"Записи других"}),h&&e.jsx("option",{value:"trending",children:"Популярные"}),x&&e.jsx("option",{value:"bookmarks",children:"Закладки"})]}),e.jsx(nn,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]}),p&&e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(yr,{className:"w-4 h-4"}),e.jsx("span",{children:"Создать запись"})]})]})]}),N&&e.jsx("div",{className:"mb-6",children:e.jsx(A3,{onSearchResults:z,onClose:()=>v(!1)})}),w&&e.jsx("div",{className:"mb-6",children:e.jsx(ti,{onSubmit:L,onCancel:()=>u(!1),userName:s,userAvatar:a})}),e.jsxs("div",{className:"space-y-4",children:[T.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Результаты поиска (",T.length,")"]}),e.jsx("div",{className:"space-y-4",children:T.map(K=>e.jsx(sn,{post:K,currentUserId:r,onReaction:i,onComment:o,onShare:l,onBookmark:c,onEdit:d,onDelete:g},K.id))})]}),P.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"text-gray-400 text-lg mb-2",children:[S==="all"&&"Пока нет записей",S==="my"&&"У вас пока нет записей",S==="others"&&"Пока нет записей от других",S==="trending"&&"Пока нет популярных записей",S==="bookmarks"&&"У вас пока нет закладок"]}),e.jsxs("p",{className:"text-gray-500",children:[S==="my"&&p&&"Создайте первую запись!",S==="others"&&"Записи от других пользователей появятся здесь",S==="trending"&&"Популярные записи появятся здесь",S==="bookmarks"&&"Добавляйте записи в закладки!"]})]}):P.map(K=>e.jsx(sn,{post:K,currentUserId:r,onReaction:i,onComment:o,onShare:l,onBookmark:c,onEdit:d,onDelete:g},K.id))]})]})},L3=({userId:t,onClose:r,onMessage:s,onBookLesson:a,isModal:n=!1})=>{const{user:i}=Ye(),{posts:o,createPost:l,addReaction:c,addComment:d,sharePost:g,bookmarkPost:p,editPost:f,deletePost:m,allUsers:y}=ct(),[h,x]=E.useState(!1),[w,u]=E.useState(!1),[N,v]=E.useState(!1),[S,_]=E.useState("posts"),P=y.find(se=>se.id===t),B=(i==null?void 0:i.id)===t,T=(P==null?void 0:P.role)==="teacher",z=o.filter(se=>se.userId===t),L=P==null?void 0:P.profile,K=se=>{switch(se){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return se}},q=se=>{switch(se){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return se}};if(!P)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(be,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пользователь не найден"}),e.jsx("p",{className:"text-gray-500",children:"Пользователь с таким ID не существует"})]})});const te=()=>{var se;return e.jsx("div",{className:`${n?"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4":""}`,children:e.jsxs("div",{className:`bg-white rounded-3xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto relative ${n?"":"border border-gray-200"}`,children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[r&&e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(an,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!B&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(!w),className:`p-2 rounded-full transition-colors ${w?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(Xs,{className:`w-5 h-5 ${w?"fill-current":""}`})}),e.jsx("button",{onClick:()=>x(!h),className:`p-2 rounded-full transition-colors ${h?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(vt,{className:`w-5 h-5 ${h?"fill-current":""}`})})]}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(zt,{className:"w-5 h-5"})}),B&&e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Qs,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsxs("div",{className:"h-56 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"}),e.jsx("div",{className:"absolute bottom-6 left-8 right-8",children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"text-white flex-1 mr-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 leading-tight",children:(L==null?void 0:L.name)||P.name||"Пользователь"}),e.jsxs("div",{className:"flex items-center space-x-4 flex-wrap",children:[T&&(L==null?void 0:L.experience)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Ht,{className:"h-4 w-4 text-yellow-300"}),e.jsx("span",{className:"font-semibold text-xs",children:K(L.experience)})]}),(L==null?void 0:L.rating)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Dt,{className:"h-4 w-4 text-yellow-300 fill-current"}),e.jsx("span",{className:"font-semibold text-xs",children:L.rating})]}),(L==null?void 0:L.city)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Et,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-xs",children:L.city})]})]})]}),e.jsxs("div",{className:"text-right text-white/90 flex-shrink-0",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:z.length}),e.jsx("div",{className:"text-sm opacity-80",children:"записей"})]})]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start mt-8",children:[e.jsxs("div",{className:"flex-shrink-0 -mt-12 ml-8 relative",children:[e.jsxs("div",{className:"w-36 h-36 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-6 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-3 border-white rounded-full shadow-lg"}),L!=null&&L.avatar&&L.avatar.trim()!==""?e.jsx("img",{src:L.avatar,alt:P.name,className:"w-36 h-36 object-cover rounded-full",onError:re=>{var H;const k=re.target;k.style.display="none",(H=k.nextElementSibling)==null||H.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-36 h-36 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${L!=null&&L.avatar&&L.avatar.trim()!==""?"hidden":""}`,children:e.jsx(be,{className:"h-20 w-20 text-white"})})]}),!B&&e.jsxs("div",{className:"absolute -bottom-2 -right-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>x(!h),className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${h?"bg-red-500 text-white scale-110":"bg-white text-gray-600 hover:bg-red-50 hover:text-red-500"}`,children:e.jsx(vt,{className:`w-5 h-5 ${h?"fill-current":""}`})}),e.jsx("button",{className:"w-10 h-10 rounded-full bg-white text-gray-600 hover:bg-gray-50 shadow-lg transition-all duration-200 flex items-center justify-center",children:e.jsx(zt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-wrap gap-4 mt-12 lg:mt-0",children:[!B&&e.jsxs(e.Fragment,{children:[T&&a&&e.jsxs("button",{onClick:()=>a(P.id),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ge,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Записаться на урок"})]}),s&&e.jsxs("button",{onClick:()=>s(P.id),className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-2xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ie,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Написать сообщение"})]}),e.jsxs("button",{onClick:()=>v(!N),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(vr,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Контактная информация"})]})]}),B&&e.jsxs("button",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(nl,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Редактировать профиль"})]})]})]})]}),N&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 mb-8 mt-8 border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-lg",children:"Контактная информация"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[P.phone&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(br,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:P.phone})]}),P.email&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(on,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:P.email})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6 mt-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:z.length}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Записей"})]}),T&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(L==null?void 0:L.lessonsCount)||0}),e.jsx("div",{className:"text-green-100 text-xs",children:"Проведено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:((se=L==null?void 0:L.students)==null?void 0:se.length)||0}),e.jsx("div",{className:"text-purple-100 text-xs",children:"Учеников"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 to-orange-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(L==null?void 0:L.rating)||0}),e.jsx("div",{className:"text-orange-100 text-xs",children:"Рейтинг"})]})]}),!T&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-green-100 text-xs",children:"Посещено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-purple-100 text-xs",children:"Преподавателей"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 to-orange-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-orange-100 text-xs",children:"Дней в системе"})]})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8 mt-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"posts",label:"Записи",count:z.length},{id:"about",label:"О пользователе",count:null},{id:"lessons",label:T?"Расписание":"Мои уроки",count:0},{id:"reviews",label:"Отзывы",count:0}].map(re=>e.jsxs("button",{onClick:()=>_(re.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${S===re.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[re.label,re.count!==null&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2 rounded-full text-xs",children:re.count})]},re.id))})}),e.jsxs("div",{className:"min-h-[400px]",children:[S==="posts"&&e.jsx("div",{className:"space-y-6",children:e.jsx(I3,{posts:z,currentUserId:(i==null?void 0:i.id)||"",currentUserName:(i==null?void 0:i.name)||"",currentUserAvatar:i==null?void 0:i.avatar,onCreatePost:l,onReaction:c,onComment:d,onShare:g,onBookmark:p,onEdit:f,onDelete:m,showCreateButton:B,title:`Записи ${(L==null?void 0:L.name)||P.name}`,showSearch:!0,showNotifications:!1,showTrending:!1,showBookmarks:!0})}),S==="about"&&e.jsxs("div",{className:"space-y-3",children:[(L==null?void 0:L.bio)&&e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-indigo-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-indigo-500 to-purple-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"О пользователе"]}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm rounded-md p-2 border border-indigo-200/50",children:e.jsx("p",{className:"text-indigo-800 leading-relaxed whitespace-pre-line text-xs",children:L.bio})})]}),T&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[(L==null?void 0:L.subjects)&&L.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Предметы"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:L.subjects.map((re,k)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium border border-blue-200/50 shadow-sm",children:re},k))})]}),(L==null?void 0:L.grades)&&L.grades.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-emerald-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 to-teal-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Классы"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:L.grades.map((re,k)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-emerald-800 px-2 py-0.5 rounded-md text-xs font-medium border border-emerald-200/50 shadow-sm",children:re},k))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2.5",children:[(L==null?void 0:L.hourlyRate)&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-200 rounded-lg p-2.5 text-center shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-purple-900 mb-1.5 flex items-center justify-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-purple-500 to-violet-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Стоимость"]}),e.jsxs("div",{className:"text-base font-bold text-purple-700 bg-white/60 backdrop-blur-sm rounded-md py-1 px-1.5 border border-purple-200/50",children:[L.hourlyRate," ₽/час"]})]}),(L==null?void 0:L.formats)&&L.formats.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-orange-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-orange-500 to-amber-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Форматы"]}),e.jsx("div",{className:"space-y-1",children:L.formats.map((re,k)=>e.jsxs("div",{className:"flex items-center space-x-1.5 p-1 bg-white/60 backdrop-blur-sm rounded border border-orange-200/50",children:[e.jsx(Gt,{className:"h-3 w-3 text-orange-600"}),e.jsx("span",{className:"text-orange-800 text-xs font-medium",children:q(re)})]},k))})]}),(L==null?void 0:L.durations)&&L.durations.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 border border-cyan-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-cyan-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-cyan-500 to-blue-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Длительность"]}),e.jsx("div",{className:"space-y-1",children:L.durations.map((re,k)=>e.jsxs("div",{className:"flex items-center space-x-1.5 p-1 bg-white/60 backdrop-blur-sm rounded border border-cyan-200/50",children:[e.jsx(Gt,{className:"h-3 w-3 text-cyan-600"}),e.jsxs("span",{className:"text-cyan-800 text-xs font-medium",children:[re," минут"]})]},k))})]})]})]}),!T&&L&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[L.subjects&&L.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Интересуется предметами"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:L.subjects.map((re,k)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium border border-blue-200/50 shadow-sm",children:re},k))})]}),L.grade&&e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-emerald-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 to-teal-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Класс"]}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm text-emerald-800 px-2 py-1 rounded-md text-xs font-medium border border-emerald-200/50 shadow-sm",children:L.grade})]})]})]}),S==="lessons"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Qe,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:T?"Расписание пока не настроено":"Уроки пока не запланированы"}),e.jsx("p",{className:"text-gray-500",children:T?"Настройте расписание для проведения уроков":"Запишитесь на уроки к преподавателям"})]}),S==="reviews"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Dt,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пока нет отзывов"}),e.jsx("p",{className:"text-gray-500",children:"Отзывы о пользователе появятся здесь"})]})]})]})]})})};return n?e.jsx(te,{}):e.jsx(te,{})},F3=()=>{const{lessons:t,studentProfiles:r,createSlot:s,bookLesson:a}=ct(),{user:n}=Ye(),[i,o]=E.useState(),[l,c]=E.useState(!1),[d,g]=E.useState(!1),[p,f]=E.useState(null),[m,y]=E.useState({subject:"",date:"",startTime:"",endTime:"",duration:60,lessonType:"regular",format:"online",price:1e3,experience:"beginner",grades:[],goals:[]}),[h,x]=E.useState(!1),[w,u]=E.useState(""),[N,v]=E.useState(!1),[S,_]=E.useState(null),[P,B]=E.useState(null),T=t.filter(H=>H.teacherId===(n==null?void 0:n.id)),z={};T.forEach(H=>{z[H.studentId]||(z[H.studentId]={studentName:H.studentName,studentId:H.studentId,lessons:[]}),z[H.studentId].lessons.push(H)});const L=Object.values(z),K=(H,Y)=>{alert(`Чат с ${Y} открыт! Перейдите в раздел 'Чаты' для общения.`)},q=H=>{o(H),c(!0)},te=()=>{c(!1),o(null)},se=H=>{_(H),v(!0)},re=async()=>{if(!(!n||!p)){x(!0),u("");try{await s({...m,teacherId:n.id,teacherName:n.name},p.id,p.name,{mode:"assign"}),g(!1)}catch{u("Ошибка при создании или бронировании слота")}finally{x(!1)}}},k=i?r[i.studentId]:void 0;return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Ученики"}),e.jsx("p",{className:"text-gray-600",children:"Здесь отображаются все ученики, которые бронировали у вас уроки, и история ваших занятий с ними"})]}),L.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(be,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Пока нет учеников"}),e.jsx("p",{className:"text-gray-600",children:"Ученики появятся здесь после бронирования уроков"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:L.map(H=>e.jsx("div",{className:"card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden cursor-pointer",onClick:()=>q(H),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:e.jsx(be,{className:"h-6 w-6 text-white"})}),e.jsx("div",{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:H.studentName})}),e.jsxs("div",{className:"ml-auto flex items-center space-x-1",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-blue-600",title:"Просмотреть записи",onClick:Y=>{Y.stopPropagation(),B(H.studentId)},children:e.jsx(rr,{className:"h-5 w-5"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-blue-600",title:"Подробнее о профиле",onClick:Y=>{Y.stopPropagation(),q(H)},children:e.jsx(Od,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-md font-bold text-gray-800 mb-2 flex items-center",children:[e.jsx(Qe,{className:"h-4 w-4 mr-1 text-blue-500"}),"Забронированные уроки"]}),H.lessons.length===0?e.jsx("div",{className:"text-gray-500 text-sm",children:"Нет уроков"}):e.jsx("ul",{className:"space-y-2",children:H.lessons.map(Y=>e.jsxs("li",{className:"flex items-center justify-between bg-gray-50 rounded px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:Y.subject}),e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:[Y.date," ",Y.startTime,"-",Y.endTime]}),e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",Y.status==="completed"?"Завершен":"Запланирован",")"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:A=>{A.stopPropagation(),K(H.studentId,H.studentName)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded-full",title:"Чат с учеником",children:e.jsx(Ie,{className:"h-4 w-4"})})})]},Y.id))})]})]})},H.studentId))}),l&&i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:te,title:"Закрыть",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[k!=null&&k.avatar&&k.avatar.trim()!==""?e.jsx("img",{src:k.avatar,alt:"avatar",className:"w-20 h-20 rounded-full object-cover mb-2",onError:H=>{var A;const Y=H.target;Y.style.display="none",(A=Y.nextElementSibling)==null||A.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-20 h-20 rounded-full bg-gradient-to-r from-blue-400 to-indigo-500 flex items-center justify-center mb-2 ${k!=null&&k.avatar&&k.avatar.trim()!==""?"hidden":""}`,children:e.jsx(be,{className:"h-10 w-10 text-white"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:i.studentName})]}),e.jsxs("div",{className:"space-y-2",children:[(k==null?void 0:k.grade)&&e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx("span",{className:"font-semibold mr-2",children:"Класс:"})," ",k.grade]}),(k==null?void 0:k.subjects)&&k.subjects.length>0&&e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx("span",{className:"font-semibold mr-2",children:"Предметы:"})," ",k.subjects.join(", ")]}),(k==null?void 0:k.bio)&&e.jsxs("div",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold mr-2",children:"О себе:"})," ",k.bio]}),!k&&e.jsx("div",{className:"text-gray-400 text-sm",children:"Профиль не заполнен"}),e.jsx("button",{onClick:()=>se({id:i.studentId,name:i.studentName}),className:"btn btn-primary mt-4",children:"Назначить урок"})]})]})}),d&&p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:()=>g(!1),title:"Закрыть",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("h3",{children:["Назначить урок для ",p.name]}),e.jsxs("form",{className:"flex flex-col gap-2",children:[e.jsx("input",{type:"text",placeholder:"Предмет",value:m.subject,onChange:H=>y({...m,subject:H.target.value}),required:!0}),e.jsx("input",{type:"date",value:m.date,onChange:H=>y({...m,date:H.target.value}),required:!0}),e.jsx("input",{type:"time",value:m.startTime,onChange:H=>y({...m,startTime:H.target.value}),required:!0}),e.jsx("input",{type:"time",value:m.endTime,onChange:H=>y({...m,endTime:H.target.value}),required:!0}),e.jsx("input",{type:"number",placeholder:"Цена",value:m.price,onChange:H=>y({...m,price:Number(H.target.value)})}),e.jsxs("select",{value:m.lessonType,onChange:H=>y({...m,lessonType:H.target.value}),children:[e.jsx("option",{value:"regular",children:"Обычный"}),e.jsx("option",{value:"trial",children:"Пробный"})]}),e.jsxs("select",{value:m.format,onChange:H=>y({...m,format:H.target.value}),children:[e.jsx("option",{value:"online",children:"Онлайн"}),e.jsx("option",{value:"offline",children:"Оффлайн"})]}),e.jsxs("select",{value:m.experience,onChange:H=>y({...m,experience:H.target.value}),children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"})]}),w&&e.jsx("div",{className:"text-red-500",children:w}),e.jsx("button",{type:"button",className:"btn btn-success mt-2",onClick:re,disabled:h,children:h?"Назначение...":"Назначить"})]})]})}),N&&S&&e.jsx(xr,{open:N,onClose:()=>v(!1),children:e.jsxs("div",{style:{minWidth:1100,minHeight:600,maxWidth:"98vw"},children:[e.jsxs("h2",{style:{marginBottom:16},children:["Назначить урок для ",S.name]}),e.jsx(Zc,{mode:"assign",student:S,onAssign:()=>v(!1)})]})}),P&&e.jsx(L3,{userId:P,onClose:()=>B(null),onMessage:H=>{B(null)},onBookLesson:H=>{B(null)},isModal:!0})]})},U3=({setActiveTab:t})=>{const{lessons:r,cancelLesson:s,rescheduleLesson:a,getOrCreateChat:n}=ct(),{user:i}=Ye(),[o,l]=E.useState(!1),[c,d]=E.useState(null),[g,p]=E.useState(""),[f,m]=E.useState(""),y=r.filter(T=>T.studentId===(i==null?void 0:i.id)),h=y.filter(T=>T.status==="scheduled"),x=y.filter(T=>T.status==="completed"),w=(T,z)=>{i&&n(i.id,T,i.name,z)},u=T=>{window.confirm("Вы уверены, что хотите отменить урок?")&&s(T)},N=()=>{c&&g&&f&&(a(c.id,g,f),l(!1),d(null),p(""),m(""))},v=T=>{d(T),p(T.date),m(T.startTime),l(!0)},S=T=>{switch(T){case"online":return e.jsx(It,{className:"h-4 w-4"});case"offline":return e.jsx(Et,{className:"h-4 w-4"});case"mini-group":return e.jsx(Zs,{className:"h-4 w-4"});default:return e.jsx(It,{className:"h-4 w-4"})}},_=T=>{switch(T){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return T}},P=T=>T==="scheduled"?e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-sm",children:[e.jsx(Wd,{className:"h-4 w-4 mr-2"}),"Запланирован"]}):e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-green-500 to-green-600 text-white shadow-sm",children:[e.jsx(qr,{className:"h-4 w-4 mr-2"}),"Завершен"]}),B=({lesson:T,isScheduled:z})=>e.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden border border-gray-100 hover:border-blue-200",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 p-4 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white opacity-10 rounded-full -translate-y-12 translate-x-12"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 bg-white opacity-10 rounded-full translate-y-8 -translate-x-8"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold mb-1",children:T.subject}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(be,{className:"h-4 w-4 text-blue-200"}),e.jsx("span",{className:"text-blue-100 text-sm font-medium",children:T.teacherName})]})]}),P(T.status)]}),e.jsxs("div",{className:"flex items-center space-x-3 text-blue-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[S(T.format),e.jsx("span",{className:"text-xs font-medium",children:_(T.format)})]}),T.lessonType==="trial"&&e.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-400 bg-opacity-20 px-2 py-1 rounded-full",children:[e.jsx(Dt,{className:"h-3 w-3 text-yellow-300"}),e.jsx("span",{className:"text-yellow-200 text-xs font-medium",children:"Пробный"})]})]})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-md",children:e.jsx(Qe,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Дата"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:T.date})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 rounded-md",children:e.jsx(Gt,{className:"h-4 w-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Время"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[T.startTime," - ",T.endTime]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-green-100 rounded-md",children:e.jsx(Bd,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Длительность"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[T.duration," мин"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Стоимость"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[T.price,"₽"]})]})]}),z&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>w(T.teacherId,T.teacherName),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg text-sm font-medium hover:from-blue-600 hover:to-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsx("span",{children:"Чат"})]}),T.format==="online"&&e.jsxs("button",{className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg text-sm font-medium hover:from-purple-600 hover:to-purple-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx("span",{children:"Видеозвонок"})]})]}),e.jsxs("div",{className:"flex space-x-2 pt-2 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>v(T),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 text-orange-600 bg-orange-50 hover:bg-orange-100 rounded-lg text-sm font-medium transition-all duration-200 border border-orange-200 hover:border-orange-300",children:[e.jsx(nl,{className:"h-3 w-3"}),e.jsx("span",{children:"Перенести"})]}),e.jsxs("button",{onClick:()=>u(T.id),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm font-medium transition-all duration-200 border border-red-200 hover:border-red-300",children:[e.jsx(Jr,{className:"h-3 w-3"}),e.jsx("span",{children:"Отменить"})]})]})]}),!z&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 py-2 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[e.jsx(qr,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-700 text-sm font-medium",children:"Урок успешно завершен"})]})]}),e.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-3 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent",children:"Мои уроки"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed",children:"Управляйте вашими запланированными и завершенными уроками. Отслеживайте прогресс и достигайте новых высот в обучении."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Qe,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:h.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Запланировано"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(qr,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:x.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Завершено"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(ll,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:y.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Всего уроков"})]})]})})]}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Qe,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Запланированные уроки"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ваши предстоящие занятия"})]})]}),h.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(T=>e.jsx(B,{lesson:T,isScheduled:!0},T.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md border border-gray-100",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Qe,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Нет запланированных уроков"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"Забронируйте свой первый урок на главной странице и начните свой путь к знаниям"}),e.jsxs("button",{onClick:()=>{console.log("🎯 Переход к главной странице для бронирования урока"),t("home")},className:"inline-flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[e.jsx(Gd,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать урок"})]})]})]}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Ht,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Завершенные уроки"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ваши достижения и пройденный материал"})]})]}),x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(T=>e.jsx(B,{lesson:T,isScheduled:!1},T.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md border border-gray-100",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-green-100 to-emerald-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ht,{className:"h-8 w-8 text-green-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Нет завершенных уроков"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"После завершения уроков здесь будут отображаться ваши достижения и прогресс"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-medium",children:[e.jsx(il,{className:"h-4 w-4"}),e.jsx("span",{children:"Достижения появятся здесь"})]})]})]}),e.jsx("div",{className:"text-center py-12 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-2xl text-white shadow-xl",children:e.jsxs("div",{className:"max-w-xl mx-auto px-6",children:[e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Готовы к следующему уроку?"}),e.jsx("p",{className:"text-lg text-blue-100 mb-6",children:"Продолжайте обучение и достигайте новых высот вместе с нашими преподавателями"}),e.jsxs("button",{onClick:()=>{console.log("🔍 Переход к главной странице для поиска преподавателя"),t("home")},className:"inline-flex items-center space-x-2 px-6 py-3 bg-white text-blue-600 rounded-lg font-semibold text-base hover:bg-gray-50 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[e.jsx(Id,{className:"h-5 w-5"}),e.jsx("span",{children:"Найти преподавателя"})]})]})})]}),o&&c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full shadow-2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Перенести урок"}),e.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(at,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Урок:"})," ",c.subject," с ",c.teacherName]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Новая дата"}),e.jsx("input",{type:"date",value:g,onChange:T=>p(T.target.value),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Новое время"}),e.jsx("input",{type:"time",value:f,onChange:T=>m(T.target.value),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-8",children:[e.jsx("button",{onClick:N,disabled:!g||!f,className:"flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 px-6 rounded-xl font-semibold hover:from-blue-600 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Перенести урок"}),e.jsx("button",{onClick:()=>l(!1),className:"px-8 py-4 border-2 border-gray-300 rounded-xl text-gray-700 font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"Отмена"})]})]})})})]})},W3=()=>{const{chats:t,sendMessage:r,sendMessageToUser:s,allUsers:a,setAllUsers:n,teacherProfiles:i,studentProfiles:o,lessons:l,deleteChat:c,markChatAsRead:d,clearChatMessages:g,archiveChat:p,unarchiveChat:f,getOrCreateChat:m,loadChatsFromServer:y}=ct(),{user:h}=Ye(),[x,w]=E.useState(null),[u,N]=E.useState(""),[v,S]=E.useState(""),[_,P]=E.useState(!1),[B,T]=E.useState(null),[z,L]=E.useState([]),[K,q]=E.useState(null),[te,se]=E.useState(null),[re,k]=E.useState(!1),[H,Y]=E.useState(!1),[A,ae]=E.useState(!1),[me,he]=E.useState(!1),[ge,ye]=E.useState(!1),[J,pe]=E.useState(""),Ee=E.useRef(null),Z=E.useRef(null),{socketRef:Ne}=ct(),Oe=()=>{var U;(U=Ee.current)==null||U.scrollIntoView({behavior:"smooth"})};E.useEffect(()=>{Oe()},[x,t]),E.useEffect(()=>{h&&(console.log("ChatList: Loading chats for user:",h.id),y())},[h,y]),E.useEffect(()=>{if(t.length>0&&!x){const U=t.find(V=>V.participants.includes((h==null?void 0:h.id)||"")&&!V.archived);U&&w(U.id)}},[t,x,h]),E.useEffect(()=>{var U;if(x&&h){const V=t.find(de=>de.id===x);V&&((U=V.messages)!=null&&U.some(ke=>ke.senderId!==h.id&&!ke.isRead))&&d(x)}},[x,t,h,d]);const tt=U=>{let V=a.find(de=>de.id===U);if(!V){const de=i?i[U]:null;de&&(V={id:U,role:"teacher",profile:de,avatar:de.avatar||"",name:de.name||"",email:de.email||"",nickname:""});const ke=o?o[U]:null;if(!V&&ke&&(V={id:U,role:"student",profile:ke,avatar:ke.avatar||"",name:ke.name||"",email:ke.email||"",nickname:""}),V){const dt=[...a,V];n(dt),localStorage.setItem("tutoring_users",JSON.stringify(dt))}}return V||null},Ke=t.filter(U=>U.participants.includes((h==null?void 0:h.id)||""));console.log("🔍 ChatList DEBUG INFO:"),console.log("- Current user:",{id:h==null?void 0:h.id,name:h==null?void 0:h.name,role:h==null?void 0:h.role}),console.log("- All chats count:",t.length),console.log("- User chats count:",Ke.length),t.length>0&&(console.log("- All chats details:"),t.forEach((U,V)=>{var de;console.log(`  Chat ${V+1}:`,{id:U.id,participants:U.participants,participantNames:U.participantNames,includesUser:U.participants.includes((h==null?void 0:h.id)||""),messagesCount:((de=U.messages)==null?void 0:de.length)||0})}));const Me=Ke.filter(U=>{if(U.archived&&!me||!U.archived&&me)return!1;const V=U.participantNames.find(de=>de!==(h==null?void 0:h.name));return V==null?void 0:V.toLowerCase().includes(v.toLowerCase())});console.log("- Filtered chats count:",Me.length),console.log("🔍 END DEBUG INFO");const G=x?t.find(U=>U.id===x):null,je=()=>{!u.trim()||!x||!h||(r(x,h.id,h.name,u.trim()),N(""),k(!1))},ue=(U,V)=>{if(!J.trim()||!h)return;console.log("🔍 ChatList handleSendMessageToUser DEBUG:"),console.log("- Sender:",{id:h.id,name:h.name}),console.log("- Receiver:",{id:U,name:V}),console.log("- Message:",J.trim());const de=s(h.id,h.name,U,V,J.trim());console.log("- Chat created/opened with ID:",de),w(de),pe(""),ye(!1),console.log("🔍 END ChatList handleSendMessageToUser DEBUG")},Le=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),je())},_e=U=>U.participantNames.find(V=>V!==(h==null?void 0:h.name))||"Неизвестный пользователь",xe=U=>U.participants.find(V=>V!==(h==null?void 0:h.id))||"",Fe=U=>{try{const V=new Date(U);return zo(V)?ze(V,"HH:mm",{locale:xt}):Go(V)?"Вчера":qC(V)?ze(V,"EEEE",{locale:xt}):ze(V,"dd.MM.yyyy",{locale:xt})}catch{return""}},Je=U=>{try{const V=new Date(U);return zo(V)?ze(V,"HH:mm",{locale:xt}):Go(V)?"Вчера":ze(V,"dd.MM",{locale:xt})}catch{return""}},Nt=U=>{console.log("handleDeleteChat called with chatId:",U),console.log("Current chats in component:",t.length);const V=t.find(ke=>ke.id===U),de=V?_e(V):"пользователем";if(confirm(`Вы уверены, что хотите удалить чат с ${de}? Это действие нельзя отменить.`))try{console.log("User confirmed deletion. Deleting chat:",U),c(U),x===U&&(console.log("Removing selection from deleted chat"),w(null)),q(null),se(null),setTimeout(()=>{console.log("Forcing state update after chat deletion"),q(null)},100),console.log("Chat deletion process completed")}catch(ke){console.error("Error deleting chat:",ke),alert("Ошибка при удалении чата. Попробуйте еще раз.")}else console.log("User cancelled chat deletion")},O=U=>{console.log("handleMarkAsRead called with chatId:",U);try{d(U),q(null),console.log("Chat marked as read successfully")}catch(V){console.error("Error marking chat as read:",V),alert("Ошибка при отметке чата как прочитанного.")}},b=U=>{var ke;console.log("handleClearMessages called with chatId:",U);const V=t.find(dt=>dt.id===U),de=((ke=V==null?void 0:V.messages)==null?void 0:ke.length)||0;if(de===0){alert("В этом чате нет сообщений для очистки."),q(null);return}if(confirm(`Вы уверены, что хотите очистить все ${de} сообщений в этом чате? Это действие нельзя отменить.`))try{console.log("Clearing messages for chat:",U),g(U),q(null),console.log("Messages cleared successfully")}catch(dt){console.error("Error clearing messages:",dt),alert("Ошибка при очистке сообщений.")}},$=U=>{console.log("handleArchiveChat called with chatId:",U);try{p(U),q(null),x===U&&w(null),console.log("Chat archived successfully")}catch(V){console.error("Error archiving chat:",V),alert("Ошибка при архивировании чата.")}},D=U=>{console.log("handleUnarchiveChat called with chatId:",U);try{f(U),q(null),console.log("Chat unarchived successfully")}catch(V){console.error("Error unarchiving chat:",V),alert("Ошибка при восстановлении чата.")}},j=()=>{alert("Функция создания нового чата будет добавлена в следующем обновлении.")},I=U=>{const V=U.target.files;V&&V.length>0&&console.log("Files to upload:",V),ae(!1)},M=U=>{console.log("handleShowProfile called with chatId:",U);try{const V=t.find(de=>de.id===U);if(console.log("Found chat:",V),V){const de=xe(V);console.log("Other participant ID:",de),de?(T(de),P(!0),console.log("Profile modal opened for user:",de)):alert("Не удалось определить пользователя для показа профиля.")}else alert("Чат не найден.");q(null)}catch(V){console.error("Error showing profile:",V),alert("Ошибка при открытии профиля пользователя."),q(null)}},F=()=>{t.filter(V=>{var de;return V.participants.includes((h==null?void 0:h.id)||"")&&!V.archived&&((de=V.messages)==null?void 0:de.some(ke=>ke.senderId!==(h==null?void 0:h.id)&&!ke.isRead))}).forEach(V=>{d(V.id)})};E.useEffect(()=>{const U=V=>{const de=V.target,ke=de.closest('button[onClick*="setShowChatMenu"]'),dt=de.closest(".chat-menu");K&&!ke&&!dt&&(console.log("Click outside menu detected, closing menu"),q(null))};return document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[K]);const ce=t.filter(U=>{var V;return U.participants.includes((h==null?void 0:h.id)||"")&&!U.archived&&((V=U.messages)==null?void 0:V.some(de=>de.senderId!==(h==null?void 0:h.id)&&!de.isRead))}).length;return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-3 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"МОИ ЧАТЫ"}),e.jsx("p",{className:"text-gray-600 text-xs",children:ce>0?`${ce} непрочитанных сообщений`:"Общайтесь с преподавателями и учениками"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[ce>0&&e.jsx("button",{onClick:F,className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:"Отметить все как прочитанные"}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Qs,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>he(!me),className:`px-3 py-1 text-sm rounded-lg transition-colors ${me?"bg-gray-200 text-gray-700":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:me?"Активные":"Архив"}),e.jsx("button",{onClick:j,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Создать новый чат",children:e.jsx(yr,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden min-h-0",children:[e.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col flex-shrink-0",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 space-y-2 flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Kr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Поиск чатов...",value:v,onChange:U=>S(U.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("button",{onClick:()=>ye(!0),className:"w-full bg-gradient-to-r from-green-600 to-green-700 text-white px-4 py-2 rounded-lg font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(yr,{className:"h-4 w-4"}),e.jsx("span",{children:"Новый чат"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:Me.length>0?Me.map(U=>{var Lr,C;const V=xe(U),de=tt(V),ke=x===U.id,dt=(Lr=U.messages)==null?void 0:Lr.some(W=>W.senderId!==(h==null?void 0:h.id)&&!W.isRead);return e.jsxs("div",{className:`relative p-4 hover:bg-gray-50 cursor-pointer transition-colors chat-menu ${ke?"bg-blue-50 border-r-2 border-blue-500":""}`,onClick:()=>w(U.id),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[de!=null&&de.avatar?e.jsx("img",{src:de.avatar,alt:"avatar",className:"h-12 w-12 rounded-full object-cover",onError:W=>{var le;const X=W.target;X.style.display="none",(le=X.nextElementSibling)==null||le.classList.remove("hidden")}}):e.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:_e(U).charAt(0).toUpperCase()})}),dt&&e.jsx("div",{className:"absolute -top-1 -right-1 h-4 w-4 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:((C=U.messages)==null?void 0:C.filter(W=>W.senderId!==(h==null?void 0:h.id)&&!W.isRead).length)||0})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:[_e(U),U.archived&&e.jsx("span",{className:"ml-2 text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded",children:"Архив"})]}),U.lastMessage&&e.jsx("span",{className:"text-xs text-gray-400",children:Je(U.lastMessage.timestamp)})]}),U.lastMessage?e.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:U.lastMessage.content}):e.jsx("p",{className:"text-sm text-gray-400 italic mt-1",children:"Нет сообщений"})]}),e.jsx("button",{onClick:W=>{console.log("Menu button clicked for chat:",U.id),W.stopPropagation(),q(K===U.id?null:U.id)},className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(sl,{className:"w-4 h-4"})})]}),K===U.id&&e.jsxs("div",{className:"absolute right-2 top-12 bg-white border border-gray-200 rounded-lg shadow-xl py-1 z-50 min-w-[180px]",children:[e.jsxs("button",{onClick:W=>{console.log("Profile button clicked for chat:",U.id),W.preventDefault(),W.stopPropagation(),M(U.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(be,{className:"w-4 h-4"}),e.jsx("span",{children:"Профиль"})]}),e.jsxs("button",{onClick:W=>{console.log("Mark as read button clicked for chat:",U.id),W.preventDefault(),W.stopPropagation(),O(U.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(vr,{className:"w-4 h-4"}),e.jsx("span",{children:"Отметить как прочитанное"})]}),e.jsxs("button",{onClick:W=>{console.log("Archive button clicked for chat:",U.id),W.preventDefault(),W.stopPropagation(),$(U.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(oi,{className:"w-4 h-4"}),e.jsx("span",{children:"Архивировать"})]}),U.archived&&e.jsxs("button",{onClick:W=>{console.log("Unarchive button clicked for chat:",U.id),W.preventDefault(),W.stopPropagation(),D(U.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(oi,{className:"w-4 h-4"}),e.jsx("span",{children:"Восстановить"})]}),e.jsxs("button",{onClick:W=>{console.log("Clear messages button clicked for chat:",U.id),W.preventDefault(),W.stopPropagation(),b(U.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Jr,{className:"w-4 h-4"}),e.jsx("span",{children:"Очистить сообщения"})]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:W=>{console.log("Delete chat button clicked for chat:",U.id),W.preventDefault(),W.stopPropagation(),Nt(U.id)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Jr,{className:"w-4 h-4"}),e.jsx("span",{children:"Удалить чат"})]})]})]},U.id)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx(Ie,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Нет чатов"}),e.jsx("p",{className:"text-sm text-center",children:"Начните общение с преподавателями или учениками"})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-white min-h-0",children:G?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[(()=>{const U=xe(G),V=tt(U);return V!=null&&V.avatar?e.jsx("img",{src:V.avatar,alt:"avatar",className:"h-10 w-10 rounded-full object-cover"}):e.jsx("div",{className:"h-10 w-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:_e(G).charAt(0).toUpperCase()})})})(),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:_e(G)}),e.jsx("p",{className:"text-sm text-gray-500",children:(()=>{const U=xe(G),V=tt(U);return(V==null?void 0:V.role)==="teacher"?"Преподаватель":"Ученик"})()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(br,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(It,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{const U=xe(G);T(U),P(!0)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(be,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 min-h-0",children:[G.messages&&G.messages.length>0?G.messages.map(U=>e.jsx("div",{className:`flex ${U.senderId===(h==null?void 0:h.id)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${U.senderId===(h==null?void 0:h.id)?"bg-blue-600 text-white":"bg-white text-gray-900 shadow-sm"}`,children:[e.jsx("p",{className:"text-sm",children:U.content}),e.jsxs("div",{className:`flex items-center justify-end mt-1 space-x-1 ${U.senderId===(h==null?void 0:h.id)?"text-blue-100":"text-gray-400"}`,children:[e.jsx("span",{className:"text-xs",children:Fe(U.timestamp)}),U.senderId===(h==null?void 0:h.id)&&e.jsx(Nd,{className:"w-3 h-3"})]})]})},U.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx(Ie,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Начните общение"}),e.jsx("p",{className:"text-sm text-center",children:"Отправьте первое сообщение"})]}),e.jsx("div",{ref:Ee})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-end space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("textarea",{value:u,onChange:U=>{N(U.target.value),k(U.target.value.length>0)},onKeyPress:Le,placeholder:"Введите сообщение...",className:"w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:1,style:{minHeight:"44px",maxHeight:"120px"}}),e.jsxs("div",{className:"absolute right-3 bottom-3 flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>Y(!H),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ln,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>ae(!A),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(li,{className:"w-5 h-5"})})]})]}),e.jsx("button",{onClick:je,disabled:!u.trim(),className:"p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:e.jsx(al,{className:"w-5 h-5"})})]}),A&&e.jsx("div",{className:"mt-2 p-2 bg-white border border-gray-200 rounded-lg shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>{var U;return(U=Z.current)==null?void 0:U.click()},className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx(li,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Файл"})]}),e.jsxs("button",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx(Pd,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Голосовое"})]})]})}),e.jsx("input",{ref:Z,type:"file",multiple:!0,onChange:I,className:"hidden"})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500",children:[e.jsx(Ie,{className:"w-24 h-24 mb-6 text-gray-300"}),e.jsx("h2",{className:"text-2xl font-medium mb-2",children:"Выберите чат"}),e.jsx("p",{className:"text-center",children:"Выберите чат из списка слева, чтобы начать общение"})]})})]}),_&&B&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Профиль пользователя"}),e.jsx("button",{onClick:()=>P(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(an,{className:"w-5 h-5"})})]}),(()=>{var V;const U=tt(B);return U?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[U.avatar?e.jsx("img",{src:U.avatar,alt:"avatar",className:"h-16 w-16 rounded-full object-cover"}):e.jsx("div",{className:"h-16 w-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium text-lg",children:((V=U.name)==null?void 0:V.charAt(0).toUpperCase())||"U"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:U.name||"Неизвестный пользователь"}),e.jsx("p",{className:"text-gray-500",children:U.role==="teacher"?"Преподаватель":"Ученик"}),U.email&&e.jsx("p",{className:"text-sm text-gray-400",children:U.email})]})]}),U.profile&&e.jsxs("div",{className:"space-y-4",children:[U.profile.bio&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"О себе"}),e.jsx("p",{className:"text-gray-600",children:U.profile.bio})]}),U.profile.subjects&&U.profile.subjects.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Предметы"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:U.profile.subjects.map((de,ke)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:de},ke))})]}),U.profile.experience&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Опыт"}),e.jsxs("p",{className:"text-gray-600",children:[U.profile.experience==="beginner"&&"Начинающий",U.profile.experience==="experienced"&&"Опытный",U.profile.experience==="professional"&&"Профессионал"]})]}),U.profile.city&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Город"}),e.jsx("p",{className:"text-gray-600",children:U.profile.city})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[e.jsxs("button",{onClick:()=>{P(!1)},className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(br,{className:"w-4 h-4"}),e.jsx("span",{children:"Позвонить"})]}),e.jsxs("button",{onClick:()=>{P(!1)},className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(It,{className:"w-4 h-4"}),e.jsx("span",{children:"Видео"})]})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Профиль пользователя не найден"})})})()]})})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Новый чат"}),e.jsx("button",{onClick:()=>ye(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(at,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Сообщение"}),e.jsx("textarea",{value:J,onChange:U=>pe(U.target.value),placeholder:"Введите ваше сообщение...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Выберите получателя"}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-lg",children:a.filter(U=>U.id!==(h==null?void 0:h.id)).map(U=>e.jsxs("button",{onClick:()=>ue(U.id,U.name),className:"w-full p-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold",children:U.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:U.name}),e.jsx("div",{className:"text-sm text-gray-500 capitalize",children:U.role==="teacher"?"Преподаватель":"Ученик"})]})]},U.id))})]})]})]})})]})},B3=()=>{var Ee,Z,Ne,Oe,tt,Ke,Me,G,je,ue,Le,_e,xe,Fe,Je,Nt,O;const{user:t,updateProfile:r,deleteAccount:s}=Ye(),{updateStudentProfile:a,updateTeacherProfile:n,lessons:i,posts:o,createPost:l,addReaction:c,addComment:d,sharePost:g,bookmarkPost:p,editPost:f,deletePost:m}=ct(),[y,h]=E.useState(!1),[x,w]=E.useState({grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""}),[u,N]=E.useState({subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,teacherType:"private",education:{university:"",degree:"",graduationYear:void 0,courses:[]}}),[v,S]=E.useState(!1),[_,P]=E.useState(!1),[B,T]=E.useState(!1),[z,L]=E.useState(!1),[K]=E.useState([{id:1,avatar:((Ee=t==null?void 0:t.profile)==null?void 0:Ee.avatar)||"",name:(t==null?void 0:t.name)||""}]),[q,te]=E.useState(!1),[se,re]=E.useState(()=>typeof window<"u"&&localStorage.getItem("theme")||"light"),k=["Математика","Русский язык","Английский язык"],H=["1","2","3","4","5","6","7","8","9","10","11","Студент","Взрослый"],Y=["подготовка к экзаменам","помощь с домашним заданием","углубленное изучение","разговорная практика"],A=["beginner","experienced","professional"],ae=[45,60],me=["online","offline","mini-group"];E.useEffect(()=>{if(t!=null&&t.profile)if(t.role==="student"){const b=t.profile;w({...x,...b,goals:b.goals||[],interests:b.interests||[],preferredFormats:b.preferredFormats||[],preferredDurations:b.preferredDurations||[]})}else{const b=t.profile;N({...u,...b,formats:b.formats||[],subjects:b.subjects||[],grades:b.grades||[],goals:b.goals||[],lessonTypes:b.lessonTypes||[],durations:b.durations||[],education:b.education||{university:"",degree:"",graduationYear:void 0,courses:[]}})}else if(t&&!t.profile){const b=t.role==="teacher"?{subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,teacherType:"private",education:{university:"",degree:"",graduationYear:void 0,courses:[]}}:{grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""};r(b)}},[t]);const he=()=>{if(!t)return;const b=t.role==="student"?x:u;r(b),t.role==="student"?a(t.id,x):t.role==="teacher"&&n(t.id,{...u,name:t.name,email:t.email}),h(!1),alert("Профиль сохранен!")},ge=b=>{switch(b){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return b}};let ye=0,J=0;if(t&&t.role==="student"&&Array.isArray(i)){const b=i.filter($=>$.studentId===t.id);ye=b.length,J=Array.from(new Set(b.map($=>$.teacherId))).length}if(!t)return null;const pe=b=>{var D;const $=(D=b.target.files)==null?void 0:D[0];if($){const j=new FileReader;j.onload=I=>{var F;const M=(F=I.target)==null?void 0:F.result;if(t.role==="student"){const ne={...x,avatar:M};w(ne),r(ne),a(t.id,ne)}else{const ne={...u,avatar:M};N(ne),r(ne),n(t.id,{...ne,name:t.name,email:t.email})}},j.readAsDataURL($)}};return e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 relative",children:[e.jsx("div",{className:"h-20 w-20 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center overflow-hidden shadow-lg",children:(Z=t.profile)!=null&&Z.avatar?e.jsx("img",{src:t.profile.avatar,alt:"Avatar",className:"h-20 w-20 rounded-full object-cover"}):e.jsx(be,{className:"h-10 w-10 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:t?t.name:""}),t&&t.nickname&&e.jsxs("span",{className:"text-gray-400 text-sm",children:["@",t.nickname]})]}),t&&t.role==="student"&&e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[e.jsx(Ge,{className:"w-5 h-5 text-blue-500 mr-1"}),ye]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Пройдено уроков"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[e.jsx(be,{className:"w-5 h-5 text-green-500 mr-1"}),J]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Учителей"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("button",{className:"btn-primary text-sm px-3 py-2",onClick:()=>h(!0),children:"Редактировать"}),e.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-500 hover:text-blue-600 rounded-full p-2 shadow transition-colors duration-150 focus:outline-none",style:{width:36,height:36},"aria-label":"Настройки",onClick:()=>P(!0),children:e.jsx(Qs,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow p-4 mb-6 text-sm flex flex-col gap-2 card-gradient",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1 space-y-1"})})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-5 mb-6 card-gradient",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-3",children:"О себе"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-line leading-relaxed mb-4 text-sm",children:t.role==="student"?x.bio||"—":((Ne=t.profile)==null?void 0:Ne.bio)||"—"}),t.role==="student"&&e.jsxs("div",{className:"space-y-3",children:[x.subjects&&x.subjects.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Предметы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:x.subjects.map((b,$)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:b},$))})]}),(x.age||x.school||x.city)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[x.age&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Возраст:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[x.age," лет"]})]}),x.school&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Школа:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:x.school})]}),x.city&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Город:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:x.city})]})]}),x.goals&&x.goals.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Цели обучения:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:x.goals.map((b,$)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:b},$))})]}),x.interests&&x.interests.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Интересы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:x.interests.map((b,$)=>e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:b},$))})]}),(x.learningStyle||x.experience)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[x.learningStyle&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Стиль обучения:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:x.learningStyle==="visual"?"Визуальный":x.learningStyle==="auditory"?"Аудиальный":x.learningStyle==="kinesthetic"?"Кинестетический":"Смешанный"})]}),x.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Уровень:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:x.experience==="beginner"?"Начинающий":x.experience==="intermediate"?"Средний":"Продвинутый"})]})]}),(x.preferredFormats&&x.preferredFormats.length>0||x.preferredDurations&&x.preferredDurations.length>0)&&e.jsxs("div",{className:"space-y-2",children:[x.preferredFormats&&x.preferredFormats.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Форматы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:x.preferredFormats.map((b,$)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full",children:b==="online"?"Онлайн":b==="offline"?"Оффлайн":"Мини-группа"},$))})]}),x.preferredDurations&&x.preferredDurations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Длительность:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:x.preferredDurations.map((b,$)=>e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full",children:[b," мин"]},$))})]})]})]}),t.role==="teacher"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Предметы:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:((tt=(Oe=t.profile)==null?void 0:Oe.subjects)==null?void 0:tt.join(", "))||"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Классы:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:((Me=(Ke=t.profile)==null?void 0:Ke.grades)==null?void 0:Me.join(", "))||"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Страна:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:((G=t.profile)==null?void 0:G.country)||"—"})]}),((je=t.profile)==null?void 0:je.experience)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Опыт:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:t.profile.experience})]})]})]}),e.jsxs(xr,{open:v,onClose:()=>S(!1),children:[e.jsx("div",{className:"text-base font-bold mb-2",children:"Контактная информация"}),e.jsxs("div",{className:"mb-2 text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",t.email]})]}),e.jsx(xr,{open:_,onClose:()=>P(!1),children:e.jsxs("div",{className:"w-[320px] max-w-full",children:[e.jsx("div",{className:"text-lg font-bold mb-4 text-center",children:"Настройки"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",onClick:()=>{P(!1),T(!0)},children:[e.jsx(Gr,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"flex-1",children:"Push-уведомления"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(rl,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"flex-1",children:"Конфиденциальность"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",onClick:()=>{P(!1),L(!0)},children:[e.jsx(be,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"flex-1",children:"Аккаунт"})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rd,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"flex-1",children:"Тема"})]}),e.jsx("button",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none ${se==="dark"?"bg-gray-900":"bg-gray-300"}`,onClick:()=>{const b=se==="dark"?"light":"dark";re(b),b==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",b)},"aria-pressed":se==="dark",type:"button",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${se==="dark"?"translate-x-5":"translate-x-1"}`})})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx($d,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"flex-1",children:"Память"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Ad,{className:"w-5 h-5 text-indigo-500"}),e.jsx("span",{className:"flex-1",children:"Устройства"})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Ge,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{className:"flex-1",children:"База знаний"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Ie,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"flex-1",children:"Поддержка"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(rr,{className:"w-5 h-5 text-blue-700"}),e.jsx("span",{className:"flex-1",children:"Документация"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Dt,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"flex-1",children:"Оценить приложение"})]})]})]})}),e.jsx(xr,{open:B,onClose:()=>T(!1),children:e.jsxs("div",{className:"w-[340px] max-w-full",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("button",{onClick:()=>T(!1),className:"mr-2 p-1 rounded hover:bg-gray-100",children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left w-5 h-5 text-gray-500",children:[e.jsx("path",{d:"M19 12H5"}),e.jsx("path",{d:"m12 19-7-7 7-7"})]})}),e.jsx("div",{className:"text-lg font-bold text-center flex-1",children:"Уведомления"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"СООБЩЕНИЯ"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Rt,{label:"Личные сообщения"}),e.jsx(Rt,{label:"Инфобот"}),e.jsx(Rt,{label:"Лиды"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ПУБЛИКАЦИИ ОТ ПОДПИСОК"}),e.jsx("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:e.jsx(Rt,{label:"Новые публикации"})}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ПОДПИСЧИКИ И ДЕЛОВЫЕ СВЯЗИ"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Rt,{label:"Новые подписчики"}),e.jsx(Rt,{label:"Установлена деловая связь"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"МАРКЕТСПЕЙС"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Rt,{label:"Отклики"}),e.jsx(Rt,{label:"Рекомендации"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ГОСЗАКУПКИ"}),e.jsx("div",{className:"bg-gray-50 rounded-xl mb-2 overflow-hidden",children:e.jsx(Rt,{label:"Подборка тендеров по ИНН"})})]})}),e.jsx(xr,{open:z,onClose:()=>L(!1),children:e.jsxs("div",{className:"w-[340px] max-w-full flex flex-col min-h-[340px]",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("button",{onClick:()=>L(!1),className:"mr-2 p-1 rounded hover:bg-gray-100",children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left w-5 h-5 text-gray-500",children:[e.jsx("path",{d:"M19 12H5"}),e.jsx("path",{d:"m12 19-7-7 7-7"})]})}),e.jsx("div",{className:"text-lg font-bold text-center flex-1",children:"Аккаунт"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"НОМЕР ТЕЛЕФОНА"}),e.jsxs("div",{className:"bg-white rounded-xl mb-4 overflow-hidden flex items-center justify-between px-4 py-3",children:[e.jsx("span",{className:"text-sm text-gray-900",children:"Изменить номер"}),e.jsx("span",{className:"text-gray-400 text-sm",children:t.phone||"+7 (999) 300-18-02"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 ml-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ЭЛЕКТРОННАЯ ПОЧТА"}),e.jsxs("div",{className:"bg-white rounded-xl mb-4 overflow-hidden flex items-center justify-between px-4 py-3",children:[e.jsx("span",{className:"text-sm text-gray-900",children:"Изменить эл. почту"}),e.jsx("span",{className:"text-gray-400 text-sm truncate max-w-[120px]",children:t.email}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 ml-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:s,className:"w-full mt-8 mb-2 py-3 rounded-xl bg-red-50 text-red-600 font-bold text-base hover:bg-red-100 transition",children:"Удалить аккаунт"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-bold text-base",children:"Истории"}),e.jsx("button",{className:"text-blue-500 text-xs font-medium hover:underline",onClick:()=>alert("Скоро можно будет добавлять истории!"),children:"Добавить"})]}),e.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-2",children:[e.jsxs("div",{className:"flex flex-col items-center cursor-pointer group",children:[e.jsxs("div",{className:"relative h-14 w-14 rounded-full bg-gradient-to-tr from-blue-400 to-purple-500 flex items-center justify-center overflow-hidden border-2 border-blue-400 group-hover:scale-105 transition",children:[(t.role==="student"?x.avatar:(ue=t.profile)!=null&&ue.avatar)?e.jsx("img",{src:t.role==="student"?x.avatar:(Le=t.profile)==null?void 0:Le.avatar,alt:"avatar",className:"h-14 w-14 object-cover rounded-full"}):e.jsx(be,{className:"h-7 w-7 text-white"}),e.jsx("span",{className:"absolute bottom-0 right-0 bg-blue-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs border-2 border-white",children:"+"})]}),e.jsx("span",{className:"text-xs mt-1 text-gray-700",children:"Ваша история"})]}),K.map(b=>e.jsxs("div",{className:"flex flex-col items-center cursor-pointer group",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-gradient-to-tr from-pink-400 to-yellow-400 flex items-center justify-center overflow-hidden border-2 border-pink-400 group-hover:scale-105 transition",children:b.avatar?e.jsx("img",{src:b.avatar,alt:b.name,className:"h-14 w-14 object-cover rounded-full"}):e.jsx(be,{className:"h-7 w-7 text-white"})}),e.jsx("span",{className:"text-xs mt-1 text-gray-700 truncate max-w-[60px]",children:b.name})]},b.id))]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"font-bold text-base",children:"Мои записи"}),e.jsxs("button",{onClick:()=>te(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(yr,{className:"w-4 h-4"}),e.jsx("span",{children:"Создать запись"})]})]}),q&&e.jsx("div",{className:"mb-6",children:e.jsx(ti,{onSubmit:b=>{l(b),te(!1)},onCancel:()=>te(!1),userName:(t==null?void 0:t.name)||"Пользователь",userAvatar:t==null?void 0:t.avatar})}),e.jsx("div",{className:"space-y-4",children:o.filter(b=>b.userId===(t==null?void 0:t.id)).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"У вас пока нет записей"}),e.jsx("p",{className:"text-gray-500",children:"Создайте первую запись!"})]}):o.filter(b=>b.userId===(t==null?void 0:t.id)).map(b=>e.jsx(sn,{post:b,onReaction:c,onComment:d,onShare:g,onBookmark:p,onEdit:f,onDelete:m},b.id))})]}),e.jsx(xr,{open:y,onClose:()=>h(!1),children:e.jsx("div",{className:"w-[720px] max-w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-8 p-4",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("div",{className:"h-20 w-20 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center overflow-hidden",children:(t.role==="student"?x.avatar:u.avatar)?e.jsx("img",{src:t.role==="student"?x.avatar:u.avatar,alt:"Avatar",className:"h-20 w-20 rounded-full object-cover"}):e.jsx(be,{className:"h-10 w-10 text-white"})}),e.jsxs("div",{children:[e.jsxs("label",{className:"btn-primary cursor-pointer",children:[e.jsx(Hd,{className:"h-4 w-4"}),e.jsx("span",{children:"Загрузить фото"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:pe})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Рекомендуемый размер: 200x200px"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Имя"}),e.jsx("input",{type:"text",value:t==null?void 0:t.name,disabled:!0,className:"input-modern w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Никнейм"}),e.jsx("input",{type:"text",value:`@${t==null?void 0:t.nickname}`,disabled:!0,className:"input-modern w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:t==null?void 0:t.email,disabled:!0,className:"input-modern w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Номер телефона"}),e.jsx("input",{type:"tel",value:(t==null?void 0:t.phone)||"",onChange:b=>{if(t)try{const $=JSON.parse(localStorage.getItem("tutoring_users")||"[]"),D=$.findIndex(j=>j.id===t.id);D!==-1&&($[D].phone=b.target.value,localStorage.setItem("tutoring_users",JSON.stringify($)))}catch{}},className:"input-modern w-full",placeholder:"+7 (999) 123-45-67"})]})]}),t.role==="teacher"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предметы, которые вы преподаете"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:k.map(b=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.subjects.includes(b),onChange:$=>{$.target.checked?N({...u,subjects:[...u.subjects,b]}):N({...u,subjects:u.subjects.filter(D=>D!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:b})]},b))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Классы, с которыми работаете"}),e.jsx("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2",children:H.map(b=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.grades.includes(b),onChange:$=>{$.target.checked?N({...u,grades:[...u.grades,b]}):N({...u,grades:u.grades.filter(D=>D!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:b})]},b))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Опыт преподавания"}),e.jsx("select",{value:u.experience,onChange:b=>N({...u,experience:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:A.map(b=>e.jsx("option",{value:b,children:ge(b)},b))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тип преподавателя"}),e.jsxs("select",{value:u.teacherType||"private",onChange:b=>N({...u,teacherType:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"private",children:"Частный преподаватель"}),e.jsx("option",{value:"school",children:"Преподаватель школы"}),e.jsx("option",{value:"both",children:"Частный + Школа"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Возраст"}),e.jsx("input",{type:"number",value:u.age||"",onChange:b=>N({...u,age:b.target.value?Number(b.target.value):void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"18",max:"100",placeholder:"Укажите возраст"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Лет опыта"}),e.jsx("input",{type:"number",value:u.experienceYears||"",onChange:b=>N({...u,experienceYears:b.target.value?Number(b.target.value):void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",max:"50",placeholder:"Количество лет"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Стоимость часа (₽)"}),e.jsx("input",{type:"number",value:u.hourlyRate,onChange:b=>N({...u,hourlyRate:Number(b.target.value)}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цели занятий"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Y.map(b=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.goals.includes(b),onChange:$=>{$.target.checked?N({...u,goals:[...u.goals,b]}):N({...u,goals:u.goals.filter(D=>D!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:b})]},b))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Продолжительность уроков"}),e.jsx("div",{className:"flex space-x-4",children:ae.map(b=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.durations.includes(b),onChange:$=>{$.target.checked?N({...u,durations:[...u.durations,b]}):N({...u,durations:u.durations.filter(D=>D!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[b," мин"]})]},b))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Форматы проведения"}),e.jsx("div",{className:"flex space-x-4",children:me.map(b=>{var $;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:(($=u.formats)==null?void 0:$.includes(b))||!1,onChange:D=>{D.target.checked?N({...u,formats:[...u.formats||[],b]}):N({...u,formats:(u.formats||[]).filter(j=>j!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:b==="online"?"Онлайн":b==="offline"?"Оффлайн":"Мини-группа"})]},b)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.offlineAvailable,onChange:b=>N({...u,offlineAvailable:b.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Провожу оффлайн занятия"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.overbookingEnabled,onChange:b=>N({...u,overbookingEnabled:b.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Участвую в овербукинге"})]})})]})]}),u.offlineAvailable&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Город"}),e.jsx("input",{type:"text",value:u.city,onChange:b=>N({...u,city:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Введите ваш город"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"О себе"}),e.jsx("textarea",{value:t.role==="student"?x.bio:u.bio,onChange:b=>{t.role==="student"?w({...x,bio:b.target.value}):N({...u,bio:b.target.value})},rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Расскажите о себе..."})]}),t.role==="student"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Дополнительная информация"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предметы, которые изучаете"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:k.map(b=>{var $;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:(($=x.subjects)==null?void 0:$.includes(b))||!1,onChange:D=>{D.target.checked?w({...x,subjects:[...x.subjects||[],b]}):w({...x,subjects:(x.subjects||[]).filter(j=>j!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:b})]},b)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Возраст"}),e.jsx("input",{type:"number",value:x.age||"",onChange:b=>w({...x,age:b.target.value?Number(b.target.value):void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"5",max:"25",placeholder:"Укажите возраст"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Школа"}),e.jsx("input",{type:"text",value:x.school||"",onChange:b=>w({...x,school:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Название школы"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Город"}),e.jsx("input",{type:"text",value:x.city||"",onChange:b=>w({...x,city:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Ваш город"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Телефон"}),e.jsx("input",{type:"tel",value:x.phone||"",onChange:b=>w({...x,phone:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Имя родителя"}),e.jsx("input",{type:"text",value:x.parentName||"",onChange:b=>w({...x,parentName:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Имя родителя"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Телефон родителя"}),e.jsx("input",{type:"tel",value:x.parentPhone||"",onChange:b=>w({...x,parentPhone:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цели обучения"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Y.map(b=>{var $;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:(($=x.goals)==null?void 0:$.includes(b))||!1,onChange:D=>{D.target.checked?w({...x,goals:[...x.goals||[],b]}):w({...x,goals:(x.goals||[]).filter(j=>j!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:b})]},b)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Интересы и хобби"}),e.jsx("textarea",{value:((_e=x.interests)==null?void 0:_e.join(", "))||"",onChange:b=>w({...x,interests:b.target.value.split(",").map($=>$.trim()).filter($=>$)}),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Напишите через запятую: спорт, музыка, рисование..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Стиль обучения"}),e.jsxs("select",{value:x.learningStyle||"mixed",onChange:b=>w({...x,learningStyle:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"visual",children:"Визуальный"}),e.jsx("option",{value:"auditory",children:"Аудиальный"}),e.jsx("option",{value:"kinesthetic",children:"Кинестетический"}),e.jsx("option",{value:"mixed",children:"Смешанный"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Уровень знаний"}),e.jsxs("select",{value:x.experience||"beginner",onChange:b=>w({...x,experience:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"intermediate",children:"Средний"}),e.jsx("option",{value:"advanced",children:"Продвинутый"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предпочитаемые форматы занятий"}),e.jsx("div",{className:"flex space-x-4",children:me.map(b=>{var $;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:(($=x.preferredFormats)==null?void 0:$.includes(b))||!1,onChange:D=>{D.target.checked?w({...x,preferredFormats:[...x.preferredFormats||[],b]}):w({...x,preferredFormats:(x.preferredFormats||[]).filter(j=>j!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:b==="online"?"Онлайн":b==="offline"?"Оффлайн":"Мини-группа"})]},b)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предпочитаемая длительность занятий"}),e.jsx("div",{className:"flex space-x-4",children:ae.map(b=>{var $;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:(($=x.preferredDurations)==null?void 0:$.includes(b))||!1,onChange:D=>{D.target.checked?w({...x,preferredDurations:[...x.preferredDurations||[],b]}):w({...x,preferredDurations:(x.preferredDurations||[]).filter(j=>j!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[b," мин"]})]},b)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Часовой пояс"}),e.jsx("input",{type:"text",value:x.timeZone||"",onChange:b=>w({...x,timeZone:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"UTC+3 (Москва)"})]})]})}),t.role==="teacher"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Образование"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Университет"}),e.jsx("input",{type:"text",value:((xe=u.education)==null?void 0:xe.university)||"",onChange:b=>N({...u,education:{...u.education,university:b.target.value}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Название университета"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Специальность/Степень"}),e.jsx("input",{type:"text",value:((Fe=u.education)==null?void 0:Fe.degree)||"",onChange:b=>N({...u,education:{...u.education,degree:b.target.value}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Ваша специальность"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Год окончания"}),e.jsx("input",{type:"number",value:((Je=u.education)==null?void 0:Je.graduationYear)||"",onChange:b=>N({...u,education:{...u.education,graduationYear:b.target.value?Number(b.target.value):void 0}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1950",max:new Date().getFullYear(),placeholder:"Год окончания"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Курсы и сертификаты"}),e.jsxs("div",{className:"space-y-4",children:[(O=(Nt=u.education)==null?void 0:Nt.courses)==null?void 0:O.map((b,$)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Название курса"}),e.jsx("input",{type:"text",value:b.name,onChange:D=>{var I;const j=[...((I=u.education)==null?void 0:I.courses)||[]];j[$]={...b,name:D.target.value},N({...u,education:{...u.education,courses:j}})},className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"Название курса"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Учреждение"}),e.jsx("input",{type:"text",value:b.institution,onChange:D=>{var I;const j=[...((I=u.education)==null?void 0:I.courses)||[]];j[$]={...b,institution:D.target.value},N({...u,education:{...u.education,courses:j}})},className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"Название учреждения"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Год прохождения"}),e.jsx("input",{type:"number",value:b.year,onChange:D=>{var I;const j=[...((I=u.education)==null?void 0:I.courses)||[]];j[$]={...b,year:Number(D.target.value)},N({...u,education:{...u.education,courses:j}})},className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"1950",max:new Date().getFullYear(),placeholder:"Год"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ссылка на сертификат"}),e.jsx("input",{type:"url",value:b.certificate||"",onChange:D=>{var I;const j=[...((I=u.education)==null?void 0:I.courses)||[]];j[$]={...b,certificate:D.target.value},N({...u,education:{...u.education,courses:j}})},className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com/certificate.pdf"})]})]}),e.jsx("button",{type:"button",onClick:()=>{var j,I;const D=((I=(j=u.education)==null?void 0:j.courses)==null?void 0:I.filter((M,F)=>F!==$))||[];N({...u,education:{...u.education,courses:D}})},className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Удалить курс"})]},$)),e.jsxs("button",{type:"button",onClick:()=>{var $;const b={name:"",institution:"",year:new Date().getFullYear(),certificate:""};N({...u,education:{...u.education,courses:[...(($=u.education)==null?void 0:$.courses)||[],b]}})},className:"w-full p-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-gray-400 hover:text-gray-800 transition-colors flex items-center justify-center gap-2",children:[e.jsx(yr,{className:"h-5 w-5"}),"Добавить курс"]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsxs("button",{onClick:he,className:"btn-primary flex items-center gap-2",children:[e.jsx(Fd,{className:"h-5 w-5"}),e.jsx("span",{children:"Сохранить профиль"})]}),e.jsx("button",{onClick:()=>h(!1),className:"btn-secondary",children:"Отмена"})]})]})})})]})},Rt=({label:t})=>{const[r,s]=E.useState(!0);return e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b last:border-b-0",children:[e.jsx("span",{className:"text-sm text-gray-900",children:t}),e.jsx("button",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none ${r?"bg-green-500":"bg-gray-300"}`,onClick:()=>s(a=>!a),"aria-pressed":r,type:"button",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${r?"translate-x-5":"translate-x-1"}`})})]})},H3=()=>{const[t,r]=E.useState(null),[s,a]=E.useState(!0),[n,i]=E.useState(!1);try{const{user:o}=Ye(),[l,c]=E.useState((o==null?void 0:o.role)==="teacher"?"slots":"home");if(E.useEffect(()=>{if(o&&!n){const g=o.role==="teacher"?"slots":"home";c(g),i(!0)}a(!1)},[o,n]),s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Загрузка приложения..."})]})});if(!o)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Добро пожаловать в Nauchi"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Платформа для репетиторов и учеников"}),e.jsx(qd,{onSuccess:()=>{}})]})});const d=()=>{try{switch(l){case"home":return o.role==="student"?e.jsx(Ra,{setActiveTab:c}):e.jsx(Ia,{});case"slots":return o.role==="teacher"?e.jsx(Ia,{}):e.jsx(Ra,{setActiveTab:c});case"calendar":return o.role==="student"?e.jsx(Qc,{onClose:()=>c("home")}):e.jsx(Zc,{});case"lessons":return o.role==="student"?e.jsx(U3,{setActiveTab:c}):null;case"students":return o.role==="teacher"?e.jsx(F3,{}):null;case"chats":return e.jsx(W3,{});case"profile":return e.jsx(B3,{});default:return o.role==="student"?e.jsx(Ra,{setActiveTab:c}):e.jsx(Ia,{})}}catch(g){return console.error("Error rendering content:",g),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Ошибка загрузки контента"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Попробуйте перезагрузить страницу"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Перезагрузить"})]})})}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Yd,{activeTab:l,onTabChange:c}),e.jsx("main",{className:l==="chats"?"h-[calc(100vh-64px)]":"container mx-auto px-4 py-8",children:d()})]})}catch(o){return console.error("Error in AppContent:",o),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Ошибка загрузки"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Произошла ошибка при загрузке приложения"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Перезагрузить страницу"})]})})}},z3=()=>e.jsx("div",{className:"App",children:e.jsx(vd,{children:e.jsx(bd,{children:e.jsxs(rd,{children:[e.jsx(ai,{path:"/teacher/:teacherId",element:e.jsx(Xc,{teacher:{},onClose:()=>{},onBookLesson:()=>{}})}),e.jsx(ai,{path:"*",element:e.jsx(H3,{})})]})})})});Qo(document.getElementById("root")).render(e.jsx(E.StrictMode,{children:e.jsx(sd,{children:e.jsx(z3,{})})}));
