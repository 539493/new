# Интеграция видео чата

## Обзор изменений

Видео чат был успешно интегрирован в основное приложение вместо использования внешнего сервиса `https://video-chat-web-lp8d.onrender.com`.

## Основные изменения

### 1. Серверная часть (`backend/production-server-simple.cjs`)

- Добавлена поддержка WebRTC через Socket.IO
- Интегрирована функциональность видео чата в основной сервер
- Добавлены обработчики для:
  - `video-join` - присоединение к видео комнате
  - `video-offer` - WebRTC offer
  - `video-answer` - WebRTC answer  
  - `video-ice-candidate` - ICE кандидаты
  - `video-user-joined` - уведомление о новом пользователе
  - `video-user-left` - уведомление о выходе пользователя

### 2. Клиентская часть (`src/components/Shared/VideoChat.tsx`)

- Обновлен для использования Socket.IO вместо WebSocket
- Изменен URL подключения на локальный сервер
- Добавлена поддержка всех WebRTC событий
- Улучшен UI с индикаторами состояния

### 3. Компоненты студентов и преподавателей

#### `src/components/Student/StudentLessons.tsx`
- Заменена внешняя ссылка на локальный компонент VideoChat
- Добавлено состояние для управления видео чатом

#### `src/components/Teacher/TeacherSlots.tsx`
- Заменены внешние ссылки на локальный компонент VideoChat
- Добавлено состояние для управления видео чатом

### 4. Удаленные файлы

- `backend/video-chat-server.js` - удален, функциональность интегрирована в основной сервер

## Преимущества новой интеграции

1. **Локальная работа** - видео чат работает на том же сервере, что и основное приложение
2. **Единая аутентификация** - пользователи уже авторизованы в системе
3. **Лучшая производительность** - нет дополнительных сетевых запросов к внешнему сервису
4. **Полный контроль** - можно настраивать и улучшать функциональность
5. **Безопасность** - данные не передаются на внешние сервисы

## Использование

### Для студентов:
1. Перейдите в раздел "Мои уроки"
2. Найдите запланированный онлайн урок
3. Нажмите кнопку "Видеозвонок"
4. Разрешите доступ к камере и микрофону

### Для преподавателей:
1. Перейдите в раздел "Мои слоты"
2. Найдите забронированный онлайн слот или урок
3. Нажмите кнопку "Видеозвонок"
4. Разрешите доступ к камере и микрофону

## Технические детали

- **WebRTC**: Используется для peer-to-peer видеосвязи
- **Socket.IO**: Для сигналинга и управления комнатами
- **STUN серверы**: Google STUN серверы для NAT traversal
- **Поддерживаемые браузеры**: Все современные браузеры с поддержкой WebRTC

## Запуск

```bash
# Установка зависимостей
npm install

# Сборка проекта
npm run build

# Запуск сервера
npm start
```

Сервер будет доступен по адресу `http://localhost:3000` 