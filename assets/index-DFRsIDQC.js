import{r as S,a as id,R as I,g as St,c as yt,b as Ql}from"./vendor-tAaa2TlE.js";import{l as ld}from"./socket-TjCxX7sJ.js";import{R as od,a as ui,B as cd}from"./router-Skg1zGfq.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var eo={exports:{}},ea={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dd=S,ud=Symbol.for("react.element"),md=Symbol.for("react.fragment"),hd=Object.prototype.hasOwnProperty,fd=dd.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xd={key:!0,ref:!0,__self:!0,__source:!0};function to(t,r,s){var a,n={},i=null,o=null;s!==void 0&&(i=""+s),r.key!==void 0&&(i=""+r.key),r.ref!==void 0&&(o=r.ref);for(a in r)hd.call(r,a)&&!xd.hasOwnProperty(a)&&(n[a]=r[a]);if(t&&t.defaultProps)for(a in r=t.defaultProps,r)n[a]===void 0&&(n[a]=r[a]);return{$$typeof:ud,type:t,key:i,ref:o,props:n,_owner:fd.current}}ea.Fragment=md;ea.jsx=to;ea.jsxs=to;eo.exports=ea;var e=eo.exports,ro,mi=id;ro=mi.createRoot,mi.hydrateRoot;const Xe=[];for(let t=0;t<256;++t)Xe.push((t+256).toString(16).slice(1));function gd(t,r=0){return(Xe[t[r+0]]+Xe[t[r+1]]+Xe[t[r+2]]+Xe[t[r+3]]+"-"+Xe[t[r+4]]+Xe[t[r+5]]+"-"+Xe[t[r+6]]+Xe[t[r+7]]+"-"+Xe[t[r+8]]+Xe[t[r+9]]+"-"+Xe[t[r+10]]+Xe[t[r+11]]+Xe[t[r+12]]+Xe[t[r+13]]+Xe[t[r+14]]+Xe[t[r+15]]).toLowerCase()}let Ca;const pd=new Uint8Array(16);function vd(){if(!Ca){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ca=crypto.getRandomValues.bind(crypto)}return Ca(pd)}const bd=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),hi={randomUUID:bd};function yd(t,r,s){var n;if(hi.randomUUID&&!t)return hi.randomUUID();t=t||{};const a=t.random??((n=t.rng)==null?void 0:n.call(t))??vd();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,gd(a)}const _e="https://na-uchi.onrender.com",jd={transports:["websocket","polling"],timeout:1e4,forceNew:!0,upgrade:!0,rememberUpgrade:!0},so=S.createContext(void 0),Ke=()=>{const t=S.useContext(so);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},gr=()=>{try{const t=localStorage.getItem("tutoring_users");return t?JSON.parse(t):[]}catch{return[]}},Cs=t=>{try{localStorage.setItem("tutoring_users",JSON.stringify(t)),window.dispatchEvent(new StorageEvent("storage",{key:"tutoring_users",newValue:JSON.stringify(t),oldValue:localStorage.getItem("tutoring_users"),storageArea:localStorage})),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_users",newValue:JSON.stringify(t),oldValue:localStorage.getItem("tutoring_users")}}))}catch{}},Es=t=>{try{localStorage.setItem("tutoring_currentUser",JSON.stringify(t))}catch{}},wd=()=>{try{const t=localStorage.getItem("tutoring_currentUser");return t?JSON.parse(t):null}catch{return null}},Ea=()=>{try{["tutoring_teacherProfiles","tutoring_studentProfiles","tutoring_timeSlots","tutoring_lessons","tutoring_chats","tutoring_posts","tutoring_notifications"].forEach(r=>{localStorage.removeItem(r),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:r,newValue:null,oldValue:null}}))})}catch{}},Nd=({children:t})=>{const[r,s]=S.useState(()=>{try{return wd()}catch{return null}}),[a,n]=S.useState(!1);let i=null;try{const h=I.useContext(require("./DataContext").DataContext);h&&(i=h.deleteUserData)}catch{}if(S.useEffect(()=>{const x=setTimeout(()=>{try{const v=gr();n(!0)}catch{n(!0)}},100);return()=>clearTimeout(x)},[]),!a)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Инициализация авторизации..."})]})});const o=async(h,x)=>{await new Promise(f=>setTimeout(f,1e3));const u=gr().find(f=>f.email===h);return u?(s(u),Es(u),!0):(alert("Пользователь с таким email не найден. Пожалуйста, зарегистрируйтесь."),!1)},c=async(h,x,v,u,f,N)=>{try{Ea();const w=await fetch(`${_e}/api/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:h,password:x,name:v,nickname:u,role:f,phone:N})});if(!w.ok){const T=await w.text();try{const M=JSON.parse(T);alert(M.error||"Ошибка регистрации на сервере")}catch{alert("Ошибка регистрации на сервере. Используется локальная регистрация.")}throw new Error("Server registration failed")}const k=await w.json(),C=[...gr(),k];Cs(C),s(k),Es(k);try{const T=await fetch(`${_e}/api/sync`);if(T.ok){const M=await T.json();console.log("✅ Данные синхронизированы после регистрации"),M.teacherProfiles&&localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(M.teacherProfiles)),M.studentProfiles&&localStorage.setItem("tutoring_studentProfiles",JSON.stringify(M.studentProfiles));const j=[];M.teacherProfiles&&Object.entries(M.teacherProfiles).forEach(([O,B])=>{j.push({id:O,email:B.email||"",name:B.name||"",nickname:B.nickname||"",role:"teacher",phone:B.phone||"",profile:B})}),M.studentProfiles&&Object.entries(M.studentProfiles).forEach(([O,B])=>{j.push({id:O,email:B.email||"",name:B.name||"",nickname:B.nickname||"",role:"student",phone:B.phone||"",profile:B})}),localStorage.setItem("tutoring_users",JSON.stringify(j)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_users",newValue:JSON.stringify(j)}}))}}catch(T){console.warn("⚠️ Не удалось синхронизировать данные после регистрации:",T)}return!0}catch{const k=gr(),p=k.some(O=>O.email===h),C=k.some(O=>O.nickname===u);if(p)return alert("Пользователь с таким email уже существует"),!1;if(C)return alert("Пользователь с таким никнеймом уже существует"),!1;const T=f==="teacher"?{subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,education:{university:"",degree:"",graduationYear:void 0,courses:[]}}:{grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""},M={id:yd(),email:h,name:v,nickname:u,role:f,phone:N,profile:T,avatar:T.avatar},j=[...k,M];if(Cs(j),s(M),Es(M),f==="teacher"){const O=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");O[M.id]=T,localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(O)),console.log("✅ Профиль преподавателя сохранен локально:",M.id),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_teacherProfiles",newValue:JSON.stringify(O)}}))}if(f==="student"){const O=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");O[M.id]=T,localStorage.setItem("tutoring_studentProfiles",JSON.stringify(O)),console.log("✅ Профиль студента сохранен локально:",M.id),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_studentProfiles",newValue:JSON.stringify(O)}}))}try{const O=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}"),B=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}"),F=JSON.parse(localStorage.getItem("tutoring_users")||"[]");if(Object.keys(O).length>0||Object.keys(B).length>0){const K=await fetch(`${_e}/api/upload-local-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherProfiles:O,studentProfiles:B,users:F})});if(K.ok){const G=await K.json();console.log("✅ Локальные данные загружены на сервер:",G),alert("Регистрация выполнена локально и данные синхронизированы с сервером!")}else console.warn("⚠️ Не удалось загрузить локальные данные на сервер"),alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}else alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}catch(O){console.warn("⚠️ Ошибка загрузки локальных данных на сервер:",O),alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}return!0}},l=()=>{s(null),localStorage.removeItem("tutoring_currentUser"),Ea()},d=h=>{if(r){const x={...r,profile:h,avatar:h.avatar};s(x),Es(x);const u=gr().map(f=>f.id===r.id?x:f);Cs(u),typeof window<"u"&&fetch(`${_e}/api/updateProfile`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.id,profileData:h,role:r.role})}).then(f=>{if(f.ok){console.log("Profile updated successfully on server");const N=window.socket;N&&N.emit("profileUpdated",{userId:r.id,profileData:h,role:r.role})}else console.error("Failed to update profile on server:",f.status)}).catch(f=>{console.error("Failed to update profile on server:",f)})}},m=()=>{s(null),localStorage.removeItem("tutoring_users"),localStorage.removeItem("tutoring_currentUser"),Ea()},g=async()=>{if(!r)return alert("Пользователь не найден"),!1;if(!window.confirm("Вы уверены, что хотите удалить свой аккаунт? Это действие нельзя отменить. Все ваши данные будут безвозвратно удалены."))return!1;try{(await fetch(`${_e}/api/delete-user`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.id,role:r.role})})).ok||console.warn("Не удалось удалить пользователя с сервера, продолжаем локальное удаление");const u=gr().filter(f=>f.id!==r.id);if(Cs(u),r.role==="teacher"){const f=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");delete f[r.id],localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(f)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_teacherProfiles",newValue:JSON.stringify(f)}}))}else if(r.role==="student"){const f=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");delete f[r.id],localStorage.setItem("tutoring_studentProfiles",JSON.stringify(f)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_studentProfiles",newValue:JSON.stringify(f)}}))}if(i)i(r.id);else{const N=JSON.parse(localStorage.getItem("tutoring_timeSlots")||"[]").filter(B=>B.teacherId!==r.id);localStorage.setItem("tutoring_timeSlots",JSON.stringify(N));const k=JSON.parse(localStorage.getItem("tutoring_lessons")||"[]").filter(B=>B.teacherId!==r.id&&B.studentId!==r.id);localStorage.setItem("tutoring_lessons",JSON.stringify(k));const C=JSON.parse(localStorage.getItem("tutoring_chats")||"[]").filter(B=>!B.participants.includes(r.id));localStorage.setItem("tutoring_chats",JSON.stringify(C));const M=JSON.parse(localStorage.getItem("tutoring_posts")||"[]").filter(B=>B.userId!==r.id);localStorage.setItem("tutoring_posts",JSON.stringify(M));const O=JSON.parse(localStorage.getItem("tutoring_notifications")||"[]").filter(B=>B.userId!==r.id);localStorage.setItem("tutoring_notifications",JSON.stringify(O))}return l(),alert("Аккаунт успешно удален"),!0}catch(x){return console.error("Ошибка при удалении аккаунта:",x),alert("Произошла ошибка при удалении аккаунта"),!1}};return e.jsx(so.Provider,{value:{user:r,login:o,register:c,logout:l,updateProfile:d,clearAllUsers:m,deleteAccount:g},children:t})},ao=S.createContext(void 0),tt=()=>{const t=S.useContext(ao);if(!t)throw new Error("useData must be used within a DataProvider");return t},pt=(t,r)=>{try{const s=localStorage.getItem(t);if(s){const a=JSON.parse(s);return Array.isArray(a)?a:r}}catch{}return r},te=(t,r)=>{try{localStorage.setItem(t,JSON.stringify(r))}catch{}},$s=()=>{const t=new Date,r=new Date(t);r.setDate(r.getDate()+1);const s=new Date(t);s.setDate(s.getDate()+2);const a=new Date(t);return a.setDate(a.getDate()+7),{timeSlots:[],lessons:[],chats:[],studentProfiles:{},teacherProfiles:{}}},Sd=({children:t})=>{const r=S.useRef(null),[s,a]=S.useState(!0),[n,i]=S.useState(()=>{const b=pt("tutoring_timeSlots",[]);if(b.length>0)return b;const P=$s();return te("tutoring_timeSlots",P.timeSlots),P.timeSlots}),[o,c]=S.useState(()=>pt("tutoring_lessons",[])),[l,d]=S.useState(()=>pt("tutoring_chats",[])),[m,g]=S.useState(()=>{const b=pt("tutoring_studentProfiles",{});if(Object.keys(b).length>0)return b;const P=$s();return te("tutoring_studentProfiles",P.studentProfiles),P.studentProfiles}),[h,x]=S.useState(()=>{const b=pt("tutoring_teacherProfiles",{});if(Object.keys(b).length>0)return console.log("📱 Загружены локальные профили преподавателей:",Object.keys(b).length),b;const P=$s();return te("tutoring_teacherProfiles",P.teacherProfiles),P.teacherProfiles}),[v,u]=S.useState(()=>{try{const b=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("🔄 Загружаем пользователей из localStorage при инициализации:",b.length);const P=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]");console.log("👨‍🏫 Зарегистрированных преподавателей (постоянно сохраненных):",P.length);const A=[...b];P.forEach(y=>{A.find($=>$.id===y.id)||A.push(y)});const E=A.filter(y=>y.role==="teacher");return console.log("👨‍🏫 Зарегистрированных преподавателей (включая постоянно сохраненных):",E.length,E.map(y=>({id:y.id,name:y.name}))),A}catch(b){return console.error("❌ Ошибка загрузки пользователей из localStorage:",b),[]}}),[f,N]=S.useState(()=>pt("tutoring_posts",[])),[w,k]=S.useState(()=>pt("tutoring_notifications",[])),{user:p,updateProfile:C}=Ke(),T=()=>{const b=pt("tutoring_timeSlots",[]),P=pt("tutoring_lessons",[]),A=pt("tutoring_chats",[]),E=$s(),R=(b.length>0?b:E.timeSlots).filter(($,_,ie)=>_===ie.findIndex(ue=>ue.id===$.id));i(R),c(P),d(A),g(E.studentProfiles),te("tutoring_timeSlots",R),te("tutoring_lessons",P),te("tutoring_chats",A),te("tutoring_studentProfiles",E.studentProfiles),Be()},M=async()=>{try{console.log("🔄 Загружаем пользователей с сервера Render...");const b=await fetch(`${_e}/api/users`);if(!b.ok)return console.warn("⚠️ Не удалось загрузить пользователей с сервера:",b.status),[];const P=await b.json();console.log("✅ Пользователи загружены с сервера Render:",P.length);const A=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("📱 Локальные пользователи:",A.length);const y=[...A,...P].filter((R,$,_)=>$===_.findIndex(ie=>ie.id===R.id));return console.log("✅ Уникальные пользователи:",y.length),console.log("👨‍🏫 Преподаватели (включая офлайн):",y.filter(R=>R.role==="teacher").length),console.log("👨‍🎓 Студенты:",y.filter(R=>R.role==="student").length),u(y),localStorage.setItem("tutoring_users",JSON.stringify(y)),y}catch(b){return console.error("❌ Ошибка загрузки пользователей с сервера:",b),[]}},j=async()=>{try{console.log("Loading lessons from server...");const b=await fetch(`${_e}/api/lessons`);if(!b.ok)return console.error("Failed to load lessons from server:",b.status),[];const P=await b.json();console.log("Loaded lessons from server:",P.length,P);const A=JSON.parse(localStorage.getItem("tutoring_lessons")||"[]");console.log("Local lessons:",A.length,A);const y=[...A,...P].filter((R,$,_)=>$===_.findIndex(ie=>ie.id===R.id));return console.log("Setting lessons in context:",y.length,y),c(y),te("tutoring_lessons",y),y}catch(b){return console.error("Error loading lessons from server:",b),[]}},O=()=>{try{console.log("🔄 Принудительное обновление списка пользователей...");const b=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("👥 Загружено пользователей из localStorage:",b.length);const P=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]");console.log("👨‍🏫 Зарегистрированных преподавателей (постоянно сохраненных):",P.length);const A=[...b];P.forEach(_=>{A.find(ue=>ue.id===_.id)?console.log("⏭️ Преподаватель уже существует:",_.name):(A.push(_),console.log("✅ Добавлен зарегистрированный преподаватель:",_.name))});const E=A.filter(_=>_.role==="teacher");console.log("👨‍🏫 Зарегистрированных преподавателей (включая постоянно сохраненных):",E.length,E.map(_=>({id:_.id,name:_.name})));const R=(v||[]).filter(_=>_.role==="teacher");E.length>R.length?(u(A),console.log("✅ Обновлены пользователи, добавлено преподавателей:",E.length-R.length)):console.log("⏭️ Пользователи уже актуальны, обновление не требуется");const $=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");console.log("📱 Обновляем teacherProfiles из localStorage:",Object.keys($).length),x($),console.log("✅ Обновление пользователей завершено")}catch(b){console.error("❌ Ошибка при обновлении пользователей:",b),console.log("⚠️ Сохраняем текущих пользователей при ошибке")}},B=async()=>{try{console.log("👨‍🏫 Принудительная загрузка зарегистрированных преподавателей...");try{await M()}catch(y){console.warn("⚠️ Не удалось загрузить с сервера, используем локальные данные:",y)}const b=JSON.parse(localStorage.getItem("tutoring_users")||"[]"),P=b.filter(y=>y.role==="teacher");console.log("📱 Зарегистрированных преподавателей (включая офлайн):",P.length),P.forEach(y=>{console.log(`  - ${y.name} (${y.email}) - ID: ${y.id} - Статус: зарегистрирован`)});const A=P.map(y=>({...y,isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()}));localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(A)),u(b);const E=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");return x(E),console.log("🔄 Принудительное обновление состояния для гарантии видимости репетиторов..."),console.log("✅ Зарегистрированные преподаватели загружены (независимо от онлайн статуса)"),P}catch(b){return console.error("❌ Ошибка загрузки зарегистрированных преподавателей:",b),[]}},F=()=>{console.log("🔄 Принудительное обновление всех данных..."),B().catch(console.error),O(),M().catch(console.error),j().catch(console.error),r.current&&s&&(r.current.emit("requestAllSlots"),r.current.emit("requestAllUsers")),K().catch(b=>{console.error("❌ Ошибка при синхронизации данных:",b)})},K=async()=>{try{console.log("🔄 Принудительная синхронизация данных с сервера..."),await M();const b=await fetch(`${_e}/api/sync`,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(1e4)});if(!b.ok){console.warn("⚠️ Не удалось синхронизировать данные с сервера:",b.status,b.statusText);return}const P=b.headers.get("content-type");if(!P||!P.includes("application/json")){console.warn("⚠️ Сервер вернул не-JSON ответ:",P);return}const A=await b.json();console.log("✅ Данные синхронизации получены:",Object.keys(A)),A.timeSlots&&(i(A.timeSlots),te("tutoring_timeSlots",A.timeSlots),console.log("✅ Слоты обновлены:",A.timeSlots.length)),A.lessons&&(c(A.lessons),te("tutoring_lessons",A.lessons),console.log("✅ Уроки обновлены:",A.lessons.length)),A.chats&&(d(A.chats),te("tutoring_chats",A.chats),console.log("✅ Чаты обновлены:",A.chats.length)),A.posts&&(N(A.posts),te("tutoring_posts",A.posts),console.log("✅ Посты обновлены:",A.posts.length));const E=[];A.teacherProfiles&&(console.log("👨‍🏫 Обновляем профили преподавателей:",Object.keys(A.teacherProfiles).length),Object.entries(A.teacherProfiles).forEach(([y,R])=>{const $=R,_={id:y,email:String($.email||""),name:String($.name||""),nickname:String($.nickname||""),role:"teacher",phone:String($.phone||""),profile:$};E.push(_),console.log("👨‍🏫 Добавлен преподаватель:",_.id,_.name,_.email)})),A.studentProfiles&&Object.entries(A.studentProfiles).forEach(([y,R])=>{const $=R;E.push({id:y,email:String($.email||""),name:String($.name||""),nickname:String($.nickname||""),role:"student",phone:String($.phone||""),profile:$})}),u(E),te("tutoring_users",E),console.log("✅ Синхронизация завершена успешно"),console.log("📊 Итоговые данные:"),console.log("- Всего пользователей:",E.length),console.log("- Преподавателей:",E.filter(y=>y.role==="teacher").length),console.log("- Студентов:",E.filter(y=>y.role==="student").length),console.log("- Пользователи:",E)}catch(b){console.warn("Error syncing data (continuing with local data):",b)}},G=async()=>{try{console.log("📤 Загружаем локальные данные на сервер...");const b=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}"),P=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}"),A=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("📊 Локальные данные:"),console.log(`   👨‍🏫 Преподаватели: ${Object.keys(b).length}`),console.log(`   👨‍🎓 Студенты: ${Object.keys(P).length}`),console.log(`   👥 Пользователи: ${A.length}`);const E=await fetch(`${_e}/api/upload-local-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherProfiles:b,studentProfiles:P,users:A})});if(!E.ok){const R=await E.json();throw new Error(R.error||"Ошибка загрузки данных на сервер")}const y=await E.json();return console.log("✅ Локальные данные успешно загружены на сервер:",y),await K(),y}catch(b){throw console.error("❌ Ошибка загрузки локальных данных на сервер:",b),b}},ae=async b=>{try{console.log(`🗑️ Удаляем пользователя: ${b}`);const P=await fetch(`${_e}/api/users/${b}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!P.ok){const E=await P.json();throw new Error(E.error||"Ошибка удаления пользователя")}const A=await P.json();return console.log("✅ Пользователь успешно удален:",A),u(E=>{const y=E.filter(R=>R.id!==b);return te("tutoring_users",y),y}),x(E=>{const y={...E};return delete y[b],te("tutoring_teacherProfiles",y),y}),g(E=>{const y={...E};return delete y[b],te("tutoring_studentProfiles",y),y}),i(E=>E.filter(y=>y.teacherId!==b)),c(E=>E.filter(y=>y.teacherId!==b&&y.studentId!==b)),d(E=>E.filter(y=>!y.participants.includes(b))),N(E=>E.filter(y=>y.userId!==b)),k(E=>E.filter(y=>y.userId!==b)),!0}catch(P){return console.error("❌ Ошибка удаления пользователя:",P),!1}};S.useEffect(()=>{console.log("🔄 Инициализация: загружаем локальных репетиторов..."),B();const b=async()=>{try{const A=await fetch(`${_e}/api/health`,{method:"GET",signal:AbortSignal.timeout(5e3)});if(A.ok){const E=await A.json();return console.log("Server health check passed:",E),!0}return!1}catch(A){return console.warn("Server not available, working in offline mode:",A),!1}};(async()=>{if(!await b()){console.log("Server not available, loading local data only"),T(),j(),B().catch(console.error);return}console.log("Server is available, initializing Socket.IO connection...");const E=ld(_e,{...jd,reconnection:!0,reconnectionAttempts:3,reconnectionDelay:2e3,timeout:1e4});return r.current=E,E.on("connect",()=>{a(!0),console.log("✅ Connected to server via Socket.IO"),console.log(`🌐 Server URL: ${_e}`),console.log(`🔌 Socket ID: ${E.id}`),console.log("🔄 Первоначальное подключение - обновляем данные..."),F();const y=pt("tutoring_timeSlots",[]);y.length>0&&y.forEach(R=>{r.current&&r.current.emit("createSlot",R)}),r.current&&(r.current.emit("requestAllPosts"),p&&(r.current.emit("requestUserNotifications",p.id),r.current.emit("subscribeNotifications",p.id)))}),E.on("disconnect",()=>{console.log("🔌 Disconnected from server")}),E.on("reconnect",y=>{a(!0),console.log(`🔄 Reconnected to server after ${y} attempts`),console.log("🔄 Восстановление соединения - обновляем данные..."),F()}),E.on("reconnect_attempt",y=>{console.log(`🔄 Reconnection attempt ${y}`)}),E.on("connect_error",y=>{console.warn("❌ Socket.IO connection error:",y),console.warn("🔧 Working in offline mode until reconnection..."),T(),j(),B().catch(console.error)}),E.on("initialData",y=>{const _=[...pt("tutoring_timeSlots",[]),...y.timeSlots].filter((ie,ue,Se)=>ue===Se.findIndex(L=>L.id===ie.id));i(_),c(y.lessons),te("tutoring_timeSlots",_),te("tutoring_lessons",y.lessons),y.chats&&(d(y.chats),te("tutoring_chats",y.chats))}),E.on("allSlots",y=>{console.log("✅ Received all slots from server:",y.length),i(y),te("tutoring_timeSlots",y),console.log("✅ All slots synchronized, total slots:",y.length)}),E.on("allUsers",y=>{u(y),te("tutoring_users",y)}),r.current&&s&&(r.current.emit("requestAllSlots"),r.current.emit("requestAllUsers")),E.on("slotCreated",y=>{console.log("✅ Slot created via WebSocket:",y),i(R=>{if(R.find(_=>_.id===y.id)){const _=R.map(ie=>ie.id===y.id?y:ie);return te("tutoring_timeSlots",_),console.log("✅ Existing slot updated, total slots:",_.length),_}else{const _=[...R,y];te("tutoring_timeSlots",_),console.log("✅ New slot added, total slots:",_.length);try{const ie=v||[];if(!ie.find(Se=>Se.id===y.teacherId)){console.log("⚠️ Репетитор не найден в allUsers после создания слота, добавляем...");const Se={id:y.teacherId,name:y.teacherName,avatar:y.teacherAvatar||"",role:"teacher",isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()},L=[...ie,Se];u(L),localStorage.setItem("tutoring_users",JSON.stringify(L));const ee=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]");if(!ee.find(ye=>ye.id===y.teacherId)){const ye=[...ee,Se];localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(ye)),console.log("✅ Репетитор добавлен в зарегистрированных преподавателей")}console.log("✅ Репетитор добавлен в allUsers для гарантии отображения")}}catch(ie){console.error("❌ Ошибка при проверке видимости репетитора:",ie)}return _}}),console.log("🔄 Принудительно обновляем данные после создания слота..."),K().catch(console.error)}),E.on("slotBooked",y=>{console.log("Slot booked via WebSocket:",y),i(R=>{const $=R.map(_=>_.id===y.slotId?{..._,isBooked:!0,bookedStudentId:y.bookedStudentId||y.lesson.studentId}:_);return te("tutoring_timeSlots",$),$}),c(R=>{if(!R.find(_=>_.id===y.lesson.id)){const _=[...R,y.lesson];return te("tutoring_lessons",_),console.log("New lesson added, total lessons:",_.length),_}return R})}),E.on("slotCancelled",y=>{console.log("Slot cancelled via WebSocket:",y),i(R=>{const $=R.map(_=>_.id===y.slotId?{..._,isBooked:!1,bookedStudentId:void 0}:_);return te("tutoring_timeSlots",$),$}),c(R=>{const $=R.filter(_=>_.id!==y.lessonId);return te("tutoring_lessons",$),console.log("Lesson removed, total lessons:",$.length),$})}),E.on("lessonBooked",y=>{console.log("Lesson booked via WebSocket:",y),c(R=>{if(!R.find(_=>_.id===y.id)){const _=[...R,y];return te("tutoring_lessons",_),console.log("New lesson added via WebSocket, total lessons:",_.length),_}return R})}),E.on("chatCreated",y=>{d(R=>{if(!R.find(_=>_.id===y.id)){const _=[...R,y];return te("tutoring_chats",_),_}return R})}),E.on("receiveMessage",y=>{d(R=>R.map($=>{if($.id===y.chatId){const _={...$,messages:[...$.messages,y.message],lastMessage:y.message};return te("tutoring_chats",R.map(ie=>ie.id===$.id?_:ie)),_}return $}))}),E.on("chatDeleted",y=>{console.log("chatDeleted event received:",y),d(R=>{const $=R.filter(_=>_.id!==y.chatId);return console.log(`Chat ${y.chatId} removed from state. Total chats: ${$.length}`),te("tutoring_chats",$),$})}),E.on("chatMarkedAsRead",y=>{d(R=>{const $=R.map(_=>_.id===y.chatId?{..._,messages:_.messages.map(ie=>({...ie,isRead:!0}))}:_);return te("tutoring_chats",$),$})}),E.on("chatMessagesCleared",y=>{d(R=>{const $=R.map(_=>_.id===y.chatId?{..._,messages:[]}:_);return te("tutoring_chats",$),$})}),E.on("chatArchived",y=>{d(R=>{const $=R.map(_=>_.id===y.chatId?{..._,archived:!0}:_);return te("tutoring_chats",$),$})}),E.on("chatUnarchived",y=>{d(R=>{const $=R.map(_=>_.id===y.chatId?{..._,archived:!1}:_);return te("tutoring_chats",$),$})}),E.on("newNotification",y=>{k(R=>{const $=[...R,y];return te("tutoring_notifications",$),$})}),E.on("slotDeleted",y=>{console.log("Slot deleted via WebSocket:",y),i(R=>{const $=R.filter(_=>_.id!==y.slotId);return te("tutoring_timeSlots",$),console.log("Slot removed, total slots:",$.length),$})}),E.on("allLessons",y=>{console.log("Received all lessons from server:",y.length),c(y),te("tutoring_lessons",y)}),E.on("dataUpdated",y=>{if(console.log("Received dataUpdated event:",y.type),y.timeSlots&&(i(y.timeSlots),te("tutoring_timeSlots",y.timeSlots),console.log("Slots updated via dataUpdated:",y.timeSlots.length)),y.lessons&&(c(y.lessons),te("tutoring_lessons",y.lessons),console.log("Lessons updated via dataUpdated:",y.lessons.length)),y.teacherProfiles){x(y.teacherProfiles),te("tutoring_teacherProfiles",y.teacherProfiles);const $=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(_=>_.role==="teacher"&&y.teacherProfiles[_.id]?{..._,profile:y.teacherProfiles[_.id]}:_);u($),te("tutoring_users",$)}if(y.studentProfiles){g(y.studentProfiles),te("tutoring_studentProfiles",y.studentProfiles);const $=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(_=>_.role==="student"&&y.studentProfiles[_.id]?{..._,profile:y.studentProfiles[_.id]}:_);u($),te("tutoring_users",$)}}),E.on("userRegistered",y=>{u(R=>{if(!R.find(_=>_.id===y.id)){const _=[...R,y];if(te("tutoring_users",_),y.role==="teacher"){const ie=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]"),ue={...y,isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()},Se=[...ie,ue];localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(Se)),console.log("👨‍🏫 Преподаватель сохранен для постоянного отображения:",y.name)}return _}return R});try{B(),r.current&&s&&r.current.emit("requestAllUsers")}catch{}}),E.on("userDeleted",y=>{console.log("🗑️ Получено событие удаления пользователя:",y),u(R=>{const $=R.filter(_=>_.id!==y.userId);return te("tutoring_users",$),$}),y.userRole==="teacher"?x(R=>{const $={...R};return delete $[y.userId],te("tutoring_teacherProfiles",$),$}):y.userRole==="student"&&g(R=>{const $={...R};return delete $[y.userId],te("tutoring_studentProfiles",$),$}),i(R=>R.filter($=>$.teacherId!==y.userId)),c(R=>R.filter($=>$.teacherId!==y.userId&&$.studentId!==y.userId)),d(R=>R.filter($=>!$.participants.includes(y.userId))),N(R=>R.filter($=>$.userId!==y.userId)),k(R=>R.filter($=>$.userId!==y.userId)),console.log("✅ Пользователь удален из локального состояния")}),r.current&&r.current.on("lessonCompleted",y=>{if(c(R=>{const $=R.map(_=>_.id===y.lesson.id?y.lesson:_);return te("tutoring_lessons",$),$}),p&&p.role==="teacher"&&y.lesson.status==="completed"){const R={...p.profile};R.lessonsCount=(R.lessonsCount||0)+1,C(R)}}),E.on("studentProfiles",y=>{g(y||{});const $=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(y).forEach(([_,ie])=>{const ue=$.findIndex(Se=>Se.id===_);ue>=0?$[ue]={...$[ue],profile:ie}:$.push({id:_,email:ie.email||"",name:ie.name||"",nickname:ie.nickname||"",role:"student",phone:ie.phone||"",profile:ie})}),localStorage.setItem("tutoring_users",JSON.stringify($)),u($)}),E.on("teacherProfiles",y=>{x(y),te("tutoring_teacherProfiles",y);const $=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(y).forEach(([_,ie])=>{const ue=$.findIndex(Se=>Se.id===_);ue>=0?$[ue]={...$[ue],profile:ie}:$.push({id:_,email:ie.email||"",name:ie.name||"",nickname:ie.nickname||"",role:"teacher",phone:ie.phone||"",profile:ie})}),localStorage.setItem("tutoring_users",JSON.stringify($)),u($)}),E.on("studentProfileUpdated",y=>{g(R=>({...R,[y.studentId]:y.profile}))}),E.on("teacherProfileUpdated",y=>{try{const $=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(_=>_.id===y.teacherId?{..._,profile:y.profile,avatar:y.profile.avatar}:_);localStorage.setItem("tutoring_users",JSON.stringify($)),u($)}catch{}}),E.on("profileUpdated",y=>{try{const R=JSON.parse(localStorage.getItem("tutoring_users")||"[]");let $=!1;const _="userId"in y?y.userId:y.id,ie="type"in y?y.type:y.role,ue=y.profile,Se=R.map(L=>L.id===_?($=!0,{...L,profile:ue,avatar:ue.avatar,name:ue.name||L.name,email:ue.email||L.email}):L);$||Se.push({id:_,role:ie,profile:ue,avatar:ue.avatar,name:ue.name||"",email:ue.email||""}),localStorage.setItem("tutoring_users",JSON.stringify(Se)),u(Se),ie==="teacher"?x(L=>({...L,[_]:ue})):ie==="student"&&g(L=>({...L,[_]:ue})),console.log("Profile updated via WebSocket:",{userId:_,role:ie,profile:ue})}catch(R){console.error("Error processing profileUpdated event:",R)}}),E.on("userRegistered",y=>{try{const R=JSON.parse(localStorage.getItem("tutoring_users")||"[]"),$=R.findIndex(_=>_.id===y.id);if($>=0?R[$]=y:R.push(y),localStorage.setItem("tutoring_users",JSON.stringify(R)),u(R),y.role==="teacher"){const _=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]"),ie={...y,isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()},ue=[..._,ie];localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(ue)),console.log("👨‍🏫 Преподаватель сохранен для постоянного отображения:",y.name)}B().catch(console.error),r.current&&s&&r.current.emit("requestAllUsers")}catch{}}),E.on("allPosts",y=>{N(y),te("tutoring_posts",y)}),E.on("postCreated",y=>{N(R=>{const $=[y,...R];return te("tutoring_posts",$),$})}),E.on("postReactionUpdated",y=>{N(R=>{const $=R.map(_=>_.id===y.postId?{..._,reactions:y.reactions,likes:y.likes}:_);return te("tutoring_posts",$),$})}),E.on("postCommentAdded",y=>{N(R=>{const $=R.map(_=>_.id===y.postId?{..._,comments:[..._.comments,y.comment]}:_);return te("tutoring_posts",$),$})}),E.on("postEdited",y=>{N(R=>{const $=R.map(_=>_.id===y.postId?{..._,text:y.text,tags:y.tags,editedAt:y.editedAt}:_);return te("tutoring_posts",$),$})}),E.on("postDeleted",y=>{N(R=>{const $=R.filter(_=>_.id!==y.postId);return te("tutoring_posts",$),$})}),E.on("postBookmarkUpdated",y=>{N(R=>{const $=R.map(_=>_.id===y.postId?{..._,bookmarks:y.bookmarks}:_);return te("tutoring_posts",$),$})}),E.on("searchResults",y=>{}),E.on("userNotifications",y=>{k(y),te("tutoring_notifications",y)}),E.on("notificationMarkedAsRead",y=>{k(R=>{const $=R.map(_=>_.id===y.notificationId?{..._,isRead:!0,readAt:new Date().toISOString()}:_);return te("tutoring_notifications",$),$})}),E.on("allNotificationsMarkedAsRead",y=>{k(R=>{const $=R.map(_=>_.userId===y.userId?{..._,isRead:!0,readAt:new Date().toISOString()}:_);return te("tutoring_notifications",$),$})}),()=>{try{E.removeAllListeners()}catch{}try{E.disconnect()}catch{}r.current=null}})()},[]),S.useEffect(()=>{const b=A=>{if(A.key==="tutoring_users")try{const E=JSON.parse(A.newValue||"[]");u(E);const y=E.filter(R=>R.role==="teacher");console.log("🔄 Обновление репетиторов через localStorage:",y.length)}catch{u([])}},P=A=>{var E,y,R;if(((E=A.detail)==null?void 0:E.key)==="tutoring_users")try{const $=JSON.parse(A.detail.newValue||"[]");u($),console.log("🔄 Пользователи обновлены через customStorage:",$.length)}catch{u([])}if(((y=A.detail)==null?void 0:y.key)==="tutoring_teacherProfiles")try{const $=JSON.parse(A.detail.newValue||"{}");x($),console.log("🔄 Профили преподавателей обновлены через customStorage:",Object.keys($).length)}catch($){console.error("❌ Ошибка обновления профилей преподавателей:",$)}if(((R=A.detail)==null?void 0:R.key)==="tutoring_studentProfiles")try{const $=JSON.parse(A.detail.newValue||"{}");g($),console.log("🔄 Профили студентов обновлены через customStorage:",Object.keys($).length)}catch($){console.error("❌ Ошибка обновления профилей студентов:",$)}};return window.addEventListener("storage",b),window.addEventListener("customStorage",P),()=>{window.removeEventListener("storage",b),window.removeEventListener("customStorage",P)}},[]),S.useEffect(()=>{te("tutoring_timeSlots",n),n.length>0&&(console.log("🔄 timeSlots изменились, принудительно синхронизируем с сервером..."),K().catch(console.error))},[n,K]),S.useEffect(()=>{te("tutoring_lessons",o)},[o]),S.useEffect(()=>{te("tutoring_chats",l)},[l]),S.useEffect(()=>{te("tutoring_posts",f)},[f]),S.useEffect(()=>{te("tutoring_notifications",w)},[w]),S.useEffect(()=>{p&&r.current&&s&&(r.current.emit("subscribeNotifications",p.id),r.current.emit("requestUserNotifications",p.id))},[p,s]);const H=b=>{const P={...b,id:`slot_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};i(A=>{const E=[...A,P];return te("tutoring_timeSlots",E),E}),r.current&&s&&r.current.emit("createSlot",P)},Y=async(b,P,A,E)=>new Promise((y,R)=>{if((E==null?void 0:E.mode)==="assign"&&(!P||!A)){alert("Ошибка: не выбран ученик для назначения урока!"),R(new Error("createSlot: assign mode without studentId/studentName"));return}const $=!!P,_={...b,id:`slot_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,isBooked:$,...$?{bookedStudentId:P}:{}};i(ie=>{const ue=[...ie,_];return te("tutoring_timeSlots",ue),console.log("✅ Слот создан и сохранен локально:",_.id),ue});try{const ie=v||[];if(ie.find(Se=>Se.id===_.teacherId))console.log("✅ Репетитор уже существует в allUsers");else{console.log("⚠️ Репетитор не найден в allUsers, добавляем...");const Se={id:_.teacherId,name:_.teacherName,avatar:_.teacherAvatar||"",role:"teacher",isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()},L=[...ie,Se];u(L),localStorage.setItem("tutoring_users",JSON.stringify(L));const ee=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]");if(!ee.find(ye=>ye.id===_.teacherId)){const ye=[...ee,Se];localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(ye)),console.log("✅ Репетитор добавлен в зарегистрированных преподавателей")}console.log("✅ Репетитор добавлен в allUsers для гарантии отображения")}}catch(ie){console.error("❌ Ошибка при проверке видимости репетитора:",ie)}if(r.current&&s?(r.current.emit("createSlot",_),console.log("📡 Слот отправлен на сервер")):console.log("⚠️ Нет соединения с сервером, слот сохранен локально"),$&&P&&A){const ie={id:`lesson_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,studentId:P,teacherId:_.teacherId,studentName:A,teacherName:_.teacherName,subject:_.subject,date:_.date,startTime:_.startTime,endTime:_.endTime,duration:_.duration,format:_.format,status:"scheduled",price:_.price,lessonType:_.lessonType};if(c(ue=>[...ue,ie]),de(P,_.teacherId,A,_.teacherName),p&&p.role==="teacher"){const ue={...p.profile};ue.students||(ue.students=[]),ue.students.includes(P)||ue.students.push(P),C(ue)}r.current&&s&&r.current.emit("bookSlot",{slotId:_.id,lesson:ie,bookedStudentId:P})}y(_)}),U=(b,P,A,E)=>{const y=n.find($=>$.id===b);if(!y||y.isBooked)return;if(p&&p.role==="teacher"){const $={...p.profile};$.students||($.students=[]),$.students.includes(P)||$.students.push(P),C($)}i($=>$.map(_=>_.id===b?{..._,isBooked:!0,bookedStudentId:P}:_));const R={id:`lesson_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,studentId:P,teacherId:y.teacherId,studentName:A,teacherName:y.teacherName,subject:y.subject,date:y.date,startTime:y.startTime,endTime:y.endTime,duration:y.duration,format:y.format,status:"scheduled",price:y.price,lessonType:y.lessonType,comment:E||""};c($=>[...$,R]),de(P,y.teacherId,A,y.teacherName),r.current&&s&&r.current.emit("bookSlot",{slotId:b,lesson:R,bookedStudentId:P})},Z=b=>{const P=o.find(E=>E.id===b);if(!P)return;const A=n.find(E=>E.teacherId===P.teacherId&&E.date===P.date&&E.startTime===P.startTime);c(E=>E.filter(y=>y.id!==b)),A&&(i(E=>E.map(y=>y.id===A.id?{...y,isBooked:!1,bookedStudentId:void 0}:y)),r.current&&s&&r.current.emit("cancelSlot",{slotId:A.id,lessonId:b}))},re=(b,P,A)=>{const E=o.find(R=>R.id===b);if(!E)return;const y=new Date(`2000-01-01T${A}`);y.setMinutes(y.getMinutes()+E.duration),c(R=>R.map($=>$.id===b?{...$,date:P,startTime:A,endTime:y.toTimeString().slice(0,5)}:$)),i(R=>R.map($=>$.teacherId===E.teacherId&&$.date===E.date&&$.startTime===E.startTime?{...$,isBooked:!1,bookedStudentId:void 0}:$))},W=b=>n.filter(A=>{var R;if(A.isBooked)return!1;const E=new Date(A.date),y=new Date;if(y.setHours(0,0,0,0),E<y||b.grade&&b.grade!==""&&(!A.grades||!A.grades.includes(b.grade))||b.subject&&b.subject!==""&&A.subject!==b.subject||b.experience&&b.experience!==""&&A.experience!==b.experience||b.lessonType&&b.lessonType!==""&&A.lessonType!==b.lessonType||b.duration&&b.duration>0&&A.duration!==b.duration||b.format&&b.format!==""&&A.format!==b.format||b.minRating&&b.minRating>0&&(A.rating||0)<b.minRating||b.goals&&b.goals.length>0&&(!A.goals||!b.goals.some($=>A.goals.includes($))))return!1;if(b.city&&b.city!==""){const $=v.find(ie=>ie.id===A.teacherId),_=((R=$==null?void 0:$.profile)==null?void 0:R.city)||"";if(_&&!_.toLowerCase().includes(b.city.toLowerCase()))return!1}return!0}),de=(b,P,A,E)=>{console.log("🔍 getOrCreateChat DEBUG:"),console.log("- Participant 1:",{id:b,name:A}),console.log("- Participant 2:",{id:P,name:E}),console.log("- Current chats count:",l.length);const y=l.find($=>$.participants.includes(b)&&$.participants.includes(P));if(y)return console.log("✅ Found existing chat:",y.id),y.id;console.log("🆕 Creating new chat...");const R={id:`chat_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,participants:[b,P],participantNames:[A,E],messages:[]};if(console.log("📝 New chat created:",R.id),d($=>{const _=[...$,R];return te("tutoring_chats",_),console.log("💾 Chat saved to localStorage, total chats:",_.length),_}),r.current&&s){console.log("📡 Sending chat to server..."),r.current.emit("createChat",R);const $={id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:P,type:"new_chat",title:"Новый чат",message:`${A} создал с вами чат`,isRead:!1,timestamp:new Date().toISOString(),data:{chatId:R.id,studentId:b,studentName:A}};r.current.emit("createNotification",$),console.log("📬 Notification sent to server")}else console.log("⚠️ Socket not connected, chat not sent to server");return console.log("🔍 END getOrCreateChat DEBUG"),R.id},xe=(b,P,A,E)=>{console.log("🔍 sendMessage DEBUG:"),console.log("- Chat ID:",b),console.log("- Sender:",{id:P,name:A}),console.log("- Content:",E);const y=l.find(ie=>ie.id===b);if(!y){console.error("❌ Chat not found:",b);return}console.log("✅ Chat found:",{id:y.id,participants:y.participants,participantNames:y.participantNames});const R=y.participants.find(ie=>ie!==P),$=y.participantNames.find((ie,ue)=>y.participants[ue]!==P);if(!R){console.error("❌ Receiver not found in chat participants");return}console.log("📬 Receiver:",{id:R,name:$});const _={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,senderId:P,senderName:A,receiverId:R,receiverName:$||"Неизвестный пользователь",content:E,timestamp:new Date().toISOString(),isRead:!1};console.log("📝 Message created:",_.id),d(ie=>ie.map(ue=>{if(ue.id===b){const Se={...ue,messages:[...ue.messages,_],lastMessage:_};return te("tutoring_chats",ie.map(L=>L.id===ue.id?Se:L)),console.log("💾 Message saved locally, total messages in chat:",Se.messages.length),Se}return ue})),r.current&&s?(console.log("📡 Sending message to server..."),r.current.emit("sendMessage",{chatId:b,message:_}),console.log("✅ Message sent to server")):console.log("⚠️ Socket not connected, message not sent to server"),console.log("🔍 END sendMessage DEBUG")},me=(b,P,A,E,y)=>{if(console.log("🔍 sendMessageToUser DEBUG:"),console.log("- Sender:",{id:b,name:P}),console.log("- Receiver:",{id:A,name:E}),console.log("- Content:",y),!b||!P||!A||!E||!y)return console.error("❌ Missing required parameters for sendMessageToUser"),"";const R=de(b,A,P,E);return console.log("- Chat ID:",R),R?(xe(R,b,P,y),console.log("✅ Message sent successfully to chat:",R),console.log("🔍 END sendMessageToUser DEBUG"),R):(console.error("❌ Failed to create or find chat"),"")},we=b=>{r.current&&s&&r.current.emit("lessonCompleted",{lessonId:b})},Ne=(b,P)=>{r.current&&r.current.emit("updateStudentProfile",{studentId:b,profile:P}),g(A=>({...A,[b]:P}))},Q=b=>{i(P=>{const A=P.map(E=>E.id===b?{...E,isDeleted:!0}:E);return te("tutoring_timeSlots",A),A}),r.current&&s&&r.current.emit("deleteSlot",{slotId:b})},be=()=>{i([]),c([]),d([]),localStorage.removeItem("tutoring_timeSlots"),localStorage.removeItem("tutoring_lessons"),localStorage.removeItem("tutoring_chats"),localStorage.removeItem("tutoring_users"),localStorage.removeItem("tutoring_currentUser")},J=(b,P)=>{console.log("🔄 Обновляем профиль преподавателя:",b,P),x(A=>{const E={...A,[b]:P};return te("tutoring_teacherProfiles",E),console.log("✅ Профиль преподавателя сохранен в teacherProfiles"),E}),r.current&&s&&(r.current.emit("updateTeacherProfile",{teacherId:b,profile:P}),console.log("📡 Профиль преподавателя отправлен на сервер"));try{const E=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map($=>$.id===b?{...$,profile:P,avatar:P.avatar}:$);localStorage.setItem("tutoring_users",JSON.stringify(E)),console.log("✅ Профиль преподавателя обновлен в tutoring_users"),u($=>{const _=$.map(ie=>ie.id===b?{...ie,profile:P,avatar:P.avatar}:ie);return console.log("✅ allUsers обновлен, репетитор остался видимым"),_});const R=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]").map($=>$.id===b?{...$,profile:P,avatar:P.avatar}:$);localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(R)),console.log("✅ Зарегистрированные преподаватели обновлены")}catch(A){console.error("❌ Ошибка обновления списка пользователей:",A)}},V=b=>{if(!p)return;const P=y=>{if(!y)return[];const R=/#[\wа-яё]+/gi,$=y.match(R);return $?[...new Set($.map(_=>_.toLowerCase()))]:[]},A=b.media.map(y=>URL.createObjectURL(y)),E={id:`post_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:p.id,userName:p.name,userAvatar:p.avatar,text:b.text,media:A,type:b.type,date:new Date().toISOString(),reactions:[],comments:[],isBookmarked:!1,tags:P(b.text),likes:0,views:0,bookmarks:[]};N(y=>{const R=[E,...y];return te("tutoring_posts",R),R}),r.current&&s&&r.current.emit("createPost",E)},je=(b,P)=>{p&&(N(A=>{const E=A.map(y=>{if(y.id===b){const R=y.reactions.find(ie=>ie.userId===p.id);let $=[...y.reactions],_=y.likes||0;return R?R.type===P?($=y.reactions.filter(ie=>ie.userId!==p.id),_=Math.max(0,_-1)):R.type=P:($.push({id:`reaction_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:p.id,type:P,date:new Date().toISOString()}),_++),{...y,reactions:$,likes:_}}return y});return te("tutoring_posts",E),E}),r.current&&s&&r.current.emit("addReaction",{postId:b,reactionType:P,userId:p.id}))},Ce=(b,P)=>{if(!p)return;const A={id:`comment_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:p.id,userName:p.name,userAvatar:p.avatar,text:P,date:new Date().toISOString()};N(E=>{const y=E.map(R=>R.id===b?{...R,comments:[...R.comments,A]}:R);return te("tutoring_posts",y),y}),r.current&&s&&r.current.emit("addComment",{postId:b,comment:A})},Ge=b=>{},Je=b=>{p&&(N(P=>{const A=P.map(E=>{if(E.id===b){const y=E.bookmarks||[],R=y.indexOf(p.id);let $=[...y];return R===-1?$.push(p.id):$.splice(R,1),{...E,bookmarks:$}}return E});return te("tutoring_posts",A),A}),r.current&&s&&r.current.emit("bookmarkPost",{postId:b,userId:p.id}))},qe=(b,P)=>{const A=E=>{if(!E)return[];const y=/#[\wа-яё]+/gi,R=E.match(y);return R?[...new Set(R.map($=>$.toLowerCase()))]:[]};N(E=>{const y=E.map(R=>R.id===b?{...R,text:P,tags:A(P),editedAt:new Date().toISOString()}:R);return te("tutoring_posts",y),y}),r.current&&s&&r.current.emit("editPost",{postId:b,newText:P})},q=b=>{N(P=>{const A=P.filter(E=>E.id!==b);return te("tutoring_posts",A),A}),r.current&&s&&r.current.emit("deletePost",{postId:b})},Ee=b=>{console.log("deleteChat called with chatId:",b),console.log("Current chats count:",l.length),d(P=>{if(!P.find(y=>y.id===b))return console.warn("Chat not found for deletion:",b),P;const E=P.filter(y=>y.id!==b);return console.log(`Chat ${b} removed. New count: ${E.length}`),te("tutoring_chats",E),E}),r.current&&s?(console.log("Sending deleteChat event to server"),r.current.emit("deleteChat",{chatId:b})):console.warn("Socket not connected, chat deletion not synced to server")},fe=b=>{d(P=>{const A=P.map(E=>E.id===b?{...E,messages:E.messages.map(y=>({...y,isRead:!0}))}:E);return te("tutoring_chats",A),A}),r.current&&s&&r.current.emit("markChatAsRead",{chatId:b})},ke=b=>{d(P=>{const A=P.map(E=>E.id===b?{...E,messages:[]}:E);return te("tutoring_chats",A),A}),r.current&&s&&r.current.emit("clearChatMessages",{chatId:b})},We=b=>{d(P=>{const A=P.map(E=>E.id===b?{...E,archived:!0}:E);return te("tutoring_chats",A),A}),r.current&&s&&r.current.emit("archiveChat",{chatId:b})},$e=b=>{d(P=>{const A=P.map(E=>E.id===b?{...E,archived:!1}:E);return te("tutoring_chats",A),A}),r.current&&s&&r.current.emit("unarchiveChat",{chatId:b})},Be=async()=>{try{console.log("🔄 Loading chats from server:",`${_e}/api/sync`);const b=await fetch(`${_e}/api/sync`);if(b.ok){const P=b.headers.get("content-type");if(P&&P.includes("application/json")){const A=await b.json();A.chats&&(console.log("✅ Loaded chats from server:",A.chats.length),d(A.chats),te("tutoring_chats",A.chats))}else console.warn("⚠️ Server returned non-JSON response, using local chats")}else console.error("❌ Failed to load chats from server:",b.status,b.statusText)}catch(b){console.warn("⚠️ Error loading chats from server, using local chats:",b)}},at=b=>{console.log("🗑️ Удаляем все данные пользователя:",b),i(P=>{const A=P.filter(E=>E.teacherId!==b);return te("tutoring_timeSlots",A),A}),c(P=>{const A=P.filter(E=>E.teacherId!==b&&E.studentId!==b);return te("tutoring_lessons",A),A}),d(P=>{const A=P.filter(E=>!E.participants.includes(b));return te("tutoring_chats",A),A}),N(P=>{const A=P.filter(E=>E.userId!==b);return te("tutoring_posts",A),A}),k(P=>{const A=P.filter(E=>E.userId!==b);return te("tutoring_notifications",A),A}),(p==null?void 0:p.role)==="teacher"?x(P=>{const A={...P};return delete A[b],te("tutoring_teacherProfiles",A),A}):(p==null?void 0:p.role)==="student"&&g(P=>{const A={...P};return delete A[b],te("tutoring_studentProfiles",A),A}),u(P=>{const A=P.filter(E=>E.id!==b);return te("tutoring_users",A),A}),console.log("✅ Все данные пользователя удалены")};return e.jsx(ao.Provider,{value:{timeSlots:n,lessons:o,chats:l,posts:f,createTimeSlot:H,bookLesson:U,cancelLesson:Z,rescheduleLesson:re,getFilteredSlots:W,sendMessage:xe,sendMessageToUser:me,getOrCreateChat:de,clearAllData:be,isConnected:s,completeLesson:we,studentProfiles:m,updateStudentProfile:Ne,deleteSlot:Q,createSlot:Y,allUsers:v,setAllUsers:b=>{u(b),localStorage.setItem("tutoring_users",JSON.stringify(b));const P=b.filter(A=>A.role==="teacher");if(P.length>0){const A=P.map(E=>({...E,isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()}));localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(A))}},refreshUsers:O,loadRegisteredTeachers:B,refreshAllData:F,forceSyncData:K,uploadLocalDataToServer:G,deleteUser:ae,teacherProfiles:h,updateTeacherProfile:J,socketRef:r,loadInitialData:T,createPost:V,addReaction:je,addComment:Ce,sharePost:Ge,bookmarkPost:Je,editPost:qe,deletePost:q,searchPosts:b=>{r.current&&s&&r.current.emit("searchPosts",b)},getPostsByUser:b=>f.filter(P=>P.userId===b),getBookmarkedPosts:b=>f.filter(P=>{var A;return(A=P.bookmarks)==null?void 0:A.includes(b)}),notifications:w,subscribeToNotifications:b=>{r.current&&s&&r.current.emit("subscribeNotifications",b)},unsubscribeFromNotifications:b=>{r.current&&s&&r.current.emit("unsubscribeNotifications",b)},markNotificationAsRead:b=>{k(P=>{const A=P.map(E=>E.id===b?{...E,isRead:!0,readAt:new Date().toISOString()}:E);return te("tutoring_notifications",A),A}),r.current&&s&&r.current.emit("markNotificationAsRead",b)},markAllNotificationsAsRead:b=>{k(P=>{const A=P.map(E=>E.userId===b?{...E,isRead:!0,readAt:new Date().toISOString()}:E);return te("tutoring_notifications",A),A}),r.current&&s&&r.current.emit("markAllNotificationsAsRead",b)},deleteNotification:b=>{k(P=>{const A=P.filter(E=>E.id!==b);return te("tutoring_notifications",A),A})},deleteChat:Ee,markChatAsRead:fe,clearChatMessages:ke,archiveChat:We,unarchiveChat:$e,loadChatsFromServer:Be,deleteUserData:at},children:t})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var kd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),oe=(t,r)=>{const s=S.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:l,...d},m)=>S.createElement("svg",{ref:m,...kd,width:n,height:n,stroke:a,strokeWidth:o?Number(i)*24/Number(n):i,className:["lucide",`lucide-${Cd(t)}`,c].join(" "),...d},[...r.map(([g,h])=>S.createElement(g,h)),...Array.isArray(l)?l:[l]]));return s.displayName=`${t}`,s};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=oe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=oe("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=oe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=oe("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=oe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=oe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=oe("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=oe("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=oe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=oe("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=oe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=oe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dd=oe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=oe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=oe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=oe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=oe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=oe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=oe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=oe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=oe("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=oe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=oe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=oe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=oe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=oe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=oe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=oe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=oe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=oe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=oe("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=oe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=oe("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=oe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=oe("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=oe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=oe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=oe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bd=oe("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hd=oe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=oe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=oe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=oe("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=oe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=oe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=oe("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=oe("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=oe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=oe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=oe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=oe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=oe("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=oe("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=oe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=oe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=oe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=oe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=oe("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vd=oe("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=oe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Jd=({onSuccess:t})=>{const[r,s]=S.useState(!0),[a,n]=S.useState(""),[i,o]=S.useState(""),[c,l]=S.useState(""),[d,m]=S.useState(""),[g,h]=S.useState(""),[x,v]=S.useState("student"),[u,f]=S.useState(!1),[N,w]=S.useState(!1),{login:k,register:p}=Ke(),C=async T=>{T.preventDefault(),f(!0);try{if(r)await k(a,i),t();else{if(!N){w(!0),f(!1);return}if(!g.trim()){alert("Пожалуйста, введите никнейм"),f(!1);return}if(!d.trim()){alert("Пожалуйста, введите номер телефона"),f(!1);return}await p(a,i,c,g,x,d)&&t()}}catch{}finally{f(!1)}};return!r&&N?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-[#0D3C69] rounded-xl flex items-center justify-center mb-4",children:e.jsx(Ae,{className:"h-6 w-6 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Выберите роль"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Кто вы на нашей платформе?"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>v("student"),className:`w-full p-6 rounded-xl border-2 transition-all duration-200 ${x==="student"?"border-[#0D3C69] bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${x==="student"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(ve,{className:`h-6 w-6 ${x==="student"?"text-[#0D3C69]":"text-gray-600"}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Ученик"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ищу репетитора для обучения"})]})]})}),e.jsx("button",{onClick:()=>v("teacher"),className:`w-full p-6 rounded-xl border-2 transition-all duration-200 ${x==="teacher"?"border-[#0D3C69] bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${x==="teacher"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(Yd,{className:`h-6 w-6 ${x==="teacher"?"text-[#0D3C69]":"text-gray-600"}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Преподаватель"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Провожу уроки и делюсь знаниями"})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nickname",className:"block text-sm font-medium text-gray-700 mb-1",children:"Никнейм"}),e.jsx("input",{id:"nickname",type:"text",value:g,onChange:T=>h(T.target.value),required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200",placeholder:"Введите никнейм"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Номер телефона"}),e.jsxs("div",{className:"relative",children:[e.jsx(jt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",type:"tel",value:d,onChange:T=>m(T.target.value),required:!0,className:"w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsx("button",{onClick:C,disabled:u||!g.trim()||!d.trim(),className:"w-full bg-[#0D3C69] hover:bg-[#0A2F56] text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Создание аккаунта...":"Завершить регистрацию"}),e.jsx("button",{onClick:()=>w(!1),className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-4 rounded-lg transition-colors duration-200",children:"Назад"})]})]})}):e.jsxs("div",{className:"min-h-screen flex",children:[e.jsx("div",{className:"flex-1 bg-white flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Добро пожаловать"}),e.jsx("p",{className:"text-lg text-gray-600",children:r?"Войдите в свой аккаунт":"Создайте новый аккаунт"})]}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[!r&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Имя"}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"name",type:"text",value:c,onChange:T=>l(T.target.value),required:!r,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"Введите ваше имя"})]})]}),!r&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Номер телефона"}),e.jsxs("div",{className:"relative",children:[e.jsx(jt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",type:"tel",value:d,onChange:T=>m(T.target.value),required:!r,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(un,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"email",type:"email",value:a,onChange:T=>n(T.target.value),required:!0,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"Введите ваш email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Пароль"}),e.jsxs("div",{className:"relative",children:[e.jsx(io,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"password",type:"password",value:i,onChange:T=>o(T.target.value),required:!0,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:r?"Введите пароль":"Создайте пароль"})]})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-[#0D3C69] hover:bg-[#0A2F56] text-white font-bold py-4 px-6 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-lg shadow-lg hover:shadow-xl transform hover:scale-105",children:u?r?"Вход...":"Создание аккаунта...":r?"Войти":"Создать аккаунт"})]}),e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["Продолжая, вы соглашаетесь с"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Условиями использования"})," ","и"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Политикой конфиденциальности"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-gray-600",children:r?"Нет аккаунта? ":"Уже есть аккаунт? "}),e.jsx("button",{onClick:()=>{s(!r),w(!1),n(""),o(""),l(""),m(""),h("")},className:"text-[#0D3C69] hover:text-[#0A2F56] font-medium",children:r?"Зарегистрироваться":"Войти"})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"text-[#0D3C69] hover:text-[#0A2F56] text-sm",children:"Получить помощь"})}),e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["Этот сайт защищен reCAPTCHA Enterprise и применяются"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Политика конфиденциальности"})," ","и"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Условия использования"})," ","Google."]})]})}),e.jsxs("div",{className:"flex-1 bg-gray-900 flex flex-col items-center justify-center p-8 relative overflow-hidden",children:[e.jsx("h2",{className:"text-5xl font-bold text-white mb-8 text-center",children:"Платформа для обучения"}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("blockquote",{className:"text-xl text-gray-300 italic leading-relaxed",children:'"Важно не количество знаний, а качество их. Можно знать очень многое не зная самого нужного."'}),e.jsx("cite",{className:"text-sm text-gray-400 mt-4 block",children:"— Л. Толстой"})]}),e.jsxs("div",{className:"relative w-full h-64 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-blue-900 via-purple-900 to-black"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 opacity-20"})}),e.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((T,M)=>e.jsx("div",{className:"absolute w-1 h-1 bg-yellow-300 rounded-full animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`}},M))})]})]})]})},Xd=({activeTab:t,onTabChange:r})=>{const{user:s,logout:a}=Ke(),[n,i]=S.useState(!1),o=S.useRef(null),c=S.useRef(null);S.useEffect(()=>{const g=h=>{const x=h.target;n&&c.current&&!c.current.contains(x)&&o.current&&!o.current.contains(x)&&i(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[n]);const l=[{id:"home",label:"Главная",icon:Ad},{id:"lessons",label:"Мои уроки",icon:Ze},{id:"chats",label:"Чаты",icon:Ue},{id:"profile",label:"Профиль",icon:ve}],d=[{id:"slots",label:"Слоты",icon:Ze},{id:"calendar",label:"Календарь",icon:Ed},{id:"students",label:"Ученики",icon:ve},{id:"chats",label:"Чаты",icon:Ue},{id:"profile",label:"Профиль",icon:ve}],m=(s==null?void 0:s.role)==="teacher"?d:l;return e.jsx("nav",{className:"bg-card-light dark:bg-card-dark shadow-lg border-b border-border-light dark:border-border-dark transition-colors",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-8",children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-xl flex items-center justify-center shadow-md",style:{background:"#175b8c"},children:e.jsx("span",{className:"text-white font-bold text-lg",style:{fontFamily:"Inter, sans-serif",fontSize:28},children:"Na"})}),e.jsx("span",{className:"ml-3 text-2xl font-bold",style:{color:"#175b8c",fontFamily:"Inter, sans-serif"},children:"uchi"})]}),e.jsxs("div",{className:"hidden md:flex space-x-8 relative",children:[m.map(g=>{const h=g.icon,x=(s==null?void 0:s.role)==="teacher"&&g.id==="profile";return e.jsxs("button",{ref:x?o:null,onClick:()=>{if(x){i(v=>!v);return}r(g.id)},className:`flex items-center gap-2 px-5 py-3 rounded-xl text-base font-semibold transition-all duration-200 shadow-none ${t===g.id?"bg-primary-light/10 text-primary-light dark:bg-primary-dark/20 dark:text-primary-dark shadow-md":"text-textSecondary-light dark:text-textSecondary-dark hover:bg-border-light dark:hover:bg-border-dark hover:text-primary-light dark:hover:text-primary-dark"}`,children:[e.jsx(h,{className:"h-5 w-5"}),e.jsx("span",{children:g.label})]},g.id)}),(s==null?void 0:s.role)==="teacher"&&n&&e.jsxs("div",{ref:c,className:"absolute top-14 right-0 w-64 bg-white dark:bg-card-dark border border-border-light dark:border-border-dark rounded-xl shadow-2xl py-2 z-50",children:[e.jsx("div",{className:"px-4 py-2 text-xs uppercase tracking-wide text-gray-400",children:"Профиль"}),e.jsxs("button",{onClick:()=>{i(!1),r("profile")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-blue-500"}),e.jsx("span",{children:"Просмотреть профиль"})]}),e.jsxs("button",{onClick:()=>{i(!1),r("slots")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{children:"Слоты"})]}),e.jsxs("button",{onClick:()=>{i(!1),r("calendar")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-purple-500"}),e.jsx("span",{children:"Календарь"})]}),e.jsxs("button",{onClick:()=>{i(!1),r("students")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-amber-500"}),e.jsx("span",{children:"Ученики"})]}),e.jsxs("button",{onClick:()=>{i(!1),r("materials")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-pink-500"}),e.jsx("span",{children:"Материалы"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:s==null?void 0:s.nickname.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:s==null?void 0:s.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["@",s==null?void 0:s.nickname]})]}),e.jsx("span",{className:"hidden md:block text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full",children:(s==null?void 0:s.role)==="teacher"?"Преподаватель":"Ученик"})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg transition-all duration-200",title:"Выйти",children:e.jsx(Id,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"md:hidden border-t border-border-light dark:border-border-dark",children:e.jsx("div",{className:"flex space-x-1 py-2 overflow-x-auto",children:m.map(g=>{const h=g.icon;return e.jsxs("button",{onClick:()=>{if((s==null?void 0:s.role)==="teacher"&&g.id==="profile"){r("profile");return}r(g.id)},className:`flex-shrink-0 flex flex-col items-center gap-1 px-4 py-3 rounded-xl text-xs font-semibold transition-all duration-200 ${t===g.id?"bg-primary-light/10 text-primary-light dark:bg-primary-dark/20 dark:text-primary-dark shadow-md":"text-textSecondary-light dark:text-textSecondary-dark hover:bg-border-light dark:hover:bg-border-dark hover:text-primary-light dark:hover:text-primary-dark"}`,children:[e.jsx(h,{className:"h-5 w-5"}),e.jsx("span",{children:g.label})]},g.id)})})})]})})};function Wt(t){"@babel/helpers - typeof";return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Wt(t)}function Zd(t,r){if(Wt(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var a=s.call(t,r);if(Wt(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function ho(t){var r=Zd(t,"string");return Wt(r)=="symbol"?r:r+""}function sr(t,r,s){return(r=ho(r))in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function pi(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,a)}return s}function Oe(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?pi(Object(s),!0).forEach(function(a){sr(t,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):pi(Object(s)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(s,a))})}return t}function sa(t,r){if(t==null)return{};var s={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(r.indexOf(a)!==-1)continue;s[a]=t[a]}return s}function _t(t,r){if(t==null)return{};var s,a,n=sa(t,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function He(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function vi(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,ho(a.key),a)}}function ze(t,r,s){return r&&vi(t.prototype,r),s&&vi(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ws(t){return Ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ws(t)}function fo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fo=function(){return!!t})()}function Qd(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eu(t,r){if(r&&(Wt(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qd(t)}function rt(t,r,s){return r=Ws(r),eu(t,fo()?Reflect.construct(r,s||[],Ws(t).constructor):r.apply(t,s))}function Bs(t,r){return Bs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},Bs(t,r)}function st(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&Bs(t,r)}function xo(t){if(Array.isArray(t))return t}function tu(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var a,n,i,o,c=[],l=!0,d=!1;try{if(i=(s=s.call(t)).next,r!==0)for(;!(l=(a=i.call(s)).done)&&(c.push(a.value),c.length!==r);l=!0);}catch(m){d=!0,n=m}finally{try{if(!l&&s.return!=null&&(o=s.return(),Object(o)!==o))return}finally{if(d)throw n}}return c}}function Ha(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,a=Array(r);s<r;s++)a[s]=t[s];return a}function xn(t,r){if(t){if(typeof t=="string")return Ha(t,r);var s={}.toString.call(t).slice(8,-1);return s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set"?Array.from(t):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Ha(t,r):void 0}}function go(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lr(t,r){return xo(t)||tu(t,r)||xn(t,r)||go()}function po(t){var r,s,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t))for(r=0;r<t.length;r++)t[r]&&(s=po(t[r]))&&(a&&(a+=" "),a+=s);else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Fe(){for(var t,r,s=0,a="";s<arguments.length;)(t=arguments[s++])&&(r=po(t))&&(a&&(a+=" "),a+=r);return a}function Le(){return Le=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},Le.apply(null,arguments)}var ru=function(t,r,s,a,n,i,o,c){if(!t){var l;if(r===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[s,a,n,i,o,c],m=0;l=new Error(r.replace(/%s/g,function(){return d[m++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},su=ru;const Qr=St(su);var au=function(){};function nu(t,r){var s={};return Object.keys(t).forEach(function(a){s[As(a)]=au}),s}function bi(t,r){return t[r]!==void 0}function As(t){return"default"+t.charAt(0).toUpperCase()+t.substr(1)}function iu(t){return!!t&&(typeof t!="function"||t.prototype&&t.prototype.isReactComponent)}function lu(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,Bs(t,r)}function vo(){var t=this.constructor.getDerivedStateFromProps(this.props,this.state);t!=null&&this.setState(t)}function bo(t){function r(s){var a=this.constructor.getDerivedStateFromProps(t,s);return a??null}this.setState(r.bind(this))}function yo(t,r){try{var s=this.props,a=this.state;this.props=t,this.state=r,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(s,a)}finally{this.props=s,this.state=a}}vo.__suppressDeprecationWarning=!0;bo.__suppressDeprecationWarning=!0;yo.__suppressDeprecationWarning=!0;function ou(t){var r=t.prototype;if(!r||!r.isReactComponent)throw new Error("Can only polyfill class components");if(typeof t.getDerivedStateFromProps!="function"&&typeof r.getSnapshotBeforeUpdate!="function")return t;var s=null,a=null,n=null;if(typeof r.componentWillMount=="function"?s="componentWillMount":typeof r.UNSAFE_componentWillMount=="function"&&(s="UNSAFE_componentWillMount"),typeof r.componentWillReceiveProps=="function"?a="componentWillReceiveProps":typeof r.UNSAFE_componentWillReceiveProps=="function"&&(a="UNSAFE_componentWillReceiveProps"),typeof r.componentWillUpdate=="function"?n="componentWillUpdate":typeof r.UNSAFE_componentWillUpdate=="function"&&(n="UNSAFE_componentWillUpdate"),s!==null||a!==null||n!==null){var i=t.displayName||t.name,o=typeof t.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+i+" uses "+o+" but also contains the following legacy lifecycles:"+(s!==null?`
  `+s:"")+(a!==null?`
  `+a:"")+(n!==null?`
  `+n:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof t.getDerivedStateFromProps=="function"&&(r.componentWillMount=vo,r.componentWillReceiveProps=bo),typeof r.getSnapshotBeforeUpdate=="function"){if(typeof r.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");r.componentWillUpdate=yo;var c=r.componentDidUpdate;r.componentDidUpdate=function(d,m,g){var h=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:g;c.call(this,d,m,h)}}return t}var cu="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function jo(t,r,s){s===void 0&&(s=[]);var a=t.displayName||t.name||"Component",n=iu(t),i=Object.keys(r),o=i.map(As);n||!s.length||Qr(!1);var c=function(d){lu(m,d);function m(){for(var h,x=arguments.length,v=new Array(x),u=0;u<x;u++)v[u]=arguments[u];h=d.call.apply(d,[this].concat(v))||this,h.handlers=Object.create(null),i.forEach(function(N){var w=r[N],k=function(C){if(h.props[w]){var T;h._notifying=!0;for(var M=arguments.length,j=new Array(M>1?M-1:0),O=1;O<M;O++)j[O-1]=arguments[O];(T=h.props)[w].apply(T,[C].concat(j)),h._notifying=!1}h.unmounted||h.setState(function(B){var F,K=B.values;return{values:Le(Object.create(null),K,(F={},F[N]=C,F))}})};h.handlers[w]=k}),s.length&&(h.attachRef=function(N){h.inner=N});var f=Object.create(null);return i.forEach(function(N){f[N]=h.props[As(N)]}),h.state={values:f,prevProps:{}},h}var g=m.prototype;return g.shouldComponentUpdate=function(){return!this._notifying},m.getDerivedStateFromProps=function(x,v){var u=v.values,f=v.prevProps,N={values:Le(Object.create(null),u),prevProps:{}};return i.forEach(function(w){N.prevProps[w]=x[w],!bi(x,w)&&bi(f,w)&&(N.values[w]=x[As(w)])}),N},g.componentWillUnmount=function(){this.unmounted=!0},g.render=function(){var x=this,v=this.props,u=v.innerRef,f=sa(v,["innerRef"]);o.forEach(function(w){delete f[w]});var N={};return i.forEach(function(w){var k=x.props[w];N[w]=k!==void 0?k:x.state.values[w]}),I.createElement(t,Le({},f,N,this.handlers,{ref:u||this.attachRef}))},m}(I.Component);ou(c),c.displayName="Uncontrolled("+a+")",c.propTypes=Le({innerRef:function(){}},nu(r)),s.forEach(function(d){c.prototype[d]=function(){var g;return(g=this.inner)[d].apply(g,arguments)}});var l=c;return I.forwardRef&&(l=I.forwardRef(function(d,m){return I.createElement(c,Le({},d,{innerRef:m,__source:{fileName:cu,lineNumber:128},__self:this}))}),l.propTypes=c.propTypes),l.ControlledComponent=t,l.deferControlTo=function(d,m,g){return m===void 0&&(m={}),jo(d,Le({},r,m),g)},l}var wo={exports:{}},du="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",uu=du,mu=uu;function No(){}function So(){}So.resetWarningCache=No;var hu=function(){function t(a,n,i,o,c,l){if(l!==mu){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function r(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:So,resetWarningCache:No};return s.PropTypes=s,s};wo.exports=hu();var fu=wo.exports;const se=St(fu);var Hs="milliseconds",es="seconds",ts="minutes",rs="hours",or="day",wr="week",ss="month",cr="year",dr="decade",ur="century",ko={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},xu={month:1,year:12,decade:10*12,century:100*12};function gu(t){return[31,pu(t),31,30,31,30,31,31,30,31,30,31]}function pu(t){return t%4===0&&t%100!==0||t%400===0?29:28}function Et(t,r,s){switch(t=new Date(t),s){case Hs:case es:case ts:case rs:case or:case wr:return vu(t,r*ko[s]);case ss:case cr:case dr:case ur:return bu(t,r*xu[s])}throw new TypeError('Invalid units: "'+s+'"')}function vu(t,r){var s=new Date(+t+r);return yu(t,s)}function bu(t,r){var s=t.getFullYear(),a=t.getMonth(),n=t.getDate(),i=s*12+a+r,o=Math.trunc(i/12),c=i%12,l=Math.min(n,gu(o)[c]),d=new Date(t);return d.setFullYear(o),d.setDate(1),d.setMonth(c),d.setDate(l),d}function yu(t,r){var s=t.getTimezoneOffset(),a=r.getTimezoneOffset(),n=a-s;return new Date(+r+n*ko.minutes)}function as(t,r,s){return Et(t,-r,s)}function Qe(t,r,s){switch(t=new Date(t),r){case ur:case dr:case cr:t=Gs(t,0);case ss:t=Oo(t,1);case wr:case or:t=ls(t,0);case rs:t=Nr(t,0);case ts:t=is(t,0);case es:t=ns(t,0)}return r===dr&&(t=as(t,mr(t)%10,"year")),r===ur&&(t=as(t,mr(t)%100,"year")),r===wr&&(t=Do(t,0,s)),t}function zs(t,r,s){switch(t=new Date(t),t=Qe(t,r,s),r){case ur:case dr:case cr:case ss:case wr:t=Et(t,1,r),t=as(t,1,or),t.setHours(23,59,59,999);break;case or:t.setHours(23,59,59,999);break;case rs:case ts:case es:t=Et(t,1,r),t=as(t,1,Hs)}return t}var $r=Or(function(t,r){return t===r}),gn=Or(function(t,r){return t!==r}),aa=Or(function(t,r){return t>r}),fs=Or(function(t,r){return t>=r}),pn=Or(function(t,r){return t<r}),Tr=Or(function(t,r){return t<=r});function Co(){return new Date(Math.min.apply(Math,arguments))}function Eo(){return new Date(Math.max.apply(Math,arguments))}function $o(t,r,s,a){return a=a||"day",(!r||fs(t,r,a))&&(!s||Tr(t,s,a))}var ns=Xt("Milliseconds"),is=Xt("Seconds"),Nr=Xt("Minutes"),ls=Xt("Hours"),To=Xt("Day"),Oo=Xt("Date"),Gs=Xt("Month"),mr=Xt("FullYear");function ju(t,r){return r===void 0?mr(Qe(t,dr)):Et(t,r+10,cr)}function wu(t,r){return r===void 0?mr(Qe(t,ur)):Et(t,r+100,cr)}function Do(t,r,s){var a=(To(t)+7-(s||0))%7;return r===void 0?a:Et(t,r-a,or)}function Nu(t,r,s,a){var n,i,o;switch(s){case Hs:case es:case ts:case rs:case or:case wr:n=r.getTime()-t.getTime();break;case ss:case cr:case dr:case ur:n=(mr(r)-mr(t))*12+Gs(r)-Gs(t);break;default:throw new TypeError('Invalid units: "'+s+'"')}switch(s){case Hs:i=1;break;case es:i=1e3;break;case ts:i=1e3*60;break;case rs:i=1e3*60*60;break;case or:i=1e3*60*60*24;break;case wr:i=1e3*60*60*24*7;break;case ss:i=1;break;case cr:i=12;break;case dr:i=120;break;case ur:i=1200;break;default:throw new TypeError('Invalid units: "'+s+'"')}return o=n/i,a?o:Math.round(o)}function Xt(t){var r=function(s){switch(s){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(t);return function(s,a){if(a===void 0)return s["get"+t]();var n=new Date(s);return n["set"+t](a),r&&n["get"+t]()!=a&&(t==="Hours"||a>=r&&n.getHours()-s.getHours()<Math.floor(a/r))&&n["set"+t](a+r),n}}function Or(t){return function(r,s,a){return t(+Qe(r,a),+Qe(s,a))}}const yi=Object.freeze(Object.defineProperty({__proto__:null,add:Et,century:wu,date:Oo,day:To,decade:ju,diff:Nu,endOf:zs,eq:$r,gt:aa,gte:fs,hours:ls,inRange:$o,lt:pn,lte:Tr,max:Eo,milliseconds:ns,min:Co,minutes:Nr,month:Gs,neq:gn,seconds:is,startOf:Qe,subtract:as,weekday:Do,year:mr},Symbol.toStringTag,{value:"Module"}));function Su(t){if(Array.isArray(t))return Ha(t)}function Mo(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ku(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rs(t){return Su(t)||Mo(t)||xn(t)||ku()}function Cu(t,r,s){var a=-1,n=t.length;r<0&&(r=-r>n?0:n+r),s=s>n?n:s,s<0&&(s+=n),n=r>s?0:s-r>>>0,r>>>=0;for(var i=Array(n);++a<n;)i[a]=t[a+r];return i}var Po=Cu;function Eu(t,r){return t===r||t!==t&&r!==r}var xs=Eu,$u=typeof yt=="object"&&yt&&yt.Object===Object&&yt,_o=$u,Tu=_o,Ou=typeof self=="object"&&self&&self.Object===Object&&self,Du=Tu||Ou||Function("return this")(),Rt=Du,Mu=Rt,Pu=Mu.Symbol,Dr=Pu,ji=Dr,Ao=Object.prototype,_u=Ao.hasOwnProperty,Au=Ao.toString,Fr=ji?ji.toStringTag:void 0;function Ru(t){var r=_u.call(t,Fr),s=t[Fr];try{t[Fr]=void 0;var a=!0}catch{}var n=Au.call(t);return a&&(r?t[Fr]=s:delete t[Fr]),n}var Iu=Ru,Lu=Object.prototype,Fu=Lu.toString;function Uu(t){return Fu.call(t)}var Wu=Uu,wi=Dr,Bu=Iu,Hu=Wu,zu="[object Null]",Gu="[object Undefined]",Ni=wi?wi.toStringTag:void 0;function qu(t){return t==null?t===void 0?Gu:zu:Ni&&Ni in Object(t)?Bu(t):Hu(t)}var Mr=qu;function Yu(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var zt=Yu,Vu=Mr,Ku=zt,Ju="[object AsyncFunction]",Xu="[object Function]",Zu="[object GeneratorFunction]",Qu="[object Proxy]";function em(t){if(!Ku(t))return!1;var r=Vu(t);return r==Xu||r==Zu||r==Ju||r==Qu}var vn=em,tm=9007199254740991;function rm(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=tm}var bn=rm,sm=vn,am=bn;function nm(t){return t!=null&&am(t.length)&&!sm(t)}var gs=nm,im=9007199254740991,lm=/^(?:0|[1-9]\d*)$/;function om(t,r){var s=typeof t;return r=r??im,!!r&&(s=="number"||s!="symbol"&&lm.test(t))&&t>-1&&t%1==0&&t<r}var yn=om,cm=xs,dm=gs,um=yn,mm=zt;function hm(t,r,s){if(!mm(s))return!1;var a=typeof r;return(a=="number"?dm(s)&&um(r,s.length):a=="string"&&r in s)?cm(s[r],t):!1}var na=hm,fm=/\s/;function xm(t){for(var r=t.length;r--&&fm.test(t.charAt(r)););return r}var gm=xm,pm=gm,vm=/^\s+/;function bm(t){return t&&t.slice(0,pm(t)+1).replace(vm,"")}var ym=bm;function jm(t){return t!=null&&typeof t=="object"}var Zt=jm,wm=Mr,Nm=Zt,Sm="[object Symbol]";function km(t){return typeof t=="symbol"||Nm(t)&&wm(t)==Sm}var ps=km,Cm=ym,Si=zt,Em=ps,ki=NaN,$m=/^[-+]0x[0-9a-f]+$/i,Tm=/^0b[01]+$/i,Om=/^0o[0-7]+$/i,Dm=parseInt;function Mm(t){if(typeof t=="number")return t;if(Em(t))return ki;if(Si(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=Si(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=Cm(t);var s=Tm.test(t);return s||Om.test(t)?Dm(t.slice(2),s?2:8):$m.test(t)?ki:+t}var Pm=Mm,_m=Pm,Ci=1/0,Am=17976931348623157e292;function Rm(t){if(!t)return t===0?t:0;if(t=_m(t),t===Ci||t===-Ci){var r=t<0?-1:1;return r*Am}return t===t?t:0}var Ro=Rm,Im=Ro;function Lm(t){var r=Im(t),s=r%1;return r===r?s?r-s:r:0}var Io=Lm,Fm=Po,Um=na,Wm=Io,Bm=Math.ceil,Hm=Math.max;function zm(t,r,s){(s?Um(t,r,s):r===void 0)?r=1:r=Hm(Wm(r),0);var a=t==null?0:t.length;if(!a||r<1)return[];for(var n=0,i=0,o=Array(Bm(a/r));n<a;)o[i++]=Fm(t,n,n+=r);return o}var Gm=zm;const qm=St(Gm);function vs(t){return t&&t.ownerDocument||document}function Ym(t){var r=vs(t);return r&&r.defaultView||window}function Vm(t,r){return Ym(t).getComputedStyle(t,r)}var Km=/([A-Z])/g;function Jm(t){return t.replace(Km,"-$1").toLowerCase()}var Xm=/^ms-/;function Ts(t){return Jm(t).replace(Xm,"-ms-")}var Zm=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Qm(t){return!!(t&&Zm.test(t))}function vr(t,r){var s="",a="";if(typeof r=="string")return t.style.getPropertyValue(Ts(r))||Vm(t).getPropertyValue(Ts(r));Object.keys(r).forEach(function(n){var i=r[n];!i&&i!==0?t.style.removeProperty(Ts(n)):Qm(n)?a+=n+"("+i+") ":s+=Ts(n)+": "+i+";"}),a&&(s+="transform: "+a+";"),t.style.cssText+=";"+s}function os(t,r){if(t.contains)return t.contains(r);if(t.compareDocumentPosition)return t===r||!!(t.compareDocumentPosition(r)&16)}function eh(t){return"nodeType"in t&&t.nodeType===document.DOCUMENT_NODE}function jn(t){return"window"in t&&t.window===t?t:eh(t)&&t.defaultView||!1}function Lo(t){var r=t==="pageXOffset"?"scrollLeft":"scrollTop";function s(a,n){var i=jn(a);if(n===void 0)return i?i[t]:a[r];i?i.scrollTo(i[t],n):a[r]=n}return s}const Fo=Lo("pageXOffset"),Uo=Lo("pageYOffset");function nr(t){var r=vs(t),s={top:0,left:0,height:0,width:0},a=r&&r.documentElement;return!a||!os(a,t)||(t.getBoundingClientRect!==void 0&&(s=t.getBoundingClientRect()),s={top:s.top+Uo(a)-(a.clientTop||0),left:s.left+Fo(a)-(a.clientLeft||0),width:s.width,height:s.height}),s}var th=function(r){return!!r&&"offsetParent"in r};function rh(t){for(var r=vs(t),s=t&&t.offsetParent;th(s)&&s.nodeName!=="HTML"&&vr(s,"position")==="static";)s=s.offsetParent;return s||r.documentElement}var sh=function(r){return r.nodeName&&r.nodeName.toLowerCase()};function Wo(t,r){var s={top:0,left:0},a;if(vr(t,"position")==="fixed")a=t.getBoundingClientRect();else{var n=r||rh(t);a=nr(t),sh(n)!=="html"&&(s=nr(n));var i=String(vr(n,"borderTopWidth")||0);s.top+=parseInt(i,10)-Uo(n)||0;var o=String(vr(n,"borderLeftWidth")||0);s.left+=parseInt(o,10)-Fo(n)||0}var c=String(vr(t,"marginTop")||0),l=String(vr(t,"marginLeft")||0);return Le({},a,{top:a.top-s.top-(parseInt(c,10)||0),left:a.left-s.left-(parseInt(l,10)||0)})}const wn=!!(typeof window<"u"&&window.document&&window.document.createElement);var Ei=new Date().getTime();function ah(t){var r=new Date().getTime(),s=Math.max(0,16-(r-Ei)),a=setTimeout(t,s);return Ei=r,a}var nh=["","webkit","moz","o","ms"],za="clearTimeout",Ga=ah,$i=function(r,s){return r+(r?s[0].toUpperCase()+s.substr(1):s)+"AnimationFrame"};wn&&nh.some(function(t){var r=$i(t,"request");return r in window&&(za=$i(t,"cancel"),Ga=function(a){return window[r](a)}),!!Ga});var Ti=function(r){typeof window[za]=="function"&&window[za](r)},Bo=Ga,$a;function ih(t,r){if(!$a){var s=document.body,a=s.matches||s.matchesSelector||s.webkitMatchesSelector||s.mozMatchesSelector||s.msMatchesSelector;$a=function(i,o){return a.call(i,o)}}return $a(t,r)}var lh=Function.prototype.bind.call(Function.prototype.call,[].slice);function oh(t,r){return lh(t.querySelectorAll(r))}var qa=!1,Ya=!1;try{var Ta={get passive(){return qa=!0},get once(){return Ya=qa=!0}};wn&&(window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,!0))}catch{}function ch(t,r,s,a){if(a&&typeof a!="boolean"&&!Ya){var n=a.once,i=a.capture,o=s;!Ya&&n&&(o=s.__once||function c(l){this.removeEventListener(r,c,i),s.call(this,l)},s.__once=o),t.addEventListener(r,o,qa?a:i)}t.addEventListener(r,s,a)}function dh(t){const r=S.useRef(t);return S.useEffect(()=>{r.current=t},[t]),r}function Oi(t){const r=dh(t);return S.useCallback(function(...s){return r.current&&r.current(...s)},[r])}function Di(){return S.useState(null)}function uh(){const t=S.useRef(!0),r=S.useRef(()=>t.current);return S.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),r.current}function mh(t){const r=uh();return[t[0],S.useCallback(s=>{if(r())return t[1](s)},[r,t[1]])]}var ot="top",wt="bottom",Nt="right",ct="left",Nn="auto",bs=[ot,wt,Nt,ct],Sr="start",cs="end",hh="clippingParents",Ho="viewport",Ur="popper",fh="reference",Mi=bs.reduce(function(t,r){return t.concat([r+"-"+Sr,r+"-"+cs])},[]),Sn=[].concat(bs,[Nn]).reduce(function(t,r){return t.concat([r,r+"-"+Sr,r+"-"+cs])},[]),xh="beforeRead",gh="read",ph="afterRead",vh="beforeMain",bh="main",yh="afterMain",jh="beforeWrite",wh="write",Nh="afterWrite",Sh=[xh,gh,ph,vh,bh,yh,jh,wh,Nh];function Mt(t){return t.split("-")[0]}function ft(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var r=t.ownerDocument;return r&&r.defaultView||window}return t}function hr(t){var r=ft(t).Element;return t instanceof r||t instanceof Element}function Pt(t){var r=ft(t).HTMLElement;return t instanceof r||t instanceof HTMLElement}function kn(t){if(typeof ShadowRoot>"u")return!1;var r=ft(t).ShadowRoot;return t instanceof r||t instanceof ShadowRoot}var ir=Math.max,qs=Math.min,kr=Math.round;function Va(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function zo(){return!/^((?!chrome|android).)*safari/i.test(Va())}function Cr(t,r,s){r===void 0&&(r=!1),s===void 0&&(s=!1);var a=t.getBoundingClientRect(),n=1,i=1;r&&Pt(t)&&(n=t.offsetWidth>0&&kr(a.width)/t.offsetWidth||1,i=t.offsetHeight>0&&kr(a.height)/t.offsetHeight||1);var o=hr(t)?ft(t):window,c=o.visualViewport,l=!zo()&&s,d=(a.left+(l&&c?c.offsetLeft:0))/n,m=(a.top+(l&&c?c.offsetTop:0))/i,g=a.width/n,h=a.height/i;return{width:g,height:h,top:m,right:d+g,bottom:m+h,left:d,x:d,y:m}}function Cn(t){var r=Cr(t),s=t.offsetWidth,a=t.offsetHeight;return Math.abs(r.width-s)<=1&&(s=r.width),Math.abs(r.height-a)<=1&&(a=r.height),{x:t.offsetLeft,y:t.offsetTop,width:s,height:a}}function Go(t,r){var s=r.getRootNode&&r.getRootNode();if(t.contains(r))return!0;if(s&&kn(s)){var a=r;do{if(a&&t.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function Kt(t){return t?(t.nodeName||"").toLowerCase():null}function Bt(t){return ft(t).getComputedStyle(t)}function kh(t){return["table","td","th"].indexOf(Kt(t))>=0}function Qt(t){return((hr(t)?t.ownerDocument:t.document)||window.document).documentElement}function ia(t){return Kt(t)==="html"?t:t.assignedSlot||t.parentNode||(kn(t)?t.host:null)||Qt(t)}function Pi(t){return!Pt(t)||Bt(t).position==="fixed"?null:t.offsetParent}function Ch(t){var r=/firefox/i.test(Va()),s=/Trident/i.test(Va());if(s&&Pt(t)){var a=Bt(t);if(a.position==="fixed")return null}var n=ia(t);for(kn(n)&&(n=n.host);Pt(n)&&["html","body"].indexOf(Kt(n))<0;){var i=Bt(n);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||r&&i.willChange==="filter"||r&&i.filter&&i.filter!=="none")return n;n=n.parentNode}return null}function ys(t){for(var r=ft(t),s=Pi(t);s&&kh(s)&&Bt(s).position==="static";)s=Pi(s);return s&&(Kt(s)==="html"||Kt(s)==="body"&&Bt(s).position==="static")?r:s||Ch(t)||r}function En(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function qr(t,r,s){return ir(t,qs(r,s))}function Eh(t,r,s){var a=qr(t,r,s);return a>s?s:a}function qo(){return{top:0,right:0,bottom:0,left:0}}function Yo(t){return Object.assign({},qo(),t)}function Vo(t,r){return r.reduce(function(s,a){return s[a]=t,s},{})}var $h=function(r,s){return r=typeof r=="function"?r(Object.assign({},s.rects,{placement:s.placement})):r,Yo(typeof r!="number"?r:Vo(r,bs))};function Th(t){var r,s=t.state,a=t.name,n=t.options,i=s.elements.arrow,o=s.modifiersData.popperOffsets,c=Mt(s.placement),l=En(c),d=[ct,Nt].indexOf(c)>=0,m=d?"height":"width";if(!(!i||!o)){var g=$h(n.padding,s),h=Cn(i),x=l==="y"?ot:ct,v=l==="y"?wt:Nt,u=s.rects.reference[m]+s.rects.reference[l]-o[l]-s.rects.popper[m],f=o[l]-s.rects.reference[l],N=ys(i),w=N?l==="y"?N.clientHeight||0:N.clientWidth||0:0,k=u/2-f/2,p=g[x],C=w-h[m]-g[v],T=w/2-h[m]/2+k,M=qr(p,T,C),j=l;s.modifiersData[a]=(r={},r[j]=M,r.centerOffset=M-T,r)}}function Oh(t){var r=t.state,s=t.options,a=s.element,n=a===void 0?"[data-popper-arrow]":a;n!=null&&(typeof n=="string"&&(n=r.elements.popper.querySelector(n),!n)||Go(r.elements.popper,n)&&(r.elements.arrow=n))}const Dh={name:"arrow",enabled:!0,phase:"main",fn:Th,effect:Oh,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Er(t){return t.split("-")[1]}var Mh={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ph(t,r){var s=t.x,a=t.y,n=r.devicePixelRatio||1;return{x:kr(s*n)/n||0,y:kr(a*n)/n||0}}function _i(t){var r,s=t.popper,a=t.popperRect,n=t.placement,i=t.variation,o=t.offsets,c=t.position,l=t.gpuAcceleration,d=t.adaptive,m=t.roundOffsets,g=t.isFixed,h=o.x,x=h===void 0?0:h,v=o.y,u=v===void 0?0:v,f=typeof m=="function"?m({x,y:u}):{x,y:u};x=f.x,u=f.y;var N=o.hasOwnProperty("x"),w=o.hasOwnProperty("y"),k=ct,p=ot,C=window;if(d){var T=ys(s),M="clientHeight",j="clientWidth";if(T===ft(s)&&(T=Qt(s),Bt(T).position!=="static"&&c==="absolute"&&(M="scrollHeight",j="scrollWidth")),T=T,n===ot||(n===ct||n===Nt)&&i===cs){p=wt;var O=g&&T===C&&C.visualViewport?C.visualViewport.height:T[M];u-=O-a.height,u*=l?1:-1}if(n===ct||(n===ot||n===wt)&&i===cs){k=Nt;var B=g&&T===C&&C.visualViewport?C.visualViewport.width:T[j];x-=B-a.width,x*=l?1:-1}}var F=Object.assign({position:c},d&&Mh),K=m===!0?Ph({x,y:u},ft(s)):{x,y:u};if(x=K.x,u=K.y,l){var G;return Object.assign({},F,(G={},G[p]=w?"0":"",G[k]=N?"0":"",G.transform=(C.devicePixelRatio||1)<=1?"translate("+x+"px, "+u+"px)":"translate3d("+x+"px, "+u+"px, 0)",G))}return Object.assign({},F,(r={},r[p]=w?u+"px":"",r[k]=N?x+"px":"",r.transform="",r))}function _h(t){var r=t.state,s=t.options,a=s.gpuAcceleration,n=a===void 0?!0:a,i=s.adaptive,o=i===void 0?!0:i,c=s.roundOffsets,l=c===void 0?!0:c,d={placement:Mt(r.placement),variation:Er(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:n,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,_i(Object.assign({},d,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:o,roundOffsets:l})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,_i(Object.assign({},d,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}const Ah={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:_h,data:{}};var Os={passive:!0};function Rh(t){var r=t.state,s=t.instance,a=t.options,n=a.scroll,i=n===void 0?!0:n,o=a.resize,c=o===void 0?!0:o,l=ft(r.elements.popper),d=[].concat(r.scrollParents.reference,r.scrollParents.popper);return i&&d.forEach(function(m){m.addEventListener("scroll",s.update,Os)}),c&&l.addEventListener("resize",s.update,Os),function(){i&&d.forEach(function(m){m.removeEventListener("scroll",s.update,Os)}),c&&l.removeEventListener("resize",s.update,Os)}}const Ih={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Rh,data:{}};var Lh={left:"right",right:"left",bottom:"top",top:"bottom"};function Is(t){return t.replace(/left|right|bottom|top/g,function(r){return Lh[r]})}var Fh={start:"end",end:"start"};function Ai(t){return t.replace(/start|end/g,function(r){return Fh[r]})}function $n(t){var r=ft(t),s=r.pageXOffset,a=r.pageYOffset;return{scrollLeft:s,scrollTop:a}}function Tn(t){return Cr(Qt(t)).left+$n(t).scrollLeft}function Uh(t,r){var s=ft(t),a=Qt(t),n=s.visualViewport,i=a.clientWidth,o=a.clientHeight,c=0,l=0;if(n){i=n.width,o=n.height;var d=zo();(d||!d&&r==="fixed")&&(c=n.offsetLeft,l=n.offsetTop)}return{width:i,height:o,x:c+Tn(t),y:l}}function Wh(t){var r,s=Qt(t),a=$n(t),n=(r=t.ownerDocument)==null?void 0:r.body,i=ir(s.scrollWidth,s.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=ir(s.scrollHeight,s.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),c=-a.scrollLeft+Tn(t),l=-a.scrollTop;return Bt(n||s).direction==="rtl"&&(c+=ir(s.clientWidth,n?n.clientWidth:0)-i),{width:i,height:o,x:c,y:l}}function On(t){var r=Bt(t),s=r.overflow,a=r.overflowX,n=r.overflowY;return/auto|scroll|overlay|hidden/.test(s+n+a)}function Ko(t){return["html","body","#document"].indexOf(Kt(t))>=0?t.ownerDocument.body:Pt(t)&&On(t)?t:Ko(ia(t))}function Yr(t,r){var s;r===void 0&&(r=[]);var a=Ko(t),n=a===((s=t.ownerDocument)==null?void 0:s.body),i=ft(a),o=n?[i].concat(i.visualViewport||[],On(a)?a:[]):a,c=r.concat(o);return n?c:c.concat(Yr(ia(o)))}function Ka(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Bh(t,r){var s=Cr(t,!1,r==="fixed");return s.top=s.top+t.clientTop,s.left=s.left+t.clientLeft,s.bottom=s.top+t.clientHeight,s.right=s.left+t.clientWidth,s.width=t.clientWidth,s.height=t.clientHeight,s.x=s.left,s.y=s.top,s}function Ri(t,r,s){return r===Ho?Ka(Uh(t,s)):hr(r)?Bh(r,s):Ka(Wh(Qt(t)))}function Hh(t){var r=Yr(ia(t)),s=["absolute","fixed"].indexOf(Bt(t).position)>=0,a=s&&Pt(t)?ys(t):t;return hr(a)?r.filter(function(n){return hr(n)&&Go(n,a)&&Kt(n)!=="body"}):[]}function zh(t,r,s,a){var n=r==="clippingParents"?Hh(t):[].concat(r),i=[].concat(n,[s]),o=i[0],c=i.reduce(function(l,d){var m=Ri(t,d,a);return l.top=ir(m.top,l.top),l.right=qs(m.right,l.right),l.bottom=qs(m.bottom,l.bottom),l.left=ir(m.left,l.left),l},Ri(t,o,a));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function Jo(t){var r=t.reference,s=t.element,a=t.placement,n=a?Mt(a):null,i=a?Er(a):null,o=r.x+r.width/2-s.width/2,c=r.y+r.height/2-s.height/2,l;switch(n){case ot:l={x:o,y:r.y-s.height};break;case wt:l={x:o,y:r.y+r.height};break;case Nt:l={x:r.x+r.width,y:c};break;case ct:l={x:r.x-s.width,y:c};break;default:l={x:r.x,y:r.y}}var d=n?En(n):null;if(d!=null){var m=d==="y"?"height":"width";switch(i){case Sr:l[d]=l[d]-(r[m]/2-s[m]/2);break;case cs:l[d]=l[d]+(r[m]/2-s[m]/2);break}}return l}function ds(t,r){r===void 0&&(r={});var s=r,a=s.placement,n=a===void 0?t.placement:a,i=s.strategy,o=i===void 0?t.strategy:i,c=s.boundary,l=c===void 0?hh:c,d=s.rootBoundary,m=d===void 0?Ho:d,g=s.elementContext,h=g===void 0?Ur:g,x=s.altBoundary,v=x===void 0?!1:x,u=s.padding,f=u===void 0?0:u,N=Yo(typeof f!="number"?f:Vo(f,bs)),w=h===Ur?fh:Ur,k=t.rects.popper,p=t.elements[v?w:h],C=zh(hr(p)?p:p.contextElement||Qt(t.elements.popper),l,m,o),T=Cr(t.elements.reference),M=Jo({reference:T,element:k,placement:n}),j=Ka(Object.assign({},k,M)),O=h===Ur?j:T,B={top:C.top-O.top+N.top,bottom:O.bottom-C.bottom+N.bottom,left:C.left-O.left+N.left,right:O.right-C.right+N.right},F=t.modifiersData.offset;if(h===Ur&&F){var K=F[n];Object.keys(B).forEach(function(G){var ae=[Nt,wt].indexOf(G)>=0?1:-1,H=[ot,wt].indexOf(G)>=0?"y":"x";B[G]+=K[H]*ae})}return B}function Gh(t,r){r===void 0&&(r={});var s=r,a=s.placement,n=s.boundary,i=s.rootBoundary,o=s.padding,c=s.flipVariations,l=s.allowedAutoPlacements,d=l===void 0?Sn:l,m=Er(a),g=m?c?Mi:Mi.filter(function(v){return Er(v)===m}):bs,h=g.filter(function(v){return d.indexOf(v)>=0});h.length===0&&(h=g);var x=h.reduce(function(v,u){return v[u]=ds(t,{placement:u,boundary:n,rootBoundary:i,padding:o})[Mt(u)],v},{});return Object.keys(x).sort(function(v,u){return x[v]-x[u]})}function qh(t){if(Mt(t)===Nn)return[];var r=Is(t);return[Ai(t),r,Ai(r)]}function Yh(t){var r=t.state,s=t.options,a=t.name;if(!r.modifiersData[a]._skip){for(var n=s.mainAxis,i=n===void 0?!0:n,o=s.altAxis,c=o===void 0?!0:o,l=s.fallbackPlacements,d=s.padding,m=s.boundary,g=s.rootBoundary,h=s.altBoundary,x=s.flipVariations,v=x===void 0?!0:x,u=s.allowedAutoPlacements,f=r.options.placement,N=Mt(f),w=N===f,k=l||(w||!v?[Is(f)]:qh(f)),p=[f].concat(k).reduce(function(we,Ne){return we.concat(Mt(Ne)===Nn?Gh(r,{placement:Ne,boundary:m,rootBoundary:g,padding:d,flipVariations:v,allowedAutoPlacements:u}):Ne)},[]),C=r.rects.reference,T=r.rects.popper,M=new Map,j=!0,O=p[0],B=0;B<p.length;B++){var F=p[B],K=Mt(F),G=Er(F)===Sr,ae=[ot,wt].indexOf(K)>=0,H=ae?"width":"height",Y=ds(r,{placement:F,boundary:m,rootBoundary:g,altBoundary:h,padding:d}),U=ae?G?Nt:ct:G?wt:ot;C[H]>T[H]&&(U=Is(U));var Z=Is(U),re=[];if(i&&re.push(Y[K]<=0),c&&re.push(Y[U]<=0,Y[Z]<=0),re.every(function(we){return we})){O=F,j=!1;break}M.set(F,re)}if(j)for(var W=v?3:1,de=function(Ne){var Q=p.find(function(be){var J=M.get(be);if(J)return J.slice(0,Ne).every(function(V){return V})});if(Q)return O=Q,"break"},xe=W;xe>0;xe--){var me=de(xe);if(me==="break")break}r.placement!==O&&(r.modifiersData[a]._skip=!0,r.placement=O,r.reset=!0)}}const Vh={name:"flip",enabled:!0,phase:"main",fn:Yh,requiresIfExists:["offset"],data:{_skip:!1}};function Ii(t,r,s){return s===void 0&&(s={x:0,y:0}),{top:t.top-r.height-s.y,right:t.right-r.width+s.x,bottom:t.bottom-r.height+s.y,left:t.left-r.width-s.x}}function Li(t){return[ot,Nt,wt,ct].some(function(r){return t[r]>=0})}function Kh(t){var r=t.state,s=t.name,a=r.rects.reference,n=r.rects.popper,i=r.modifiersData.preventOverflow,o=ds(r,{elementContext:"reference"}),c=ds(r,{altBoundary:!0}),l=Ii(o,a),d=Ii(c,n,i),m=Li(l),g=Li(d);r.modifiersData[s]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:m,hasPopperEscaped:g},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":m,"data-popper-escaped":g})}const Jh={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Kh};function Xh(t,r,s){var a=Mt(t),n=[ct,ot].indexOf(a)>=0?-1:1,i=typeof s=="function"?s(Object.assign({},r,{placement:t})):s,o=i[0],c=i[1];return o=o||0,c=(c||0)*n,[ct,Nt].indexOf(a)>=0?{x:c,y:o}:{x:o,y:c}}function Zh(t){var r=t.state,s=t.options,a=t.name,n=s.offset,i=n===void 0?[0,0]:n,o=Sn.reduce(function(m,g){return m[g]=Xh(g,r.rects,i),m},{}),c=o[r.placement],l=c.x,d=c.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=l,r.modifiersData.popperOffsets.y+=d),r.modifiersData[a]=o}const Qh={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Zh};function ef(t){var r=t.state,s=t.name;r.modifiersData[s]=Jo({reference:r.rects.reference,element:r.rects.popper,placement:r.placement})}const tf={name:"popperOffsets",enabled:!0,phase:"read",fn:ef,data:{}};function rf(t){return t==="x"?"y":"x"}function sf(t){var r=t.state,s=t.options,a=t.name,n=s.mainAxis,i=n===void 0?!0:n,o=s.altAxis,c=o===void 0?!1:o,l=s.boundary,d=s.rootBoundary,m=s.altBoundary,g=s.padding,h=s.tether,x=h===void 0?!0:h,v=s.tetherOffset,u=v===void 0?0:v,f=ds(r,{boundary:l,rootBoundary:d,padding:g,altBoundary:m}),N=Mt(r.placement),w=Er(r.placement),k=!w,p=En(N),C=rf(p),T=r.modifiersData.popperOffsets,M=r.rects.reference,j=r.rects.popper,O=typeof u=="function"?u(Object.assign({},r.rects,{placement:r.placement})):u,B=typeof O=="number"?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),F=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,K={x:0,y:0};if(T){if(i){var G,ae=p==="y"?ot:ct,H=p==="y"?wt:Nt,Y=p==="y"?"height":"width",U=T[p],Z=U+f[ae],re=U-f[H],W=x?-j[Y]/2:0,de=w===Sr?M[Y]:j[Y],xe=w===Sr?-j[Y]:-M[Y],me=r.elements.arrow,we=x&&me?Cn(me):{width:0,height:0},Ne=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:qo(),Q=Ne[ae],be=Ne[H],J=qr(0,M[Y],we[Y]),V=k?M[Y]/2-W-J-Q-B.mainAxis:de-J-Q-B.mainAxis,je=k?-M[Y]/2+W+J+be+B.mainAxis:xe+J+be+B.mainAxis,Ce=r.elements.arrow&&ys(r.elements.arrow),Ge=Ce?p==="y"?Ce.clientTop||0:Ce.clientLeft||0:0,Je=(G=F==null?void 0:F[p])!=null?G:0,qe=U+V-Je-Ge,q=U+je-Je,Ee=qr(x?qs(Z,qe):Z,U,x?ir(re,q):re);T[p]=Ee,K[p]=Ee-U}if(c){var fe,ke=p==="x"?ot:ct,We=p==="x"?wt:Nt,$e=T[C],Be=C==="y"?"height":"width",at=$e+f[ke],b=$e-f[We],P=[ot,ct].indexOf(N)!==-1,A=(fe=F==null?void 0:F[C])!=null?fe:0,E=P?at:$e-M[Be]-j[Be]-A+B.altAxis,y=P?$e+M[Be]+j[Be]-A-B.altAxis:b,R=x&&P?Eh(E,$e,y):qr(x?E:at,$e,x?y:b);T[C]=R,K[C]=R-$e}r.modifiersData[a]=K}}const af={name:"preventOverflow",enabled:!0,phase:"main",fn:sf,requiresIfExists:["offset"]};function nf(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function lf(t){return t===ft(t)||!Pt(t)?$n(t):nf(t)}function of(t){var r=t.getBoundingClientRect(),s=kr(r.width)/t.offsetWidth||1,a=kr(r.height)/t.offsetHeight||1;return s!==1||a!==1}function cf(t,r,s){s===void 0&&(s=!1);var a=Pt(r),n=Pt(r)&&of(r),i=Qt(r),o=Cr(t,n,s),c={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(a||!a&&!s)&&((Kt(r)!=="body"||On(i))&&(c=lf(r)),Pt(r)?(l=Cr(r,!0),l.x+=r.clientLeft,l.y+=r.clientTop):i&&(l.x=Tn(i))),{x:o.left+c.scrollLeft-l.x,y:o.top+c.scrollTop-l.y,width:o.width,height:o.height}}function df(t){var r=new Map,s=new Set,a=[];t.forEach(function(i){r.set(i.name,i)});function n(i){s.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(c){if(!s.has(c)){var l=r.get(c);l&&n(l)}}),a.push(i)}return t.forEach(function(i){s.has(i.name)||n(i)}),a}function uf(t){var r=df(t);return Sh.reduce(function(s,a){return s.concat(r.filter(function(n){return n.phase===a}))},[])}function mf(t){var r;return function(){return r||(r=new Promise(function(s){Promise.resolve().then(function(){r=void 0,s(t())})})),r}}function hf(t){var r=t.reduce(function(s,a){var n=s[a.name];return s[a.name]=n?Object.assign({},n,a,{options:Object.assign({},n.options,a.options),data:Object.assign({},n.data,a.data)}):a,s},{});return Object.keys(r).map(function(s){return r[s]})}var Fi={placement:"bottom",modifiers:[],strategy:"absolute"};function Ui(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return!r.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function ff(t){t===void 0&&(t={});var r=t,s=r.defaultModifiers,a=s===void 0?[]:s,n=r.defaultOptions,i=n===void 0?Fi:n;return function(c,l,d){d===void 0&&(d=i);var m={placement:"bottom",orderedModifiers:[],options:Object.assign({},Fi,i),modifiersData:{},elements:{reference:c,popper:l},attributes:{},styles:{}},g=[],h=!1,x={state:m,setOptions:function(N){var w=typeof N=="function"?N(m.options):N;u(),m.options=Object.assign({},i,m.options,w),m.scrollParents={reference:hr(c)?Yr(c):c.contextElement?Yr(c.contextElement):[],popper:Yr(l)};var k=uf(hf([].concat(a,m.options.modifiers)));return m.orderedModifiers=k.filter(function(p){return p.enabled}),v(),x.update()},forceUpdate:function(){if(!h){var N=m.elements,w=N.reference,k=N.popper;if(Ui(w,k)){m.rects={reference:cf(w,ys(k),m.options.strategy==="fixed"),popper:Cn(k)},m.reset=!1,m.placement=m.options.placement,m.orderedModifiers.forEach(function(B){return m.modifiersData[B.name]=Object.assign({},B.data)});for(var p=0;p<m.orderedModifiers.length;p++){if(m.reset===!0){m.reset=!1,p=-1;continue}var C=m.orderedModifiers[p],T=C.fn,M=C.options,j=M===void 0?{}:M,O=C.name;typeof T=="function"&&(m=T({state:m,options:j,name:O,instance:x})||m)}}}},update:mf(function(){return new Promise(function(f){x.forceUpdate(),f(m)})}),destroy:function(){u(),h=!0}};if(!Ui(c,l))return x;x.setOptions(d).then(function(f){!h&&d.onFirstUpdate&&d.onFirstUpdate(f)});function v(){m.orderedModifiers.forEach(function(f){var N=f.name,w=f.options,k=w===void 0?{}:w,p=f.effect;if(typeof p=="function"){var C=p({state:m,name:N,instance:x,options:k}),T=function(){};g.push(C||T)}})}function u(){g.forEach(function(f){return f()}),g=[]}return x}}var xf=ff({defaultModifiers:[Jh,tf,Ah,Ih,Qh,Vh,af,Dh]}),Wi=function(r){return{position:r,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},gf={name:"applyStyles",enabled:!1},pf={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(r){var s=r.state;return function(){var a=s.elements,n=a.reference,i=a.popper;if("removeAttribute"in n){var o=(n.getAttribute("aria-describedby")||"").split(",").filter(function(c){return c.trim()!==i.id});o.length?n.setAttribute("aria-describedby",o.join(",")):n.removeAttribute("aria-describedby")}}},fn:function(r){var s,a=r.state,n=a.elements,i=n.popper,o=n.reference,c=(s=i.getAttribute("role"))==null?void 0:s.toLowerCase();if(i.id&&c==="tooltip"&&"setAttribute"in o){var l=o.getAttribute("aria-describedby");if(l&&l.split(",").indexOf(i.id)!==-1)return;o.setAttribute("aria-describedby",l?l+","+i.id:i.id)}}},vf=[];function bf(t,r,s){var a=s===void 0?{}:s,n=a.enabled,i=n===void 0?!0:n,o=a.placement,c=o===void 0?"bottom":o,l=a.strategy,d=l===void 0?"absolute":l,m=a.modifiers,g=m===void 0?vf:m,h=sa(a,["enabled","placement","strategy","modifiers"]),x=S.useRef(),v=S.useCallback(function(){var p;(p=x.current)==null||p.update()},[]),u=S.useCallback(function(){var p;(p=x.current)==null||p.forceUpdate()},[]),f=mh(S.useState({placement:c,update:v,forceUpdate:u,attributes:{},styles:{popper:Wi(d),arrow:{}}})),N=f[0],w=f[1],k=S.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(C){var T=C.state,M={},j={};Object.keys(T.elements).forEach(function(O){M[O]=T.styles[O],j[O]=T.attributes[O]}),w({state:T,styles:M,attributes:j,update:v,forceUpdate:u,placement:T.placement})}}},[v,u,w]);return S.useEffect(function(){!x.current||!i||x.current.setOptions({placement:c,strategy:d,modifiers:[].concat(g,[k,gf])})},[d,c,k,i]),S.useEffect(function(){if(!(!i||t==null||r==null))return x.current=xf(t,r,Le({},h,{placement:c,strategy:d,modifiers:[].concat(g,[pf,k])})),function(){x.current!=null&&(x.current.destroy(),x.current=void 0,w(function(p){return Le({},p,{attributes:{},styles:{popper:Wi(d)}})}))}},[i,t,r]),N}function yf(t,r,s,a){var n=a&&typeof a!="boolean"?a.capture:a;t.removeEventListener(r,s,n),s.__once&&t.removeEventListener(r,s.__once,n)}function zr(t,r,s,a){return ch(t,r,s,a),function(){yf(t,r,s,a)}}var jf=function(){},wf=jf;const Nf=St(wf);function Sf(t){return t&&"setState"in t?Ql.findDOMNode(t):t??null}const kf=function(t){return vs(Sf(t))};var Cf=27,Bi=function(){};function Ef(t){return t.button===0}function $f(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}var Hi=function(r){return r&&("current"in r?r.current:r)};function Tf(t,r,s){var a=s===void 0?{}:s,n=a.disabled,i=a.clickTrigger,o=i===void 0?"click":i,c=S.useRef(!1),l=r||Bi,d=S.useCallback(function(h){var x,v=Hi(t);Nf(!!v,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),c.current=!v||$f(h)||!Ef(h)||!!os(v,(x=h.composedPath==null?void 0:h.composedPath()[0])!=null?x:h.target)},[t]),m=Oi(function(h){c.current||l(h)}),g=Oi(function(h){h.keyCode===Cf&&l(h)});S.useEffect(function(){if(!(n||t==null)){var h=window.event,x=kf(Hi(t)),v=zr(x,o,d,!0),u=zr(x,o,function(w){if(w===h){h=void 0;return}m(w)}),f=zr(x,"keyup",function(w){if(w===h){h=void 0;return}g(w)}),N=[];return"ontouchstart"in x.documentElement&&(N=[].slice.call(x.body.children).map(function(w){return zr(w,"mousemove",Bi)})),function(){v(),u(),f(),N.forEach(function(w){return w()})}}},[t,n,o,d,m,g])}function Of(t){var r={};return Array.isArray(t)?(t==null||t.forEach(function(s){r[s.name]=s}),r):t||r}function Df(t){return t===void 0&&(t={}),Array.isArray(t)?t:Object.keys(t).map(function(r){return t[r].name=r,t[r]})}function Mf(t){var r,s,a,n,i=t.enabled,o=t.enableEvents,c=t.placement,l=t.flip,d=t.offset,m=t.fixed,g=t.containerPadding,h=t.arrowElement,x=t.popperConfig,v=x===void 0?{}:x,u=Of(v.modifiers);return Le({},v,{placement:c,enabled:i,strategy:m?"fixed":v.strategy,modifiers:Df(Le({},u,{eventListeners:{enabled:o},preventOverflow:Le({},u.preventOverflow,{options:g?Le({padding:g},(r=u.preventOverflow)==null?void 0:r.options):(s=u.preventOverflow)==null?void 0:s.options}),offset:{options:Le({offset:d},(a=u.offset)==null?void 0:a.options)},arrow:Le({},u.arrow,{enabled:!!h,options:Le({},(n=u.arrow)==null?void 0:n.options,{element:h})}),flip:Le({enabled:!!l},u.flip)}))})}function Pf(t,r){return t.classList?t.classList.contains(r):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+r+" ")!==-1}function _f(t,r){t.classList?t.classList.add(r):Pf(t,r)||(typeof t.className=="string"?t.className=t.className+" "+r:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+r))}function zi(t,r){return t.replace(new RegExp("(^|\\s)"+r+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Af(t,r){t.classList?t.classList.remove(r):typeof t.className=="string"?t.className=zi(t.className,r):t.setAttribute("class",zi(t.className&&t.className.baseVal||"",r))}var Ds;function Dn(t){if((!Ds&&Ds!==0||t)&&wn){var r=document.createElement("div");r.style.position="absolute",r.style.top="-9999px",r.style.width="50px",r.style.height="50px",r.style.overflow="scroll",document.body.appendChild(r),Ds=r.offsetWidth-r.clientWidth,document.body.removeChild(r)}return Ds}var Oa=function(r){var s;return typeof document>"u"?null:r==null?vs().body:(typeof r=="function"&&(r=r()),r&&"current"in r&&(r=r.current),(s=r)!=null&&s.nodeType&&r||null)};function Gi(t,r){var s=S.useState(function(){return Oa(t)}),a=s[0],n=s[1];if(!a){var i=Oa(t);i&&n(i)}return S.useEffect(function(){},[r,a]),S.useEffect(function(){var o=Oa(t);o!==a&&n(o)},[t,a]),a}const qi=t=>!t||typeof t=="function"?t:r=>{t.current=r};function Rf(t,r){const s=qi(t),a=qi(r);return n=>{s&&s(n),a&&a(n)}}function If(t,r){return S.useMemo(()=>Rf(t,r),[t,r])}var Mn=I.forwardRef(function(t,r){var s=t.flip,a=t.offset,n=t.placement,i=t.containerPadding,o=i===void 0?5:i,c=t.popperConfig,l=c===void 0?{}:c,d=t.transition,m=Di(),g=m[0],h=m[1],x=Di(),v=x[0],u=x[1],f=If(h,r),N=Gi(t.container),w=Gi(t.target),k=S.useState(!t.show),p=k[0],C=k[1],T=bf(w,g,Mf({placement:n,enableEvents:!!t.show,containerPadding:o||5,flip:s,offset:a,arrowElement:v,popperConfig:l})),M=T.styles,j=T.attributes,O=sa(T,["styles","attributes"]);t.show?p&&C(!1):!t.transition&&!p&&C(!0);var B=function(){C(!0),t.onExited&&t.onExited.apply(t,arguments)},F=t.show||d&&!p;if(Tf(g,t.onHide,{disabled:!t.rootClose||t.rootCloseDisabled,clickTrigger:t.rootCloseEvent}),!F)return null;var K=t.children(Le({},O,{show:!!t.show,props:Le({},j.popper,{style:M.popper,ref:f}),arrowProps:Le({},j.arrow,{style:M.arrow,ref:u})}));if(d){var G=t.onExit,ae=t.onExiting,H=t.onEnter,Y=t.onEntering,U=t.onEntered;K=I.createElement(d,{in:t.show,appear:!0,onExit:G,onExiting:ae,onExited:B,onEnter:H,onEntering:Y,onEntered:U},K)}return N?Ql.createPortal(K,N):null});Mn.displayName="Overlay";Mn.propTypes={show:se.bool,placement:se.oneOf(Sn),target:se.any,container:se.any,flip:se.bool,children:se.func.isRequired,containerPadding:se.number,popperConfig:se.object,rootClose:se.bool,rootCloseEvent:se.oneOf(["click","mousedown"]),rootCloseDisabled:se.bool,onHide:function(r){for(var s=arguments.length,a=new Array(s>1?s-1:0),n=1;n<s;n++)a[n-1]=arguments[n];if(r.rootClose){var i;return(i=se.func).isRequired.apply(i,[r].concat(a))}return se.func.apply(se,[r].concat(a))},transition:se.elementType,onEnter:se.func,onEntering:se.func,onEntered:se.func,onExit:se.func,onExiting:se.func,onExited:se.func};function Lf(){this.__data__=[],this.size=0}var Ff=Lf,Uf=xs;function Wf(t,r){for(var s=t.length;s--;)if(Uf(t[s][0],r))return s;return-1}var la=Wf,Bf=la,Hf=Array.prototype,zf=Hf.splice;function Gf(t){var r=this.__data__,s=Bf(r,t);if(s<0)return!1;var a=r.length-1;return s==a?r.pop():zf.call(r,s,1),--this.size,!0}var qf=Gf,Yf=la;function Vf(t){var r=this.__data__,s=Yf(r,t);return s<0?void 0:r[s][1]}var Kf=Vf,Jf=la;function Xf(t){return Jf(this.__data__,t)>-1}var Zf=Xf,Qf=la;function ex(t,r){var s=this.__data__,a=Qf(s,t);return a<0?(++this.size,s.push([t,r])):s[a][1]=r,this}var tx=ex,rx=Ff,sx=qf,ax=Kf,nx=Zf,ix=tx;function Pr(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var a=t[r];this.set(a[0],a[1])}}Pr.prototype.clear=rx;Pr.prototype.delete=sx;Pr.prototype.get=ax;Pr.prototype.has=nx;Pr.prototype.set=ix;var oa=Pr,lx=oa;function ox(){this.__data__=new lx,this.size=0}var cx=ox;function dx(t){var r=this.__data__,s=r.delete(t);return this.size=r.size,s}var ux=dx;function mx(t){return this.__data__.get(t)}var hx=mx;function fx(t){return this.__data__.has(t)}var xx=fx,gx=Rt,px=gx["__core-js_shared__"],vx=px,Da=vx,Yi=function(){var t=/[^.]+$/.exec(Da&&Da.keys&&Da.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function bx(t){return!!Yi&&Yi in t}var yx=bx,jx=Function.prototype,wx=jx.toString;function Nx(t){if(t!=null){try{return wx.call(t)}catch{}try{return t+""}catch{}}return""}var Xo=Nx,Sx=vn,kx=yx,Cx=zt,Ex=Xo,$x=/[\\^$.*+?()[\]{}|]/g,Tx=/^\[object .+?Constructor\]$/,Ox=Function.prototype,Dx=Object.prototype,Mx=Ox.toString,Px=Dx.hasOwnProperty,_x=RegExp("^"+Mx.call(Px).replace($x,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ax(t){if(!Cx(t)||kx(t))return!1;var r=Sx(t)?_x:Tx;return r.test(Ex(t))}var Rx=Ax;function Ix(t,r){return t==null?void 0:t[r]}var Lx=Ix,Fx=Rx,Ux=Lx;function Wx(t,r){var s=Ux(t,r);return Fx(s)?s:void 0}var xr=Wx,Bx=xr,Hx=Rt,zx=Bx(Hx,"Map"),Pn=zx,Gx=xr,qx=Gx(Object,"create"),ca=qx,Vi=ca;function Yx(){this.__data__=Vi?Vi(null):{},this.size=0}var Vx=Yx;function Kx(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var Jx=Kx,Xx=ca,Zx="__lodash_hash_undefined__",Qx=Object.prototype,eg=Qx.hasOwnProperty;function tg(t){var r=this.__data__;if(Xx){var s=r[t];return s===Zx?void 0:s}return eg.call(r,t)?r[t]:void 0}var rg=tg,sg=ca,ag=Object.prototype,ng=ag.hasOwnProperty;function ig(t){var r=this.__data__;return sg?r[t]!==void 0:ng.call(r,t)}var lg=ig,og=ca,cg="__lodash_hash_undefined__";function dg(t,r){var s=this.__data__;return this.size+=this.has(t)?0:1,s[t]=og&&r===void 0?cg:r,this}var ug=dg,mg=Vx,hg=Jx,fg=rg,xg=lg,gg=ug;function _r(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var a=t[r];this.set(a[0],a[1])}}_r.prototype.clear=mg;_r.prototype.delete=hg;_r.prototype.get=fg;_r.prototype.has=xg;_r.prototype.set=gg;var pg=_r,Ki=pg,vg=oa,bg=Pn;function yg(){this.size=0,this.__data__={hash:new Ki,map:new(bg||vg),string:new Ki}}var jg=yg;function wg(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}var Ng=wg,Sg=Ng;function kg(t,r){var s=t.__data__;return Sg(r)?s[typeof r=="string"?"string":"hash"]:s.map}var da=kg,Cg=da;function Eg(t){var r=Cg(this,t).delete(t);return this.size-=r?1:0,r}var $g=Eg,Tg=da;function Og(t){return Tg(this,t).get(t)}var Dg=Og,Mg=da;function Pg(t){return Mg(this,t).has(t)}var _g=Pg,Ag=da;function Rg(t,r){var s=Ag(this,t),a=s.size;return s.set(t,r),this.size+=s.size==a?0:1,this}var Ig=Rg,Lg=jg,Fg=$g,Ug=Dg,Wg=_g,Bg=Ig;function Ar(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var a=t[r];this.set(a[0],a[1])}}Ar.prototype.clear=Lg;Ar.prototype.delete=Fg;Ar.prototype.get=Ug;Ar.prototype.has=Wg;Ar.prototype.set=Bg;var _n=Ar,Hg=oa,zg=Pn,Gg=_n,qg=200;function Yg(t,r){var s=this.__data__;if(s instanceof Hg){var a=s.__data__;if(!zg||a.length<qg-1)return a.push([t,r]),this.size=++s.size,this;s=this.__data__=new Gg(a)}return s.set(t,r),this.size=s.size,this}var Vg=Yg,Kg=oa,Jg=cx,Xg=ux,Zg=hx,Qg=xx,ep=Vg;function Rr(t){var r=this.__data__=new Kg(t);this.size=r.size}Rr.prototype.clear=Jg;Rr.prototype.delete=Xg;Rr.prototype.get=Zg;Rr.prototype.has=Qg;Rr.prototype.set=ep;var An=Rr,tp="__lodash_hash_undefined__";function rp(t){return this.__data__.set(t,tp),this}var sp=rp;function ap(t){return this.__data__.has(t)}var np=ap,ip=_n,lp=sp,op=np;function Ys(t){var r=-1,s=t==null?0:t.length;for(this.__data__=new ip;++r<s;)this.add(t[r])}Ys.prototype.add=Ys.prototype.push=lp;Ys.prototype.has=op;var cp=Ys;function dp(t,r){for(var s=-1,a=t==null?0:t.length;++s<a;)if(r(t[s],s,t))return!0;return!1}var up=dp;function mp(t,r){return t.has(r)}var hp=mp,fp=cp,xp=up,gp=hp,pp=1,vp=2;function bp(t,r,s,a,n,i){var o=s&pp,c=t.length,l=r.length;if(c!=l&&!(o&&l>c))return!1;var d=i.get(t),m=i.get(r);if(d&&m)return d==r&&m==t;var g=-1,h=!0,x=s&vp?new fp:void 0;for(i.set(t,r),i.set(r,t);++g<c;){var v=t[g],u=r[g];if(a)var f=o?a(u,v,g,r,t,i):a(v,u,g,t,r,i);if(f!==void 0){if(f)continue;h=!1;break}if(x){if(!xp(r,function(N,w){if(!gp(x,w)&&(v===N||n(v,N,s,a,i)))return x.push(w)})){h=!1;break}}else if(!(v===u||n(v,u,s,a,i))){h=!1;break}}return i.delete(t),i.delete(r),h}var Zo=bp,yp=Rt,jp=yp.Uint8Array,Qo=jp;function wp(t){var r=-1,s=Array(t.size);return t.forEach(function(a,n){s[++r]=[n,a]}),s}var Np=wp;function Sp(t){var r=-1,s=Array(t.size);return t.forEach(function(a){s[++r]=a}),s}var kp=Sp,Ji=Dr,Xi=Qo,Cp=xs,Ep=Zo,$p=Np,Tp=kp,Op=1,Dp=2,Mp="[object Boolean]",Pp="[object Date]",_p="[object Error]",Ap="[object Map]",Rp="[object Number]",Ip="[object RegExp]",Lp="[object Set]",Fp="[object String]",Up="[object Symbol]",Wp="[object ArrayBuffer]",Bp="[object DataView]",Zi=Ji?Ji.prototype:void 0,Ma=Zi?Zi.valueOf:void 0;function Hp(t,r,s,a,n,i,o){switch(s){case Bp:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case Wp:return!(t.byteLength!=r.byteLength||!i(new Xi(t),new Xi(r)));case Mp:case Pp:case Rp:return Cp(+t,+r);case _p:return t.name==r.name&&t.message==r.message;case Ip:case Fp:return t==r+"";case Ap:var c=$p;case Lp:var l=a&Op;if(c||(c=Tp),t.size!=r.size&&!l)return!1;var d=o.get(t);if(d)return d==r;a|=Dp,o.set(t,r);var m=Ep(c(t),c(r),a,n,i,o);return o.delete(t),m;case Up:if(Ma)return Ma.call(t)==Ma.call(r)}return!1}var zp=Hp;function Gp(t,r){for(var s=-1,a=r.length,n=t.length;++s<a;)t[n+s]=r[s];return t}var Rn=Gp,qp=Array.isArray,kt=qp,Yp=Rn,Vp=kt;function Kp(t,r,s){var a=r(t);return Vp(t)?a:Yp(a,s(t))}var ec=Kp;function Jp(t,r){for(var s=-1,a=t==null?0:t.length,n=0,i=[];++s<a;){var o=t[s];r(o,s,t)&&(i[n++]=o)}return i}var Xp=Jp;function Zp(){return[]}var tc=Zp,Qp=Xp,e0=tc,t0=Object.prototype,r0=t0.propertyIsEnumerable,Qi=Object.getOwnPropertySymbols,s0=Qi?function(t){return t==null?[]:(t=Object(t),Qp(Qi(t),function(r){return r0.call(t,r)}))}:e0,In=s0;function a0(t,r){for(var s=-1,a=Array(t);++s<t;)a[s]=r(s);return a}var n0=a0,i0=Mr,l0=Zt,o0="[object Arguments]";function c0(t){return l0(t)&&i0(t)==o0}var d0=c0,el=d0,u0=Zt,rc=Object.prototype,m0=rc.hasOwnProperty,h0=rc.propertyIsEnumerable,f0=el(function(){return arguments}())?el:function(t){return u0(t)&&m0.call(t,"callee")&&!h0.call(t,"callee")},Ln=f0,Vs={exports:{}};function x0(){return!1}var g0=x0;Vs.exports;(function(t,r){var s=Rt,a=g0,n=r&&!r.nodeType&&r,i=n&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===n,c=o?s.Buffer:void 0,l=c?c.isBuffer:void 0,d=l||a;t.exports=d})(Vs,Vs.exports);var ua=Vs.exports,p0=Mr,v0=bn,b0=Zt,y0="[object Arguments]",j0="[object Array]",w0="[object Boolean]",N0="[object Date]",S0="[object Error]",k0="[object Function]",C0="[object Map]",E0="[object Number]",$0="[object Object]",T0="[object RegExp]",O0="[object Set]",D0="[object String]",M0="[object WeakMap]",P0="[object ArrayBuffer]",_0="[object DataView]",A0="[object Float32Array]",R0="[object Float64Array]",I0="[object Int8Array]",L0="[object Int16Array]",F0="[object Int32Array]",U0="[object Uint8Array]",W0="[object Uint8ClampedArray]",B0="[object Uint16Array]",H0="[object Uint32Array]",Me={};Me[A0]=Me[R0]=Me[I0]=Me[L0]=Me[F0]=Me[U0]=Me[W0]=Me[B0]=Me[H0]=!0;Me[y0]=Me[j0]=Me[P0]=Me[w0]=Me[_0]=Me[N0]=Me[S0]=Me[k0]=Me[C0]=Me[E0]=Me[$0]=Me[T0]=Me[O0]=Me[D0]=Me[M0]=!1;function z0(t){return b0(t)&&v0(t.length)&&!!Me[p0(t)]}var G0=z0;function q0(t){return function(r){return t(r)}}var ma=q0,Ks={exports:{}};Ks.exports;(function(t,r){var s=_o,a=r&&!r.nodeType&&r,n=a&&!0&&t&&!t.nodeType&&t,i=n&&n.exports===a,o=i&&s.process,c=function(){try{var l=n&&n.require&&n.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=c})(Ks,Ks.exports);var Fn=Ks.exports,Y0=G0,V0=ma,tl=Fn,rl=tl&&tl.isTypedArray,K0=rl?V0(rl):Y0,Un=K0,J0=n0,X0=Ln,Z0=kt,Q0=ua,ev=yn,tv=Un,rv=Object.prototype,sv=rv.hasOwnProperty;function av(t,r){var s=Z0(t),a=!s&&X0(t),n=!s&&!a&&Q0(t),i=!s&&!a&&!n&&tv(t),o=s||a||n||i,c=o?J0(t.length,String):[],l=c.length;for(var d in t)(r||sv.call(t,d))&&!(o&&(d=="length"||n&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||ev(d,l)))&&c.push(d);return c}var sc=av,nv=Object.prototype;function iv(t){var r=t&&t.constructor,s=typeof r=="function"&&r.prototype||nv;return t===s}var Wn=iv;function lv(t,r){return function(s){return t(r(s))}}var ac=lv,ov=ac,cv=ov(Object.keys,Object),dv=cv,uv=Wn,mv=dv,hv=Object.prototype,fv=hv.hasOwnProperty;function xv(t){if(!uv(t))return mv(t);var r=[];for(var s in Object(t))fv.call(t,s)&&s!="constructor"&&r.push(s);return r}var gv=xv,pv=sc,vv=gv,bv=gs;function yv(t){return bv(t)?pv(t):vv(t)}var js=yv,jv=ec,wv=In,Nv=js;function Sv(t){return jv(t,Nv,wv)}var nc=Sv,sl=nc,kv=1,Cv=Object.prototype,Ev=Cv.hasOwnProperty;function $v(t,r,s,a,n,i){var o=s&kv,c=sl(t),l=c.length,d=sl(r),m=d.length;if(l!=m&&!o)return!1;for(var g=l;g--;){var h=c[g];if(!(o?h in r:Ev.call(r,h)))return!1}var x=i.get(t),v=i.get(r);if(x&&v)return x==r&&v==t;var u=!0;i.set(t,r),i.set(r,t);for(var f=o;++g<l;){h=c[g];var N=t[h],w=r[h];if(a)var k=o?a(w,N,h,r,t,i):a(N,w,h,t,r,i);if(!(k===void 0?N===w||n(N,w,s,a,i):k)){u=!1;break}f||(f=h=="constructor")}if(u&&!f){var p=t.constructor,C=r.constructor;p!=C&&"constructor"in t&&"constructor"in r&&!(typeof p=="function"&&p instanceof p&&typeof C=="function"&&C instanceof C)&&(u=!1)}return i.delete(t),i.delete(r),u}var Tv=$v,Ov=xr,Dv=Rt,Mv=Ov(Dv,"DataView"),Pv=Mv,_v=xr,Av=Rt,Rv=_v(Av,"Promise"),Iv=Rv,Lv=xr,Fv=Rt,Uv=Lv(Fv,"Set"),Wv=Uv,Bv=xr,Hv=Rt,zv=Bv(Hv,"WeakMap"),Gv=zv,Ja=Pv,Xa=Pn,Za=Iv,Qa=Wv,en=Gv,ic=Mr,Ir=Xo,al="[object Map]",qv="[object Object]",nl="[object Promise]",il="[object Set]",ll="[object WeakMap]",ol="[object DataView]",Yv=Ir(Ja),Vv=Ir(Xa),Kv=Ir(Za),Jv=Ir(Qa),Xv=Ir(en),tr=ic;(Ja&&tr(new Ja(new ArrayBuffer(1)))!=ol||Xa&&tr(new Xa)!=al||Za&&tr(Za.resolve())!=nl||Qa&&tr(new Qa)!=il||en&&tr(new en)!=ll)&&(tr=function(t){var r=ic(t),s=r==qv?t.constructor:void 0,a=s?Ir(s):"";if(a)switch(a){case Yv:return ol;case Vv:return al;case Kv:return nl;case Jv:return il;case Xv:return ll}return r});var ha=tr,Pa=An,Zv=Zo,Qv=zp,eb=Tv,cl=ha,dl=kt,ul=ua,tb=Un,rb=1,ml="[object Arguments]",hl="[object Array]",Ms="[object Object]",sb=Object.prototype,fl=sb.hasOwnProperty;function ab(t,r,s,a,n,i){var o=dl(t),c=dl(r),l=o?hl:cl(t),d=c?hl:cl(r);l=l==ml?Ms:l,d=d==ml?Ms:d;var m=l==Ms,g=d==Ms,h=l==d;if(h&&ul(t)){if(!ul(r))return!1;o=!0,m=!1}if(h&&!m)return i||(i=new Pa),o||tb(t)?Zv(t,r,s,a,n,i):Qv(t,r,l,s,a,n,i);if(!(s&rb)){var x=m&&fl.call(t,"__wrapped__"),v=g&&fl.call(r,"__wrapped__");if(x||v){var u=x?t.value():t,f=v?r.value():r;return i||(i=new Pa),n(u,f,s,a,i)}}return h?(i||(i=new Pa),eb(t,r,s,a,n,i)):!1}var nb=ab,ib=nb,xl=Zt;function lc(t,r,s,a,n){return t===r?!0:t==null||r==null||!xl(t)&&!xl(r)?t!==t&&r!==r:ib(t,r,s,a,lc,n)}var Bn=lc,lb=Bn;function ob(t,r){return lb(t,r)}var cb=ob;const db=St(cb);function _a(t,r){var s=jn(t);return s?s.innerHeight:nr(t).height}function oc(t,r,s){t.closest&&!s&&t.closest(r);var a=t;do{if(ih(a,r))return a;a=a.parentElement}while(a&&a!==s&&a.nodeType===document.ELEMENT_NODE);return null}function ub(t,r,s,a){for(var n=t.length,i=s+(a?1:-1);a?i--:++i<n;)if(r(t[i],i,t))return i;return-1}var mb=ub,hb=An,fb=Bn,xb=1,gb=2;function pb(t,r,s,a){var n=s.length,i=n,o=!a;if(t==null)return!i;for(t=Object(t);n--;){var c=s[n];if(o&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++n<i;){c=s[n];var l=c[0],d=t[l],m=c[1];if(o&&c[2]){if(d===void 0&&!(l in t))return!1}else{var g=new hb;if(a)var h=a(d,m,l,t,r,g);if(!(h===void 0?fb(m,d,xb|gb,a,g):h))return!1}}return!0}var vb=pb,bb=zt;function yb(t){return t===t&&!bb(t)}var cc=yb,jb=cc,wb=js;function Nb(t){for(var r=wb(t),s=r.length;s--;){var a=r[s],n=t[a];r[s]=[a,n,jb(n)]}return r}var Sb=Nb;function kb(t,r){return function(s){return s==null?!1:s[t]===r&&(r!==void 0||t in Object(s))}}var dc=kb,Cb=vb,Eb=Sb,$b=dc;function Tb(t){var r=Eb(t);return r.length==1&&r[0][2]?$b(r[0][0],r[0][1]):function(s){return s===t||Cb(s,t,r)}}var Ob=Tb,Db=kt,Mb=ps,Pb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_b=/^\w*$/;function Ab(t,r){if(Db(t))return!1;var s=typeof t;return s=="number"||s=="symbol"||s=="boolean"||t==null||Mb(t)?!0:_b.test(t)||!Pb.test(t)||r!=null&&t in Object(r)}var Hn=Ab,uc=_n,Rb="Expected a function";function zn(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(Rb);var s=function(){var a=arguments,n=r?r.apply(this,a):a[0],i=s.cache;if(i.has(n))return i.get(n);var o=t.apply(this,a);return s.cache=i.set(n,o)||i,o};return s.cache=new(zn.Cache||uc),s}zn.Cache=uc;var Ib=zn,Lb=Ib,Fb=500;function Ub(t){var r=Lb(t,function(a){return s.size===Fb&&s.clear(),a}),s=r.cache;return r}var Wb=Ub,Bb=Wb,Hb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,zb=/\\(\\)?/g,Gb=Bb(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(Hb,function(s,a,n,i){r.push(n?i.replace(zb,"$1"):a||s)}),r}),qb=Gb;function Yb(t,r){for(var s=-1,a=t==null?0:t.length,n=Array(a);++s<a;)n[s]=r(t[s],s,t);return n}var Gn=Yb,gl=Dr,Vb=Gn,Kb=kt,Jb=ps,pl=gl?gl.prototype:void 0,vl=pl?pl.toString:void 0;function mc(t){if(typeof t=="string")return t;if(Kb(t))return Vb(t,mc)+"";if(Jb(t))return vl?vl.call(t):"";var r=t+"";return r=="0"&&1/t==-1/0?"-0":r}var Xb=mc,Zb=Xb;function Qb(t){return t==null?"":Zb(t)}var ey=Qb,ty=kt,ry=Hn,sy=qb,ay=ey;function ny(t,r){return ty(t)?t:ry(t,r)?[t]:sy(ay(t))}var fa=ny,iy=ps;function ly(t){if(typeof t=="string"||iy(t))return t;var r=t+"";return r=="0"&&1/t==-1/0?"-0":r}var ws=ly,oy=fa,cy=ws;function dy(t,r){r=oy(r,t);for(var s=0,a=r.length;t!=null&&s<a;)t=t[cy(r[s++])];return s&&s==a?t:void 0}var xa=dy,uy=xa;function my(t,r,s){var a=t==null?void 0:uy(t,r);return a===void 0?s:a}var hy=my;function fy(t,r){return t!=null&&r in Object(t)}var xy=fy,gy=fa,py=Ln,vy=kt,by=yn,yy=bn,jy=ws;function wy(t,r,s){r=gy(r,t);for(var a=-1,n=r.length,i=!1;++a<n;){var o=jy(r[a]);if(!(i=t!=null&&s(t,o)))break;t=t[o]}return i||++a!=n?i:(n=t==null?0:t.length,!!n&&yy(n)&&by(o,n)&&(vy(t)||py(t)))}var Ny=wy,Sy=xy,ky=Ny;function Cy(t,r){return t!=null&&ky(t,r,Sy)}var Ey=Cy,$y=Bn,Ty=hy,Oy=Ey,Dy=Hn,My=cc,Py=dc,_y=ws,Ay=1,Ry=2;function Iy(t,r){return Dy(t)&&My(r)?Py(_y(t),r):function(s){var a=Ty(s,t);return a===void 0&&a===r?Oy(s,t):$y(r,a,Ay|Ry)}}var Ly=Iy;function Fy(t){return t}var ga=Fy;function Uy(t){return function(r){return r==null?void 0:r[t]}}var Wy=Uy,By=xa;function Hy(t){return function(r){return By(r,t)}}var zy=Hy,Gy=Wy,qy=zy,Yy=Hn,Vy=ws;function Ky(t){return Yy(t)?Gy(Vy(t)):qy(t)}var Jy=Ky,Xy=Ob,Zy=Ly,Qy=ga,ej=kt,tj=Jy;function rj(t){return typeof t=="function"?t:t==null?Qy:typeof t=="object"?ej(t)?Zy(t[0],t[1]):Xy(t):tj(t)}var pa=rj,sj=mb,aj=pa,nj=Io,ij=Math.max;function lj(t,r,s){var a=t==null?0:t.length;if(!a)return-1;var n=s==null?0:nj(s);return n<0&&(n=ij(a+n,0)),sj(t,aj(r),n)}var oj=lj;const cj=St(oj);var dj=Math.ceil,uj=Math.max;function mj(t,r,s,a){for(var n=-1,i=uj(dj((r-t)/(s||1)),0),o=Array(i);i--;)o[a?i:++n]=t,t+=s;return o}var hj=mj,fj=hj,xj=na,Aa=Ro;function gj(t){return function(r,s,a){return a&&typeof a!="number"&&xj(r,s,a)&&(s=a=void 0),r=Aa(r),s===void 0?(s=r,r=0):s=Aa(s),a=a===void 0?r<s?1:-1:Aa(a),fj(r,s,a,t)}}var pj=gj,vj=pj,bj=vj(),yj=bj;const jj=St(yj);var bl=Number.isNaN||function(r){return typeof r=="number"&&r!==r};function wj(t,r){return!!(t===r||bl(t)&&bl(r))}function Nj(t,r){if(t.length!==r.length)return!1;for(var s=0;s<t.length;s++)if(!wj(t[s],r[s]))return!1;return!0}function hc(t,r){r===void 0&&(r=Nj);var s=null;function a(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(s&&s.lastThis===this&&r(n,s.lastArgs))return s.lastResult;var o=t.apply(this,n);return s={lastResult:o,lastArgs:n,lastThis:this},o}return a.clear=function(){s=null},a}function tn(t,r){var s=jn(t);return s?s.innerWidth:nr(t).width}var yl=Dr,Sj=Ln,kj=kt,jl=yl?yl.isConcatSpreadable:void 0;function Cj(t){return kj(t)||Sj(t)||!!(jl&&t&&t[jl])}var Ej=Cj,$j=Rn,Tj=Ej;function fc(t,r,s,a,n){var i=-1,o=t.length;for(s||(s=Tj),n||(n=[]);++i<o;){var c=t[i];r>0&&s(c)?r>1?fc(c,r-1,s,a,n):$j(n,c):a||(n[n.length]=c)}return n}var xc=fc;function Oj(t){return function(r,s,a){for(var n=-1,i=Object(r),o=a(r),c=o.length;c--;){var l=o[t?c:++n];if(s(i[l],l,i)===!1)break}return r}}var Dj=Oj,Mj=Dj,Pj=Mj(),_j=Pj,Aj=_j,Rj=js;function Ij(t,r){return t&&Aj(t,r,Rj)}var qn=Ij,Lj=gs;function Fj(t,r){return function(s,a){if(s==null)return s;if(!Lj(s))return t(s,a);for(var n=s.length,i=r?n:-1,o=Object(s);(r?i--:++i<n)&&a(o[i],i,o)!==!1;);return s}}var Uj=Fj,Wj=qn,Bj=Uj,Hj=Bj(Wj),zj=Hj,Gj=zj,qj=gs;function Yj(t,r){var s=-1,a=qj(t)?Array(t.length):[];return Gj(t,function(n,i,o){a[++s]=r(n,i,o)}),a}var Vj=Yj;function Kj(t,r){var s=t.length;for(t.sort(r);s--;)t[s]=t[s].value;return t}var Jj=Kj,wl=ps;function Xj(t,r){if(t!==r){var s=t!==void 0,a=t===null,n=t===t,i=wl(t),o=r!==void 0,c=r===null,l=r===r,d=wl(r);if(!c&&!d&&!i&&t>r||i&&o&&l&&!c&&!d||a&&o&&l||!s&&l||!n)return 1;if(!a&&!i&&!d&&t<r||d&&s&&n&&!a&&!i||c&&s&&n||!o&&n||!l)return-1}return 0}var Zj=Xj,Qj=Zj;function ew(t,r,s){for(var a=-1,n=t.criteria,i=r.criteria,o=n.length,c=s.length;++a<o;){var l=Qj(n[a],i[a]);if(l){if(a>=c)return l;var d=s[a];return l*(d=="desc"?-1:1)}}return t.index-r.index}var tw=ew,Ra=Gn,rw=xa,sw=pa,aw=Vj,nw=Jj,iw=ma,lw=tw,ow=ga,cw=kt;function dw(t,r,s){r.length?r=Ra(r,function(i){return cw(i)?function(o){return rw(o,i.length===1?i[0]:i)}:i}):r=[ow];var a=-1;r=Ra(r,iw(sw));var n=aw(t,function(i,o,c){var l=Ra(r,function(d){return d(i)});return{criteria:l,index:++a,value:i}});return nw(n,function(i,o){return lw(i,o,s)})}var uw=dw;function mw(t,r,s){switch(s.length){case 0:return t.call(r);case 1:return t.call(r,s[0]);case 2:return t.call(r,s[0],s[1]);case 3:return t.call(r,s[0],s[1],s[2])}return t.apply(r,s)}var hw=mw,fw=hw,Nl=Math.max;function xw(t,r,s){return r=Nl(r===void 0?t.length-1:r,0),function(){for(var a=arguments,n=-1,i=Nl(a.length-r,0),o=Array(i);++n<i;)o[n]=a[r+n];n=-1;for(var c=Array(r+1);++n<r;)c[n]=a[n];return c[r]=s(o),fw(t,this,c)}}var gc=xw;function gw(t){return function(){return t}}var pw=gw,vw=xr,bw=function(){try{var t=vw(Object,"defineProperty");return t({},"",{}),t}catch{}}(),pc=bw,yw=pw,Sl=pc,jw=ga,ww=Sl?function(t,r){return Sl(t,"toString",{configurable:!0,enumerable:!1,value:yw(r),writable:!0})}:jw,Nw=ww,Sw=800,kw=16,Cw=Date.now;function Ew(t){var r=0,s=0;return function(){var a=Cw(),n=kw-(a-s);if(s=a,n>0){if(++r>=Sw)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}var $w=Ew,Tw=Nw,Ow=$w,Dw=Ow(Tw),vc=Dw,Mw=ga,Pw=gc,_w=vc;function Aw(t,r){return _w(Pw(t,r,Mw),t+"")}var bc=Aw,Rw=xc,Iw=uw,Lw=bc,kl=na,Fw=Lw(function(t,r){if(t==null)return[];var s=r.length;return s>1&&kl(t,r[0],r[1])?r=[]:s>2&&kl(r[0],r[1],r[2])&&(r=[r[0]]),Iw(t,Rw(r,1),[])}),Uw=Fw;const Ww=St(Uw);function yc(t){return xo(t)||Mo(t)||xn(t)||go()}function Bw(t){var r=[];if(t!=null)for(var s in Object(t))r.push(s);return r}var Hw=Bw,zw=zt,Gw=Wn,qw=Hw,Yw=Object.prototype,Vw=Yw.hasOwnProperty;function Kw(t){if(!zw(t))return qw(t);var r=Gw(t),s=[];for(var a in t)a=="constructor"&&(r||!Vw.call(t,a))||s.push(a);return s}var Jw=Kw,Xw=sc,Zw=Jw,Qw=gs;function eN(t){return Qw(t)?Xw(t,!0):Zw(t)}var va=eN,tN=bc,rN=xs,sN=na,aN=va,jc=Object.prototype,nN=jc.hasOwnProperty,iN=tN(function(t,r){t=Object(t);var s=-1,a=r.length,n=a>2?r[2]:void 0;for(n&&sN(r[0],r[1],n)&&(a=1);++s<a;)for(var i=r[s],o=aN(i),c=-1,l=o.length;++c<l;){var d=o[c],m=t[d];(m===void 0||rN(m,jc[d])&&!nN.call(t,d))&&(t[d]=i[d])}return t}),lN=iN;const oN=St(lN);var Cl=pc;function cN(t,r,s){r=="__proto__"&&Cl?Cl(t,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):t[r]=s}var Yn=cN,dN=Yn,uN=qn,mN=pa;function hN(t,r){var s={};return r=mN(r),uN(t,function(a,n,i){dN(s,n,r(a,n,i))}),s}var fN=hN;const xN=St(fN);function gN(t,r){for(var s=-1,a=t==null?0:t.length;++s<a&&r(t[s],s,t)!==!1;);return t}var wc=gN,pN=Yn,vN=xs,bN=Object.prototype,yN=bN.hasOwnProperty;function jN(t,r,s){var a=t[r];(!(yN.call(t,r)&&vN(a,s))||s===void 0&&!(r in t))&&pN(t,r,s)}var Nc=jN,wN=Nc,NN=Yn;function SN(t,r,s,a){var n=!s;s||(s={});for(var i=-1,o=r.length;++i<o;){var c=r[i],l=a?a(s[c],t[c],c,s,t):void 0;l===void 0&&(l=t[c]),n?NN(s,c,l):wN(s,c,l)}return s}var Ns=SN,kN=Ns,CN=js;function EN(t,r){return t&&kN(r,CN(r),t)}var $N=EN,TN=Ns,ON=va;function DN(t,r){return t&&TN(r,ON(r),t)}var MN=DN,Js={exports:{}};Js.exports;(function(t,r){var s=Rt,a=r&&!r.nodeType&&r,n=a&&!0&&t&&!t.nodeType&&t,i=n&&n.exports===a,o=i?s.Buffer:void 0,c=o?o.allocUnsafe:void 0;function l(d,m){if(m)return d.slice();var g=d.length,h=c?c(g):new d.constructor(g);return d.copy(h),h}t.exports=l})(Js,Js.exports);var PN=Js.exports;function _N(t,r){var s=-1,a=t.length;for(r||(r=Array(a));++s<a;)r[s]=t[s];return r}var AN=_N,RN=Ns,IN=In;function LN(t,r){return RN(t,IN(t),r)}var FN=LN,UN=ac,WN=UN(Object.getPrototypeOf,Object),ba=WN,BN=Rn,HN=ba,zN=In,GN=tc,qN=Object.getOwnPropertySymbols,YN=qN?function(t){for(var r=[];t;)BN(r,zN(t)),t=HN(t);return r}:GN,Sc=YN,VN=Ns,KN=Sc;function JN(t,r){return VN(t,KN(t),r)}var XN=JN,ZN=ec,QN=Sc,e1=va;function t1(t){return ZN(t,e1,QN)}var kc=t1,r1=Object.prototype,s1=r1.hasOwnProperty;function a1(t){var r=t.length,s=new t.constructor(r);return r&&typeof t[0]=="string"&&s1.call(t,"index")&&(s.index=t.index,s.input=t.input),s}var n1=a1,El=Qo;function i1(t){var r=new t.constructor(t.byteLength);return new El(r).set(new El(t)),r}var Vn=i1,l1=Vn;function o1(t,r){var s=r?l1(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.byteLength)}var c1=o1,d1=/\w*$/;function u1(t){var r=new t.constructor(t.source,d1.exec(t));return r.lastIndex=t.lastIndex,r}var m1=u1,$l=Dr,Tl=$l?$l.prototype:void 0,Ol=Tl?Tl.valueOf:void 0;function h1(t){return Ol?Object(Ol.call(t)):{}}var f1=h1,x1=Vn;function g1(t,r){var s=r?x1(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.length)}var p1=g1,v1=Vn,b1=c1,y1=m1,j1=f1,w1=p1,N1="[object Boolean]",S1="[object Date]",k1="[object Map]",C1="[object Number]",E1="[object RegExp]",$1="[object Set]",T1="[object String]",O1="[object Symbol]",D1="[object ArrayBuffer]",M1="[object DataView]",P1="[object Float32Array]",_1="[object Float64Array]",A1="[object Int8Array]",R1="[object Int16Array]",I1="[object Int32Array]",L1="[object Uint8Array]",F1="[object Uint8ClampedArray]",U1="[object Uint16Array]",W1="[object Uint32Array]";function B1(t,r,s){var a=t.constructor;switch(r){case D1:return v1(t);case N1:case S1:return new a(+t);case M1:return b1(t,s);case P1:case _1:case A1:case R1:case I1:case L1:case F1:case U1:case W1:return w1(t,s);case k1:return new a;case C1:case T1:return new a(t);case E1:return y1(t);case $1:return new a;case O1:return j1(t)}}var H1=B1,z1=zt,Dl=Object.create,G1=function(){function t(){}return function(r){if(!z1(r))return{};if(Dl)return Dl(r);t.prototype=r;var s=new t;return t.prototype=void 0,s}}(),Cc=G1,q1=Cc,Y1=ba,V1=Wn;function K1(t){return typeof t.constructor=="function"&&!V1(t)?q1(Y1(t)):{}}var J1=K1,X1=ha,Z1=Zt,Q1="[object Map]";function e2(t){return Z1(t)&&X1(t)==Q1}var t2=e2,r2=t2,s2=ma,Ml=Fn,Pl=Ml&&Ml.isMap,a2=Pl?s2(Pl):r2,n2=a2,i2=ha,l2=Zt,o2="[object Set]";function c2(t){return l2(t)&&i2(t)==o2}var d2=c2,u2=d2,m2=ma,_l=Fn,Al=_l&&_l.isSet,h2=Al?m2(Al):u2,f2=h2,x2=An,g2=wc,p2=Nc,v2=$N,b2=MN,y2=PN,j2=AN,w2=FN,N2=XN,S2=nc,k2=kc,C2=ha,E2=n1,$2=H1,T2=J1,O2=kt,D2=ua,M2=n2,P2=zt,_2=f2,A2=js,R2=va,I2=1,L2=2,F2=4,Ec="[object Arguments]",U2="[object Array]",W2="[object Boolean]",B2="[object Date]",H2="[object Error]",$c="[object Function]",z2="[object GeneratorFunction]",G2="[object Map]",q2="[object Number]",Tc="[object Object]",Y2="[object RegExp]",V2="[object Set]",K2="[object String]",J2="[object Symbol]",X2="[object WeakMap]",Z2="[object ArrayBuffer]",Q2="[object DataView]",eS="[object Float32Array]",tS="[object Float64Array]",rS="[object Int8Array]",sS="[object Int16Array]",aS="[object Int32Array]",nS="[object Uint8Array]",iS="[object Uint8ClampedArray]",lS="[object Uint16Array]",oS="[object Uint32Array]",De={};De[Ec]=De[U2]=De[Z2]=De[Q2]=De[W2]=De[B2]=De[eS]=De[tS]=De[rS]=De[sS]=De[aS]=De[G2]=De[q2]=De[Tc]=De[Y2]=De[V2]=De[K2]=De[J2]=De[nS]=De[iS]=De[lS]=De[oS]=!0;De[H2]=De[$c]=De[X2]=!1;function Ls(t,r,s,a,n,i){var o,c=r&I2,l=r&L2,d=r&F2;if(s&&(o=n?s(t,a,n,i):s(t)),o!==void 0)return o;if(!P2(t))return t;var m=O2(t);if(m){if(o=E2(t),!c)return j2(t,o)}else{var g=C2(t),h=g==$c||g==z2;if(D2(t))return y2(t,c);if(g==Tc||g==Ec||h&&!n){if(o=l||h?{}:T2(t),!c)return l?N2(t,b2(o,t)):w2(t,v2(o,t))}else{if(!De[g])return n?t:{};o=$2(t,g,c)}}i||(i=new x2);var x=i.get(t);if(x)return x;i.set(t,o),_2(t)?t.forEach(function(f){o.add(Ls(f,r,s,f,t,i))}):M2(t)&&t.forEach(function(f,N){o.set(N,Ls(f,r,s,N,t,i))});var v=d?l?k2:S2:l?R2:A2,u=m?void 0:v(t);return g2(u||t,function(f,N){u&&(N=f,f=t[N]),p2(o,N,Ls(f,r,s,N,t,i))}),o}var cS=Ls;function dS(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}var uS=dS,mS=xa,hS=Po;function fS(t,r){return r.length<2?t:mS(t,hS(r,0,-1))}var xS=fS,gS=fa,pS=uS,vS=xS,bS=ws;function yS(t,r){return r=gS(r,t),t=vS(t,r),t==null||delete t[bS(pS(r))]}var jS=yS,wS=Mr,NS=ba,SS=Zt,kS="[object Object]",CS=Function.prototype,ES=Object.prototype,Oc=CS.toString,$S=ES.hasOwnProperty,TS=Oc.call(Object);function OS(t){if(!SS(t)||wS(t)!=kS)return!1;var r=NS(t);if(r===null)return!0;var s=$S.call(r,"constructor")&&r.constructor;return typeof s=="function"&&s instanceof s&&Oc.call(s)==TS}var DS=OS,MS=DS;function PS(t){return MS(t)?void 0:t}var _S=PS,AS=xc;function RS(t){var r=t==null?0:t.length;return r?AS(t,1):[]}var IS=RS,LS=IS,FS=gc,US=vc;function WS(t){return US(FS(t,void 0,LS),t+"")}var BS=WS,HS=Gn,zS=cS,GS=jS,qS=fa,YS=Ns,VS=_S,KS=BS,JS=kc,XS=1,ZS=2,QS=4,ek=KS(function(t,r){var s={};if(t==null)return s;var a=!1;r=HS(r,function(i){return i=qS(i,t),a||(a=i.length>1),i}),YS(t,JS(t),s),a&&(s=zS(s,XS|ZS|QS,VS));for(var n=r.length;n--;)GS(s,r[n]);return s}),tk=ek;const rk=St(tk);var sk=wc,ak=Cc,nk=qn,ik=pa,lk=ba,ok=kt,ck=ua,dk=vn,uk=zt,mk=Un;function hk(t,r,s){var a=ok(t),n=a||ck(t)||mk(t);if(r=ik(r),s==null){var i=t&&t.constructor;n?s=a?new i:[]:uk(t)?s=dk(i)?ak(lk(t)):{}:s={}}return(n?sk:nk)(t,function(o,c,l){return r(s,o,c,l)}),s}var fk=hk;const xk=St(fk);var gk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(yt,function(){return function(s,a,n){a.prototype.isBetween=function(i,o,c,l){var d=n(i),m=n(o),g=(l=l||"()")[0]==="(",h=l[1]===")";return(g?this.isAfter(d,c):!this.isBefore(d,c))&&(h?this.isBefore(m,c):!this.isAfter(m,c))||(g?this.isBefore(d,c):!this.isAfter(d,c))&&(h?this.isAfter(m,c):!this.isBefore(m,c))}}})})(gk);var pk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(yt,function(){return function(s,a){a.prototype.isSameOrAfter=function(n,i){return this.isSame(n,i)||this.isAfter(n,i)}}})})(pk);var vk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(yt,function(){return function(s,a){a.prototype.isSameOrBefore=function(n,i){return this.isSame(n,i)||this.isBefore(n,i)}}})})(vk);var bk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(yt,function(){return function(s,a,n){var i=a.prototype,o=function(g){return g&&(g.indexOf?g:g.s)},c=function(g,h,x,v,u){var f=g.name?g:g.$locale(),N=o(f[h]),w=o(f[x]),k=N||w.map(function(C){return C.slice(0,v)});if(!u)return k;var p=f.weekStart;return k.map(function(C,T){return k[(T+(p||0))%7]})},l=function(){return n.Ls[n.locale()]},d=function(g,h){return g.formats[h]||function(x){return x.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(v,u,f){return u||f.slice(1)})}(g.formats[h.toUpperCase()])},m=function(){var g=this;return{months:function(h){return h?h.format("MMMM"):c(g,"months")},monthsShort:function(h){return h?h.format("MMM"):c(g,"monthsShort","months",3)},firstDayOfWeek:function(){return g.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):c(g,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):c(g,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):c(g,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return d(g.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return m.bind(this)()},n.localeData=function(){var g=l();return{firstDayOfWeek:function(){return g.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(h){return d(g,h)},meridiem:g.meridiem,ordinal:g.ordinal}},n.months=function(){return c(l(),"months")},n.monthsShort=function(){return c(l(),"monthsShort","months",3)},n.weekdays=function(g){return c(l(),"weekdays",null,null,g)},n.weekdaysShort=function(g){return c(l(),"weekdaysShort","weekdays",3,g)},n.weekdaysMin=function(g){return c(l(),"weekdaysMin","weekdays",2,g)}}})})(bk);var yk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(yt,function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(a,n,i){var o=n.prototype,c=o.format;i.en.formats=s,o.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var d=this.$locale().formats,m=function(g,h){return g.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(x,v,u){var f=u&&u.toUpperCase();return v||h[u]||s[u]||h[f].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(N,w,k){return w||k.slice(1)})})}(l,d===void 0?{}:d);return c.call(this,m)}}})})(yk);var jk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(yt,function(){return function(s,a,n){var i=function(o,c){if(!c||!c.length||c.length===1&&!c[0]||c.length===1&&Array.isArray(c[0])&&!c[0].length)return null;var l;c.length===1&&c[0].length>0&&(c=c[0]),l=(c=c.filter(function(m){return m}))[0];for(var d=1;d<c.length;d+=1)c[d].isValid()&&!c[d][o](l)||(l=c[d]);return l};n.max=function(){var o=[].slice.call(arguments,0);return i("isAfter",o)},n.min=function(){var o=[].slice.call(arguments,0);return i("isBefore",o)}}})})(jk);var wk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(yt,function(){var s="minute",a=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(i,o,c){var l=o.prototype;c.utc=function(u){var f={date:u,utc:!0,args:arguments};return new o(f)},l.utc=function(u){var f=c(this.toDate(),{locale:this.$L,utc:!0});return u?f.add(this.utcOffset(),s):f},l.local=function(){return c(this.toDate(),{locale:this.$L,utc:!1})};var d=l.parse;l.parse=function(u){u.utc&&(this.$u=!0),this.$utils().u(u.$offset)||(this.$offset=u.$offset),d.call(this,u)};var m=l.init;l.init=function(){if(this.$u){var u=this.$d;this.$y=u.getUTCFullYear(),this.$M=u.getUTCMonth(),this.$D=u.getUTCDate(),this.$W=u.getUTCDay(),this.$H=u.getUTCHours(),this.$m=u.getUTCMinutes(),this.$s=u.getUTCSeconds(),this.$ms=u.getUTCMilliseconds()}else m.call(this)};var g=l.utcOffset;l.utcOffset=function(u,f){var N=this.$utils().u;if(N(u))return this.$u?0:N(this.$offset)?g.call(this):this.$offset;if(typeof u=="string"&&(u=function(C){C===void 0&&(C="");var T=C.match(a);if(!T)return null;var M=(""+T[0]).match(n)||["-",0,0],j=M[0],O=60*+M[1]+ +M[2];return O===0?0:j==="+"?O:-O}(u),u===null))return this;var w=Math.abs(u)<=16?60*u:u,k=this;if(f)return k.$offset=w,k.$u=u===0,k;if(u!==0){var p=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(k=this.local().add(w+p,s)).$offset=w,k.$x.$localOffset=p}else k=this.utc();return k};var h=l.format;l.format=function(u){var f=u||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,f)},l.valueOf=function(){var u=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*u},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var x=l.toDate;l.toDate=function(u){return u==="s"&&this.$offset?c(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():x.call(this)};var v=l.diff;l.diff=function(u,f,N){if(u&&this.$u===u.$u)return v.call(this,u,f,N);var w=this.local(),k=c(u).local();return v.call(w,k,f,N)}}})})(wk);var Nk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(yt,function(){return function(s,a){a.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}}})})(Nk);function $t(t){return t.children}var dt={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},it={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},Rl=Object.keys(it).map(function(t){return it[t]});se.oneOfType([se.string,se.func]);se.any;se.func;se.oneOfType([se.arrayOf(se.oneOf(Rl)),se.objectOf(function(t,r){var s=Rl.indexOf(r)!==-1&&typeof t[r]=="boolean";if(s)return null;for(var a=arguments.length,n=new Array(a>2?a-2:0),i=2;i<a;i++)n[i-2]=arguments[i];return se.elementType.apply(se,[t,r].concat(n))})]);se.oneOfType([se.oneOf(["overlap","no-overlap"]),se.func]);var Il={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function Dc(t,r){var s=Qe(t,"month");return Qe(s,"week",r.startOfWeek())}function Mc(t,r){var s=zs(t,"month");return zs(s,"week",r.startOfWeek())}function Sk(t,r){for(var s=Dc(t,r),a=Mc(t,r),n=[];Tr(s,a,"day");)n.push(s),s=Et(s,1,"day");return n}function kk(t,r){var s=Qe(t,r);return $r(s,t)?s:Et(s,1,r)}function Ck(t,r){for(var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",a=t,n=[];Tr(a,r,s);)n.push(a),a=Et(a,1,s);return n}function Ek(t,r){return r==null&&t==null?null:(r==null&&(r=new Date),t==null&&(t=new Date),t=Qe(t,"day"),t=ls(t,ls(r)),t=Nr(t,Nr(r)),t=is(t,is(r)),ns(t,ns(r)))}function Ll(t){return ls(t)===0&&Nr(t)===0&&is(t)===0&&ns(t)===0}function $k(t,r,s,a){return s==="day"&&(s="date"),Math.abs(yi[s](t,void 0,a)-yi[s](r,void 0,a))}function Kn(t,r,s){return!s||s==="milliseconds"?Math.abs(+t-+r):Math.round(Math.abs(+Qe(t,s)/Il[s]-+Qe(r,s)/Il[s]))}var Tk=se.oneOfType([se.string,se.func]);function Ok(t,r,s,a,n){var i=typeof a=="function"?a(s,n,t):r.call(t,s,a,n);return Qr(i==null||typeof i=="string","`localizer format(..)` must return a string, null, or undefined"),i}function Dk(t,r,s){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,r+s,0,0)}function Jn(t,r){return t.getTimezoneOffset()-r.getTimezoneOffset()}function Mk(t,r){return Kn(t,r,"minutes")+Jn(t,r)}function Pk(t){var r=Qe(t,"day");return Kn(r,t,"minutes")+Jn(r,t)}function _k(t,r){return pn(t,r,"day")}function Ak(t,r,s){var a=$r(t,r,"minutes");return a?fs(r,s,"minutes"):aa(r,s,"minutes")}function rn(t,r){return $k(t,r,"day")}function Rk(t){var r=t.evtA,s=r.start,a=r.end,n=r.allDay,i=t.evtB,o=i.start,c=i.end,l=i.allDay,d=+Qe(s,"day")-+Qe(o,"day"),m=rn(s,a),g=rn(o,c);return d||g-m||!!l-!!n||+s-+o||+a-+c}function Ik(t){var r=t.event,s=r.start,a=r.end,n=t.range,i=n.start,o=n.end,c=Qe(s,"day"),l=Tr(c,o,"day"),d=gn(c,a,"minutes"),m=d?aa(a,i,"minutes"):fs(a,i,"minutes");return l&&m}function Lk(t,r){return $r(t,r,"day")}function Fk(t,r){return Ll(t)&&Ll(r)}var Uk=ze(function t(r){var s=this;He(this,t),Qr(typeof r.format=="function","date localizer `format(..)` must be a function"),Qr(typeof r.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=r.propType||Tk,this.formats=r.formats,this.format=function(){for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return Ok.apply(void 0,[s,r.format].concat(n))},this.startOfWeek=r.firstOfWeek,this.merge=r.merge||Ek,this.inRange=r.inRange||$o,this.lt=r.lt||pn,this.lte=r.lte||Tr,this.gt=r.gt||aa,this.gte=r.gte||fs,this.eq=r.eq||$r,this.neq=r.neq||gn,this.startOf=r.startOf||Qe,this.endOf=r.endOf||zs,this.add=r.add||Et,this.range=r.range||Ck,this.diff=r.diff||Kn,this.ceil=r.ceil||kk,this.min=r.min||Co,this.max=r.max||Eo,this.minutes=r.minutes||Nr,this.daySpan=r.daySpan||rn,this.firstVisibleDay=r.firstVisibleDay||Dc,this.lastVisibleDay=r.lastVisibleDay||Mc,this.visibleDays=r.visibleDays||Sk,this.getSlotDate=r.getSlotDate||Dk,this.getTimezoneOffset=r.getTimezoneOffset||function(a){return a.getTimezoneOffset()},this.getDstOffset=r.getDstOffset||Jn,this.getTotalMin=r.getTotalMin||Mk,this.getMinutesFromMidnight=r.getMinutesFromMidnight||Pk,this.continuesPrior=r.continuesPrior||_k,this.continuesAfter=r.continuesAfter||Ak,this.sortEvents=r.sortEvents||Rk,this.inEventRange=r.inEventRange||Ik,this.isSameDate=r.isSameDate||Lk,this.startAndEndAreDateOnly=r.startAndEndAreDateOnly||Fk,this.segmentOffset=r.browserTZOffset?r.browserTZOffset():0});function Wk(t,r,s,a){var n=Oe(Oe({},t.formats),s);return Oe(Oe({},t),{},{messages:a,startOfWeek:function(){return t.startOfWeek(r)},format:function(o,c){return t.format(o,n[c]||c,r)}})}var Bk=function(t){function r(){var s;He(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=rt(this,r,[].concat(n)),s.navigate=function(o){s.props.onNavigate(o)},s.view=function(o){s.props.onView(o)},s}return st(r,t),ze(r,[{key:"render",value:function(){var a=this.props,n=a.localizer.messages,i=a.label;return I.createElement("div",{className:"rbc-toolbar"},I.createElement("span",{className:"rbc-btn-group"},I.createElement("button",{type:"button",onClick:this.navigate.bind(null,dt.TODAY)},n.today),I.createElement("button",{type:"button",onClick:this.navigate.bind(null,dt.PREVIOUS)},n.previous),I.createElement("button",{type:"button",onClick:this.navigate.bind(null,dt.NEXT)},n.next)),I.createElement("span",{className:"rbc-toolbar-label"},i),I.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(n)))}},{key:"viewNamesGroup",value:function(a){var n=this,i=this.props.views,o=this.props.view;if(i.length>1)return i.map(function(c){return I.createElement("button",{type:"button",key:c,className:Fe({"rbc-active":o===c}),onClick:n.view.bind(null,c)},a[c])})}}])}(I.Component);function Pe(t,r){t&&t.apply(null,[].concat(r))}var Hk={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(r){return"+".concat(r," more")}};function zk(t){return Oe(Oe({},Hk),t)}function Gk(t){var r=t.ref,s=t.callback;S.useEffect(function(){var a=function(i){r.current&&!r.current.contains(i.target)&&s()};return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[r,s])}var qk=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],Pc=function(t){function r(){return He(this,r),rt(this,r,arguments)}return st(r,t),ze(r,[{key:"render",value:function(){var a=this.props,n=a.style,i=a.className,o=a.event,c=a.selected,l=a.isAllDay,d=a.onSelect,m=a.onDoubleClick,g=a.onKeyPress,h=a.localizer,x=a.continuesPrior,v=a.continuesAfter,u=a.accessors,f=a.getters,N=a.children,w=a.components,k=w.event,p=w.eventWrapper,C=a.slotStart,T=a.slotEnd,M=_t(a,qk);delete M.resizable;var j=u.title(o),O=u.tooltip(o),B=u.end(o),F=u.start(o),K=u.allDay(o),G=l||K||h.diff(F,h.ceil(B,"day"),"day")>1,ae=f.eventProp(o,F,B,c),H=I.createElement("div",{className:"rbc-event-content",title:O||void 0},k?I.createElement(k,{event:o,continuesPrior:x,continuesAfter:v,title:j,isAllDay:K,localizer:h,slotStart:C,slotEnd:T}):j);return I.createElement(p,Object.assign({},this.props,{type:"date"}),I.createElement("div",Object.assign({},M,{style:Oe(Oe({},ae.style),n),className:Fe("rbc-event",i,ae.className,{"rbc-selected":c,"rbc-event-allday":G,"rbc-event-continues-prior":x,"rbc-event-continues-after":v}),onClick:function(U){return d&&d(o,U)},onDoubleClick:function(U){return m&&m(o,U)},onKeyDown:function(U){return g&&g(o,U)}}),typeof N=="function"?N(H):H))}}])}(I.Component);function ya(t,r){return!t||r==null?!1:db(t,r)}function _c(t,r){var s=t.right-t.left,a=s/r;return a}function Ac(t,r,s,a){var n=_c(t,a);return s?a-1-Math.floor((r-t.left)/n):Math.floor((r-t.left)/n)}function Yk(t,r){var s=r.x,a=r.y;return a>=t.top&&a<=t.bottom&&s>=t.left&&s<=t.right}function Vk(t,r,s,a,n){var i=-1,o=-1,c=a-1,l=_c(r,a),d=Ac(r,s.x,n,a),m=r.top<s.y&&r.bottom>s.y,g=r.top<t.y&&r.bottom>t.y,h=t.y>r.bottom,x=r.top>t.y,v=s.top<r.top&&s.bottom>r.bottom;return v&&(i=0,o=c),m&&(x?(i=0,o=d):h&&(i=d,o=c)),g&&(i=o=n?c-Math.floor((t.x-r.left)/l):Math.floor((t.x-r.left)/l),m?d<i?i=d:o=d:t.y<s.y?o=c:i=0),{startIdx:i,endIdx:o}}function Kk(t){var r=t.target,s=t.offset,a=t.container,n=t.box,i=nr(r),o=i.top,c=i.left,l=i.width,d=i.height,m=nr(a),g=m.top,h=m.left,x=m.width,v=m.height,u=nr(n),f=u.width,N=u.height,w=g+v,k=h+x,p=o+N,C=c+f,T=s.x,M=s.y,j=p>w?o-N-M:o+M+d,O=C>k?c+T-f+l:c+T;return{topOffset:j,leftOffset:O}}function Jk(t){var r=t.containerRef,s=t.accessors,a=t.getters,n=t.selected,i=t.components,o=t.localizer,c=t.position,l=t.show,d=t.events,m=t.slotStart,g=t.slotEnd,h=t.onSelect,x=t.onDoubleClick,v=t.onKeyPress,u=t.handleDragStart,f=t.popperRef,N=t.target,w=t.offset;Gk({ref:f,callback:l}),S.useLayoutEffect(function(){var C=Kk({target:N,offset:w,container:r.current,box:f.current}),T=C.topOffset,M=C.leftOffset;f.current.style.top="".concat(T,"px"),f.current.style.left="".concat(M,"px")},[w.x,w.y,N]);var k=c.width,p={minWidth:k+k/2};return I.createElement("div",{style:p,className:"rbc-overlay",ref:f},I.createElement("div",{className:"rbc-overlay-header"},o.format(m,"dayHeaderFormat")),d.map(function(C,T){return I.createElement(Pc,{key:T,type:"popup",localizer:o,event:C,getters:a,onSelect:h,accessors:s,components:i,onDoubleClick:x,onKeyPress:v,continuesPrior:o.lt(s.end(C),m,"day"),continuesAfter:o.gte(s.start(C),g,"day"),slotStart:m,slotEnd:g,selected:ya(C,n),draggable:!0,onDragStart:function(){return u(C)},onDragEnd:function(){return l()}})}))}var Rc=I.forwardRef(function(t,r){return I.createElement(Jk,Object.assign({},t,{popperRef:r}))});Rc.propTypes={accessors:se.object.isRequired,getters:se.object.isRequired,selected:se.object,components:se.object.isRequired,localizer:se.object.isRequired,position:se.object.isRequired,show:se.func.isRequired,events:se.array.isRequired,slotStart:se.instanceOf(Date).isRequired,slotEnd:se.instanceOf(Date),onSelect:se.func,onDoubleClick:se.func,onKeyPress:se.func,handleDragStart:se.func,style:se.object,offset:se.shape({x:se.number,y:se.number})};function Xk(t){var r=t.containerRef,s=t.popupOffset,a=s===void 0?5:s,n=t.overlay,i=t.accessors,o=t.localizer,c=t.components,l=t.getters,d=t.selected,m=t.handleSelectEvent,g=t.handleDoubleClickEvent,h=t.handleKeyPressEvent,x=t.handleDragStart,v=t.onHide,u=t.overlayDisplay,f=S.useRef(null);if(!n.position)return null;var N=a;isNaN(a)||(N={x:a,y:a});var w=n.position,k=n.events,p=n.date,C=n.end;return I.createElement(Mn,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:v,target:n.target},function(T){var M=T.props;return I.createElement(Rc,Object.assign({},M,{containerRef:r,ref:f,target:n.target,offset:N,accessors:i,getters:l,selected:d,components:c,localizer:o,position:w,show:u,events:k,slotStart:p,slotEnd:C,onSelect:m,onDoubleClick:g,onKeyPress:h,handleDragStart:x}))})}var Xn=I.forwardRef(function(t,r){return I.createElement(Xk,Object.assign({},t,{containerRef:r}))});Xn.propTypes={popupOffset:se.oneOfType([se.number,se.shape({x:se.number,y:se.number})]),overlay:se.shape({position:se.object,events:se.array,date:se.instanceOf(Date),end:se.instanceOf(Date)}),accessors:se.object.isRequired,localizer:se.object.isRequired,components:se.object.isRequired,getters:se.object.isRequired,selected:se.object,handleSelectEvent:se.func,handleDoubleClickEvent:se.func,handleKeyPressEvent:se.func,handleDragStart:se.func,onHide:se.func,overlayDisplay:se.func};function et(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return zr(s,t,r,{passive:!1})}function Zk(t,r,s){return!t||os(t,document.elementFromPoint(r,s))}function Qk(t,r){var s=r.clientX,a=r.clientY,n=document.elementFromPoint(s,a);return oc(n,".rbc-event",t)}function e5(t,r){var s=r.clientX,a=r.clientY,n=document.elementFromPoint(s,a);return oc(n,".rbc-show-more",t)}function Xs(t,r){return!!Qk(t,r)}function t5(t,r){return!!e5(t,r)}function Wr(t){var r=t;return t.touches&&t.touches.length&&(r=t.touches[0]),{clientX:r.clientX,clientY:r.clientY,pageX:r.pageX,pageY:r.pageY}}var Fl=5,r5=250,Ic=function(){function t(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.global,n=a===void 0?!1:a,i=s.longPressThreshold,o=i===void 0?250:i,c=s.validContainers,l=c===void 0?[]:c;He(this,t),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=r,this.globalMouse=!r||n,this.longPressThreshold=o,this.validContainers=l,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=et("touchmove",function(){},window),this._removeKeyDownListener=et("keydown",this._keyListener),this._removeKeyUpListener=et("keyup",this._keyListener),this._removeDropFromOutsideListener=et("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=et("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return ze(t,[{key:"on",value:function(s,a){var n=this._listeners[s]||(this._listeners[s]=[]);return n.push(a),{remove:function(){var o=n.indexOf(a);o!==-1&&n.splice(o,1)}}}},{key:"emit",value:function(s){for(var a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];var o,c=this._listeners[s]||[];return c.forEach(function(l){o===void 0&&(o=l.apply(void 0,n))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(s){var a=this._selectRect;return!a||!this.selecting?!1:Ul(a,fr(s))}},{key:"filter",value:function(s){var a=this._selectRect;return!a||!this.selecting?[]:s.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(s,a){var n=this,i=null,o=null,c=null,l=function(h){i=setTimeout(function(){m(),s(h)},n.longPressThreshold),o=et("touchmove",function(){return m()}),c=et("touchend",function(){return m()})},d=et("touchstart",l),m=function(){i&&clearTimeout(i),o&&o(),c&&c(),i=null,o=null,c=null};return a&&l(a),function(){m(),d()}}},{key:"_addInitialEventListener",value:function(){var s=this,a=et("mousedown",function(i){s._removeInitialEventListener(),s._handleInitialEvent(i),s._removeInitialEventListener=et("mousedown",s._handleInitialEvent)}),n=et("touchstart",function(i){s._removeInitialEventListener(),s._removeInitialEventListener=s._addLongPressListener(s._handleInitialEvent,i)});this._removeInitialEventListener=function(){a(),n()}}},{key:"_dropFromOutsideListener",value:function(s){var a=Wr(s),n=a.pageX,i=a.pageY,o=a.clientX,c=a.clientY;this.emit("dropFromOutside",{x:n,y:i,clientX:o,clientY:c}),s.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(s){var a=Wr(s),n=a.pageX,i=a.pageY,o=a.clientX,c=a.clientY;this.emit("dragOverFromOutside",{x:n,y:i,clientX:o,clientY:c}),s.preventDefault()}},{key:"_handleInitialEvent",value:function(s){if(this._initialEvent=s,!this.isDetached){var a=Wr(s),n=a.clientX,i=a.clientY,o=a.pageX,c=a.pageY,l=this.container(),d,m;if(!(s.which===3||s.button===2||!Zk(l,n,i))){if(!this.globalMouse&&l&&!os(l,s.target)){var g=s5(0),h=g.top,x=g.left,v=g.bottom,u=g.right;if(m=fr(l),d=Ul({top:m.top-h,left:m.left-x,bottom:m.bottom+v,right:m.right+u},{top:c,left:o}),!d)return}var f=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(s.type),x:o,y:c,clientX:n,clientY:i});if(f!==!1)switch(s.type){case"mousedown":this._removeEndListener=et("mouseup",this._handleTerminatingEvent),this._onEscListener=et("keydown",this._handleTerminatingEvent),this._removeMoveListener=et("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(s),this._removeEndListener=et("touchend",this._handleTerminatingEvent),this._removeMoveListener=et("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(s){var a=s.target,n=this.validContainers;return!n||!n.length||!a?!0:n.some(function(i){return!!a.closest(i)})}},{key:"_handleTerminatingEvent",value:function(s){var a=this.selecting,n=this._selectRect;if(!a&&s.type.includes("key")&&(s=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!s){var i=!this.container||os(this.container(),s.target),o=this._isWithinValidContainer(s);return s.key==="Escape"||!o?this.emit("reset"):!a&&i?this._handleClickEvent(s):a?this.emit("select",n):this.emit("reset")}}},{key:"_handleClickEvent",value:function(s){var a=Wr(s),n=a.pageX,i=a.pageY,o=a.clientX,c=a.clientY,l=new Date().getTime();return this._lastClickData&&l-this._lastClickData.timestamp<r5?(this._lastClickData=null,this.emit("doubleClick",{x:n,y:i,clientX:o,clientY:c})):(this._lastClickData={timestamp:l},this.emit("click",{x:n,y:i,clientX:o,clientY:c}))}},{key:"_handleMoveEvent",value:function(s){if(!(this._initialEventData===null||this.isDetached)){var a=this._initialEventData,n=a.x,i=a.y,o=Wr(s),c=o.pageX,l=o.pageY,d=Math.abs(n-c),m=Math.abs(i-l),g=Math.min(c,n),h=Math.min(l,i),x=this.selecting,v=this.isClick(c,l);v&&!x&&!(d||m)||(!x&&!v&&this.emit("selectStart",this._initialEventData),v||(this.selecting=!0,this._selectRect={top:h,left:g,x:c,y:l,right:g+d,bottom:h+m},this.emit("selecting",this._selectRect)),s.preventDefault())}}},{key:"_keyListener",value:function(s){this.ctrl=s.metaKey||s.ctrlKey}},{key:"isClick",value:function(s,a){var n=this._initialEventData,i=n.x,o=n.y,c=n.isTouch;return!c&&Math.abs(s-i)<=Fl&&Math.abs(a-o)<=Fl}}])}();function s5(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return Wt(t)!=="object"&&(t={top:t,left:t,right:t,bottom:t}),t}function Ul(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=fr(t),n=a.top,i=a.left,o=a.right,c=o===void 0?i:o,l=a.bottom,d=l===void 0?n:l,m=fr(r),g=m.top,h=m.left,x=m.right,v=x===void 0?h:x,u=m.bottom,f=u===void 0?g:u;return!(d-s<g||n+s>f||c-s<h||i+s>v)}function fr(t){if(!t.getBoundingClientRect)return t;var r=t.getBoundingClientRect(),s=r.left+Wl("left"),a=r.top+Wl("top");return{top:a,left:s,right:(t.offsetWidth||0)+s,bottom:(t.offsetHeight||0)+a}}function Wl(t){if(t==="left")return window.pageXOffset||document.body.scrollLeft||0;if(t==="top")return window.pageYOffset||document.body.scrollTop||0}var a5=function(t){function r(s,a){var n;return He(this,r),n=rt(this,r,[s,a]),n.state={selecting:!1},n.containerRef=S.createRef(),n}return st(r,t),ze(r,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(a){!a.selectable&&this.props.selectable&&this._selectable(),a.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var a=this.props,n=a.range,i=a.getNow,o=a.getters,c=a.date,l=a.components.dateCellWrapper,d=a.localizer,m=this.state,g=m.selecting,h=m.startIdx,x=m.endIdx,v=i();return I.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},n.map(function(u,f){var N=g&&f>=h&&f<=x,w=o.dayProp(u),k=w.className,p=w.style;return I.createElement(l,{key:f,value:u,range:n},I.createElement("div",{style:p,className:Fe("rbc-day-bg",k,N&&"rbc-selected-cell",d.isSameDate(u,v)&&"rbc-today",c&&d.neq(c,u,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var a=this,n=this.containerRef.current,i=this._selector=new Ic(this.props.container,{longPressThreshold:this.props.longPressThreshold}),o=function(l,d){if(!Xs(n,l)&&!t5(n,l)){var m=fr(n),g=a.props,h=g.range,x=g.rtl;if(Yk(m,l)){var v=Ac(m,l.x,x,h.length);a._selectSlot({startIdx:v,endIdx:v,action:d,box:l})}}a._initial={},a.setState({selecting:!1})};i.on("selecting",function(c){var l=a.props,d=l.range,m=l.rtl,g=-1,h=-1;if(a.state.selecting||(Pe(a.props.onSelectStart,[c]),a._initial={x:c.x,y:c.y}),i.isSelected(n)){var x=fr(n),v=Vk(a._initial,x,c,d.length,m);g=v.startIdx,h=v.endIdx}a.setState({selecting:!0,startIdx:g,endIdx:h})}),i.on("beforeSelect",function(c){if(a.props.selectable==="ignoreEvents")return!Xs(a.containerRef.current,c)}),i.on("click",function(c){return o(c,"click")}),i.on("doubleClick",function(c){return o(c,"doubleClick")}),i.on("select",function(c){a._selectSlot(Oe(Oe({},a.state),{},{action:"select",bounds:c})),a._initial={},a.setState({selecting:!1}),Pe(a.props.onSelectEnd,[a.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(a){var n=a.endIdx,i=a.startIdx,o=a.action,c=a.bounds,l=a.box;n!==-1&&i!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:i,end:n,action:o,bounds:c,box:l,resourceId:this.props.resourceId})}}])}(I.Component),vt={propTypes:{slotMetrics:se.object.isRequired,selected:se.object,isAllDay:se.bool,accessors:se.object.isRequired,localizer:se.object.isRequired,components:se.object.isRequired,getters:se.object.isRequired,onSelect:se.func,onDoubleClick:se.func,onKeyPress:se.func},defaultProps:{segments:[],selected:{}},renderEvent:function(r,s){var a=r.selected;r.isAllDay;var n=r.accessors,i=r.getters,o=r.onSelect,c=r.onDoubleClick,l=r.onKeyPress,d=r.localizer,m=r.slotMetrics,g=r.components,h=r.resizable,x=m.continuesPrior(s),v=m.continuesAfter(s);return I.createElement(Pc,{event:s,getters:i,localizer:d,accessors:n,components:g,onSelect:o,onDoubleClick:c,onKeyPress:l,continuesPrior:x,continuesAfter:v,slotStart:m.first,slotEnd:m.last,selected:ya(s,a),resizable:h})},renderSpan:function(r,s,a){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(s)/r*100+"%";return I.createElement("div",{key:a,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},n)}},Lc=function(t){function r(){return He(this,r),rt(this,r,arguments)}return st(r,t),ze(r,[{key:"render",value:function(){var a=this,n=this.props,i=n.segments,o=n.slotMetrics.slots,c=n.className,l=1;return I.createElement("div",{className:Fe(c,"rbc-row")},i.reduce(function(d,m,g){var h=m.event,x=m.left,v=m.right,u=m.span,f="_lvl_"+g,N=x-l,w=vt.renderEvent(a.props,h);return N&&d.push(vt.renderSpan(o,N,"".concat(f,"_gap"))),d.push(vt.renderSpan(o,u,f,w)),l=v+1,d},[]))}}])}(I.Component);Lc.defaultProps=Oe({},vt.defaultProps);function Fc(t){var r=t.dateRange,s=t.unit,a=s===void 0?"day":s,n=t.localizer;return{first:r[0],last:n.add(r[r.length-1],1,a)}}function n5(t,r,s,a){var n=Fc({dateRange:r,localizer:a}),i=n.first,o=n.last,c=a.diff(i,o,"day"),l=a.max(a.startOf(s.start(t),"day"),i),d=a.min(a.ceil(s.end(t),"day"),o),m=cj(r,function(h){return a.isSameDate(h,l)}),g=a.diff(l,d,"day");return g=Math.min(g,c),g=Math.max(g-a.segmentOffset,1),{event:t,span:g,left:m+1,right:Math.max(m+g,1)}}function sn(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,s,a,n,i=[],o=[];for(s=0;s<t.length;s++){for(n=t[s],a=0;a<i.length&&i5(n,i[a]);a++);a>=r?o.push(n):(i[a]||(i[a]=[])).push(n)}for(s=0;s<i.length;s++)i[s].sort(function(c,l){return c.left-l.left});return{levels:i,extra:o}}function us(t,r,s,a,n){var i={start:a.start(t),end:a.end(t)},o={start:r,end:s};return n.inEventRange({event:i,range:o})}function i5(t,r){return r.some(function(s){return s.left<=t.right&&s.right>=t.left})}function l5(t,r,s){var a=Rs(t),n=[],i=[];a.forEach(function(l){var d=r.start(l),m=r.end(l);s.daySpan(d,m)>1?n.push(l):i.push(l)});var o=n.sort(function(l,d){return an(l,d,r,s)}),c=i.sort(function(l,d){return an(l,d,r,s)});return[].concat(Rs(o),Rs(c))}function an(t,r,s,a){var n={start:s.start(t),end:s.end(t),allDay:s.allDay(t)},i={start:s.start(r),end:s.end(r),allDay:s.allDay(r)};return a.sortEvents({evtA:n,evtB:i})}var nn=function(r,s){return r.left<=s&&r.right>=s},Ia=function(r,s){return r.filter(function(a){return nn(a,s)}).map(function(a){return a.event})},Uc=function(t){function r(){return He(this,r),rt(this,r,arguments)}return st(r,t),ze(r,[{key:"render",value:function(){for(var a=this.props,n=a.segments,i=a.slotMetrics.slots,o=sn(n).levels[0],c=1,l=1,d=[];c<=i;){var m="_lvl_"+c,g=o.filter(function(p){return nn(p,c)})[0]||{},h=g.event,x=g.left,v=g.right,u=g.span;if(!h){var f=this.getHiddenEventsForSlot(n,c);if(f.length>0){var N=c-l;N&&d.push(vt.renderSpan(i,N,m+"_gap")),d.push(vt.renderSpan(i,1,m,this.renderShowMore(n,c))),l=c=c+1;continue}c++;continue}var w=Math.max(0,x-l);if(this.canRenderSlotEvent(x,u)){var k=vt.renderEvent(this.props,h);w&&d.push(vt.renderSpan(i,w,m+"_gap")),d.push(vt.renderSpan(i,u,m,k)),l=c=v+1}else w&&d.push(vt.renderSpan(i,w,m+"_gap")),d.push(vt.renderSpan(i,1,m,this.renderShowMore(n,c))),l=c=c+1}return I.createElement("div",{className:"rbc-row"},d)}},{key:"getHiddenEventsForSlot",value:function(a,n){var i=Ia(a,n),o=sn(a).levels[0],c=o.filter(function(l){return nn(l,n)}).map(function(l){return l.event});return i.filter(function(l){return!c.some(function(d){return d===l})})}},{key:"canRenderSlotEvent",value:function(a,n){var i=this.props.segments;return jj(a,a+n).every(function(o){var c=Ia(i,o).length;return c===1})}},{key:"renderShowMore",value:function(a,n){var i=this,o=this.props,c=o.localizer,l=o.slotMetrics,d=o.components,m=l.getEventsForSlot(n),g=Ia(a,n),h=g.length;if(d!=null&&d.showMore){var x=d.showMore,v=l.getDateForSlot(n-1);return h?I.createElement(x,{localizer:c,slotDate:v,slot:n,count:h,events:m,remainingEvents:g}):!1}return h?I.createElement("button",{type:"button",key:"sm_"+n,className:Fe("rbc-button-link","rbc-show-more"),onClick:function(f){return i.showMore(n,f)}},c.messages.showMore(h,g,m)):!1}},{key:"showMore",value:function(a,n){n.preventDefault(),n.stopPropagation(),this.props.onShowMore(a,n.target)}}])}(I.Component);Uc.defaultProps=Oe({},vt.defaultProps);var o5=function(r){var s=r.children;return I.createElement("div",{className:"rbc-row-content-scroll-container"},s)},c5=function(r,s){return r.left<=s&&r.right>=s},d5=function(r,s){return r[0].range===s[0].range&&r[0].events===s[0].events};function Wc(){return hc(function(t){for(var r=t.range,s=t.events,a=t.maxRows,n=t.minRows,i=t.accessors,o=t.localizer,c=Fc({dateRange:r,localizer:o}),l=c.first,d=c.last,m=s.map(function(u){return n5(u,r,i,o)}),g=sn(m,Math.max(a-1,1)),h=g.levels,x=g.extra,v=x.length>0?n-1:n;h.length<v;)h.push([]);return{first:l,last:d,levels:h,extra:x,range:r,slots:r.length,clone:function(f){var N=Wc();return N(Oe(Oe({},t),f))},getDateForSlot:function(f){return r[f]},getSlotForDate:function(f){return r.find(function(N){return o.isSameDate(N,f)})},getEventsForSlot:function(f){return m.filter(function(N){return c5(N,f)}).map(function(N){return N.event})},continuesPrior:function(f){return o.continuesPrior(i.start(f),l)},continuesAfter:function(f){var N=i.start(f),w=i.end(f);return o.continuesAfter(N,w,d)}}},d5)}var ms=function(t){function r(){var s;He(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=rt(this,r,[].concat(n)),s.handleSelectSlot=function(o){var c=s.props,l=c.range,d=c.onSelectSlot;d(l.slice(o.start,o.end+1),o)},s.handleShowMore=function(o,c){var l=s.props,d=l.range,m=l.onShowMore,g=s.slotMetrics(s.props),h=oh(s.containerRef.current,".rbc-row-bg")[0],x;h&&(x=h.children[o-1]);var v=g.getEventsForSlot(o);m(v,d[o-1],x,o,c)},s.getContainer=function(){var o=s.props.container;return o?o():s.containerRef.current},s.renderHeadingCell=function(o,c){var l=s.props,d=l.renderHeader,m=l.getNow,g=l.localizer;return d({date:o,key:"header_".concat(c),className:Fe("rbc-date-cell",g.isSameDate(o,m())&&"rbc-now")})},s.renderDummy=function(){var o=s.props,c=o.className,l=o.range,d=o.renderHeader,m=o.showAllEvents;return I.createElement("div",{className:c,ref:s.containerRef},I.createElement("div",{className:Fe("rbc-row-content",m&&"rbc-row-content-scrollable")},d&&I.createElement("div",{className:"rbc-row",ref:s.headingRowRef},l.map(s.renderHeadingCell)),I.createElement("div",{className:"rbc-row",ref:s.eventRowRef},I.createElement("div",{className:"rbc-row-segment"},I.createElement("div",{className:"rbc-event"},I.createElement("div",{className:"rbc-event-content"}," "))))))},s.containerRef=S.createRef(),s.headingRowRef=S.createRef(),s.eventRowRef=S.createRef(),s.slotMetrics=Wc(),s}return st(r,t),ze(r,[{key:"getRowLimit",value:function(){var a,n=_a(this.eventRowRef.current),i=(a=this.headingRowRef)!==null&&a!==void 0&&a.current?_a(this.headingRowRef.current):0,o=_a(this.containerRef.current)-i;return Math.max(Math.floor(o/n),1)}},{key:"render",value:function(){var a=this.props,n=a.date,i=a.rtl,o=a.range,c=a.className,l=a.selected,d=a.selectable,m=a.renderForMeasure,g=a.accessors,h=a.getters,x=a.components,v=a.getNow,u=a.renderHeader,f=a.onSelect,N=a.localizer,w=a.onSelectStart,k=a.onSelectEnd,p=a.onDoubleClick,C=a.onKeyPress,T=a.resourceId,M=a.longPressThreshold,j=a.isAllDay,O=a.resizable,B=a.showAllEvents;if(m)return this.renderDummy();var F=this.slotMetrics(this.props),K=F.levels,G=F.extra,ae=B?o5:$t,H=x.weekWrapper,Y={selected:l,accessors:g,getters:h,localizer:N,components:x,onSelect:f,onDoubleClick:p,onKeyPress:C,resourceId:T,slotMetrics:F,resizable:O};return I.createElement("div",{className:c,role:"rowgroup",ref:this.containerRef},I.createElement(a5,{localizer:N,date:n,getNow:v,rtl:i,range:o,selectable:d,container:this.getContainer,getters:h,onSelectStart:w,onSelectEnd:k,onSelectSlot:this.handleSelectSlot,components:x,longPressThreshold:M,resourceId:T}),I.createElement("div",{className:Fe("rbc-row-content",B&&"rbc-row-content-scrollable"),role:"row"},u&&I.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},o.map(this.renderHeadingCell)),I.createElement(ae,null,I.createElement(H,Object.assign({isAllDay:j},Y,{rtl:this.props.rtl}),K.map(function(U,Z){return I.createElement(Lc,Object.assign({key:Z,segments:U},Y))}),!!G.length&&I.createElement(Uc,Object.assign({segments:G,onShowMore:this.handleShowMore},Y))))))}}])}(I.Component);ms.defaultProps={minRows:0,maxRows:1/0};var Zn=function(r){var s=r.label;return I.createElement("span",{role:"columnheader","aria-sort":"none"},s)},u5=function(r){var s=r.label,a=r.drilldownView,n=r.onDrillDown;return a?I.createElement("button",{type:"button",className:"rbc-button-link",onClick:n},s):I.createElement("span",null,s)},m5=["date","className"],h5=function(r,s,a,n,i){return r.filter(function(o){return us(o,s,a,n,i)})},ja=function(t){function r(){var s;He(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=rt(this,r,[].concat(n)),s.getContainer=function(){return s.containerRef.current},s.renderWeek=function(o,c){var l=s.props,d=l.events,m=l.components,g=l.selectable,h=l.getNow,x=l.selected,v=l.date,u=l.localizer,f=l.longPressThreshold,N=l.accessors,w=l.getters,k=l.showAllEvents,p=s.state,C=p.needLimitMeasure,T=p.rowLimit,M=h5(Rs(d),o[0],o[o.length-1],N,u),j=l5(M,N,u);return I.createElement(ms,{key:c,ref:c===0?s.slotRowRef:void 0,container:s.getContainer,className:"rbc-month-row",getNow:h,date:v,range:o,events:j,maxRows:k?1/0:T,selected:x,selectable:g,components:m,accessors:N,getters:w,localizer:u,renderHeader:s.readerDateHeading,renderForMeasure:C,onShowMore:s.handleShowMore,onSelect:s.handleSelectEvent,onDoubleClick:s.handleDoubleClickEvent,onKeyPress:s.handleKeyPressEvent,onSelectSlot:s.handleSelectSlot,longPressThreshold:f,rtl:s.props.rtl,resizable:s.props.resizable,showAllEvents:k})},s.readerDateHeading=function(o){var c=o.date,l=o.className,d=_t(o,m5),m=s.props,g=m.date,h=m.getDrilldownView,x=m.localizer,v=x.neq(g,c,"month"),u=x.isSameDate(c,g),f=h(c),N=x.format(c,"dateFormat"),w=s.props.components.dateHeader||u5;return I.createElement("div",Object.assign({},d,{className:Fe(l,v&&"rbc-off-range",u&&"rbc-current"),role:"cell"}),I.createElement(w,{label:N,date:c,drilldownView:f,isOffRange:v,onDrillDown:function(p){return s.handleHeadingClick(c,f,p)}}))},s.handleSelectSlot=function(o,c){s._pendingSelection=s._pendingSelection.concat(o),clearTimeout(s._selectTimer),s._selectTimer=setTimeout(function(){return s.selectDates(c)})},s.handleHeadingClick=function(o,c,l){l.preventDefault(),s.clearSelection(),Pe(s.props.onDrillDown,[o,c])},s.handleSelectEvent=function(){s.clearSelection();for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];Pe(s.props.onSelectEvent,c)},s.handleDoubleClickEvent=function(){s.clearSelection();for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];Pe(s.props.onDoubleClickEvent,c)},s.handleKeyPressEvent=function(){s.clearSelection();for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];Pe(s.props.onKeyPressEvent,c)},s.handleShowMore=function(o,c,l,d,m){var g=s.props,h=g.popup,x=g.onDrillDown,v=g.onShowMore,u=g.getDrilldownView,f=g.doShowMoreDrillDown;if(s.clearSelection(),h){var N=Wo(l,s.containerRef.current);s.setState({overlay:{date:c,events:o,position:N,target:m}})}else f&&Pe(x,[c,u(c)||it.DAY]);Pe(v,[o,c,d])},s.overlayDisplay=function(){s.setState({overlay:null})},s.state={rowLimit:5,needLimitMeasure:!0,date:null},s.containerRef=S.createRef(),s.slotRowRef=S.createRef(),s._bgRows=[],s._pendingSelection=[],s}return st(r,t),ze(r,[{key:"componentDidMount",value:function(){var a=this,n;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){n||Bo(function(){n=!1,a.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.className,c=i.visibleDays(n,i),l=qm(c,7);return this._weekCount=l.length,I.createElement("div",{className:Fe("rbc-month-view",o),role:"table","aria-label":"Month View",ref:this.containerRef},I.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(l[0])),l.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(a){var n=this.props,i=n.localizer,o=n.components,c=a[0],l=a[a.length-1],d=o.header||Zn;return i.range(c,l,"day").map(function(m,g){return I.createElement("div",{key:"header_"+g,className:"rbc-header"},I.createElement(d,{date:m,localizer:i,label:i.format(m,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var a,n,i=this,o=(a=(n=this.state)===null||n===void 0?void 0:n.overlay)!==null&&a!==void 0?a:{},c=this.props,l=c.accessors,d=c.localizer,m=c.components,g=c.getters,h=c.selected,x=c.popupOffset,v=c.handleDragStart,u=function(){return i.setState({overlay:null})};return I.createElement(Xn,{overlay:o,accessors:l,localizer:d,components:m,getters:g,selected:h,popupOffset:x,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:u})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(a){var n=this._pendingSelection.slice();this._pendingSelection=[],n.sort(function(c,l){return+c-+l});var i=new Date(n[0]),o=new Date(n[n.length-1]);o.setDate(n[n.length-1].getDate()+1),Pe(this.props.onSelectSlot,{slots:n,start:i,end:o,action:a.action,bounds:a.bounds,box:a.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(a,n){var i=a.date,o=a.localizer;return{date:i,needLimitMeasure:o.neq(i,n.date,"month")}}}])}(I.Component);ja.range=function(t,r){var s=r.localizer,a=s.firstVisibleDay(t,s),n=s.lastVisibleDay(t,s);return{start:a,end:n}};ja.navigate=function(t,r,s){var a=s.localizer;switch(r){case dt.PREVIOUS:return a.add(t,-1,"month");case dt.NEXT:return a.add(t,1,"month");default:return t}};ja.title=function(t,r){var s=r.localizer;return s.format(t,"monthHeaderFormat")};var Bl=function(r){var s=r.min,a=r.max,n=r.step,i=r.slots,o=r.localizer;return"".concat(+o.startOf(s,"minutes"))+"".concat(+o.startOf(a,"minutes"))+"".concat(n,"-").concat(i)};function Qn(t){for(var r=t.min,s=t.max,a=t.step,n=t.timeslots,i=t.localizer,o=Bl({step:a,localizer:i}),c=1+i.getTotalMin(r,s),l=i.getMinutesFromMidnight(r),d=Math.ceil((c-1)/(a*n)),m=d*n,g=new Array(d),h=new Array(m),x=0;x<d;x++){g[x]=new Array(n);for(var v=0;v<n;v++){var u=x*n+v,f=u*a;h[u]=g[x][v]=i.getSlotDate(r,l,f)}}var N=h.length*a;h.push(i.getSlotDate(r,l,N));function w(k){var p=i.diff(r,k,"minutes")+i.getDstOffset(r,k);return Math.min(p,c)}return{groups:g,update:function(p){return Bl(p)!==o?Qn(p):this},dateIsInGroup:function(p,C){var T=g[C+1];return i.inRange(p,g[C][0],T?T[0]:s,"minutes")},nextSlot:function(p){var C=h[Math.min(h.findIndex(function(T){return T===p||i.eq(T,p)})+1,h.length-1)];return i.eq(C,p)&&(C=i.add(p,a,"minutes")),C},closestSlotToPosition:function(p){var C=Math.min(h.length-1,Math.max(0,Math.floor(p*m)));return h[C]},closestSlotFromPoint:function(p,C){var T=Math.abs(C.top-C.bottom);return this.closestSlotToPosition((p.y-C.top)/T)},closestSlotFromDate:function(p){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(i.lt(p,r,"minutes"))return h[0];if(i.gt(p,s,"minutes"))return h[h.length-1];var T=i.diff(r,p,"minutes");return h[(T-T%a)/a+C]},startsBeforeDay:function(p){return i.lt(p,r,"day")},startsAfterDay:function(p){return i.gt(p,s,"day")},startsBefore:function(p){return i.lt(i.merge(r,p),r,"minutes")},startsAfter:function(p){return i.gt(i.merge(s,p),s,"minutes")},getRange:function(p,C,T,M){T||(p=i.min(s,i.max(r,p))),M||(C=i.min(s,i.max(r,C)));var j=w(p),O=w(C),B=O>a*m&&!i.eq(s,C)?(j-a)/(a*m)*100:j/(a*m)*100;return{top:B,height:O/(a*m)*100-B,start:w(p),startDate:p,end:w(C),endDate:C}},getCurrentTimePosition:function(p){var C=w(p),T=C/(a*m)*100;return T}}}var f5=function(){function t(r,s){var a=s.accessors,n=s.slotMetrics;He(this,t);var i=n.getRange(a.start(r),a.end(r)),o=i.start,c=i.startDate,l=i.end,d=i.endDate,m=i.top,g=i.height;this.start=o,this.end=l,this.startMs=+c,this.endMs=+d,this.top=m,this.height=g,this.data=r}return ze(t,[{key:"_width",get:function(){if(this.rows){var s=this.rows.reduce(function(n,i){return Math.max(n,i.leaves.length+1)},0)+1;return 100/s}if(this.leaves){var a=100-this.container._width;return a/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var s=this._width,a=Math.min(100,this._width*1.7);if(this.rows)return a;if(this.leaves)return this.leaves.length>0?a:s;var n=this.row.leaves,i=n.indexOf(this);return i===n.length-1?s:a}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var s=this.row,a=s.leaves,n=s.xOffset,i=s._width,o=a.indexOf(this)+1;return n+o*i}}])}();function x5(t,r,s){return Math.abs(r.start-t.start)<s||r.start>t.start&&r.start<t.end}function g5(t){for(var r=Ww(t,["startMs",function(c){return-c.endMs}]),s=[];r.length>0;){var a=r.shift();s.push(a);for(var n=0;n<r.length;n++){var i=r[n];if(!(a.endMs>i.startMs)){if(n>0){var o=r.splice(n,1)[0];s.push(o)}break}}}return s}function Bc(t){for(var r=t.events,s=t.minimumStartDifference,a=t.slotMetrics,n=t.accessors,i=r.map(function(m){return new f5(m,{slotMetrics:a,accessors:n})}),o=g5(i),c=[],l=function(){var g=o[d],h=c.find(function(u){return u.end>g.start||Math.abs(g.start-u.start)<s});if(!h)return g.rows=[],c.push(g),1;g.container=h;for(var x=null,v=h.rows.length-1;!x&&v>=0;v--)x5(h.rows[v],g,s)&&(x=h.rows[v]);x?(x.leaves.push(g),g.row=x):(g.leaves=[],h.rows.push(g))},d=0;d<o.length;d++)l();return o.map(function(m){return{event:m.data,style:{top:m.top,height:m.height,width:m.width,xOffset:Math.max(0,m.xOffset)}}})}function Hc(t,r,s){for(var a=0;a<t.friends.length;++a)if(!(s.indexOf(t.friends[a])>-1)){r=r>t.friends[a].idx?r:t.friends[a].idx,s.push(t.friends[a]);var n=Hc(t.friends[a],r,s);r=r>n?r:n}return r}function p5(t){var r=t.events,s=t.minimumStartDifference,a=t.slotMetrics,n=t.accessors,i=Bc({events:r,minimumStartDifference:s,slotMetrics:a,accessors:n});i.sort(function(H,Y){return H=H.style,Y=Y.style,H.top!==Y.top?H.top>Y.top?1:-1:H.height!==Y.height?H.top+H.height<Y.top+Y.height?1:-1:0});for(var o=0;o<i.length;++o)i[o].friends=[],delete i[o].style.left,delete i[o].style.left,delete i[o].idx,delete i[o].size;for(var c=0;c<i.length-1;++c)for(var l=i[c],d=l.style.top,m=l.style.top+l.style.height,g=c+1;g<i.length;++g){var h=i[g],x=h.style.top,v=h.style.top+h.style.height;(x>=d&&v<=m||v>d&&v<=m||x>=d&&x<m)&&(l.friends.push(h),h.friends.push(l))}for(var u=0;u<i.length;++u){for(var f=i[u],N=[],w=0;w<100;++w)N.push(1);for(var k=0;k<f.friends.length;++k)f.friends[k].idx!==void 0&&(N[f.friends[k].idx]=0);f.idx=N.indexOf(1)}for(var p=0;p<i.length;++p){var C=0;if(!i[p].size){var T=[],M=Hc(i[p],0,T);C=100/(M+1),i[p].size=C;for(var j=0;j<T.length;++j)T[j].size=C}}for(var O=0;O<i.length;++O){var B=i[O];B.style.left=B.idx*B.size;for(var F=0,K=0;K<B.friends.length;++K){var G=B.friends[K].idx;F=F>G?F:G}F<=B.idx&&(B.size=100-B.idx*B.size);var ae=B.idx===0?0:3;B.style.width="calc(".concat(B.size,"% - ").concat(ae,"px)"),B.style.height="calc(".concat(B.style.height,"% - 2px)"),B.style.xOffset="calc(".concat(B.style.left,"% + ").concat(ae,"px)")}return i}var Hl={overlap:Bc,"no-overlap":p5};function v5(t){return!!(t&&t.constructor&&t.call&&t.apply)}function b5(t){t.events,t.minimumStartDifference,t.slotMetrics,t.accessors;var r=t.dayLayoutAlgorithm,s=r;return r in Hl&&(s=Hl[r]),v5(s)?s.apply(this,arguments):[]}var zc=function(t){function r(){return He(this,r),rt(this,r,arguments)}return st(r,t),ze(r,[{key:"render",value:function(){var a=this.props,n=a.renderSlot,i=a.resource,o=a.group,c=a.getters,l=a.components,d=l===void 0?{}:l,m=d.timeSlotWrapper,g=m===void 0?$t:m,h=c?c.slotGroupProp(o):{};return I.createElement("div",Object.assign({className:"rbc-timeslot-group"},h),o.map(function(x,v){var u=c?c.slotProp(x,i):{};return I.createElement(g,{key:v,value:x,resource:i},I.createElement("div",Object.assign({},u,{className:Fe("rbc-time-slot",u.className)}),n&&n(x,v)))}))}}])}(S.Component);function Ps(t){return typeof t=="string"?t:t+"%"}function y5(t){var r=t.style,s=t.className,a=t.event,n=t.accessors,i=t.rtl,o=t.selected,c=t.label,l=t.continuesPrior,d=t.continuesAfter,m=t.getters,g=t.onClick,h=t.onDoubleClick,x=t.isBackgroundEvent,v=t.onKeyPress,u=t.components,f=u.event,N=u.eventWrapper,w=n.title(a),k=n.tooltip(a),p=n.end(a),C=n.start(a),T=m.eventProp(a,C,p,o),M=[I.createElement("div",{key:"1",className:"rbc-event-label"},c),I.createElement("div",{key:"2",className:"rbc-event-content"},f?I.createElement(f,{event:a,title:w}):w)],j=r.height,O=r.top,B=r.width,F=r.xOffset,K=Oe(Oe({},T.style),{},sr({top:Ps(O),height:Ps(j),width:Ps(B)},i?"right":"left",Ps(F)));return I.createElement(N,Object.assign({type:"time"},t),I.createElement("div",{role:"button",tabIndex:0,onClick:g,onDoubleClick:h,style:K,onKeyDown:v,title:k?(typeof c=="string"?c+": ":"")+k:void 0,className:Fe(x?"rbc-background-event":"rbc-event",s,T.className,{"rbc-selected":o,"rbc-event-continues-earlier":l,"rbc-event-continues-later":d})},M))}var j5=function(r){var s=r.children,a=r.className,n=r.style,i=r.innerRef;return I.createElement("div",{className:a,style:n,ref:i},s)},w5=I.forwardRef(function(t,r){return I.createElement(j5,Object.assign({},t,{innerRef:r}))}),N5=["dayProp"],S5=["eventContainerWrapper","timeIndicatorWrapper"],Gc=function(t){function r(){var s;He(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=rt(this,r,[].concat(n)),s.state={selecting:!1,timeIndicatorPosition:null},s.intervalTriggered=!1,s.renderEvents=function(o){var c=o.events,l=o.isBackgroundEvent,d=s.props,m=d.rtl,g=d.selected,h=d.accessors,x=d.localizer,v=d.getters,u=d.components,f=d.step,N=d.timeslots,w=d.dayLayoutAlgorithm,k=d.resizable,p=s,C=p.slotMetrics,T=x.messages,M=b5({events:c,accessors:h,slotMetrics:C,minimumStartDifference:Math.ceil(f*N/2),dayLayoutAlgorithm:w});return M.map(function(j,O){var B,F=j.event,K=j.style,G=h.end(F),ae=h.start(F),H=(B=h.eventId(F))!==null&&B!==void 0?B:"evt_"+O,Y="eventTimeRangeFormat",U,Z=C.startsBeforeDay(ae),re=C.startsAfterDay(G);Z?Y="eventTimeRangeEndFormat":re&&(Y="eventTimeRangeStartFormat"),Z&&re?U=T.allDay:U=x.format({start:ae,end:G},Y);var W=Z||C.startsBefore(ae),de=re||C.startsAfter(G);return I.createElement(y5,{style:K,event:F,label:U,key:H,getters:v,rtl:m,components:u,continuesPrior:W,continuesAfter:de,accessors:h,resource:s.props.resource,selected:ya(F,g),onClick:function(me){return s._select(Oe(Oe(Oe({},F),s.props.resource&&{sourceResource:s.props.resource}),l&&{isBackgroundEvent:!0}),me)},onDoubleClick:function(me){return s._doubleClick(F,me)},isBackgroundEvent:l,onKeyPress:function(me){return s._keyPress(F,me)},resizable:k})})},s._selectable=function(){var o=s.containerRef.current,c=s.props,l=c.longPressThreshold,d=c.localizer,m=s._selector=new Ic(function(){return o},{longPressThreshold:l}),g=function(u){var f=s.props.onSelecting,N=s.state||{},w=h(u),k=w.startDate,p=w.endDate;f&&(d.eq(N.startDate,k,"minutes")&&d.eq(N.endDate,p,"minutes")||f({start:k,end:p,resourceId:s.props.resource})===!1)||(s.state.start!==w.start||s.state.end!==w.end||s.state.selecting!==w.selecting)&&s.setState(w)},h=function(u){var f=s.slotMetrics.closestSlotFromPoint(u,fr(o));s.state.selecting||(s._initialSlot=f);var N=s._initialSlot;d.lte(N,f)?f=s.slotMetrics.nextSlot(f):d.gt(N,f)&&(N=s.slotMetrics.nextSlot(N));var w=s.slotMetrics.getRange(d.min(N,f),d.max(N,f));return Oe(Oe({},w),{},{selecting:!0,top:"".concat(w.top,"%"),height:"".concat(w.height,"%")})},x=function(u,f){if(!Xs(s.containerRef.current,u)){var N=h(u),w=N.startDate,k=N.endDate;s._selectSlot({startDate:w,endDate:k,action:f,box:u})}s.setState({selecting:!1})};m.on("selecting",g),m.on("selectStart",g),m.on("beforeSelect",function(v){if(s.props.selectable==="ignoreEvents")return!Xs(s.containerRef.current,v)}),m.on("click",function(v){return x(v,"click")}),m.on("doubleClick",function(v){return x(v,"doubleClick")}),m.on("select",function(v){s.state.selecting&&(s._selectSlot(Oe(Oe({},s.state),{},{action:"select",bounds:v})),s.setState({selecting:!1}))}),m.on("reset",function(){s.state.selecting&&s.setState({selecting:!1})})},s._teardownSelectable=function(){s._selector&&(s._selector.teardown(),s._selector=null)},s._selectSlot=function(o){for(var c=o.startDate,l=o.endDate,d=o.action,m=o.bounds,g=o.box,h=c,x=[];s.props.localizer.lte(h,l);)x.push(h),h=new Date(+h+s.props.step*60*1e3);Pe(s.props.onSelectSlot,{slots:x,start:c,end:l,resourceId:s.props.resource,action:d,bounds:m,box:g})},s._select=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];Pe(s.props.onSelectEvent,c)},s._doubleClick=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];Pe(s.props.onDoubleClickEvent,c)},s._keyPress=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];Pe(s.props.onKeyPressEvent,c)},s.slotMetrics=Qn(s.props),s.containerRef=S.createRef(),s}return st(r,t),ze(r,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(a,n){this.props.selectable&&!a.selectable&&this._selectable(),!this.props.selectable&&a.selectable&&this._teardownSelectable();var i=this.props,o=i.getNow,c=i.isNow,l=i.localizer,d=i.date,m=i.min,g=i.max,h=l.neq(a.getNow(),o(),"minutes");if(a.isNow!==c||h){if(this.clearTimeIndicatorInterval(),c){var x=!h&&l.eq(a.date,d,"minutes")&&n.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(x)}}else c&&(l.neq(a.min,m,"minutes")||l.neq(a.max,g,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var a=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!n&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){a.intervalTriggered=!0,a.positionTimeIndicator(),a.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var a=this.props,n=a.min,i=a.max,o=a.getNow,c=o();if(c>=n&&c<=i){var l=this.slotMetrics.getCurrentTimePosition(c);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:l})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var a=this.props,n=a.date,i=a.max,o=a.rtl,c=a.isNow,l=a.resource,d=a.accessors,m=a.localizer,g=a.getters,h=g.dayProp,x=_t(g,N5),v=a.components,u=v.eventContainerWrapper,f=v.timeIndicatorWrapper,N=_t(v,S5);this.slotMetrics=this.slotMetrics.update(this.props);var w=this.slotMetrics,k=this.state,p=k.selecting,C=k.top,T=k.height,M=k.startDate,j=k.endDate,O={start:M,end:j},B=h(i,l),F=B.className,K=B.style,G={className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}},ae=N.dayColumnWrapper||w5;return I.createElement(ae,{ref:this.containerRef,date:n,style:K,className:Fe(F,"rbc-day-slot","rbc-time-column",c&&"rbc-now",c&&"rbc-today",p&&"rbc-slot-selecting"),slotMetrics:w,resource:l},w.groups.map(function(H,Y){return I.createElement(zc,{key:Y,group:H,resource:l,getters:x,components:N})}),I.createElement(u,{localizer:m,resource:l,accessors:d,getters:x,components:N,slotMetrics:w},I.createElement("div",{className:Fe("rbc-events-container",o&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),p&&I.createElement("div",{className:"rbc-slot-selection",style:{top:C,height:T}},I.createElement("span",null,m.format(O,"selectRangeFormat"))),c&&this.intervalTriggered&&I.createElement(f,G,I.createElement("div",G)))}}])}(I.Component);Gc.defaultProps={dragThroughEvents:!0,timeslots:2};var qc=function(r){var s=r.label;return I.createElement(I.Fragment,null,s)},k5=function(t){function r(){var s;He(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=rt(this,r,[].concat(n)),s.handleHeaderClick=function(o,c,l){l.preventDefault(),Pe(s.props.onDrillDown,[o,c])},s.renderRow=function(o){var c=s.props,l=c.events,d=c.rtl,m=c.selectable,g=c.getNow,h=c.range,x=c.getters,v=c.localizer,u=c.accessors,f=c.components,N=c.resizable,w=u.resourceId(o),k=o?l.filter(function(p){return u.resource(p)===w}):l;return I.createElement(ms,{isAllDay:!0,rtl:d,getNow:g,minRows:2,maxRows:s.props.allDayMaxRows+1,range:h,events:k,resourceId:w,className:"rbc-allday-cell",selectable:m,selected:s.props.selected,components:f,accessors:u,getters:x,localizer:v,onSelect:s.props.onSelectEvent,onShowMore:s.props.onShowMore,onDoubleClick:s.props.onDoubleClickEvent,onKeyPress:s.props.onKeyPressEvent,onSelectSlot:s.props.onSelectSlot,longPressThreshold:s.props.longPressThreshold,resizable:N})},s}return st(r,t),ze(r,[{key:"renderHeaderCells",value:function(a){var n=this,i=this.props,o=i.localizer,c=i.getDrilldownView,l=i.getNow,d=i.getters.dayProp,m=i.components.header,g=m===void 0?Zn:m,h=l();return a.map(function(x,v){var u=c(x),f=o.format(x,"dayFormat"),N=d(x),w=N.className,k=N.style,p=I.createElement(g,{date:x,label:f,localizer:o});return I.createElement("div",{key:v,style:k,className:Fe("rbc-header",w,o.isSameDate(x,h)&&"rbc-today")},u?I.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(T){return n.handleHeaderClick(x,u,T)}},p):I.createElement("span",null,p))})}},{key:"render",value:function(){var a=this,n=this.props,i=n.width,o=n.rtl,c=n.resources,l=n.range,d=n.events,m=n.getNow,g=n.accessors,h=n.selectable,x=n.components,v=n.getters,u=n.scrollRef,f=n.localizer,N=n.isOverflowing,w=n.components,k=w.timeGutterHeader,p=w.resourceHeader,C=p===void 0?qc:p,T=n.resizable,M={};N&&(M[o?"marginLeft":"marginRight"]="".concat(Dn()-1,"px"));var j=c.groupEvents(d);return I.createElement("div",{style:M,ref:u,className:Fe("rbc-time-header",N&&"rbc-overflowing")},I.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:i,minWidth:i,maxWidth:i}},k&&I.createElement(k,null)),c.map(function(O,B){var F=lr(O,2),K=F[0],G=F[1];return I.createElement("div",{className:"rbc-time-header-content",key:K||B},G&&I.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(B)},I.createElement("div",{className:"rbc-header"},I.createElement(C,{index:B,label:g.resourceTitle(G),resource:G}))),I.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(l.length<=1?" rbc-time-header-cell-single-day":"")},a.renderHeaderCells(l)),I.createElement(ms,{isAllDay:!0,rtl:o,getNow:m,minRows:2,maxRows:a.props.allDayMaxRows+1,range:l,events:j.get(K)||[],resourceId:G&&K,className:"rbc-allday-cell",selectable:h,selected:a.props.selected,components:x,accessors:g,getters:v,localizer:f,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:T}))}))}}])}(I.Component),C5=function(t){function r(){var s;He(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=rt(this,r,[].concat(n)),s.handleHeaderClick=function(o,c,l){l.preventDefault(),Pe(s.props.onDrillDown,[o,c])},s}return st(r,t),ze(r,[{key:"renderHeaderCells",value:function(a){var n=this,i=this.props,o=i.localizer,c=i.getDrilldownView,l=i.getNow,d=i.getters.dayProp,m=i.components,g=m.header,h=g===void 0?Zn:g,x=m.resourceHeader,v=x===void 0?qc:x,u=i.resources,f=i.accessors,N=i.events,w=i.rtl,k=i.selectable,p=i.components,C=i.getters,T=i.resizable,M=l(),j=u.groupEvents(N);return a.map(function(O,B){var F=c(O),K=o.format(O,"dayFormat"),G=d(O),ae=G.className,H=G.style,Y=I.createElement(h,{date:O,label:K,localizer:o});return I.createElement("div",{key:B,className:"rbc-time-header-content rbc-resource-grouping"},I.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(a.length<=1?" rbc-time-header-cell-single-day":"")},I.createElement("div",{style:H,className:Fe("rbc-header",ae,o.isSameDate(O,M)&&"rbc-today")},F?I.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(Z){return n.handleHeaderClick(O,F,Z)}},Y):I.createElement("span",null,Y))),I.createElement("div",{className:"rbc-row"},u.map(function(U,Z){var re=lr(U,2),W=re[0],de=re[1];return I.createElement("div",{key:"resource_".concat(W,"_").concat(Z),className:Fe("rbc-header",ae,o.isSameDate(O,M)&&"rbc-today")},I.createElement(v,{index:Z,label:f.resourceTitle(de),resource:de}))})),I.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},u.map(function(U,Z){var re=lr(U,2),W=re[0],de=re[1],xe=(j.get(W)||[]).filter(function(me){return o.isSameDate(me.start,O)||o.isSameDate(me.end,O)});return I.createElement(ms,{key:"resource_".concat(W,"_").concat(Z),isAllDay:!0,rtl:w,getNow:l,minRows:2,maxRows:n.props.allDayMaxRows+1,range:[O],events:xe,resourceId:de&&W,className:"rbc-allday-cell",selectable:k,selected:n.props.selected,components:p,accessors:f,getters:C,localizer:o,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:T})})))})}},{key:"render",value:function(){var a=this.props,n=a.width,i=a.rtl,o=a.range,c=a.scrollRef,l=a.isOverflowing,d=a.components.timeGutterHeader,m={};return l&&(m[i?"marginLeft":"marginRight"]="".concat(Dn()-1,"px")),I.createElement("div",{style:m,ref:c,className:Fe("rbc-time-header",l&&"rbc-overflowing")},I.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:n,minWidth:n,maxWidth:n}},d&&I.createElement(d,null)),this.renderHeaderCells(o))}}])}(I.Component);function E5(t){var r=t.min,s=t.max,a=t.localizer;return a.getTimezoneOffset(r)!==a.getTimezoneOffset(s)?{start:a.add(r,-1,"day"),end:a.add(s,-1,"day")}:{start:r,end:s}}var $5=function(r){var s=r.min,a=r.max,n=r.timeslots,i=r.step,o=r.localizer,c=r.getNow,l=r.resource,d=r.components,m=r.getters,g=r.gutterRef,h=d.timeGutterWrapper,x=S.useMemo(function(){return E5({min:s,max:a,localizer:o})},[s==null?void 0:s.toISOString(),a==null?void 0:a.toISOString(),o]),v=x.start,u=x.end,f=S.useState(Qn({min:v,max:u,timeslots:n,step:i,localizer:o})),N=lr(f,2),w=N[0],k=N[1];S.useEffect(function(){w&&k(w.update({min:v,max:u,timeslots:n,step:i,localizer:o}))},[v==null?void 0:v.toISOString(),u==null?void 0:u.toISOString(),n,i]);var p=S.useCallback(function(C,T){if(T)return null;var M=w.dateIsInGroup(c(),T);return I.createElement("span",{className:Fe("rbc-label",M&&"rbc-now")},o.format(C,"timeGutterFormat"))},[w,o,c]);return I.createElement(h,{slotMetrics:w},I.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:g},w.groups.map(function(C,T){return I.createElement(zc,{key:T,group:C,resource:l,components:d,renderSlot:p,getters:m})})))},T5=I.forwardRef(function(t,r){return I.createElement($5,Object.assign({gutterRef:r},t))}),La={};function O5(t,r){return{map:function(a){return t?t.map(function(n,i){return a([r.resourceId(n),n],i)}):[a([La,null],0)]},groupEvents:function(a){var n=new Map;return t?(a.forEach(function(i){var o=r.resource(i)||La;if(Array.isArray(o))o.forEach(function(l){var d=n.get(l)||[];d.push(i),n.set(l,d)});else{var c=n.get(o)||[];c.push(i),n.set(o,c)}}),n):(n.set(La,a),n)}}}var Lr=function(t){function r(s){var a;return He(this,r),a=rt(this,r,[s]),a.handleScroll=function(n){a.scrollRef.current&&(a.scrollRef.current.scrollLeft=n.target.scrollLeft)},a.handleResize=function(){Ti(a.rafHandle),a.rafHandle=Bo(a.checkOverflow)},a.handleKeyPressEvent=function(){a.clearSelection();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];Pe(a.props.onKeyPressEvent,i)},a.handleSelectEvent=function(){a.clearSelection();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];Pe(a.props.onSelectEvent,i)},a.handleDoubleClickEvent=function(){a.clearSelection();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];Pe(a.props.onDoubleClickEvent,i)},a.handleShowMore=function(n,i,o,c,l){var d=a.props,m=d.popup,g=d.onDrillDown,h=d.onShowMore,x=d.getDrilldownView,v=d.doShowMoreDrillDown;if(a.clearSelection(),m){var u=Wo(o,a.containerRef.current);a.setState({overlay:{date:i,events:n,position:Oe(Oe({},u),{},{width:"200px"}),target:l}})}else v&&Pe(g,[i,x(i)||it.DAY]);Pe(h,[n,i,c])},a.handleSelectAllDaySlot=function(n,i){var o=a.props.onSelectSlot,c=new Date(n[0]),l=new Date(n[n.length-1]);l.setDate(n[n.length-1].getDate()+1),Pe(o,{slots:n,start:c,end:l,action:i.action,resourceId:i.resourceId})},a.overlayDisplay=function(){a.setState({overlay:null})},a.checkOverflow=function(){if(!a._updatingOverflow){var n=a.contentRef.current;if(n!=null&&n.scrollHeight){var i=n.scrollHeight>n.clientHeight;a.state.isOverflowing!==i&&(a._updatingOverflow=!0,a.setState({isOverflowing:i},function(){a._updatingOverflow=!1}))}}},a.memoizedResources=hc(function(n,i){return O5(n,i)}),a.state={gutterWidth:void 0,isOverflowing:null},a.scrollRef=I.createRef(),a.contentRef=I.createRef(),a.containerRef=I.createRef(),a._scrollRatio=null,a.gutterRef=S.createRef(),a}return st(r,t),ze(r,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),Ti(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(a,n,i,o,c,l,d,m,g,h){var x=this.props,v=x.min,u=x.max,f=(o.get(n)||[]).filter(function(w){return l.inRange(a,d.start(w),d.end(w),"day")}),N=(c.get(n)||[]).filter(function(w){return l.inRange(a,d.start(w),d.end(w),"day")});return I.createElement(Gc,Object.assign({},this.props,{localizer:l,min:l.merge(a,v),max:l.merge(a,u),resource:i&&n,components:m,isNow:l.isSameDate(a,h),key:"".concat(n,"-").concat(a),date:a,events:f,backgroundEvents:N,dayLayoutAlgorithm:g}))}},{key:"renderResourcesFirst",value:function(a,n,i,o,c,l,d,m,g){var h=this;return n.map(function(x){var v=lr(x,2),u=v[0],f=v[1];return a.map(function(N){return h.renderDayColumn(N,u,f,i,o,c,l,m,g,d)})})}},{key:"renderRangeFirst",value:function(a,n,i,o,c,l,d,m,g){var h=this;return a.map(function(x){return I.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:x},n.map(function(v){var u=lr(v,2),f=u[0],N=u[1];return I.createElement("div",{style:{flex:1},key:l.resourceId(N)},h.renderDayColumn(x,f,N,i,o,c,l,m,g,d))}))})}},{key:"renderEvents",value:function(a,n,i,o){var c=this.props,l=c.accessors,d=c.localizer,m=c.resourceGroupingLayout,g=c.components,h=c.dayLayoutAlgorithm,x=this.memoizedResources(this.props.resources,l),v=x.groupEvents(n),u=x.groupEvents(i);return m?this.renderRangeFirst(a,x,v,u,d,l,o,g,h):this.renderResourcesFirst(a,x,v,u,d,l,o,g,h)}},{key:"render",value:function(){var a,n=this.props,i=n.events,o=n.backgroundEvents,c=n.range,l=n.width,d=n.rtl,m=n.selected,g=n.getNow,h=n.resources,x=n.components,v=n.accessors,u=n.getters,f=n.localizer,N=n.min,w=n.max,k=n.showMultiDayTimes,p=n.longPressThreshold,C=n.resizable,T=n.resourceGroupingLayout;l=l||this.state.gutterWidth;var M=c[0],j=c[c.length-1];this.slots=c.length;var O=[],B=[],F=[];i.forEach(function(G){if(us(G,M,j,v,f)){var ae=v.start(G),H=v.end(G);v.allDay(G)||f.startAndEndAreDateOnly(ae,H)||!k&&!f.isSameDate(ae,H)?O.push(G):B.push(G)}}),o.forEach(function(G){us(G,M,j,v,f)&&F.push(G)}),O.sort(function(G,ae){return an(G,ae,v,f)});var K={range:c,events:O,width:l,rtl:d,getNow:g,localizer:f,selected:m,allDayMaxRows:this.props.showAllEvents?1/0:(a=this.props.allDayMaxRows)!==null&&a!==void 0?a:1/0,resources:this.memoizedResources(h,v),selectable:this.props.selectable,accessors:v,getters:u,components:x,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:p,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:C};return I.createElement("div",{className:Fe("rbc-time-view",h&&"rbc-time-view-resources"),ref:this.containerRef},h&&h.length>1&&T?I.createElement(C5,K):I.createElement(k5,K),this.props.popup&&this.renderOverlay(),I.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},I.createElement(T5,{date:M,ref:this.gutterRef,localizer:f,min:f.merge(M,N),max:f.merge(M,w),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:x,className:"rbc-time-gutter",getters:u}),this.renderEvents(c,B,F,g())))}},{key:"renderOverlay",value:function(){var a,n,i=this,o=(a=(n=this.state)===null||n===void 0?void 0:n.overlay)!==null&&a!==void 0?a:{},c=this.props,l=c.accessors,d=c.localizer,m=c.components,g=c.getters,h=c.selected,x=c.popupOffset,v=c.handleDragStart,u=function(){return i.setState({overlay:null})};return I.createElement(Xn,{overlay:o,accessors:l,localizer:d,components:m,getters:g,selected:h,popupOffset:x,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:u})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var a=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var n,i=(n=a.gutterRef)!==null&&n!==void 0&&n.current?tn(a.gutterRef.current):void 0;i&&a.state.gutterWidth!==i&&a.setState({gutterWidth:i})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var a=this.contentRef.current;a.scrollTop=a.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,n=a.min,i=a.max,o=a.scrollToTime,c=a.localizer,l=c.diff(c.merge(o,n),o,"milliseconds"),d=c.diff(n,i,"milliseconds");this._scrollRatio=l/d}}])}(S.Component);Lr.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var D5=["date","localizer","min","max","scrollToTime","enableAutoScroll"],wa=function(t){function r(){return He(this,r),rt(this,r,arguments)}return st(r,t),ze(r,[{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.min,c=o===void 0?i.startOf(new Date,"day"):o,l=a.max,d=l===void 0?i.endOf(new Date,"day"):l,m=a.scrollToTime,g=m===void 0?i.startOf(new Date,"day"):m,h=a.enableAutoScroll,x=h===void 0?!0:h,v=_t(a,D5),u=r.range(n,{localizer:i});return I.createElement(Lr,Object.assign({},v,{range:u,eventOffset:10,localizer:i,min:c,max:d,scrollToTime:g,enableAutoScroll:x}))}}])}(I.Component);wa.range=function(t,r){var s=r.localizer;return[s.startOf(t,"day")]};wa.navigate=function(t,r,s){var a=s.localizer;switch(r){case dt.PREVIOUS:return a.add(t,-1,"day");case dt.NEXT:return a.add(t,1,"day");default:return t}};wa.title=function(t,r){var s=r.localizer;return s.format(t,"dayHeaderFormat")};var M5=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Jt=function(t){function r(){return He(this,r),rt(this,r,arguments)}return st(r,t),ze(r,[{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.min,c=o===void 0?i.startOf(new Date,"day"):o,l=a.max,d=l===void 0?i.endOf(new Date,"day"):l,m=a.scrollToTime,g=m===void 0?i.startOf(new Date,"day"):m,h=a.enableAutoScroll,x=h===void 0?!0:h,v=_t(a,M5),u=r.range(n,this.props);return I.createElement(Lr,Object.assign({},v,{range:u,eventOffset:15,localizer:i,min:c,max:d,scrollToTime:g,enableAutoScroll:x}))}}])}(I.Component);Jt.defaultProps=Lr.defaultProps;Jt.navigate=function(t,r,s){var a=s.localizer;switch(r){case dt.PREVIOUS:return a.add(t,-1,"week");case dt.NEXT:return a.add(t,1,"week");default:return t}};Jt.range=function(t,r){var s=r.localizer,a=s.startOfWeek(),n=s.startOf(t,"week",a),i=s.endOf(t,"week",a);return s.range(n,i)};Jt.title=function(t,r){var s=r.localizer,a=Jt.range(t,{localizer:s}),n=yc(a),i=n[0],o=n.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var P5=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function ei(t,r){return Jt.range(t,r).filter(function(s){return[6,0].indexOf(s.getDay())===-1})}var Ss=function(t){function r(){return He(this,r),rt(this,r,arguments)}return st(r,t),ze(r,[{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.min,c=o===void 0?i.startOf(new Date,"day"):o,l=a.max,d=l===void 0?i.endOf(new Date,"day"):l,m=a.scrollToTime,g=m===void 0?i.startOf(new Date,"day"):m,h=a.enableAutoScroll,x=h===void 0?!0:h,v=_t(a,P5),u=ei(n,this.props);return I.createElement(Lr,Object.assign({},v,{range:u,eventOffset:15,localizer:i,min:c,max:d,scrollToTime:g,enableAutoScroll:x}))}}])}(I.Component);Ss.defaultProps=Lr.defaultProps;Ss.range=ei;Ss.navigate=Jt.navigate;Ss.title=function(t,r){var s=r.localizer,a=ei(t,{localizer:s}),n=yc(a),i=n[0],o=n.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var Na=30;function Sa(t){var r=t.accessors,s=t.components,a=t.date,n=t.events,i=t.getters,o=t.length,c=o===void 0?Na:o,l=t.localizer,d=t.onDoubleClickEvent,m=t.onSelectEvent,g=t.selected,h=S.useRef(null),x=S.useRef(null),v=S.useRef(null),u=S.useRef(null),f=S.useRef(null);S.useEffect(function(){k()});var N=function(j,O,B){var F=s.event,K=s.date;return O=O.filter(function(G){return us(G,l.startOf(j,"day"),l.endOf(j,"day"),r,l)}),O.map(function(G,ae){var H=r.title(G),Y=r.end(G),U=r.start(G),Z=i.eventProp(G,U,Y,ya(G,g)),re=ae===0&&l.format(j,"agendaDateFormat"),W=ae===0?I.createElement("td",{rowSpan:O.length,className:"rbc-agenda-date-cell"},K?I.createElement(K,{day:j,label:re}):re):!1;return I.createElement("tr",{key:B+"_"+ae,className:Z.className,style:Z.style},W,I.createElement("td",{className:"rbc-agenda-time-cell"},w(j,G)),I.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(xe){return m&&m(G,xe)},onDoubleClick:function(xe){return d&&d(G,xe)}},F?I.createElement(F,{event:G,title:H}):H))},[])},w=function(j,O){var B="",F=s.time,K=l.messages.allDay,G=r.end(O),ae=r.start(O);return r.allDay(O)||(l.eq(ae,G)?K=l.format(ae,"agendaTimeFormat"):l.isSameDate(ae,G)?K=l.format({start:ae,end:G},"agendaTimeRangeFormat"):l.isSameDate(j,ae)?K=l.format(ae,"agendaTimeFormat"):l.isSameDate(j,G)&&(K=l.format(G,"agendaTimeFormat"))),l.gt(j,ae,"day")&&(B="rbc-continues-prior"),l.lt(j,G,"day")&&(B+=" rbc-continues-after"),I.createElement("span",{className:B.trim()},F?I.createElement(F,{event:O,day:j,label:K}):K)},k=function(){if(f.current){var j=h.current,O=f.current.firstChild;if(O){var B=u.current.scrollHeight>u.current.clientHeight,F=[],K=F;F=[tn(O.children[0]),tn(O.children[1])],(K[0]!==F[0]||K[1]!==F[1])&&(x.current.style.width=F[0]+"px",v.current.style.width=F[1]+"px"),B?(_f(j,"rbc-header-overflowing"),j.style.marginRight=Dn()+"px"):Af(j,"rbc-header-overflowing")}}},p=l.messages,C=l.add(a,c,"day"),T=l.range(a,C,"day");return n=n.filter(function(M){return us(M,l.startOf(a,"day"),l.endOf(C,"day"),r,l)}),n.sort(function(M,j){return+r.start(M)-+r.start(j)}),I.createElement("div",{className:"rbc-agenda-view"},n.length!==0?I.createElement(I.Fragment,null,I.createElement("table",{ref:h,className:"rbc-agenda-table"},I.createElement("thead",null,I.createElement("tr",null,I.createElement("th",{className:"rbc-header",ref:x},p.date),I.createElement("th",{className:"rbc-header",ref:v},p.time),I.createElement("th",{className:"rbc-header"},p.event)))),I.createElement("div",{className:"rbc-agenda-content",ref:u},I.createElement("table",{className:"rbc-agenda-table"},I.createElement("tbody",{ref:f},T.map(function(M,j){return N(M,n,j)}))))):I.createElement("span",{className:"rbc-agenda-empty"},p.noEventsInRange))}Sa.range=function(t,r){var s=r.length,a=s===void 0?Na:s,n=r.localizer,i=n.add(t,a,"day");return{start:t,end:i}};Sa.navigate=function(t,r,s){var a=s.length,n=a===void 0?Na:a,i=s.localizer;switch(r){case dt.PREVIOUS:return i.add(t,-n,"day");case dt.NEXT:return i.add(t,n,"day");default:return t}};Sa.title=function(t,r){var s=r.length,a=s===void 0?Na:s,n=r.localizer,i=n.add(t,a,"day");return n.format({start:t,end:i},"agendaHeaderFormat")};var Fs=sr(sr(sr(sr(sr({},it.MONTH,ja),it.WEEK,Jt),it.WORK_WEEK,Ss),it.DAY,wa),it.AGENDA,Sa),_5=["action","date","today"];function A5(t,r){var s=r.action,a=r.date,n=r.today,i=_t(r,_5);switch(t=typeof t=="string"?Fs[t]:t,s){case dt.TODAY:a=n||new Date;break;case dt.DATE:break;default:Qr(t&&typeof t.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),a=t.navigate(a,s,i)}return a}function R5(t,r){var s=null;return typeof r=="function"?s=r(t):typeof r=="string"&&Wt(t)==="object"&&t!=null&&r in t&&(s=t[r]),s}var It=function(r){return function(s){return R5(s,r)}},I5=["view","date","getNow","onNavigate"],L5=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function Yc(t){if(Array.isArray(t))return t;for(var r=[],s=0,a=Object.entries(t);s<a.length;s++){var n=lr(a[s],2),i=n[0],o=n[1];o&&r.push(i)}return r}function F5(t,r){var s=r.views,a=Yc(s);return a.indexOf(t)!==-1}var Vc=function(t){function r(){var s;He(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=rt(this,r,[].concat(n)),s.getViews=function(){var o=s.props.views;return Array.isArray(o)?xk(o,function(c,l){return c[l]=Fs[l]},{}):Wt(o)==="object"?xN(o,function(c,l){return c===!0?Fs[l]:c}):Fs},s.getView=function(){var o=s.getViews();return o[s.props.view]},s.getDrilldownView=function(o){var c=s.props,l=c.view,d=c.drilldownView,m=c.getDrilldownView;return m?m(o,l,Object.keys(s.getViews())):d},s.handleRangeChange=function(o,c,l){var d=s.props,m=d.onRangeChange,g=d.localizer;m&&c.range&&m(c.range(o,{localizer:g}),l)},s.handleNavigate=function(o,c){var l=s.props,d=l.view,m=l.date,g=l.getNow,h=l.onNavigate,x=_t(l,I5),v=s.getView(),u=g();m=A5(v,Oe(Oe({},x),{},{action:o,date:c||m||u,today:u})),h(m,d,o),s.handleRangeChange(m,v)},s.handleViewChange=function(o){o!==s.props.view&&F5(o,s.props)&&s.props.onView(o);var c=s.getViews();s.handleRangeChange(s.props.date||s.props.getNow(),c[o],o)},s.handleSelectEvent=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];Pe(s.props.onSelectEvent,c)},s.handleDoubleClickEvent=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];Pe(s.props.onDoubleClickEvent,c)},s.handleKeyPressEvent=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];Pe(s.props.onKeyPressEvent,c)},s.handleSelectSlot=function(o){Pe(s.props.onSelectSlot,o)},s.handleDrillDown=function(o,c){var l=s.props.onDrillDown;if(l){l(o,c,s.drilldownView);return}c&&s.handleViewChange(c),s.handleNavigate(dt.DATE,o)},s.state={context:r.getContext(s.props)},s}return st(r,t),ze(r,[{key:"render",value:function(){var a=this.props,n=a.view,i=a.toolbar,o=a.events,c=a.backgroundEvents,l=a.resourceGroupingLayout,d=a.style,m=a.className,g=a.elementProps,h=a.date,x=a.getNow,v=a.length,u=a.showMultiDayTimes,f=a.onShowMore,N=a.doShowMoreDrillDown;a.components,a.formats,a.messages,a.culture;var w=_t(a,L5);h=h||x();var k=this.getView(),p=this.state.context,C=p.accessors,T=p.components,M=p.getters,j=p.localizer,O=p.viewNames,B=T.toolbar||Bk,F=k.title(h,{localizer:j,length:v});return I.createElement("div",Object.assign({},g,{className:Fe(m,"rbc-calendar",w.rtl&&"rbc-rtl"),style:d}),i&&I.createElement(B,{date:h,view:n,views:O,label:F,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:j}),I.createElement(k,Object.assign({},w,{events:o,backgroundEvents:c,date:h,getNow:x,length:v,localizer:j,getters:M,components:T,accessors:C,showMultiDayTimes:u,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:f,doShowMoreDrillDown:N,resourceGroupingLayout:l})))}}],[{key:"getDerivedStateFromProps",value:function(a){return{context:r.getContext(a)}}},{key:"getContext",value:function(a){var n=a.startAccessor,i=a.endAccessor,o=a.allDayAccessor,c=a.tooltipAccessor,l=a.titleAccessor,d=a.resourceAccessor,m=a.resourceIdAccessor,g=a.resourceTitleAccessor,h=a.eventIdAccessor,x=a.eventPropGetter,v=a.backgroundEventPropGetter,u=a.slotPropGetter,f=a.slotGroupPropGetter,N=a.dayPropGetter,w=a.view,k=a.views,p=a.localizer,C=a.culture,T=a.messages,M=T===void 0?{}:T,j=a.components,O=j===void 0?{}:j,B=a.formats,F=B===void 0?{}:B,K=Yc(k),G=zk(M);return{viewNames:K,localizer:Wk(p,C,F,G),getters:{eventProp:function(){return x&&x.apply(void 0,arguments)||{}},backgroundEventProp:function(){return v&&v.apply(void 0,arguments)||{}},slotProp:function(){return u&&u.apply(void 0,arguments)||{}},slotGroupProp:function(){return f&&f.apply(void 0,arguments)||{}},dayProp:function(){return N&&N.apply(void 0,arguments)||{}}},components:oN(O[w]||{},rk(O,K),{eventWrapper:$t,backgroundEventWrapper:$t,eventContainerWrapper:$t,dateCellWrapper:$t,weekWrapper:$t,timeSlotWrapper:$t,timeGutterWrapper:$t,timeIndicatorWrapper:$t}),accessors:{start:It(n),end:It(i),allDay:It(o),tooltip:It(c),title:It(l),resource:It(d),resourceId:It(m),resourceTitle:It(g),eventId:It(h)}}}}])}(I.Component);Vc.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:it.MONTH,views:[it.MONTH,it.WEEK,it.DAY,it.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:it.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var ti=jo(Vc,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),U5=function(r,s,a){var n=r.start,i=r.end;return"".concat(a.format(n,"P",s)," – ").concat(a.format(i,"P",s))},Fa=function(r,s,a){var n=r.start,i=r.end;return"".concat(a.format(n,"p",s)," – ").concat(a.format(i,"p",s))},W5=function(r,s,a){var n=r.start;return"".concat(a.format(n,"h:mma",s)," – ")},B5=function(r,s,a){var n=r.end;return" – ".concat(a.format(n,"h:mma",s))},H5=function(r,s,a){var n=r.start,i=r.end;return"".concat(a.format(n,"MMMM dd",s)," – ").concat(a.format(i,$r(n,i,"month")?"dd":"MMMM dd",s))},z5={dateFormat:"dd",dayFormat:"dd eee",weekdayFormat:"ccc",selectRangeFormat:Fa,eventTimeRangeFormat:Fa,eventTimeRangeStartFormat:W5,eventTimeRangeEndFormat:B5,timeGutterFormat:"p",monthHeaderFormat:"MMMM yyyy",dayHeaderFormat:"cccc MMM dd",dayRangeHeaderFormat:H5,agendaHeaderFormat:U5,agendaDateFormat:"ccc MMM dd",agendaTimeFormat:"p",agendaTimeRangeFormat:Fa},ri=function(r){var s=r.startOfWeek,a=r.getDay,n=r.format,i=r.locales;return new Uk({formats:z5,firstOfWeek:function(c){return a(s(new Date,{locale:i[c]}))},format:function(c,l,d){return n(new Date(c),l,{locale:i[d]})}})};function xt(t){const r=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&r==="[object Date]"?new t.constructor(+t):typeof t=="number"||r==="[object Number]"||typeof t=="string"||r==="[object String]"?new Date(t):new Date(NaN)}function Ht(t,r){return t instanceof Date?new t.constructor(r):new Date(r)}function G5(t,r){const s=xt(t);return isNaN(r)?Ht(t,NaN):(s.setDate(s.getDate()+r),s)}const Kc=6048e5,q5=864e5;let Y5={};function ka(){return Y5}function At(t,r){var c,l,d,m;const s=ka(),a=(r==null?void 0:r.weekStartsOn)??((l=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??s.weekStartsOn??((m=(d=s.locale)==null?void 0:d.options)==null?void 0:m.weekStartsOn)??0,n=xt(t),i=n.getDay(),o=(i<a?7:0)+i-a;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function Zs(t){return At(t,{weekStartsOn:1})}function Jc(t){const r=xt(t),s=r.getFullYear(),a=Ht(t,0);a.setFullYear(s+1,0,4),a.setHours(0,0,0,0);const n=Zs(a),i=Ht(t,0);i.setFullYear(s,0,4),i.setHours(0,0,0,0);const o=Zs(i);return r.getTime()>=n.getTime()?s+1:r.getTime()>=o.getTime()?s:s-1}function Qs(t){const r=xt(t);return r.setHours(0,0,0,0),r}function zl(t){const r=xt(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}function V5(t,r){const s=Qs(t),a=Qs(r),n=+s-zl(s),i=+a-zl(a);return Math.round((n-i)/q5)}function K5(t){const r=Jc(t),s=Ht(t,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),Zs(s)}function si(t){return Ht(t,Date.now())}function Xc(t,r){const s=Qs(t),a=Qs(r);return+s==+a}function J5(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function X5(t){if(!J5(t)&&typeof t!="number")return!1;const r=xt(t);return!isNaN(Number(r))}function Z5(t){const r=xt(t),s=Ht(t,0);return s.setFullYear(r.getFullYear(),0,1),s.setHours(0,0,0,0),s}const Q5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},e4=(t,r,s)=>{let a;const n=Q5[t];return typeof n=="string"?a=n:r===1?a=n.one:a=n.other.replace("{{count}}",r.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};function jr(t){return(r={})=>{const s=r.width?String(r.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const t4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},r4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},s4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},a4={date:jr({formats:t4,defaultWidth:"full"}),time:jr({formats:r4,defaultWidth:"full"}),dateTime:jr({formats:s4,defaultWidth:"full"})},n4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},i4=(t,r,s,a)=>n4[t];function Tt(t){return(r,s)=>{const a=s!=null&&s.context?String(s.context):"standalone";let n;if(a==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,c=s!=null&&s.width?String(s.width):o;n=t.formattingValues[c]||t.formattingValues[o]}else{const o=t.defaultWidth,c=s!=null&&s.width?String(s.width):t.defaultWidth;n=t.values[c]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(r):r;return n[i]}}const l4={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},o4={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},c4={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},d4={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},u4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},m4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},h4=(t,r)=>{const s=Number(t),a=s%100;if(a>20||a<10)switch(a%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},f4={ordinalNumber:h4,era:Tt({values:l4,defaultWidth:"wide"}),quarter:Tt({values:o4,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Tt({values:c4,defaultWidth:"wide"}),day:Tt({values:d4,defaultWidth:"wide"}),dayPeriod:Tt({values:u4,defaultWidth:"wide",formattingValues:m4,defaultFormattingWidth:"wide"})};function Ot(t){return(r,s={})=>{const a=s.width,n=a&&t.matchPatterns[a]||t.matchPatterns[t.defaultMatchWidth],i=r.match(n);if(!i)return null;const o=i[0],c=a&&t.parsePatterns[a]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(c)?g4(c,g=>g.test(o)):x4(c,g=>g.test(o));let d;d=t.valueCallback?t.valueCallback(l):l,d=s.valueCallback?s.valueCallback(d):d;const m=r.slice(o.length);return{value:d,rest:m}}}function x4(t,r){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&r(t[s]))return s}function g4(t,r){for(let s=0;s<t.length;s++)if(r(t[s]))return s}function Zc(t){return(r,s={})=>{const a=r.match(t.matchPattern);if(!a)return null;const n=a[0],i=r.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=s.valueCallback?s.valueCallback(o):o;const c=r.slice(n.length);return{value:o,rest:c}}}const p4=/^(\d+)(th|st|nd|rd)?/i,v4=/\d+/i,b4={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},y4={any:[/^b/i,/^(a|c)/i]},j4={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},w4={any:[/1/i,/2/i,/3/i,/4/i]},N4={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},S4={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},k4={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},C4={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},E4={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$4={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},T4={ordinalNumber:Zc({matchPattern:p4,parsePattern:v4,valueCallback:t=>parseInt(t,10)}),era:Ot({matchPatterns:b4,defaultMatchWidth:"wide",parsePatterns:y4,defaultParseWidth:"any"}),quarter:Ot({matchPatterns:j4,defaultMatchWidth:"wide",parsePatterns:w4,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ot({matchPatterns:N4,defaultMatchWidth:"wide",parsePatterns:S4,defaultParseWidth:"any"}),day:Ot({matchPatterns:k4,defaultMatchWidth:"wide",parsePatterns:C4,defaultParseWidth:"any"}),dayPeriod:Ot({matchPatterns:E4,defaultMatchWidth:"any",parsePatterns:$4,defaultParseWidth:"any"})},O4={code:"en-US",formatDistance:e4,formatLong:a4,formatRelative:i4,localize:f4,match:T4,options:{weekStartsOn:0,firstWeekContainsDate:1}};function D4(t){const r=xt(t);return V5(r,Z5(r))+1}function M4(t){const r=xt(t),s=+Zs(r)-+K5(r);return Math.round(s/Kc)+1}function Qc(t,r){var m,g,h,x;const s=xt(t),a=s.getFullYear(),n=ka(),i=(r==null?void 0:r.firstWeekContainsDate)??((g=(m=r==null?void 0:r.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??n.firstWeekContainsDate??((x=(h=n.locale)==null?void 0:h.options)==null?void 0:x.firstWeekContainsDate)??1,o=Ht(t,0);o.setFullYear(a+1,0,i),o.setHours(0,0,0,0);const c=At(o,r),l=Ht(t,0);l.setFullYear(a,0,i),l.setHours(0,0,0,0);const d=At(l,r);return s.getTime()>=c.getTime()?a+1:s.getTime()>=d.getTime()?a:a-1}function P4(t,r){var c,l,d,m;const s=ka(),a=(r==null?void 0:r.firstWeekContainsDate)??((l=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:l.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(d=s.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??1,n=Qc(t,r),i=Ht(t,0);return i.setFullYear(n,0,a),i.setHours(0,0,0,0),At(i,r)}function _4(t,r){const s=xt(t),a=+At(s,r)-+P4(s,r);return Math.round(a/Kc)+1}function Te(t,r){const s=t<0?"-":"",a=Math.abs(t).toString().padStart(r,"0");return s+a}const Gt={y(t,r){const s=t.getFullYear(),a=s>0?s:1-s;return Te(r==="yy"?a%100:a,r.length)},M(t,r){const s=t.getMonth();return r==="M"?String(s+1):Te(s+1,2)},d(t,r){return Te(t.getDate(),r.length)},a(t,r){const s=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h(t,r){return Te(t.getHours()%12||12,r.length)},H(t,r){return Te(t.getHours(),r.length)},m(t,r){return Te(t.getMinutes(),r.length)},s(t,r){return Te(t.getSeconds(),r.length)},S(t,r){const s=r.length,a=t.getMilliseconds(),n=Math.trunc(a*Math.pow(10,s-3));return Te(n,r.length)}},pr={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Gl={G:function(t,r,s){const a=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return s.era(a,{width:"abbreviated"});case"GGGGG":return s.era(a,{width:"narrow"});case"GGGG":default:return s.era(a,{width:"wide"})}},y:function(t,r,s){if(r==="yo"){const a=t.getFullYear(),n=a>0?a:1-a;return s.ordinalNumber(n,{unit:"year"})}return Gt.y(t,r)},Y:function(t,r,s,a){const n=Qc(t,a),i=n>0?n:1-n;if(r==="YY"){const o=i%100;return Te(o,2)}return r==="Yo"?s.ordinalNumber(i,{unit:"year"}):Te(i,r.length)},R:function(t,r){const s=Jc(t);return Te(s,r.length)},u:function(t,r){const s=t.getFullYear();return Te(s,r.length)},Q:function(t,r,s){const a=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(a);case"QQ":return Te(a,2);case"Qo":return s.ordinalNumber(a,{unit:"quarter"});case"QQQ":return s.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,r,s){const a=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(a);case"qq":return Te(a,2);case"qo":return s.ordinalNumber(a,{unit:"quarter"});case"qqq":return s.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,r,s){const a=t.getMonth();switch(r){case"M":case"MM":return Gt.M(t,r);case"Mo":return s.ordinalNumber(a+1,{unit:"month"});case"MMM":return s.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(a,{width:"wide",context:"formatting"})}},L:function(t,r,s){const a=t.getMonth();switch(r){case"L":return String(a+1);case"LL":return Te(a+1,2);case"Lo":return s.ordinalNumber(a+1,{unit:"month"});case"LLL":return s.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(a,{width:"wide",context:"standalone"})}},w:function(t,r,s,a){const n=_4(t,a);return r==="wo"?s.ordinalNumber(n,{unit:"week"}):Te(n,r.length)},I:function(t,r,s){const a=M4(t);return r==="Io"?s.ordinalNumber(a,{unit:"week"}):Te(a,r.length)},d:function(t,r,s){return r==="do"?s.ordinalNumber(t.getDate(),{unit:"date"}):Gt.d(t,r)},D:function(t,r,s){const a=D4(t);return r==="Do"?s.ordinalNumber(a,{unit:"dayOfYear"}):Te(a,r.length)},E:function(t,r,s){const a=t.getDay();switch(r){case"E":case"EE":case"EEE":return s.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(a,{width:"short",context:"formatting"});case"EEEE":default:return s.day(a,{width:"wide",context:"formatting"})}},e:function(t,r,s,a){const n=t.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return Te(i,2);case"eo":return s.ordinalNumber(i,{unit:"day"});case"eee":return s.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(n,{width:"short",context:"formatting"});case"eeee":default:return s.day(n,{width:"wide",context:"formatting"})}},c:function(t,r,s,a){const n=t.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return Te(i,r.length);case"co":return s.ordinalNumber(i,{unit:"day"});case"ccc":return s.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(n,{width:"narrow",context:"standalone"});case"cccccc":return s.day(n,{width:"short",context:"standalone"});case"cccc":default:return s.day(n,{width:"wide",context:"standalone"})}},i:function(t,r,s){const a=t.getDay(),n=a===0?7:a;switch(r){case"i":return String(n);case"ii":return Te(n,r.length);case"io":return s.ordinalNumber(n,{unit:"day"});case"iii":return s.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(a,{width:"short",context:"formatting"});case"iiii":default:return s.day(a,{width:"wide",context:"formatting"})}},a:function(t,r,s){const n=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,r,s){const a=t.getHours();let n;switch(a===12?n=pr.noon:a===0?n=pr.midnight:n=a/12>=1?"pm":"am",r){case"b":case"bb":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,r,s){const a=t.getHours();let n;switch(a>=17?n=pr.evening:a>=12?n=pr.afternoon:a>=4?n=pr.morning:n=pr.night,r){case"B":case"BB":case"BBB":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,r,s){if(r==="ho"){let a=t.getHours()%12;return a===0&&(a=12),s.ordinalNumber(a,{unit:"hour"})}return Gt.h(t,r)},H:function(t,r,s){return r==="Ho"?s.ordinalNumber(t.getHours(),{unit:"hour"}):Gt.H(t,r)},K:function(t,r,s){const a=t.getHours()%12;return r==="Ko"?s.ordinalNumber(a,{unit:"hour"}):Te(a,r.length)},k:function(t,r,s){let a=t.getHours();return a===0&&(a=24),r==="ko"?s.ordinalNumber(a,{unit:"hour"}):Te(a,r.length)},m:function(t,r,s){return r==="mo"?s.ordinalNumber(t.getMinutes(),{unit:"minute"}):Gt.m(t,r)},s:function(t,r,s){return r==="so"?s.ordinalNumber(t.getSeconds(),{unit:"second"}):Gt.s(t,r)},S:function(t,r){return Gt.S(t,r)},X:function(t,r,s){const a=t.getTimezoneOffset();if(a===0)return"Z";switch(r){case"X":return Yl(a);case"XXXX":case"XX":return rr(a);case"XXXXX":case"XXX":default:return rr(a,":")}},x:function(t,r,s){const a=t.getTimezoneOffset();switch(r){case"x":return Yl(a);case"xxxx":case"xx":return rr(a);case"xxxxx":case"xxx":default:return rr(a,":")}},O:function(t,r,s){const a=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+ql(a,":");case"OOOO":default:return"GMT"+rr(a,":")}},z:function(t,r,s){const a=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+ql(a,":");case"zzzz":default:return"GMT"+rr(a,":")}},t:function(t,r,s){const a=Math.trunc(t.getTime()/1e3);return Te(a,r.length)},T:function(t,r,s){const a=t.getTime();return Te(a,r.length)}};function ql(t,r=""){const s=t>0?"-":"+",a=Math.abs(t),n=Math.trunc(a/60),i=a%60;return i===0?s+String(n):s+String(n)+r+Te(i,2)}function Yl(t,r){return t%60===0?(t>0?"-":"+")+Te(Math.abs(t)/60,2):rr(t,r)}function rr(t,r=""){const s=t>0?"-":"+",a=Math.abs(t),n=Te(Math.trunc(a/60),2),i=Te(a%60,2);return s+n+r+i}const Vl=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},ed=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},A4=(t,r)=>{const s=t.match(/(P+)(p+)?/)||[],a=s[1],n=s[2];if(!n)return Vl(t,r);let i;switch(a){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",Vl(a,r)).replace("{{time}}",ed(n,r))},R4={p:ed,P:A4},I4=/^D+$/,L4=/^Y+$/,F4=["D","DD","YY","YYYY"];function U4(t){return I4.test(t)}function W4(t){return L4.test(t)}function B4(t,r,s){const a=H4(t,r,s);if(console.warn(a),F4.includes(t))throw new RangeError(a)}function H4(t,r,s){const a=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${a} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const z4=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,G4=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,q4=/^'([^]*?)'?$/,Y4=/''/g,V4=/[a-zA-Z]/;function Ye(t,r,s){var m,g,h,x,v,u,f,N;const a=ka(),n=(s==null?void 0:s.locale)??a.locale??O4,i=(s==null?void 0:s.firstWeekContainsDate)??((g=(m=s==null?void 0:s.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((x=(h=a.locale)==null?void 0:h.options)==null?void 0:x.firstWeekContainsDate)??1,o=(s==null?void 0:s.weekStartsOn)??((u=(v=s==null?void 0:s.locale)==null?void 0:v.options)==null?void 0:u.weekStartsOn)??a.weekStartsOn??((N=(f=a.locale)==null?void 0:f.options)==null?void 0:N.weekStartsOn)??0,c=xt(t);if(!X5(c))throw new RangeError("Invalid time value");let l=r.match(G4).map(w=>{const k=w[0];if(k==="p"||k==="P"){const p=R4[k];return p(w,n.formatLong)}return w}).join("").match(z4).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const k=w[0];if(k==="'")return{isToken:!1,value:K4(w)};if(Gl[k])return{isToken:!0,value:w};if(k.match(V4))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:w}});n.localize.preprocessor&&(l=n.localize.preprocessor(c,l));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:n};return l.map(w=>{if(!w.isToken)return w.value;const k=w.value;(!(s!=null&&s.useAdditionalWeekYearTokens)&&W4(k)||!(s!=null&&s.useAdditionalDayOfYearTokens)&&U4(k))&&B4(k,r,String(t));const p=Gl[k[0]];return p(c,k,n.localize,d)}).join("")}function K4(t){const r=t.match(q4);return r?r[1].replace(Y4,"'"):t}function ai(t){return xt(t).getDay()}function ln(t,r,s){const a=At(t,s),n=At(r,s);return+a==+n}function J4(t,r){return ln(t,si(t),r)}function Kl(t){return Xc(t,si(t))}function X4(t,r){return G5(t,-1)}function Jl(t){return Xc(t,X4(si(t)))}function Br(t,r){if(t.one!==void 0&&r===1)return t.one;const s=r%10,a=r%100;return s===1&&a!==11?t.singularNominative.replace("{{count}}",String(r)):s>=2&&s<=4&&(a<10||a>20)?t.singularGenitive.replace("{{count}}",String(r)):t.pluralGenitive.replace("{{count}}",String(r))}function nt(t){return(r,s)=>s!=null&&s.addSuffix?s.comparison&&s.comparison>0?t.future?Br(t.future,r):"через "+Br(t.regular,r):t.past?Br(t.past,r):Br(t.regular,r)+" назад":Br(t.regular,r)}const Z4={lessThanXSeconds:nt({regular:{one:"меньше секунды",singularNominative:"меньше {{count}} секунды",singularGenitive:"меньше {{count}} секунд",pluralGenitive:"меньше {{count}} секунд"},future:{one:"меньше, чем через секунду",singularNominative:"меньше, чем через {{count}} секунду",singularGenitive:"меньше, чем через {{count}} секунды",pluralGenitive:"меньше, чем через {{count}} секунд"}}),xSeconds:nt({regular:{singularNominative:"{{count}} секунда",singularGenitive:"{{count}} секунды",pluralGenitive:"{{count}} секунд"},past:{singularNominative:"{{count}} секунду назад",singularGenitive:"{{count}} секунды назад",pluralGenitive:"{{count}} секунд назад"},future:{singularNominative:"через {{count}} секунду",singularGenitive:"через {{count}} секунды",pluralGenitive:"через {{count}} секунд"}}),halfAMinute:(t,r)=>r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"через полминуты":"полминуты назад":"полминуты",lessThanXMinutes:nt({regular:{one:"меньше минуты",singularNominative:"меньше {{count}} минуты",singularGenitive:"меньше {{count}} минут",pluralGenitive:"меньше {{count}} минут"},future:{one:"меньше, чем через минуту",singularNominative:"меньше, чем через {{count}} минуту",singularGenitive:"меньше, чем через {{count}} минуты",pluralGenitive:"меньше, чем через {{count}} минут"}}),xMinutes:nt({regular:{singularNominative:"{{count}} минута",singularGenitive:"{{count}} минуты",pluralGenitive:"{{count}} минут"},past:{singularNominative:"{{count}} минуту назад",singularGenitive:"{{count}} минуты назад",pluralGenitive:"{{count}} минут назад"},future:{singularNominative:"через {{count}} минуту",singularGenitive:"через {{count}} минуты",pluralGenitive:"через {{count}} минут"}}),aboutXHours:nt({regular:{singularNominative:"около {{count}} часа",singularGenitive:"около {{count}} часов",pluralGenitive:"около {{count}} часов"},future:{singularNominative:"приблизительно через {{count}} час",singularGenitive:"приблизительно через {{count}} часа",pluralGenitive:"приблизительно через {{count}} часов"}}),xHours:nt({regular:{singularNominative:"{{count}} час",singularGenitive:"{{count}} часа",pluralGenitive:"{{count}} часов"}}),xDays:nt({regular:{singularNominative:"{{count}} день",singularGenitive:"{{count}} дня",pluralGenitive:"{{count}} дней"}}),aboutXWeeks:nt({regular:{singularNominative:"около {{count}} недели",singularGenitive:"около {{count}} недель",pluralGenitive:"около {{count}} недель"},future:{singularNominative:"приблизительно через {{count}} неделю",singularGenitive:"приблизительно через {{count}} недели",pluralGenitive:"приблизительно через {{count}} недель"}}),xWeeks:nt({regular:{singularNominative:"{{count}} неделя",singularGenitive:"{{count}} недели",pluralGenitive:"{{count}} недель"}}),aboutXMonths:nt({regular:{singularNominative:"около {{count}} месяца",singularGenitive:"около {{count}} месяцев",pluralGenitive:"около {{count}} месяцев"},future:{singularNominative:"приблизительно через {{count}} месяц",singularGenitive:"приблизительно через {{count}} месяца",pluralGenitive:"приблизительно через {{count}} месяцев"}}),xMonths:nt({regular:{singularNominative:"{{count}} месяц",singularGenitive:"{{count}} месяца",pluralGenitive:"{{count}} месяцев"}}),aboutXYears:nt({regular:{singularNominative:"около {{count}} года",singularGenitive:"около {{count}} лет",pluralGenitive:"около {{count}} лет"},future:{singularNominative:"приблизительно через {{count}} год",singularGenitive:"приблизительно через {{count}} года",pluralGenitive:"приблизительно через {{count}} лет"}}),xYears:nt({regular:{singularNominative:"{{count}} год",singularGenitive:"{{count}} года",pluralGenitive:"{{count}} лет"}}),overXYears:nt({regular:{singularNominative:"больше {{count}} года",singularGenitive:"больше {{count}} лет",pluralGenitive:"больше {{count}} лет"},future:{singularNominative:"больше, чем через {{count}} год",singularGenitive:"больше, чем через {{count}} года",pluralGenitive:"больше, чем через {{count}} лет"}}),almostXYears:nt({regular:{singularNominative:"почти {{count}} год",singularGenitive:"почти {{count}} года",pluralGenitive:"почти {{count}} лет"},future:{singularNominative:"почти через {{count}} год",singularGenitive:"почти через {{count}} года",pluralGenitive:"почти через {{count}} лет"}})},Q4=(t,r,s)=>Z4[t](r,s),eC={full:"EEEE, d MMMM y 'г.'",long:"d MMMM y 'г.'",medium:"d MMM y 'г.'",short:"dd.MM.y"},tC={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},rC={any:"{{date}}, {{time}}"},sC={date:jr({formats:eC,defaultWidth:"full"}),time:jr({formats:tC,defaultWidth:"full"}),dateTime:jr({formats:rC,defaultWidth:"any"})},ni=["воскресенье","понедельник","вторник","среду","четверг","пятницу","субботу"];function aC(t){const r=ni[t];switch(t){case 0:return"'в прошлое "+r+" в' p";case 1:case 2:case 4:return"'в прошлый "+r+" в' p";case 3:case 5:case 6:return"'в прошлую "+r+" в' p"}}function Xl(t){const r=ni[t];return t===2?"'во "+r+" в' p":"'в "+r+" в' p"}function nC(t){const r=ni[t];switch(t){case 0:return"'в следующее "+r+" в' p";case 1:case 2:case 4:return"'в следующий "+r+" в' p";case 3:case 5:case 6:return"'в следующую "+r+" в' p"}}const iC={lastWeek:(t,r,s)=>{const a=t.getDay();return ln(t,r,s)?Xl(a):aC(a)},yesterday:"'вчера в' p",today:"'сегодня в' p",tomorrow:"'завтра в' p",nextWeek:(t,r,s)=>{const a=t.getDay();return ln(t,r,s)?Xl(a):nC(a)},other:"P"},lC=(t,r,s,a)=>{const n=iC[t];return typeof n=="function"?n(r,s,a):n},oC={narrow:["до н.э.","н.э."],abbreviated:["до н. э.","н. э."],wide:["до нашей эры","нашей эры"]},cC={narrow:["1","2","3","4"],abbreviated:["1-й кв.","2-й кв.","3-й кв.","4-й кв."],wide:["1-й квартал","2-й квартал","3-й квартал","4-й квартал"]},dC={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],wide:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"]},uC={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],wide:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"]},mC={narrow:["В","П","В","С","Ч","П","С"],short:["вс","пн","вт","ср","чт","пт","сб"],abbreviated:["вск","пнд","втр","срд","чтв","птн","суб"],wide:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"]},hC={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утро",afternoon:"день",evening:"вечер",night:"ночь"}},fC={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утра",afternoon:"дня",evening:"вечера",night:"ночи"}},xC=(t,r)=>{const s=Number(t),a=r==null?void 0:r.unit;let n;return a==="date"?n="-е":a==="week"||a==="minute"||a==="second"?n="-я":n="-й",s+n},gC={ordinalNumber:xC,era:Tt({values:oC,defaultWidth:"wide"}),quarter:Tt({values:cC,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Tt({values:dC,defaultWidth:"wide",formattingValues:uC,defaultFormattingWidth:"wide"}),day:Tt({values:mC,defaultWidth:"wide"}),dayPeriod:Tt({values:hC,defaultWidth:"any",formattingValues:fC,defaultFormattingWidth:"wide"})},pC=/^(\d+)(-?(е|я|й|ое|ье|ая|ья|ый|ой|ий|ый))?/i,vC=/\d+/i,bC={narrow:/^((до )?н\.?\s?э\.?)/i,abbreviated:/^((до )?н\.?\s?э\.?)/i,wide:/^(до нашей эры|нашей эры|наша эра)/i},yC={any:[/^д/i,/^н/i]},jC={narrow:/^[1234]/i,abbreviated:/^[1234](-?[ыои]?й?)? кв.?/i,wide:/^[1234](-?[ыои]?й?)? квартал/i},wC={any:[/1/i,/2/i,/3/i,/4/i]},NC={narrow:/^[яфмаисонд]/i,abbreviated:/^(янв|фев|март?|апр|ма[йя]|июн[ья]?|июл[ья]?|авг|сент?|окт|нояб?|дек)\.?/i,wide:/^(январ[ья]|феврал[ья]|марта?|апрел[ья]|ма[йя]|июн[ья]|июл[ья]|августа?|сентябр[ья]|октябр[ья]|октябр[ья]|ноябр[ья]|декабр[ья])/i},SC={narrow:[/^я/i,/^ф/i,/^м/i,/^а/i,/^м/i,/^и/i,/^и/i,/^а/i,/^с/i,/^о/i,/^н/i,/^я/i],any:[/^я/i,/^ф/i,/^мар/i,/^ап/i,/^ма[йя]/i,/^июн/i,/^июл/i,/^ав/i,/^с/i,/^о/i,/^н/i,/^д/i]},kC={narrow:/^[впсч]/i,short:/^(вс|во|пн|по|вт|ср|чт|че|пт|пя|сб|су)\.?/i,abbreviated:/^(вск|вос|пнд|пон|втр|вто|срд|сре|чтв|чет|птн|пят|суб).?/i,wide:/^(воскресень[ея]|понедельника?|вторника?|сред[аы]|четверга?|пятниц[аы]|суббот[аы])/i},CC={narrow:[/^в/i,/^п/i,/^в/i,/^с/i,/^ч/i,/^п/i,/^с/i],any:[/^в[ос]/i,/^п[он]/i,/^в/i,/^ср/i,/^ч/i,/^п[ят]/i,/^с[уб]/i]},EC={narrow:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,abbreviated:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,wide:/^([дп]п|полночь|полдень|утр[оа]|день|дня|вечера?|ноч[ьи])/i},$C={any:{am:/^дп/i,pm:/^пп/i,midnight:/^полн/i,noon:/^полд/i,morning:/^у/i,afternoon:/^д[ен]/i,evening:/^в/i,night:/^н/i}},TC={ordinalNumber:Zc({matchPattern:pC,parsePattern:vC,valueCallback:t=>parseInt(t,10)}),era:Ot({matchPatterns:bC,defaultMatchWidth:"wide",parsePatterns:yC,defaultParseWidth:"any"}),quarter:Ot({matchPatterns:jC,defaultMatchWidth:"wide",parsePatterns:wC,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ot({matchPatterns:NC,defaultMatchWidth:"wide",parsePatterns:SC,defaultParseWidth:"any"}),day:Ot({matchPatterns:kC,defaultMatchWidth:"wide",parsePatterns:CC,defaultParseWidth:"any"}),dayPeriod:Ot({matchPatterns:EC,defaultMatchWidth:"wide",parsePatterns:$C,defaultParseWidth:"any"})},bt={code:"ru",formatDistance:Q4,formatLong:sC,formatRelative:lC,localize:gC,match:TC,options:{weekStartsOn:1,firstWeekContainsDate:1}},ii=({isOpen:t,onClose:r,onConfirm:s,slot:a,teacher:n,student:i})=>{var v;const[o,c]=S.useState(""),[l,d]=S.useState(!1),m=async()=>{d(!0);try{await s(o),r()}catch{}finally{d(!1)}},g=u=>{switch(u){case"online":return e.jsx(Ae,{className:"h-4 w-4"});case"offline":return e.jsx(ht,{className:"h-4 w-4"});case"mini-group":return e.jsx(Zr,{className:"h-4 w-4"});default:return e.jsx(Ae,{className:"h-4 w-4"})}},h=u=>{switch(u){case"online":return"Онлайн";case"offline":return"Очно";case"mini-group":return"Мини-группа";default:return u}},x=u=>{switch(u){case"regular":return"Обычный урок";case"consultation":return"Консультация";case"exam_prep":return"Подготовка к экзамену";case"homework_help":return"Помощь с домашним заданием";default:return u}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Подтверждение бронирования"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ve,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Преподаватель"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[n!=null&&n.avatar?e.jsx("img",{src:n.avatar,alt:n.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ve,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:(n==null?void 0:n.name)||"Преподаватель"}),e.jsx("p",{className:"text-sm text-gray-600",children:a==null?void 0:a.subject}),((v=n==null?void 0:n.profile)==null?void 0:v.rating)&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-yellow-500",children:"★"}),e.jsx("span",{className:"text-sm text-gray-600 ml-1",children:n.profile.rating})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Детали урока"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Ze,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Дата: ",new Date(a==null?void 0:a.date).toLocaleDateString("ru-RU")]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Ct,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Время: ",a==null?void 0:a.startTime," - ",a==null?void 0:a.endTime]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Ae,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Предмет: ",a==null?void 0:a.subject]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[g(a==null?void 0:a.format),e.jsxs("span",{className:"text-sm",children:["Формат: ",h(a==null?void 0:a.format)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Ld,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Тип: ",x(a==null?void 0:a.lessonType)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(no,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Стоимость: ",a==null?void 0:a.price," ₽"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Студент"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[i!=null&&i.avatar?e.jsx("img",{src:i.avatar,alt:i.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(ve,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:i==null?void 0:i.name}),e.jsx("p",{className:"text-sm text-gray-600",children:"Студент"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Примечание к уроку"}),e.jsx("textarea",{value:o,onChange:u=>c(u.target.value),placeholder:"Опишите ваши цели, задачи или особые пожелания к уроку...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:4}),e.jsx("p",{className:"text-sm text-gray-500",children:"Это поможет преподавателю лучше подготовиться к уроку"})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Отмена"}),e.jsx("button",{onClick:m,disabled:l,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Бронирование..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать урок"})]})})]})]})}):null},td=({teacher:t,onClose:r,onBookLesson:s,onMessage:a})=>{var J;const{user:n}=Ke(),{timeSlots:i,bookLesson:o,posts:c,createPost:l,addReaction:d,addComment:m,sharePost:g,bookmarkPost:h,editPost:x,deletePost:v}=tt(),[u,f]=S.useState(!1),[N,w]=S.useState(!1),[k,p]=S.useState(!1),[C,T]=S.useState(!1),[M,j]=S.useState(!1),[O,B]=S.useState(null),[F,K]=S.useState("about"),[G,ae]=S.useState(null),[H,Y]=S.useState({}),U=i.filter(V=>V.teacherId===t.id),Z=U.filter(V=>!V.isBooked),re=U.filter(V=>V.isBooked),W=t.profile,de=c.filter(V=>V.userId===t.id),xe=V=>{switch(V){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return V}},me=V=>{switch(V){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}},we=V=>{switch(V){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return V}},Ne=V=>{B(V),j(!0)},Q=async V=>{n&&O&&(o(O.id,n.id,n.name,V),j(!1),B(null))},be=(V,je)=>new Date(`${V}T${je}`).toLocaleDateString("ru-RU",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(cn,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>w(!N),className:`p-2 rounded-full transition-colors ${N?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(ta,{className:`w-5 h-5 ${N?"fill-current":""}`})}),e.jsx("button",{onClick:()=>f(!u),className:`p-2 rounded-full transition-colors ${u?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(mt,{className:`w-5 h-5 ${u?"fill-current":""}`})}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(qt,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsxs("div",{className:"h-56 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"}),e.jsx("div",{className:"absolute bottom-6 left-8 right-8",children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"text-white flex-1 mr-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 leading-tight",children:(W==null?void 0:W.name)||t.name||"Репетитор"}),e.jsxs("div",{className:"flex items-center space-x-4 flex-wrap",children:[(W==null?void 0:W.experience)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Ft,{className:"h-4 w-4 text-yellow-300"}),e.jsx("span",{className:"font-semibold text-xs",children:xe(W.experience)})]}),(W==null?void 0:W.rating)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Dt,{className:"h-4 w-4 text-yellow-300 fill-current"}),e.jsx("span",{className:"font-semibold text-xs",children:W.rating})]}),(W==null?void 0:W.city)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(ht,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-xs",children:W.city})]})]})]}),e.jsxs("div",{className:"text-right text-white/90 flex-shrink-0",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:(W==null?void 0:W.lessonsCount)||0}),e.jsx("div",{className:"text-sm opacity-80",children:"уроков"})]})]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start mt-8",children:[e.jsxs("div",{className:"flex-shrink-0 -mt-12 ml-8 relative",children:[e.jsxs("div",{className:"w-36 h-36 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-6 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-3 border-white rounded-full shadow-lg"}),W!=null&&W.avatar&&W.avatar.trim()!==""&&W.avatar!=="undefined"&&W.avatar!=="null"?e.jsx("img",{src:W.avatar,alt:(W==null?void 0:W.name)||t.name||"Репетитор",className:"w-36 h-36 object-cover rounded-full",onError:V=>{const je=V.target;je.style.display="none";const Ce=je.nextElementSibling;Ce&&Ce.classList.remove("hidden")},onLoad:V=>{const Ce=V.target.nextElementSibling;Ce&&Ce.classList.add("hidden")}}):null,e.jsx("div",{className:`w-36 h-36 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${W!=null&&W.avatar&&W.avatar.trim()!==""&&W.avatar!=="undefined"&&W.avatar!=="null"?"hidden":""}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(ve,{className:"h-16 w-16 text-white mb-2"}),e.jsx("div",{className:"text-white text-sm font-semibold",children:((W==null?void 0:W.name)||t.name||"Репетитор").charAt(0).toUpperCase()})]})})]}),e.jsxs("div",{className:"absolute -bottom-2 -right-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>f(!u),className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${u?"bg-red-500 text-white scale-110":"bg-white text-gray-600 hover:bg-red-50 hover:text-red-500"}`,children:e.jsx(mt,{className:`w-5 h-5 ${u?"fill-current":""}`})}),e.jsx("button",{className:"w-10 h-10 rounded-full bg-white text-gray-600 hover:bg-gray-50 shadow-lg transition-all duration-200 flex items-center justify-center",children:e.jsx(qt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-wrap gap-4 mt-12 lg:mt-0",children:[e.jsxs("button",{onClick:()=>s(t.id),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ae,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Записаться на урок"})]}),a&&e.jsxs("button",{onClick:()=>a(t.id),className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-2xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ue,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Написать сообщение"})]}),e.jsxs("button",{onClick:()=>T(!C),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(Ze,{className:"h-6 w-6"}),e.jsxs("span",{className:"text-lg",children:["Слоты (",Z.length,")"]})]}),e.jsxs("button",{onClick:()=>p(!k),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(Yt,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Контактная информация"})]})]})]})]}),k&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 mb-8 mt-8 border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-lg",children:"Контактная информация"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.phone&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(jt,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:t.phone})]}),t.email&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(un,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:t.email})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6 mt-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(W==null?void 0:W.lessonsCount)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Проведено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:((J=W==null?void 0:W.students)==null?void 0:J.length)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Учеников"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(W==null?void 0:W.rating)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Рейтинг"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:Z.length}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Свободных слотов"})]})]}),de.length>0&&e.jsxs("div",{className:"mb-8 mt-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx(Vt,{className:"w-5 h-5 mr-2 text-blue-600"}),"Записи ",(W==null?void 0:W.name)||t.name,e.jsx("span",{className:"ml-2 bg-blue-100 text-blue-800 py-0.5 px-2 rounded-full text-sm",children:de.length})]})}),e.jsxs("div",{className:"space-y-4",children:[de.slice(0,3).map(V=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:((W==null?void 0:W.name)||t.name).charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:(W==null?void 0:W.name)||t.name}),e.jsx("span",{className:"text-gray-500 text-sm",children:new Date(V.date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})})]}),e.jsx("div",{className:"text-gray-700 mb-3 whitespace-pre-line",children:V.text.length>200?`${V.text.substring(0,200)}...`:V.text}),V.tags&&V.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[V.tags.slice(0,3).map((je,Ce)=>e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-1 rounded-md text-xs font-medium",children:["#",je]},Ce)),V.tags.length>3&&e.jsxs("span",{className:"text-gray-500 text-xs",children:["+",V.tags.length-3," еще"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(mt,{className:"w-4 h-4"}),e.jsx("span",{children:V.likes||V.reactions.length})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{children:V.comments.length})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Yt,{className:"w-4 h-4"}),e.jsx("span",{children:V.views||0})]})]})]})]})},V.id)),de.length>3&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"text-blue-600 hover:text-blue-800 font-medium",children:["Показать все записи (",de.length,")"]})})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8 mt-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"about",label:"О преподавателе",count:null},{id:"slots",label:"Расписание",count:Z.length},{id:"reviews",label:"Отзывы",count:0}].map(V=>e.jsxs("button",{onClick:()=>K(V.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${F===V.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[V.label,V.count!==null&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2 rounded-full text-xs",children:V.count})]},V.id))})}),e.jsxs("div",{className:"min-h-[400px]",children:[F==="about"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Основная информация"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ve,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Имя"}),e.jsx("div",{className:"font-semibold text-gray-900",children:(W==null?void 0:W.name)||t.name||"Репетитор"})]})]}),(W==null?void 0:W.experience)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ft,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Опыт"}),e.jsx("div",{className:"font-semibold text-gray-900",children:xe(W.experience)})]})]}),(W==null?void 0:W.experienceYears)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(hs,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Лет преподавания"}),e.jsx("div",{className:"font-semibold text-gray-900",children:W.experienceYears})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ar,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Тип преподавателя"}),e.jsx("div",{className:"font-semibold text-gray-900",children:me((W==null?void 0:W.teacherType)||"private")})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[(W==null?void 0:W.rating)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Dt,{className:"w-5 h-5 text-yellow-500 fill-current"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Рейтинг"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[W.rating,"/5"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ae,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Проведено уроков"}),e.jsx("div",{className:"font-semibold text-gray-900",children:(W==null?void 0:W.lessonsCount)||0})]})]}),(W==null?void 0:W.hourlyRate)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-green-600 font-bold text-lg",children:"₽"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Стоимость урока"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[W.hourlyRate," ₽/час"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(W==null?void 0:W.subjects)&&W.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-green-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-green-500 to-emerald-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Предметы"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:W.subjects.map((V,je)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-green-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-green-200/50 shadow-sm",children:V},je))})]}),(W==null?void 0:W.grades)&&W.grades.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-purple-500 to-pink-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Классы"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:W.grades.map((V,je)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-purple-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-purple-200/50 shadow-sm",children:V},je))})]})]}),(W==null?void 0:W.education)&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-orange-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-orange-500 to-red-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Образование"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[W.education.university&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"🎓"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Университет"}),e.jsx("div",{className:"font-semibold text-gray-900",children:W.education.university})]})]}),W.education.degree&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"📜"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Степень"}),e.jsx("div",{className:"font-semibold text-gray-900",children:W.education.degree})]})]}),W.education.graduationYear&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"📅"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Год выпуска"}),e.jsx("div",{className:"font-semibold text-gray-900",children:W.education.graduationYear})]})]})]})]}),(W==null?void 0:W.bio)&&e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-indigo-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-indigo-500 to-purple-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"О преподавателе"]}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm rounded-lg p-4 border border-indigo-200/50",children:e.jsx("p",{className:"text-indigo-800 leading-relaxed whitespace-pre-line",children:W.bio})})]}),(W==null?void 0:W.formats)&&W.formats.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 border border-teal-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-teal-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-teal-500 to-cyan-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Форматы обучения"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:W.formats.map((V,je)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-teal-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-teal-200/50 shadow-sm",children:we(V)},je))})]})]}),F==="slots"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Доступные слоты"}),Z.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Z.map(V=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:V.subject}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:be(V.date,V.startTime)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ht,{className:"h-4 w-4"}),e.jsx("span",{children:we(V.format)})]})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600 mt-3",children:[V.price," ₽"]})]})}),e.jsxs("button",{onClick:()=>Ne(V),className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать"})]})]},V.id))}):e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-8 text-center",children:[e.jsx(Ze,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg mb-2",children:"Нет доступных слотов"}),e.jsx("p",{className:"text-gray-500",children:"Попробуйте позже или свяжитесь с преподавателем"})]})]}),re.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Забронированные уроки"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:re.map(V=>e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:V.subject}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:be(V.date,V.startTime)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ht,{className:"h-4 w-4"}),e.jsx("span",{children:we(V.format)})]})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-600 mt-3",children:[V.price," ₽"]})]})}),e.jsx("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded-xl text-sm font-medium text-center",children:"Забронировано"})]},V.id))})]})]}),F==="reviews"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Dt,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пока нет отзывов"}),e.jsx("p",{className:"text-gray-500",children:"Будьте первым, кто оставит отзыв о преподавателе"})]})]})]})]}),M&&O&&e.jsx(ii,{isOpen:M,slot:O,onClose:()=>j(!1),onConfirm:Q,teacher:t,student:n})]})},OC=({teacher:t,onClose:r,onBookLesson:s,onMessage:a})=>{var F,K,G,ae;const{timeSlots:n,posts:i,lessons:o,refreshUsers:c,forceSyncData:l}=tt(),[d,m]=S.useState(!1),[g,h]=S.useState(!1),[x,v]=S.useState(!1),u=async()=>{var H,Y;v(!0);try{const U=await fetch(`${_e}/api/users/${t.id}`);if(U.ok){const Z=await U.json();console.log("Fresh teacher data from refresh button:",Z);const W=JSON.parse(localStorage.getItem("allUsers")||"[]").map(xe=>xe.id===Z.id?Z:xe);localStorage.setItem("allUsers",JSON.stringify(W)),c(),await l();const de={...t,name:Z.name||t.name,email:Z.email||t.email,avatar:((H=Z.profile)==null?void 0:H.avatar)||Z.avatar||t.avatar,profile:{...t.profile,...Z.profile,avatar:((Y=Z.profile)==null?void 0:Y.avatar)||Z.avatar||t.avatar,name:Z.name||t.name,email:Z.email||t.email}};console.log("Updated teacher data in modal:",de)}else console.warn("Failed to refresh teacher data:",U.status)}catch(U){console.error("Error refreshing teacher data:",U)}finally{v(!1)}},f=t.profile;console.log("Teacher in modal:",t),console.log("Profile in modal:",f),S.useEffect(()=>{(async()=>{var Y,U;try{const Z=await fetch(`${_e}/api/users/${t.id}`);if(Z.ok){const re=await Z.json();console.log("Fresh teacher data in modal:",re);const de=JSON.parse(localStorage.getItem("allUsers")||"[]").map(me=>me.id===re.id?re:me);localStorage.setItem("allUsers",JSON.stringify(de)),c(),await l();const xe={...t,name:re.name||t.name,email:re.email||t.email,avatar:((Y=re.profile)==null?void 0:Y.avatar)||re.avatar||t.avatar,profile:{...t.profile,...re.profile,avatar:((U=re.profile)==null?void 0:U.avatar)||re.avatar||t.avatar,name:re.name||t.name,email:re.email||t.email}};console.log("Updated teacher data in modal useEffect:",xe)}else console.warn("Failed to refresh teacher data in modal:",Z.status)}catch(Z){console.error("Error refreshing teacher data in modal:",Z)}})()},[t.id]);const w=n.filter(H=>H.teacherId===t.id).filter(H=>!H.isBooked),k=i.filter(H=>H.userId===t.id),C=o.filter(H=>H.teacherId===t.id).filter(H=>H.status==="completed"),T=H=>{switch(H){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return H}},M=H=>{switch(H){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}},j=H=>{switch(H){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return H}},O=H=>{const Y=new Date(H),Z=Math.floor((new Date().getTime()-Y.getTime())/(1e3*60*60));return Z<1?"только что":Z<24?`${Z}ч назад`:Z<48?"вчера":Y.toLocaleDateString("ru-RU")},B=H=>new Date(H).toLocaleDateString("ru-RU",{weekday:"short",month:"short",day:"numeric"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Ve,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>h(!g),className:`p-2 rounded-full transition-colors ${g?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(ta,{className:`w-5 h-5 ${g?"fill-current":""}`})}),e.jsx("button",{onClick:()=>m(!d),className:`p-2 rounded-full transition-colors ${d?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(mt,{className:`w-5 h-5 ${d?"fill-current":""}`})}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(qt,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-6 mb-6",children:[e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-lg relative",children:[e.jsx("div",{className:"absolute top-1 right-1 w-4 h-4 bg-green-500 border-2 border-white rounded-full shadow-sm"}),(()=>{const H=(f==null?void 0:f.avatar)||t.avatar;return H&&H.trim()!==""&&H!=="undefined"&&H!=="null"?e.jsx("img",{src:H,alt:t.name,className:"w-24 h-24 object-cover rounded-full",onError:U=>{const Z=U.target;Z.style.display="none";const re=Z.nextElementSibling;re&&re.classList.remove("hidden")},onLoad:U=>{const re=U.target.nextElementSibling;re&&re.classList.add("hidden")}}):null})(),e.jsx("div",{className:`w-24 h-24 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${(()=>{const H=(f==null?void 0:f.avatar)||t.avatar;return H&&H.trim()!==""&&H!=="undefined"&&H!=="null"?"hidden":""})()}`,children:e.jsx(ve,{className:"h-12 w-12 text-white"})})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:u,disabled:x,className:"p-2 text-gray-400 hover:text-blue-600 transition-colors disabled:opacity-50",title:"Обновить данные",children:e.jsx(Us,{className:`w-5 h-5 ${x?"animate-spin":""}`})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(qt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[(f==null?void 0:f.rating)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Dt,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{children:f.rating})]}),(f==null?void 0:f.lessonsCount)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsxs("span",{children:[f.lessonsCount," уроков"]})]}),(f==null?void 0:f.experienceYears)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ft,{className:"w-4 h-4"}),e.jsxs("span",{children:[f.experienceYears," лет опыта"]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-3",children:"Статистика"}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600 mb-1",children:C.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Проведено уроков"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600 mb-1",children:w.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Свободных слотов"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600 mb-1",children:k.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Записей"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600 mb-1",children:(f==null?void 0:f.reviewsCount)||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Отзывов"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>s(t.id),className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),e.jsx("span",{children:"Записаться на урок"})]}),e.jsxs("button",{onClick:()=>a(t.id),className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(Ue,{className:"w-5 h-5"}),e.jsx("span",{children:"Написать сообщение"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"О преподавателе"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Предметы:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((F=f==null?void 0:f.subjects)==null?void 0:F.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:f.subjects.map((H,Y)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium",children:H},Y))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(ar,{className:"w-3 h-3 mr-1"}),"Классы:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((K=f==null?void 0:f.grades)==null?void 0:K.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:f.grades.map((H,Y)=>e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs font-medium",children:H},Y))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(fn,{className:"w-3 h-3 mr-1"}),"Цели обучения:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((G=f==null?void 0:f.goals)==null?void 0:G.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:f.goals.map((H,Y)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full text-xs font-medium",children:H},Y))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Ft,{className:"w-3 h-3 mr-1"}),"Опыт:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:f!=null&&f.experience?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-0.5 rounded-full text-xs font-medium",children:T(f.experience)}),f.experienceYears&&e.jsxs("span",{className:"text-gray-600 text-xs",children:["(",f.experienceYears," лет)"]})]}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(ar,{className:"w-3 h-3 mr-1"}),"Тип преподавателя:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:e.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded-full text-xs font-medium",children:M((f==null?void 0:f.teacherType)||"private")})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(ht,{className:"w-3 h-3 mr-1"}),"Город:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:f!=null&&f.city?e.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-0.5 rounded-full text-xs font-medium",children:f.city}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Pd,{className:"w-3 h-3 mr-1"}),"Форматы обучения:"]}),e.jsx("div",{className:"text-base text-gray-900 mt-2",children:((ae=f==null?void 0:f.formats)==null?void 0:ae.length)>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:f.formats.map((H,Y)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium",children:j(H)},Y))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]})]})]})]}),(f==null?void 0:f.education)&&e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(ar,{className:"w-4 h-4 mr-2"}),"Образование"]}),e.jsxs("div",{className:"space-y-2",children:[f.education.university&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Университет:"}),e.jsx("div",{className:"text-sm text-gray-900",children:f.education.university})]}),f.education.degree&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Специальность:"}),e.jsx("div",{className:"text-sm text-gray-900",children:f.education.degree})]}),f.education.graduationYear&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Год выпуска:"}),e.jsx("div",{className:"text-sm text-gray-900",children:f.education.graduationYear})]}),f.education.courses&&f.education.courses.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Курсы:"}),e.jsx("div",{className:"space-y-1 mt-1",children:f.education.courses.map((H,Y)=>e.jsxs("div",{className:"text-xs text-gray-700",children:["• ",H.name," (",H.institution,", ",H.year,")"]},Y))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(no,{className:"w-4 h-4 mr-2"}),"Стоимость и услуги"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Базовая стоимость:"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 mt-1",children:f!=null&&f.hourlyRate?`${f.hourlyRate} ₽/час`:"Не указана"})]}),(f==null?void 0:f.durations)&&f.durations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Длительности занятий:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:f.durations.map((H,Y)=>e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded-lg text-xs font-medium",children:[H," мин"]},Y))})]}),(f==null?void 0:f.lessonTypes)&&f.lessonTypes.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Типы уроков:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:f.lessonTypes.map((H,Y)=>e.jsx("span",{className:"bg-green-50 text-green-700 px-2 py-0.5 rounded-lg text-xs font-medium",children:H},Y))})]})]}),e.jsxs("div",{className:"space-y-3",children:[(f==null?void 0:f.rating)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Рейтинг:"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(H=>e.jsx(Dt,{className:`w-4 h-4 ${H<=(f.rating||0)?"text-yellow-400 fill-current":"text-gray-300"}`},H))}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[f.rating,"/5"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Автоподбор:"}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:f!=null&&f.overbookingEnabled?e.jsx("span",{className:"text-green-600 font-medium",children:"✓ Доступен"}):e.jsx("span",{className:"text-gray-500",children:"Недоступен"})})]})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-700",children:"💡 Стоимость может варьироваться в зависимости от формата, длительности занятия и сложности материала"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Доступные слоты (",w.length,")"]}),w.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Сводка по ценам:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Минимальная цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.min(...w.map(H=>H.price))," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Максимальная цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.max(...w.map(H=>H.price))," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Средняя цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.round(w.reduce((H,Y)=>H+Y.price,0)/w.length)," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Всего слотов:"}),e.jsx("div",{className:"font-semibold text-blue-600",children:w.length})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:w.slice(0,6).map(H=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:H.subject})]}),e.jsxs("span",{className:"text-base font-bold text-green-600",children:[H.price," ₽"]})]}),e.jsxs("div",{className:"space-y-1 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Ct,{className:"w-3 h-3"}),e.jsxs("span",{children:[B(H.date)," • ",H.startTime,"-",H.endTime]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(ht,{className:"w-3 h-3"}),e.jsxs("span",{children:[j(H.format)," • ",H.duration," мин"]})]}),H.experience&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Ft,{className:"w-3 h-3"}),e.jsxs("span",{children:["Опыт: ",T(H.experience)]})]})]}),e.jsxs("button",{onClick:()=>s(t.id),className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-2 px-4 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 text-sm font-semibold",children:["Записаться за ",H.price," ₽"]})]},H.id))}),w.length>6&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:["И еще ",w.length-6," доступных слотов"]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ze,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"Нет доступных слотов"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Следите за обновлениями расписания"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h3",{className:"text-base font-bold text-gray-900 flex items-center",children:[e.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Записи преподавателя (",k.length,")"]})}),k.length>0?e.jsxs("div",{className:"space-y-3",children:[k.slice(0,3).map(H=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center flex-shrink-0",children:e.jsx(ve,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:H.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:O(H.date)})]}),e.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed text-sm",children:H.text}),H.tags&&H.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:H.tags.map((Y,U)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium",children:Y},U))}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(uo,{className:"w-3 h-3"}),e.jsx("span",{children:H.reactions.length})]}),e.jsxs("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(Ue,{className:"w-3 h-3"}),e.jsx("span",{children:H.comments.length})]}),e.jsx("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:e.jsx(qt,{className:"w-3 h-3"})})]})]})]})},H.id)),k.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs("p",{className:"text-gray-600 text-xs",children:["И еще ",k.length-3," записей"]})})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(Vt,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"У преподавателя пока нет записей"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Записи появятся здесь, когда преподаватель начнет публиковать контент"})]})]})]})]})})},DC={ru:bt},MC=ri({format:Ye,startOfWeek:At,getDay:ai,locales:DC}),rd=({onClose:t})=>{const{timeSlots:r,bookLesson:s}=tt(),{user:a}=Ke(),[n,i]=S.useState(null),[o,c]=S.useState(!1),[l,d]=S.useState(!1),[m,g]=S.useState(null),x=r.filter(p=>!p.isBooked).map(p=>({id:p.id,title:`${p.teacherName} - ${p.subject}`,start:new Date(`${p.date}T${p.startTime}`),end:new Date(`${p.date}T${p.endTime}`),slot:p,teacherName:p.teacherName,subject:p.subject,price:p.price,format:p.format,experience:p.experience,rating:p.rating,city:p.city,teacherAvatar:p.teacherAvatar})),v=S.useCallback(p=>{let C={backgroundColor:"#3B82F6",borderRadius:"6px",opacity:.95,color:"white",border:"0px",display:"block",padding:"3px 6px",fontSize:"11px",fontWeight:"500",margin:"1px 0",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",transition:"all 0.2s ease"};return p.format==="offline"?C.backgroundColor="#10B981":p.format==="mini-group"&&(C.backgroundColor="#8B5CF6"),{style:C}},[]),u=S.useCallback(p=>{i(p),c(!0)},[]),f=p=>{if(!a){alert("Пожалуйста, войдите в систему для бронирования");return}g(p),d(!0),c(!1)},N=async p=>{if(a&&m)try{await s(m.id,a.id,a.name,p),d(!1),g(null),window.location.reload()}catch{alert("Произошла ошибка при бронировании. Попробуйте еще раз.")}},w=p=>{switch(p){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return p}},k=p=>{switch(p){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return p}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9998] p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-7xl w-full max-h-[90vh] overflow-hidden relative",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 p-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Календарь свободных слотов"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Выберите удобное время для занятия с преподавателем"})]}),e.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Ve,{className:"w-6 h-6 text-gray-600"})})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:e.jsx(ti,{localizer:MC,events:x,startAccessor:"start",endAccessor:"end",style:{height:600},eventPropGetter:v,onSelectEvent:u,views:["month","week","day"],messages:{next:"Следующий",previous:"Предыдущий",today:"Сегодня",month:"Месяц",week:"Неделя",day:"День",noEventsInRange:"Нет свободных слотов в выбранном диапазоне",showMore:p=>`+${p} еще`}})})}),o&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:p=>{p.target===p.currentTarget&&c(!1)},children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Детали слота"}),e.jsx("button",{onClick:()=>c(!1),className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Ve,{className:"w-5 h-5 text-gray-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden",children:n.teacherAvatar?e.jsx("img",{src:n.teacherAvatar,alt:n.teacherName,className:"w-12 h-12 object-cover rounded-full"}):e.jsx(ve,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:n.teacherName}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[n.rating&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Dt,{className:"h-3 w-3 text-yellow-400 fill-current"}),e.jsx("span",{children:n.rating})]}),n.experience&&e.jsx("span",{className:"text-blue-600",children:w(n.experience)})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:n.subject})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-gray-700",children:[Ye(n.start,"dd MMMM yyyy, HH:mm",{locale:bt})," - ",Ye(n.end,"HH:mm",{locale:bt})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ht,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:k(n.format)})]}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[n.price," ₽"]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsxs("button",{onClick:()=>f(n.slot),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать"})]}),e.jsx("button",{onClick:()=>c(!1),className:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Отмена"})]})]})]})}),l&&m&&e.jsx(ii,{slot:m,onClose:()=>d(!1),onConfirm:N})]})})},PC=({title:t,description:r,actionPrimary:s,actionSecondary:a,icon:n})=>e.jsx("div",{className:"col-span-full text-center py-14 card-gradient",children:e.jsxs("div",{className:"flex flex-col items-center",children:[n&&e.jsx("div",{className:"mb-3 text-blue-500",children:n}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),r&&e.jsx("p",{className:"text-gray-500 max-w-xl mx-auto mb-5",children:r}),e.jsxs("div",{className:"flex items-center gap-3 justify-center",children:[s&&e.jsx("button",{type:"button",onClick:s.onClick,className:`btn-primary px-5 py-2 rounded-lg ${s.variant==="secondary"?"btn-secondary":""}`,"aria-label":s.label,children:s.label}),a&&e.jsx("button",{type:"button",onClick:a.onClick,className:`btn-secondary px-5 py-2 rounded-lg ${a.variant==="primary"?"btn-primary":""}`,"aria-label":a.label,children:a.label})]})]})}),Ua=({setActiveTab:t})=>{var ut;const{bookLesson:r,timeSlots:s,allUsers:a,refreshUsers:n,refreshAllData:i,forceSyncData:o,sendMessageToUser:c,teacherProfiles:l,loadRegisteredTeachers:d,setAllUsers:m,socketRef:g,isConnected:h}=tt(),x=()=>{console.log("🔄 Принудительное обновление данных..."),i()};I.useEffect(()=>{console.log("🔄 StudentHome: Автоматическая загрузка зарегистрированных преподавателей и слотов...");const D=async()=>{try{await d(),await o(),console.log("✅ Данные загружены успешно")}catch(X){console.error("❌ Ошибка загрузки данных:",X),setTimeout(async()=>{try{await d(),await o(),console.log("✅ Данные загружены при повторной попытке")}catch(ce){console.error("❌ Ошибка при повторной попытке:",ce)}},2e3)}};D();const z=setInterval(()=>{document.visibilityState==="visible"&&(console.log("⏰ StudentHome: Периодическая загрузка зарегистрированных преподавателей и слотов..."),D())},15e3);return()=>clearInterval(z)},[d,o]);const{user:v}=Ke(),[u,f]=S.useState({}),[N,w]=S.useState(!1),[k,p]=S.useState(!1),[C,T]=S.useState(!1),[M,j]=S.useState({grade:"",subject:"",goals:[],experience:"",duration:60,format:"online",city:"",date:"",startTime:"",comment:""}),[O,B]=S.useState(!1),[F,K]=S.useState(null),[G,ae]=S.useState(!1),[H,Y]=S.useState(!1),[U,Z]=S.useState(null),[re,W]=S.useState(()=>{const D=new Date,z=D.getDay(),X=D.getDate()-z+(z===0?-6:1);return new Date(D.setDate(X))}),[de,xe]=S.useState(null),[me,we]=S.useState(null),[Ne,Q]=S.useState(""),[be,J]=S.useState(""),V=["Математика","Русский язык","Английский язык"],je=["1","2","3","4","5","6","7","8","9","10","11","Студент","Взрослый"],Ce=["подготовка к экзаменам","помощь с домашним заданием","углубленное изучение","разговорная практика"],Ge=["beginner","experienced","professional"],Je=["online","offline","mini-group"],qe=[45,60],Ee=ri({format:Ye,startOfWeek:At,getDay:ai,locales:{ru:bt}}),[fe,ke]=S.useState([]),We=async()=>{try{console.log("🔄 Загружаем всех преподавателей..."),console.log("🌐 SERVER_URL:",_e),console.log("🔄 Синхронизируем данные с сервера..."),await o(),console.log("📡 Запрашиваем пользователей с сервера...");const D=await fetch(`${_e}/api/users`);if(console.log("📡 Ответ сервера:",D.status,D.statusText),D.ok){const X=D.headers.get("content-type");if(console.log("📡 Content-Type:",X),X&&X.includes("application/json")){const ce=await D.json();console.log("✅ Все пользователи загружены с сервера:",ce.length,ce);const pe=ce.filter(ne=>ne.role==="teacher");if(console.log("✅ Преподаватели найдены:",pe.length,pe),ke(pe),Array.isArray(ce)){const ne=a||[],ge=[...ne];ce.forEach(le=>{ge.find(Ie=>Ie.id===le.id)?console.log("⏭️ Пользователь уже существует:",le.name):(ge.push(le),console.log("➕ Добавлен новый пользователь с сервера:",le.name))}),ge.length!==ne.length&&(m(ge),console.log("✅ Обновлены пользователи, добавлено новых:",ge.length-ne.length))}}else console.warn("⚠️ Сервер вернул не-JSON ответ для пользователей"),ke([])}else console.warn("⚠️ Не удалось загрузить пользователей с сервера:",D.status),ke([]);console.log("📡 Запрашиваем преподавателей через /api/teachers...");const z=await fetch(`${_e}/api/teachers`);if(console.log("📡 Ответ /api/teachers:",z.status,z.statusText),z.ok){const X=z.headers.get("content-type");if(console.log("📡 Content-Type /api/teachers:",X),X&&X.includes("application/json")){const ce=await z.json();console.log("✅ Преподаватели загружены через /api/teachers:",ce.length,ce),ke(pe=>{const ge=[...pe,...ce].filter((le,Re,Ie)=>Re===Ie.findIndex(gt=>gt.id===le.id));return console.log("✅ Объединенные преподаватели:",ge.length,ge),ge});try{const pe=Array.isArray(a)?a:[],ne=[...pe];ce.forEach(le=>{ne.find(Ie=>Ie.id===le.id)||(ne.push(le),console.log("➕ Добавлен новый преподаватель через /api/teachers:",le.name))});const ge=ne.filter((le,Re,Ie)=>Re===Ie.findIndex(gt=>gt.id===le.id));ge.length!==pe.length&&(m(ge),console.log("✅ Обновлены пользователи через /api/teachers, добавлено новых:",ge.length-pe.length))}catch{}}else console.warn("⚠️ Сервер вернул не-JSON ответ для преподавателей")}else console.warn("⚠️ Не удалось загрузить преподавателей через /api/teachers:",z.status)}catch(D){console.error("❌ Ошибка загрузки преподавателей с сервера:",D),ke([])}};S.useEffect(()=>{console.log("🚀 Компонент StudentHome смонтирован, загружаем преподавателей..."),We();const D=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");console.log("📱 Локальные профили преподавателей при монтировании:",Object.keys(D).length);const z=setInterval(()=>{document.visibilityState==="visible"&&(console.log("🔄 Периодическое обновление списка преподавателей (каждые 30 сек)..."),We())},3e4);return()=>clearInterval(z)},[o,n]),S.useEffect(()=>{const D=setTimeout(()=>{J(Ne)},300);return()=>clearTimeout(D)},[Ne]),S.useEffect(()=>{const D=X=>{X.key==="tutoring_users"&&X.newValue&&(console.log("🔄 Обнаружены изменения в пользователях, обновляем список преподавателей"),We())},z=X=>{var ce;((ce=X.detail)==null?void 0:ce.key)==="tutoring_users"&&(console.log("🔄 Обнаружены кастомные изменения в пользователях, обновляем список преподавателей"),We())};return window.addEventListener("storage",D),window.addEventListener("customStorage",z),()=>{window.removeEventListener("storage",D),window.removeEventListener("customStorage",z)}},[]),S.useEffect(()=>{console.log("📱 teacherProfiles изменились:",Object.keys(l).length),Object.keys(l).length>0&&(console.log("✅ Найдены локальные профили преподавателей:",Object.keys(l)),d().catch(console.error),o().catch(console.error))},[l,d,o]);const $e=()=>s.filter(z=>{if(z.isBooked)return!1;const X=new Date(z.date),ce=new Date;return ce.setHours(0,0,0,0),!(X<ce)}),Be=(D=!1)=>{p(!0);try{let z=s.filter(X=>{if(X.isBooked)return!1;const ce=new Date(X.date),pe=new Date;return pe.setHours(0,0,0,0),!(ce<pe)});if(u.grade&&u.grade!==""&&(z=z.filter(X=>X.grades&&X.grades.includes(u.grade))),u.subject&&u.subject!==""&&(z=z.filter(X=>X.subject===u.subject)),u.experience&&u.experience!==""&&(z=z.filter(X=>X.experience===u.experience)),u.format&&u.format!==""&&(z=z.filter(X=>X.format===u.format)),u.duration&&u.duration>0&&(z=z.filter(X=>X.duration===u.duration)),u.minRating&&u.minRating>0&&(z=z.filter(X=>(X.rating||0)>=u.minRating)),u.goals&&u.goals.length>0&&(z=z.filter(X=>X.goals&&u.goals.some(ce=>X.goals.includes(ce)))),de){const X=Ye(de,"yyyy-MM-dd");z=z.filter(ce=>ce.date===X)}me&&(z=z.filter(X=>{const ce=parseInt(X.startTime.split(":")[0]),pe=parseInt(me.start.split(":")[0]),ne=parseInt(me.end.split(":")[0]);return ce>=pe&&ce<ne})),D&&w(!1)}catch(z){console.error("Error applying filters:",z)}finally{p(!1)}},at=()=>{f({}),xe(null),we(null),Q(""),$e(),w(!1)},b=async D=>{v&&F&&(r(F.id,v.id,v.name,D),setTimeout(()=>{Object.keys(u).length===0&&!de&&!me?$e():Be(!1)},100))},P=()=>{if(T(!1),g!=null&&g.current){const D={studentId:v==null?void 0:v.id,studentName:v==null?void 0:v.name,...M};g.current.emit("overbookingRequest",D)}alert("Заявка на овербукинг отправлена! Мы подберем лучшего преподавателя за 5 часов до занятия.")},A=D=>{switch(D){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return D}},E=I.useMemo(()=>{console.log("🔄 Собираем всех преподавателей..."),console.log("📊 Исходные данные:"),console.log("- serverTeachers:",fe.length,fe),console.log("- allUsers:",(a==null?void 0:a.length)||0,a),console.log("- teacherProfiles:",Object.keys(l).length,l),console.log("- timeSlots:",s.length);const D=(a==null?void 0:a.filter(le=>le.role==="teacher").map(le=>{var Re,Ie,gt;return{id:le.id,name:le.name||((Re=le.profile)==null?void 0:Re.name)||"Репетитор",avatar:le.avatar||((Ie=le.profile)==null?void 0:Ie.avatar)||"",rating:((gt=le.profile)==null?void 0:gt.rating)||0,profile:le.profile||{},isRegistered:!0,source:"registered"}}))||[];console.log("👥 ЗАРЕГИСТРИРОВАННЫЕ преподаватели (ПРИОРИТЕТ):",D.length,D);const z=Object.entries(l).map(([le,Re])=>({id:le,name:Re.name||"Репетитор",avatar:Re.avatar||"",rating:Re.rating||0,profile:Re,isRegistered:!1,source:"profiles"}));console.log("📱 Преподаватели из teacherProfiles:",z.length,z);const X=fe.map(le=>{var Re,Ie,gt;return{id:le.id,name:le.name||((Re=le.profile)==null?void 0:Re.name)||"Репетитор",avatar:le.avatar||((Ie=le.profile)==null?void 0:Ie.avatar)||"",rating:((gt=le.profile)==null?void 0:gt.rating)||0,profile:le.profile||{},isRegistered:!1,source:"server"}});console.log("📡 Преподаватели с сервера:",X.length,X);const ce=s.filter(le=>le.teacherId&&le.teacherName).map(le=>({id:le.teacherId,name:le.teacherName,avatar:le.teacherAvatar||"",rating:le.rating||0,profile:{subjects:le.subject?[le.subject]:[],experience:le.experience||"beginner",grades:le.grades||[],goals:le.goals||[],city:"",bio:"",rating:le.rating||0,hourlyRate:le.price||0},isRegistered:!1,source:"slots"}));console.log("📅 Преподаватели из слотов:",ce.length,ce);const pe=[...D,...z,...X,...ce];console.log("🔄 Всего источников:",pe.length);const ne=new Map;D.forEach(le=>{ne.set(le.id,le),console.log("✅ ГАРАНТИРОВАННО добавлен зарегистрированный преподаватель:",le.id,le.name)}),[...z,...X,...ce].forEach(le=>{ne.has(le.id)?console.log("⏭️ Пропущен дубликат преподавателя:",le.id,le.name,le.source):(ne.set(le.id,le),console.log("➕ Добавлен дополнительный преподаватель:",le.id,le.name,le.source))});const ge=Array.from(ne.values());return console.log("✅ Итоговый список всех преподавателей:",ge.length,ge),ge},[fe,a,s,l]);I.useEffect(()=>{if(console.log("🔄 allUsers изменились:",(a==null?void 0:a.length)||0),a&&a.length>0){const D=a.filter(z=>z.role==="teacher");console.log("👨‍🏫 Обнаружены репетиторы в allUsers:",D.length),d().catch(console.error),o().catch(console.error)}},[a,d,o]);const y=I.useMemo(()=>{const D=Object.keys(u).length>0||de||me||be,z=s.filter(pe=>!pe.isBooked),X=new Set(z.map(pe=>pe.teacherId));console.log("🔍 Фильтрация преподавателей:"),console.log("- hasActiveFilters:",D),console.log("- filters:",u),console.log("- selectedDate:",de),console.log("- selectedTimeRange:",me),console.log("- debouncedSearchQuery:",be),console.log("- availableSlots:",z.length),console.log("- teacherIdsWithSlots:",Array.from(X)),console.log("- allTeachers:",E.length);let ce=E;if(console.log("- Показываем ВСЕХ преподавателей (независимо от онлайн статуса):",ce.length),g!=null&&g.current&&h&&(console.log("🔄 Запрашиваем все слоты с сервера для синхронизации..."),g.current.emit("requestAllSlots")),D&&(ce=ce.filter(pe=>{const ne=pe.profile;return!(u.subject&&u.subject!==""&&(!(ne!=null&&ne.subjects)||!ne.subjects.includes(u.subject))||u.experience&&u.experience!==""&&(ne==null?void 0:ne.experience)!==u.experience||u.format&&u.format!==""&&(!(ne!=null&&ne.formats)||!ne.formats.includes(u.format))||u.city&&u.city!==""&&(!(ne!=null&&ne.city)||!ne.city.toLowerCase().includes(u.city.toLowerCase()))||u.minRating&&u.minRating>0&&((ne==null?void 0:ne.rating)||0)<u.minRating||u.duration&&u.duration>0&&(!(ne!=null&&ne.durations)||!ne.durations.includes(u.duration))||u.grade&&u.grade!==""&&(!(ne!=null&&ne.grades)||!ne.grades.includes(u.grade))||u.goals&&u.goals.length>0&&(!(ne!=null&&ne.goals)||!u.goals.some(ge=>ne.goals.includes(ge))))})),be.trim()){const pe=be.toLowerCase().trim();ce=ce.filter(ne=>{const ge=ne.profile;return!!(ne.name.toLowerCase().includes(pe)||ge!=null&&ge.subjects&&ge.subjects.some(le=>le.toLowerCase().includes(pe))||ge!=null&&ge.city&&ge.city.toLowerCase().includes(pe))})}return console.log("✅ StudentHome - Итоговый результат:",ce.length,"преподавателей"),ce},[E,u,de,me,be,s]);function R(D){try{return JSON.parse(localStorage.getItem("tutoring_users")||"[]").find(X=>X.id===D&&X.role==="teacher")||null}catch{return null}}const[$,_]=S.useState(null),[ie,ue]=S.useState(!1),[Se,L]=S.useState(!1);I.useEffect(()=>{Object.keys(u).length>0||de||me?Be():$e(),s.length>0&&(console.log("🔄 timeSlots изменились, синхронизируем с сервером..."),o().catch(console.error))},[u,de,me,s,o]),I.useEffect(()=>{$e(),o().catch(console.error)},[a,o]),I.useEffect(()=>{s.length>0&&(console.log("🔄 timeSlots изменились, принудительно синхронизируем с сервером..."),o().catch(console.error),g!=null&&g.current&&h&&(console.log("🔄 Запрашиваем все слоты с сервера..."),g.current.emit("requestAllSlots")),console.log("🔄 Обновляем преподавателей при изменении слотов..."),n(),d().catch(console.error))},[s,o,g,h,n,d]),I.useEffect(()=>{const D=X=>{X.key==="tutoring_users"&&(n(),ke([]),fetch(`${_e}/api/teachers`).then(ce=>ce.json()).then(ce=>ke(Array.isArray(ce)?ce:[])).catch(()=>ke([])),$e())},z=X=>{var ce;((ce=X.detail)==null?void 0:ce.key)==="tutoring_users"&&(n(),ke([]),fetch(`${_e}/api/teachers`).then(pe=>pe.json()).then(pe=>ke(Array.isArray(pe)?pe:[])).catch(()=>ke([])),$e())};return window.addEventListener("storage",D),window.addEventListener("customStorage",z),()=>{window.removeEventListener("storage",D),window.removeEventListener("customStorage",z)}},[]),I.useEffect(()=>{$e(),g!=null&&g.current&&h&&(console.log("🔄 StudentHome: Запрашиваем все слоты с сервера при монтировании..."),g.current.emit("requestAllSlots"))},[s,g,h]);const ee=async D=>{var X,ce,pe,ne,ge,le,Re,Ie,gt,oi;console.log("Teacher clicked:",D);try{const ks=await fetch(`${_e}/api/users/${D.id}`);if(ks.ok){const lt=await ks.json();if(console.log("Fresh teacher data from server:",lt),lt){const nd=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(di=>di.id===lt.id?lt:di);localStorage.setItem("tutoring_users",JSON.stringify(nd));const ci={id:lt.id,name:lt.name,email:lt.email,avatar:((X=lt.profile)==null?void 0:X.avatar)||lt.avatar,role:"teacher",profile:{...lt.profile,avatar:((ce=lt.profile)==null?void 0:ce.avatar)||lt.avatar,name:lt.name,email:lt.email}};console.log("Updated teacher data for modal:",ci),_(ci),ue(!0);return}}}catch(ks){console.error("Error fetching fresh teacher data:",ks)}let z=R(D.id);z?z={...z,name:D.name||z.name,email:((Re=D.profile)==null?void 0:Re.email)||D.email||z.email,avatar:((Ie=D.profile)==null?void 0:Ie.avatar)||D.avatar||z.avatar,profile:{...z.profile,...D.profile,avatar:((gt=D.profile)==null?void 0:gt.avatar)||D.avatar||z.avatar,name:D.name||z.name,email:((oi=D.profile)==null?void 0:oi.email)||D.email||z.email}}:z={id:D.id,name:D.name,email:((pe=D.profile)==null?void 0:pe.email)||D.email||"",avatar:((ne=D.profile)==null?void 0:ne.avatar)||D.avatar,role:"teacher",profile:{...D.profile,avatar:((ge=D.profile)==null?void 0:ge.avatar)||D.avatar,name:D.name,email:((le=D.profile)==null?void 0:le.email)||D.email}},console.log("Fallback teacher data for modal:",z),_(z),ue(!0)},he=D=>{const z=a.find(X=>X.id===D);z&&(Z(z),Y(!0)),L(!1)},ye=D=>{console.log("🔍 StudentHome handleMessage DEBUG:"),console.log("- Student user:",{id:v==null?void 0:v.id,name:v==null?void 0:v.name,role:v==null?void 0:v.role}),console.log("- Target teacher ID:",D);const z=a.find(X=>X.id===D);if(console.log("- Found teacher:",z),z&&v){console.log("- Sending message to teacher:",{studentId:v.id,teacherId:D,studentName:v.name,teacherName:z.name});const X=c(v.id,v.name,D,z.name,`Привет! Меня зовут ${v.name}. Можете ли вы помочь мне с обучением?`);console.log("- Message sent, chat ID:",X),t("chats")}else console.log("❌ Teacher not found or user not available");console.log("🔍 END StudentHome DEBUG"),L(!1)};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-3",children:"Найди своего идеального репетитора"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Изучай профили преподавателей, связывайся с ними и записывайся на уроки"})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"flex items-center space-x-2 bg-green-50 border border-green-200 rounded-full px-4 py-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx(Vd,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Подключено в реальном времени"})]})})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap justify-center gap-4",children:[e.jsxs("button",{onClick:()=>T(!0),className:"group bg-gradient-to-r from-green-500 via-emerald-500 to-teal-500 text-white px-6 py-3 rounded-xl font-semibold text-base hover:from-green-600 hover:via-emerald-600 hover:to-teal-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Ae,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Овербукинг"}),e.jsx("div",{className:"text-xs opacity-90",children:"Автоподбор"})]})]}),e.jsxs("button",{onClick:()=>ae(!0),className:"group bg-gradient-to-r from-purple-500 via-pink-500 to-rose-500 text-white px-6 py-3 rounded-xl font-semibold text-base hover:from-purple-600 hover:via-pink-600 hover:to-rose-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Ze,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Календарь"}),e.jsx("div",{className:"text-xs opacity-90",children:"Слоты"})]})]})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative group",children:[e.jsx(Kr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{type:"text",value:Ne,onChange:D=>Q(D.target.value),placeholder:"🔍 Поиск по предмету, преподавателю или городу...",className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base placeholder-gray-400"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>w(!N),className:`flex items-center space-x-2 px-4 py-2.5 rounded-xl font-medium transition-all duration-200 text-sm ${N?"bg-blue-600 text-white shadow-md":"bg-white border-2 border-gray-200 text-gray-700 hover:border-blue-300 hover:bg-blue-50"}`,children:[e.jsx(dn,{className:"h-4 w-4"}),e.jsx("span",{children:"Фильтры"}),(Object.keys(u).length>0||de||me||Ne.trim())&&e.jsx("span",{className:"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded-full text-xs font-bold",children:Object.keys(u).length+(de?1:0)+(me?1:0)+(Ne.trim()?1:0)})]}),e.jsx("button",{onClick:()=>Be(!0),disabled:k,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2.5 rounded-xl font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 flex items-center space-x-2 text-sm",children:k?e.jsxs(e.Fragment,{children:[e.jsx(Us,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Применение..."})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Применить"})})}),(Object.keys(u).length>0||de||me||Ne.trim())&&e.jsx("button",{onClick:at,className:"bg-white border-2 border-gray-300 text-gray-700 px-4 py-2.5 rounded-xl font-medium hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 text-sm",children:"Сбросить"})]})]}),N&&e.jsxs("div",{className:"bg-white p-6 rounded-2xl border-2 border-gray-100 shadow-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Класс"}),e.jsxs("select",{value:u.grade||"",onChange:D=>f({...u,grade:D.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой класс"}),je.map(D=>e.jsx("option",{value:D,children:D},D))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Предмет"}),e.jsxs("select",{value:u.subject||"",onChange:D=>f({...u,subject:D.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой предмет"}),V.map(D=>e.jsx("option",{value:D,children:D},D))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Опыт"}),e.jsxs("select",{value:u.experience||"",onChange:D=>f({...u,experience:D.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой опыт"}),Ge.map(D=>e.jsx("option",{value:D,children:A(D)},D))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Формат"}),e.jsxs("select",{value:u.format||"",onChange:D=>f({...u,format:D.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой формат"}),Je.map(D=>e.jsx("option",{value:D,children:D==="online"?"Онлайн":D==="offline"?"Оффлайн":"Мини-группа"},D))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Длительность"}),e.jsxs("select",{value:u.duration||"",onChange:D=>f({...u,duration:D.target.value?parseInt(D.target.value):void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любая длительность"}),qe.map(D=>e.jsxs("option",{value:D,children:[D," мин"]},D))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Мин. рейтинг"}),e.jsxs("select",{value:u.minRating||"",onChange:D=>f({...u,minRating:D.target.value?parseFloat(D.target.value):void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой рейтинг"}),e.jsx("option",{value:"4",children:"4+ звезды"}),e.jsx("option",{value:"4.5",children:"4.5+ звезды"}),e.jsx("option",{value:"5",children:"5 звезд"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Город"}),e.jsx("input",{type:"text",value:u.city||"",onChange:D=>f({...u,city:D.target.value}),placeholder:"Введите город",className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Цели обучения"}),e.jsxs("select",{value:((ut=u.goals)==null?void 0:ut[0])||"",onChange:D=>f({...u,goals:D.target.value?[D.target.value]:void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любые цели"}),Ce.map(D=>e.jsx("option",{value:D,children:D},D))]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4 text-center",children:"Выберите дату и время"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Дата"}),e.jsx("div",{className:"border-2 border-gray-200 rounded-2xl overflow-hidden shadow-lg",children:e.jsx(ti,{localizer:Ee,events:[],startAccessor:"start",endAccessor:"end",style:{height:280},views:["month"],view:"month",selectable:!0,onSelectSlot:D=>{xe(D.start)},onSelectEvent:()=>{}})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Время"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Начало"}),e.jsx("input",{type:"time",value:(me==null?void 0:me.start)||"",onChange:D=>we(z=>({start:D.target.value,end:(z==null?void 0:z.end)||"23:00"})),className:"w-full p-3 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Конец"}),e.jsx("input",{type:"time",value:(me==null?void 0:me.end)||"",onChange:D=>we(z=>({start:(z==null?void 0:z.start)||"00:00",end:D.target.value})),className:"w-full p-3 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base"})]})]}),de&&e.jsxs("div",{className:"mt-4 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ze,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Выбрана дата:"})]}),e.jsx("p",{className:"text-base font-medium text-blue-900",children:Ye(de,"dd MMMM yyyy",{locale:bt})})]})]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:y.length>0?`Найдено ${y.length} преподавателей`:"Преподаватели"}),e.jsxs("button",{onClick:x,className:"px-3 py-1 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm flex items-center gap-2",title:"Обновить список преподавателей",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Обновить"]})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:y.length>0?"Зарегистрированные преподаватели всегда доступны для связи и бронирования уроков":"Попробуйте изменить фильтры или воспользоваться овербукингом"}),y.length>0&&e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 text-green-600 text-xs",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{children:"Все репетиторы доступны 24/7"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:y.length===0?e.jsx(PC,{title:Object.keys(u).length>0||de||me?"Нет преподавателей подходящих под фильтры":"Нет зарегистрированных преподавателей",description:Object.keys(u).length>0||de||me?"Попробуйте изменить фильтры или воспользоваться овербукингом":"Попробуйте воспользоваться овербукингом или обратитесь к администратору",actionPrimary:{label:"Овербукинг",onClick:()=>T(!0)},actionSecondary:{label:"Сбросить фильтры",onClick:at,variant:"secondary"}}):e.jsx(e.Fragment,{children:y.map(D=>{const z=D.profile,pe=s.filter(ne=>ne.teacherId===D.id).filter(ne=>!ne.isBooked).length>0;return e.jsxs("div",{className:"bg-white rounded-3xl border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer group overflow-hidden transform hover:-translate-y-2",onClick:()=>ee(D),children:[e.jsxs("div",{className:"h-32 relative overflow-hidden",style:{background:z!=null&&z.cardBackground?z.cardBackground.startsWith("http")||z.cardBackground.startsWith("data:")?`url(${z.cardBackground}) center/cover`:z.cardBackground:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsxs("div",{className:"absolute top-3 right-3 flex items-center space-x-2",children:[e.jsx("button",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-full text-white hover:bg-white/30 transition-colors border border-white/30",onClick:ne=>{ne.stopPropagation()},children:e.jsx(mt,{className:"h-3 w-3"})}),e.jsx("button",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-full text-white hover:bg-white/30 transition-colors border border-white/30",onClick:ne=>{ne.stopPropagation()},children:e.jsx(qt,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"relative -mt-12 flex justify-center",children:e.jsxs("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-2 border-white rounded-full shadow-lg animate-pulse",title:"Зарегистрированный репетитор (всегда доступен)"}),(()=>{const ne=(z==null?void 0:z.avatar)||D.avatar;return ne&&ne.trim()!==""&&ne!=="undefined"&&ne!=="null"?e.jsx("img",{src:ne,alt:D.name,className:"w-32 h-32 object-cover rounded-full",onError:le=>{const Re=le.target;Re.style.display="none";const Ie=Re.nextElementSibling;Ie&&Ie.classList.remove("hidden")},onLoad:le=>{const Ie=le.target.nextElementSibling;Ie&&Ie.classList.add("hidden")}}):null})(),e.jsx("div",{className:`w-32 h-32 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${(()=>{const ne=(z==null?void 0:z.avatar)||D.avatar;return ne&&ne.trim()!==""&&ne!=="undefined"&&ne!=="null"?"hidden":""})()}`,children:e.jsx(ve,{className:"h-16 w-16 text-white"})})]})}),e.jsxs("div",{className:"px-6 pb-6 pt-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:(z==null?void 0:z.name)||D.name||"Репетитор"}),e.jsx("p",{className:"text-sm text-gray-600",children:(z==null?void 0:z.teacherType)==="private"?"Частный преподаватель":(z==null?void 0:z.teacherType)==="school"?"Преподаватель школы":(z==null?void 0:z.teacherType)==="both"?"Частный + Школа":"Частный преподаватель"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-600 mb-4",children:[(z==null?void 0:z.age)&&e.jsxs("span",{children:["возраст ",z.age," лет"]}),(z==null?void 0:z.experienceYears)&&e.jsxs("span",{children:["стаж ",z.experienceYears," лет"]})]}),e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsxs("div",{className:"flex items-center space-x-1 bg-green-50 px-3 py-1.5 rounded-full",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:z!=null&&z.reviewsCount&&z.reviewsCount>0?`${z.reviewsCount} отзывов`:"отзывов нет"})]})}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-sm text-gray-600",children:[e.jsx(ht,{className:"h-4 w-4"}),e.jsx("span",{children:(z==null?void 0:z.city)||"Город не указан"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:ne=>{ne.stopPropagation(),pe?(Z(D),Y(!0)):ee(D)},className:`w-full py-3 rounded-xl font-semibold transition-all duration-200 text-base ${pe?"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1":"bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1"}`,children:pe?"Забронировать урок":"Связаться с репетитором"}),e.jsx("button",{onClick:ne=>{ne.stopPropagation(),ee(D)},className:"w-full py-2 text-gray-500 hover:text-blue-600 transition-colors text-sm font-medium",children:"Подробнее →"})]})]})]},D.id)})})})]}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Овербукинг - Автоподбор преподавателя"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Заполните форму, и мы автоматически подберем лучшего доступного преподавателя за 5 часов до занятия"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Класс"}),e.jsxs("select",{value:M.grade,onChange:D=>j({...M,grade:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Выберите класс"}),je.map(D=>e.jsx("option",{value:D,children:D},D))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предмет"}),e.jsxs("select",{value:M.subject,onChange:D=>j({...M,subject:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Выберите предмет"}),V.map(D=>e.jsx("option",{value:D,children:D},D))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md-grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата занятия"}),e.jsx("input",{type:"date",value:M.date,onChange:D=>j({...M,date:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Время начала"}),e.jsx("input",{type:"time",value:M.startTime,onChange:D=>j({...M,startTime:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цель занятий"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ce.map(D=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:M.goals.includes(D),onChange:z=>{z.target.checked?j({...M,goals:[...M.goals,D]}):j({...M,goals:M.goals.filter(X=>X!==D)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:D})]},D))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Опыт преподавателя"}),e.jsxs("select",{value:M.experience,onChange:D=>j({...M,experience:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Любой"}),Ge.map(D=>e.jsx("option",{value:D,children:A(D)},D))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Продолжительность"}),e.jsx("select",{value:M.duration,onChange:D=>j({...M,duration:Number(D.target.value)}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:qe.map(D=>e.jsxs("option",{value:D,children:[D," мин"]},D))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Формат"}),e.jsx("select",{value:M.format,onChange:D=>j({...M,format:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Je.map(D=>e.jsx("option",{value:D,children:D==="online"?"Онлайн":D==="offline"?"Оффлайн":"Мини-группа"},D))})]})]}),M.format==="offline"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Город"}),e.jsx("input",{type:"text",value:M.city,onChange:D=>j({...M,city:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Введите ваш город"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Примечание"}),e.jsx("textarea",{value:M.comment,onChange:D=>j({...M,comment:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Например: хочу разобрать домашнее задание или подготовиться к контрольной..."})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-6",children:[e.jsx("button",{onClick:P,disabled:!M.grade||!M.subject||!M.date||!M.startTime,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white py-3 px-4 rounded-lg font-medium hover:from-green-600 hover:to-emerald-600 transition-all duration-200 disabled:opacity-50",children:"Отправить заявку"}),e.jsx("button",{onClick:()=>T(!1),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Отмена"})]})]})})}),ie&&$&&e.jsx(OC,{teacher:$,onClose:()=>ue(!1),onBookLesson:D=>{ue(!1),he(D)},onMessage:D=>{ue(!1),ye(D)}}),O&&F&&v&&e.jsx(ii,{isOpen:O,onClose:()=>{B(!1),K(null)},onConfirm:b,slot:F,teacher:R(F.teacherId),student:v}),Se&&$&&e.jsx(td,{teacher:$,onClose:()=>L(!1),onBookLesson:he,onMessage:ye}),G&&e.jsx(rd,{onClose:()=>ae(!1)}),H&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center",children:e.jsx(ve,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Календарь ",(U==null?void 0:U.name)||"Преподавателя"]}),e.jsx("p",{className:"text-gray-600",children:"Выберите удобное время для занятия"})]})]}),e.jsx("button",{onClick:()=>{Y(!1),Z(null)},className:"p-2 rounded-full hover:bg-gray-100",children:e.jsx(Ve,{className:"w-5 h-5 text-gray-600"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{const D=new Date(re);D.setDate(D.getDate()-7),W(D)},className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[re.toLocaleDateString("ru-RU",{day:"numeric",month:"long"})," — ",new Date(re.getTime()+6*24*60*60*1e3).toLocaleDateString("ru-RU",{day:"numeric",month:"long"})]}),e.jsx("button",{onClick:()=>{const D=new Date(re);D.setDate(D.getDate()+7),W(D)},className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("button",{onClick:()=>{const D=new Date,z=D.getDay(),X=D.getDate()-z+(z===0?-6:1);W(new Date(D.setDate(X)))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:"Сегодня"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-200 bg-gray-50",children:[e.jsx("div",{className:"w-20 p-3 border-r border-gray-200"}),Array.from({length:7},(D,z)=>{const X=new Date(re);return X.setDate(X.getDate()+z),e.jsxs("div",{className:"flex-1 p-3 border-r border-gray-200 last:border-r-0 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.toLocaleDateString("ru-RU",{weekday:"short"})}),e.jsx("div",{className:"text-xs text-gray-600",children:X.toLocaleDateString("ru-RU",{day:"numeric",month:"short"})})]},z)})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:Array.from({length:24},(D,z)=>z).map(D=>e.jsxs("div",{className:"flex border-b border-gray-200 last:border-b-0",children:[e.jsxs("div",{className:"w-20 bg-gray-50 p-3 border-r border-gray-200 flex items-center justify-center text-sm font-medium text-gray-600 sticky left-0",children:[D.toString().padStart(2,"0"),":00"]}),Array.from({length:7},(z,X)=>{const ce=new Date(re);ce.setDate(ce.getDate()+X);const pe=ce.toISOString().split("T")[0],ne=s.filter(ge=>ge.teacherId===(U==null?void 0:U.id)&&!ge.isBooked&&ge.date===pe&&parseInt(ge.startTime.split(":")[0])===D);return e.jsx("div",{className:"flex-1 p-3 border-r border-gray-200 last:border-r-0 min-h-[60px]",children:ne.map(ge=>e.jsxs("div",{className:"bg-blue-100 border border-blue-300 rounded-lg p-2 mb-2 cursor-pointer hover:bg-blue-200 transition-colors",onClick:()=>{v&&(K(ge),B(!0),Y(!1),Z(null))},children:[e.jsxs("div",{className:"text-xs font-medium text-blue-900",children:[ge.startTime," - ",ge.endTime]}),e.jsx("div",{className:"text-xs text-blue-700",children:ge.subject}),e.jsxs("div",{className:"text-xs text-blue-600",children:[ge.price," ₽"]})]},ge.id))},X)})]},D))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["Доступные слоты: ",s.filter(D=>D.teacherId===(U==null?void 0:U.id)&&!D.isBooked).length]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Нажмите на любой слот в календаре для бронирования"})]})]})]})})]})},Wa=()=>{const{timeSlots:t,lessons:r,createSlot:s,cancelLesson:a,getOrCreateChat:n,completeLesson:i,deleteSlot:o,isConnected:c,socketRef:l}=tt(),{user:d}=Ke(),[m,g]=S.useState(!1),[h,x]=S.useState({date:"",startTime:"",duration:60,subject:"",lessonType:"regular",format:"online",price:1e3}),[v,u]=I.useState(null),[f,N]=I.useState(!1),[w,k]=I.useState(null),[p,C]=S.useState(!1),[T,M]=S.useState([]),[j,O]=S.useState(null),[B,F]=S.useState(!1);I.useEffect(()=>{l.current&&(d!=null&&d.id)&&c&&l.current.emit("subscribeOverbooking",d.id)},[l.current,d==null?void 0:d.id,c]),I.useEffect(()=>{if(!l.current)return;const q=()=>{d!=null&&d.id&&(d!=null&&d.profile)&&c&&l.current.emit("subscribeOverbooking",d.id)};return l.current.off("connect",q),l.current.on("connect",q),d!=null&&d.id&&(d!=null&&d.profile)&&(l.current.emit("subscribeOverbooking",d.id),l.current.on("overbookingRequests",Ee=>{M(Ee),setTimeout(()=>{},100)}),l.current.on("newOverbookingRequest",Ee=>{M(fe=>[...fe,Ee])}),l.current.on("overbookingRequestAccepted",Ee=>{M(fe=>fe.filter(ke=>ke.id!==Ee.id))})),()=>{l.current&&(l.current.off("overbookingRequests"),l.current.off("newOverbookingRequest"),l.current.off("overbookingRequestAccepted"),l.current.off("connect",q))}},[d==null?void 0:d.id,d==null?void 0:d.profile,c]),I.useEffect(()=>{d&&d.profile&&Array.isArray(d.profile.subjects)&&d.profile.subjects.length>=1&&x(q=>({...q,subject:d.profile.subjects[0]}))},[d]);const G=t.filter(q=>q.teacherId===(d==null?void 0:d.id)).filter(q=>!q.isBooked),ae=r.filter(q=>q.teacherId===(d==null?void 0:d.id)),H=ae.filter(q=>q.status==="scheduled"),Y=ae.filter(q=>q.status==="completed"),U=(q,Ee)=>{const fe=new Date(`${q.date}T${q.startTime}`),ke=new Date(`${Ee.date}T${Ee.startTime}`);return fe.getTime()-ke.getTime()},Z=[...G].sort(U),re=[...H].sort(U),W=[...Y].sort(U),de=()=>{if(!d||!h.date||!h.startTime||!h.subject){alert("Пожалуйста, заполните все обязательные поля");return}const q=new Date(`2000-01-01T${h.startTime}`),Ee=new Date(q.getTime()+h.duration*6e4);let fe;d.profile&&d.role==="teacher"&&(fe=d.profile);const ke={teacherId:d.id,teacherName:d.name,teacherAvatar:d.avatar,date:h.date,startTime:h.startTime,endTime:Ee.toTimeString().slice(0,5),duration:h.duration,subject:h.subject,lessonType:h.lessonType,format:h.format,price:h.price,experience:(fe==null?void 0:fe.experience)||"beginner",goals:(fe==null?void 0:fe.goals)||[],grades:(fe==null?void 0:fe.grades)||[],rating:fe==null?void 0:fe.rating,bio:(fe==null?void 0:fe.bio)||"",...h.format==="offline"&&(fe!=null&&fe.city)?{city:fe.city}:{}};s(ke),g(!1),x({date:"",startTime:"",duration:60,subject:"",lessonType:"regular",format:"online",price:1e3})},xe=q=>{d&&(u(q),k(null),N(!0))},me=q=>{d&&(k(q),u(null),N(!0))},we=()=>{N(!1),u(null),k(null)},Ne=async q=>{var fe,ke,We,$e,Be,at;if(!d)return;l.current&&l.current.emit("acceptOverbookingRequest",{requestId:q.id,teacherId:d.id});const Ee={teacherId:d.id,teacherName:d.name,teacherAvatar:d.avatar||"",date:q.date||new Date().toISOString().slice(0,10),startTime:q.startTime||"15:00",endTime:q.endTime||"16:00",duration:q.duration||60,subject:q.subject,lessonType:"regular",format:q.format,price:1e3,experience:((fe=d.profile)==null?void 0:fe.experience)||"beginner",goals:((ke=d.profile)==null?void 0:ke.goals)||[],grades:((We=d.profile)==null?void 0:We.grades)||[],rating:($e=d.profile)==null?void 0:$e.rating,bio:((Be=d.profile)==null?void 0:Be.bio)||"",city:((at=d.profile)==null?void 0:at.city)||""};await s(Ee,q.studentId,q.studentName),C(!1),alert("Вы приняли заявку. Слот создан и забронирован!")},Q=q=>{switch(q){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return q}},be=q=>{switch(q){case"trial":return"Пробный";case"regular":return"Обычный";default:return q}},J=({slot:q,isBooked:Ee,onClick:fe})=>e.jsx("div",{className:`card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden border-l-4 ${Ee?"border-green-500":"border-blue-500"} cursor-pointer`,onClick:fe,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 leading-tight mb-1",children:q.subject}),e.jsxs("div",{className:"text-xs text-gray-500",children:[q.date," • ",q.startTime,"–",q.endTime]})]})}),V=({lesson:q,status:Ee,onClick:fe})=>e.jsx("div",{className:`card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden border-l-4 ${Ee==="completed"?"border-gray-400":"border-green-500"} cursor-pointer`,onClick:fe,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 leading-tight mb-1",children:q.subject}),e.jsxs("div",{className:"text-xs text-gray-500",children:[q.date," • ",q.startTime,"–",q.endTime]})]})}),je=(d==null?void 0:d.profile)&&"overbookingEnabled"in d.profile&&d.profile.overbookingEnabled,Ce=d!=null&&d.profile&&"subjects"in d.profile?d.profile.subjects:[],Ge=[45,60,90],Je=["regular","trial"],qe=["online","offline","mini-group"];return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 relative",children:[je&&e.jsxs("button",{className:"absolute top-0 right-0 p-2 rounded-full hover:bg-gray-100 transition z-10",title:"Уведомления",onClick:()=>C(!0),children:[e.jsx(Gr,{className:"w-7 h-7 text-blue-500"}),T.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full text-xs px-1.5 py-0.5",children:T.length})]}),e.jsx("h1",{className:"text-3xl font-bold gradient-text mb-2",children:"Управление слотами"}),e.jsx("p",{className:"text-gray-600",children:"Создавайте временные слоты для уроков и управляйте своим расписанием"})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:()=>C(!1),title:"Закрыть",children:e.jsx(Ve,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Заявки на овербукинг"}),T.length===0?e.jsx("div",{className:"text-gray-500 text-center",children:"Нет новых заявок"}):e.jsx("div",{className:"space-y-2",children:T.map(q=>e.jsxs("div",{className:"flex items-center gap-2 border rounded-lg px-3 py-2 bg-purple-50 cursor-pointer hover:bg-purple-100 transition",onClick:()=>{O(q),F(!0)},children:[e.jsx("span",{className:"font-semibold text-purple-800",children:q.studentName}),e.jsx("span",{className:"text-xs text-gray-500",children:q.subject}),e.jsx("span",{className:"text-xs text-gray-500",children:q.startTime||"—"})]},q.id))})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>g(!0),className:"btn-primary flex items-center space-x-2",children:[e.jsx(Vr,{className:"h-5 w-5"}),e.jsx("span",{children:"Создать новый слот"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700 mb-4",children:"Свободные слоты"}),Z.length>0?e.jsx("div",{className:"space-y-4",children:Z.map(q=>e.jsx(J,{slot:q,isBooked:!1,onClick:()=>xe(q)},q.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет свободных слотов"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-green-700 mb-4",children:"Забронированные уроки"}),re.length>0?e.jsx("div",{className:"space-y-4",children:re.map(q=>e.jsx(V,{lesson:q,status:"scheduled",onClick:()=>me(q)},q.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет забронированных уроков"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4",children:"Завершённые уроки"}),W.length>0?e.jsx("div",{className:"space-y-4",children:W.map(q=>e.jsx(V,{lesson:q,status:"completed",onClick:()=>me(q)},q.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет завершённых уроков"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-purple-700 mb-4",children:"Овербукинг"}),e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет новых заявок"})]})]}),m&&e.jsx("div",{className:"fixed inset-0 modal-backdrop flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"modal-content bg-white rounded-2xl shadow-2xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold gradient-text",children:"Создать новый слот"}),e.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Предмет *"}),e.jsxs("select",{value:h.subject,onChange:q=>x({...h,subject:q.target.value}),className:"input-modern w-full",children:[e.jsx("option",{value:"",children:"Выберите предмет"}),Ce.map(q=>e.jsx("option",{value:q,children:q},q))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Дата *"}),e.jsx("input",{type:"date",value:h.date,onChange:q=>x({...h,date:q.target.value}),className:"input-modern w-full",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Время начала *"}),e.jsx("input",{type:"time",value:h.startTime,onChange:q=>x({...h,startTime:q.target.value}),className:"input-modern w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Длительность"}),e.jsx("select",{value:h.duration,onChange:q=>x({...h,duration:parseInt(q.target.value)}),className:"input-modern w-full",children:Ge.map(q=>e.jsxs("option",{value:q,children:[q," минут"]},q))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Цена (₽)"}),e.jsx("input",{type:"number",value:h.price,onChange:q=>x({...h,price:parseInt(q.target.value)}),className:"input-modern w-full",min:"100",step:"100"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Тип урока"}),e.jsx("select",{value:h.lessonType,onChange:q=>x({...h,lessonType:q.target.value}),className:"input-modern w-full",children:Je.map(q=>e.jsx("option",{value:q,children:be(q)},q))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Формат"}),e.jsx("select",{value:h.format,onChange:q=>x({...h,format:q.target.value}),className:"input-modern w-full",children:qe.map(q=>e.jsx("option",{value:q,children:Q(q)},q))})]})]}),e.jsxs("div",{className:"flex space-x-4 pt-4",children:[e.jsx("button",{onClick:de,className:"btn-primary flex-1",children:"Создать слот"}),e.jsx("button",{onClick:()=>g(!1),className:"btn-secondary flex-1",children:"Отмена"})]})]})]})})}),f&&(v||w)&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[e.jsx("button",{onClick:we,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:v?"Детали слота":"Детали урока"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Предмет:"})," ",(v||w).subject]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Дата:"})," ",(v||w).date," ",(v||w).startTime," - ",(v||w).endTime]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Формат:"})," ",(v||w).format]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Цена:"})," ",(v||w).price,"₽"]}),v&&v.studentName&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",v.studentName]}),w&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",w.studentName]}),((w==null?void 0:w.comment)||(v==null?void 0:v.comment))&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-blue-900",children:[e.jsx("span",{className:"font-medium",children:"Комментарий ученика:"})," ",(w==null?void 0:w.comment)||(v==null?void 0:v.comment)]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[v&&v.isBooked&&v.studentId&&d&&e.jsxs("button",{onClick:()=>{n(d.id,v.studentId,d.name,v.studentName),we()},className:"flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200",children:[e.jsx(Ue,{className:"w-5 h-5"})," Чат с учеником"]}),v&&v.isBooked&&v.format==="online"&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(Ut,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Видеозвонок"})]})}),v&&v.isBooked&&e.jsxs("button",{onClick:()=>{i(v.lessonId),we()},className:"flex items-center gap-2 bg-amber-100 text-amber-700 px-4 py-2 rounded-lg hover:bg-amber-200",children:[e.jsx(yr,{className:"w-5 h-5"})," Завершить урок"]}),v&&e.jsx("button",{onClick:()=>{o(v.id),we()},className:"absolute top-4 left-4 text-red-500 hover:text-red-700",children:e.jsx(Xr,{className:"w-6 h-6"})}),w&&w.status==="scheduled"&&d&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{n(d.id,w.studentId,d.name,w.studentName),we()},className:"flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200",children:[e.jsx(Ue,{className:"w-5 h-5"})," Чат с учеником"]}),w.format==="online"&&e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(Ut,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Видеозвонок"})]}),e.jsxs("button",{onClick:()=>{i(w.id),we()},className:"flex items-center gap-2 bg-amber-100 text-amber-700 px-4 py-2 rounded-lg hover:bg-amber-200",children:[e.jsx(yr,{className:"w-5 h-5"})," Завершить урок"]})]}),w&&w.status==="completed"&&e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg text-center text-gray-800",children:"Урок завершён"})]})]})}),B&&j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[e.jsx("button",{onClick:()=>{F(!1),O(null)},className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Заявка на овербукинг"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",j.studentName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Предмет:"})," ",j.subject]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Класс:"})," ",j.grade]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Формат:"})," ",j.format]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Длительность:"})," ",j.duration," мин"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Время:"})," ",j.startTime||"—"," - ",j.endTime||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Цели:"})," ",Array.isArray(j.goals)?j.goals.join(", "):j.goals]}),j.comment&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-blue-900",children:[e.jsx("span",{className:"font-medium",children:"Комментарий:"})," ",j.comment]})]}),e.jsx("button",{className:"mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",onClick:()=>{Ne(j),F(!1),O(null)},children:"Забронировать слот"})]})})]})},_C={ru:bt},AC=ri({format:Ye,startOfWeek:At,getDay:ai,locales:_C}),sd=({mode:t,student:r,onAssign:s})=>{const{timeSlots:a,lessons:n,bookLesson:i,createSlot:o}=tt(),{user:c}=Ke(),[l,d]=S.useState(null),[m,g]=S.useState(!1),[h,x]=S.useState(""),[v,u]=S.useState(!1),[f,N]=S.useState(!1),[w,k]=S.useState({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),[p,C]=S.useState(!1),[T,M]=S.useState(null),[j,O]=S.useState(!1),[B,F]=S.useState(""),K=a.filter(Q=>{if(Q.teacherId!==(c==null?void 0:c.id)||Q.status==="completed")return!1;if(t==="assign"&&r){if(Q.isBooked&&Q.bookedStudentId!==r.id)return!1}else if(Q.isBooked)return!1;return!0}),G=n.filter(Q=>Q.teacherId===(c==null?void 0:c.id)&&Q.status!=="completed"),ae=t==="assign"?a.filter(Q=>Q.teacherId===(c==null?void 0:c.id)&&Q.status!=="completed"):K,H=t==="assign"?n.filter(Q=>Q.teacherId===(c==null?void 0:c.id)&&Q.status!=="completed"):G,Y=ae.map(Q=>({id:Q.id,title:`${Q.subject} - ${Q.isBooked?"Забронирован":"Свободен"}`,start:new Date(`${Q.date}T${Q.startTime}`),end:new Date(`${Q.date}T${Q.endTime}`),resource:Q,type:"slot",isBooked:Q.isBooked,subject:Q.subject,price:Q.price,format:Q.format,lessonType:Q.lessonType})),U=H.map(Q=>({id:Q.id,title:`${Q.subject} - ${Q.studentName}`,start:new Date(`${Q.date}T${Q.startTime}`),end:new Date(`${Q.date}T${Q.endTime}`),resource:Q,type:"lesson",studentName:Q.studentName,subject:Q.subject,price:Q.price,format:Q.format,status:Q.status})),Z=[...Y,...U],re=S.useCallback(Q=>{let be={borderRadius:"8px",border:"none",padding:"4px 8px",fontSize:"12px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",transition:"all 0.2s ease"};return Q.type==="slot"?Q.isBooked?(be.backgroundColor="#10b981",be.color="white"):(be.backgroundColor="#3b82f6",be.color="white"):Q.type==="lesson"&&(be.backgroundColor="#f59e0b",be.color="white"),{style:be}},[]),W=S.useCallback(Q=>{d(Q),g(!0),x("")},[]),de=()=>{g(!1),d(null),x("")},xe=async Q=>{t==="assign"&&r&&(await i(Q.id,r.id,r.name),s&&s())},me=S.useCallback(Q=>{const{start:be,end:J}=Q,V=Ye(be,"yyyy-MM-dd"),je=Ye(be,"HH:mm"),Ce=Ye(J,"HH:mm");k({date:V,startTime:je,endTime:Ce,subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),N(!0)},[]),we=async()=>{if(!c||!w.subject.trim()){alert("Пожалуйста, заполните все обязательные поля");return}if(!w.startTime||!w.endTime||w.startTime>=w.endTime){alert("Проверьте корректность времени начала и окончания");return}C(!0);try{if(t==="assign"&&r){await o({...w,teacherId:c.id,teacherName:c.name,duration:60,lessonType:w.lessonType,format:w.format,experience:w.experience,goals:w.goals||[],grades:w.grades||[]},r.id,r.name,{mode:"assign"}),N(!1),k({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]});return}await o({...w,teacherId:c.id,teacherName:c.name,duration:60,lessonType:w.lessonType,format:w.format,experience:w.experience,goals:w.goals||[],grades:w.grades||[]}),N(!1),k({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),alert("Слот успешно создан!")}catch{alert("Ошибка при создании слота")}finally{C(!1)}},Ne=async Q=>{if(r){O(!0);try{await i(Q.id,r.id,r.name),F(`Урок назначен для ${r.name}`),setTimeout(()=>{F(""),M(null),s&&s()},1200)}catch{alert("Ошибка при бронировании слота")}finally{O(!1)}}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 p-2",children:[e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-1",children:"Календарь занятий"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Управляйте своим расписанием и отслеживайте забронированные уроки"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"p-3",children:e.jsx(ti,{localizer:AC,events:Z,startAccessor:"start",endAccessor:"end",style:{height:400},eventPropGetter:re,onSelectEvent:W,onSelectSlot:me,selectable:!0,views:["month","week","day"],messages:{next:"Следующий",previous:"Предыдущий",today:"Сегодня",month:"Месяц",week:"Неделя",day:"День",noEventsInRange:"Нет событий в выбранном диапазоне",showMore:Q=>`+${Q} еще`},className:"custom-calendar"})})}),e.jsxs("div",{className:"mt-3 bg-white rounded-lg shadow-sm border border-gray-100 p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Легенда"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Свободные слоты"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Забронированные слоты"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Запланированные уроки"})]})]})]})]}),m&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-xs w-full p-3 transform transition-all duration-300 scale-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900",children:l.type==="slot"?"Детали слота":"Детали урока"}),e.jsx("button",{onClick:de,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Предмет:"}),e.jsx("p",{className:"text-xs text-gray-900",children:l.subject})]}),l.type==="slot"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Статус:"}),e.jsx("p",{className:`text-xs font-medium ${l.isBooked?"text-green-600":"text-blue-600"}`,children:l.isBooked?"Забронирован":"Свободен"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Тип урока:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:l.lessonType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Формат:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:l.format})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Цена:"}),e.jsxs("p",{className:"text-xs text-gray-900",children:[l.price," ₽"]})]}),!l.isBooked&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Имя студента для бронирования:"}),e.jsx("input",{type:"text",value:h,onChange:Q=>x(Q.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"Введите имя студента"}),e.jsx("button",{onClick:()=>xe(l.resource),disabled:v,className:"mt-2 px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:v?"Бронирую...":"Забронировать слот"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Ученик:"}),e.jsx("p",{className:"text-xs text-gray-900",children:l.studentName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Статус:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:l.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Формат:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:l.format})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Цена:"}),e.jsxs("p",{className:"text-xs text-gray-900",children:[l.price," ₽"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Время:"}),e.jsxs("p",{className:"text-gray-900 text-xs",children:[Ye(l.start,"HH:mm")," - ",Ye(l.end,"HH:mm")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Дата:"}),e.jsx("p",{className:"text-gray-900 text-xs",children:Ye(l.start,"dd MMMM yyyy",{locale:bt})})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:de,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Закрыть"})})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-sm w-full p-4 transform transition-all duration-300 scale-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Создать новый слот"}),e.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Предмет *"}),e.jsx("input",{type:"text",value:w.subject,onChange:Q=>k({...w,subject:Q.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"Например: Математика",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Время начала"}),e.jsx("input",{type:"time",value:w.startTime,onChange:Q=>k({...w,startTime:Q.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Время окончания"}),e.jsx("input",{type:"time",value:w.endTime,onChange:Q=>k({...w,endTime:Q.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Тип урока"}),e.jsxs("select",{value:w.lessonType,onChange:Q=>k({...w,lessonType:Q.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"regular",children:"Обычный"}),e.jsx("option",{value:"trial",children:"Пробный"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Формат"}),e.jsxs("select",{value:w.format,onChange:Q=>k({...w,format:Q.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"online",children:"Онлайн"}),e.jsx("option",{value:"offline",children:"Офлайн"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Цена (₽)"}),e.jsx("input",{type:"number",value:w.price,onChange:Q=>k({...w,price:parseInt(Q.target.value)||0}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"1000",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Опыт"}),e.jsxs("select",{value:w.experience,onChange:Q=>k({...w,experience:Q.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>N(!1),className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Отмена"}),e.jsx("button",{onClick:we,disabled:p||!w.subject.trim(),className:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:p?"Создаю...":"Создать слот"})]})]})}),t==="assign"&&r&&T&&!T.isBooked&&e.jsx("button",{onClick:()=>Ne(T),disabled:j,style:{marginTop:12,padding:"6px 16px",fontSize:14},children:j?"Назначение...":`Забронировать для ${r.name}`}),B&&e.jsx("div",{style:{color:"green",marginTop:8,fontSize:14},children:B})]})},RC={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},IC={background:"#fff",borderRadius:12,boxShadow:"0 2px 16px rgba(0,0,0,0.15)",padding:24,minWidth:320,maxHeight:"90vh",overflowY:"auto",position:"relative"},LC={position:"absolute",top:12,right:16,fontSize:24,background:"none",border:"none",cursor:"pointer",color:"#888"},br=({open:t,onClose:r,children:s,style:a})=>t?e.jsx("div",{style:RC,onClick:r,children:e.jsxs("div",{style:{...IC,...a},onClick:n=>n.stopPropagation(),children:[e.jsx("button",{style:LC,onClick:r,"aria-label":"Закрыть",children:"×"}),s]})}):null,li=({onSubmit:t,onCancel:r,initialText:s="",isEditing:a=!1,userName:n="U",userAvatar:i})=>{const[o,c]=S.useState(s),[l,d]=S.useState([]),[m,g]=S.useState([]),h=S.useRef(null),x=N=>{const w=Array.from(N.target.files||[]);if(w.length===0)return;const k=[...l,...w];d(k);const p=w.map(C=>URL.createObjectURL(C));g([...m,...p]),h.current&&(h.current.value="")},v=N=>{const w=l.filter((p,C)=>C!==N),k=m.filter((p,C)=>C!==N);d(w),g(k)},u=()=>{if(!o.trim()&&l.length===0)return;const N=l.length>0?l.some(k=>k.type.startsWith("video/"))?"video":"image":"text",w={text:o.trim(),media:l,type:N};t(w),m.forEach(k=>URL.revokeObjectURL(k))},f=!o.trim()&&l.length===0;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center overflow-hidden",children:i?e.jsx("img",{src:i,alt:n,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:n.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{value:o,onChange:N=>c(N.target.value),placeholder:a?"Редактировать запись...":"Что нового?",className:"w-full border-none resize-none focus:ring-0 text-gray-900 placeholder-gray-500",rows:3}),m.length>0&&e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2",children:m.map((N,w)=>{var k;return e.jsxs("div",{className:"relative group",children:[(k=l[w])!=null&&k.type.startsWith("video/")?e.jsx("video",{src:N,className:"w-full h-24 object-cover rounded-lg",controls:!0}):e.jsx("img",{src:N,alt:"Preview",className:"w-full h-24 object-cover rounded-lg"}),e.jsx("button",{onClick:()=>v(w),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ve,{className:"w-3 h-3"})})]},w)})}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{var N;return(N=h.current)==null?void 0:N.click()},className:"p-2 text-gray-500 hover:text-blue-500 transition-colors",title:"Добавить фото или видео",children:e.jsx(Ba,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-500 hover:text-blue-500 transition-colors",children:e.jsx(hn,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Отмена"}),e.jsx("button",{onClick:u,disabled:f,className:`px-4 py-2 rounded-lg font-medium transition-colors ${f?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:a?"Сохранить":"Опубликовать"})]})]})]})]}),e.jsx("input",{ref:h,type:"file",multiple:!0,accept:"image/*,video/*",onChange:x,className:"hidden"})]})},on=({post:t,onReaction:r,onComment:s,onShare:a,onBookmark:n,onEdit:i,onDelete:o})=>{const[c,l]=S.useState(!1),[d,m]=S.useState(""),[g,h]=S.useState(!1),[x,v]=S.useState(!1),u=p=>{r(t.id,p),v(!1)},f=()=>{d.trim()&&(s(t.id,d.trim()),m(""))},N=p=>{i&&(i(t.id,p),h(!1))},w=()=>{o&&o(t.id)},k=p=>{const C=new Date(p),M=Math.floor((new Date().getTime()-C.getTime())/(1e3*60*60));return M<1?"только что":M<24?`${M}ч назад`:M<48?"вчера":C.toLocaleDateString("ru-RU")};return t.reactions.reduce((p,C)=>p+C.count,0),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 mb-4",children:[e.jsx("div",{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:t.userAvatar?e.jsx("img",{src:t.userAvatar,alt:t.userName,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:t.userName.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.userName}),e.jsx("div",{className:"text-sm text-gray-500",children:k(t.date)})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(lo,{className:"w-5 h-5"})}),e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10",children:[i&&e.jsx("button",{onClick:()=>h(!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50",children:"Редактировать"}),o&&e.jsx("button",{onClick:w,className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50",children:"Удалить"})]})]})]})}),g&&i&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx(li,{onSubmit:({text:p})=>N(p),onCancel:()=>h(!1),initialText:t.text,isEditing:!0})}),!g&&e.jsxs(e.Fragment,{children:[t.text&&e.jsxs("div",{className:"px-4 pb-3",children:[e.jsx("p",{className:"text-gray-900 whitespace-pre-line",children:t.text}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:t.tags.map(p=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-700 font-medium",children:["#",p]},p))})]}),t.media&&t.media.length>0&&e.jsx("div",{className:"px-4 pb-3",children:t.type==="video"?e.jsxs("div",{className:"relative",children:[e.jsx("video",{src:t.media[0],className:"w-full rounded-lg",controls:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Hd,{className:"w-12 h-12 text-white opacity-80"})})]}):e.jsx("div",{className:`grid gap-2 ${t.media.length===1?"grid-cols-1":t.media.length===2?"grid-cols-2":"grid-cols-3"}`,children:t.media.map((p,C)=>e.jsx("div",{className:"relative aspect-square",children:e.jsx("img",{src:p,alt:"Post media",className:"w-full h-full object-cover rounded-lg"})},C))})}),(t.likes&&t.likes>0||t.comments.length>0||t.views&&t.views>0)&&e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[t.likes&&t.likes>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(mt,{className:"w-4 h-4 text-red-500 fill-current"}),e.jsx("span",{children:t.likes})]}),t.comments.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ue,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:t.comments.length})]}),t.views&&t.views>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Yt,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:t.views})]})]}),t.editedAt&&e.jsx("span",{className:"text-xs text-gray-400",children:"ред."})]})}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>v(!x),className:`flex items-center space-x-1 px-3 py-1 rounded-full transition-colors ${t.reactions.some(p=>p.userReacted)?"text-red-500 bg-red-50":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx(mt,{className:`w-5 h-5 ${t.reactions.some(p=>p.userReacted)?"fill-current":""}`}),e.jsx("span",{className:"text-sm",children:"Нравится"})]}),x&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>u("like"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Нравится",children:e.jsx(uo,{className:"w-6 h-6 text-blue-500"})}),e.jsx("button",{onClick:()=>u("love"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Любовь",children:e.jsx(mt,{className:"w-6 h-6 text-red-500"})}),e.jsx("button",{onClick:()=>u("smile"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Улыбка",children:e.jsx(hn,{className:"w-6 h-6 text-yellow-500"})})]})]}),e.jsxs("button",{onClick:()=>l(!c),className:"flex items-center space-x-1 px-3 py-1 rounded-full text-gray-500 hover:bg-gray-50 transition-colors",children:[e.jsx(Ue,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Комментировать"})]}),e.jsxs("button",{onClick:()=>a(t.id),className:"flex items-center space-x-1 px-3 py-1 rounded-full text-gray-500 hover:bg-gray-50 transition-colors",children:[e.jsx(zd,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Поделиться"})]})]}),e.jsx("button",{onClick:()=>n(t.id),className:`p-2 rounded-full transition-colors ${t.isBookmarked?"text-blue-500 bg-blue-50":"text-gray-500 hover:bg-gray-50"}`,children:e.jsx(ta,{className:`w-5 h-5 ${t.isBookmarked?"fill-current":""}`})})]})}),c&&e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50",children:[e.jsx("div",{className:"space-y-3 mb-3",children:t.comments.map(p=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:p.userAvatar?e.jsx("img",{src:p.userAvatar,alt:p.userName,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-xs font-medium",children:p.userName.charAt(0).toUpperCase()})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"bg-white rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:p.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:k(p.date)})]}),e.jsx("p",{className:"text-sm text-gray-800",children:p.text})]})})]},p.id))}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:"U"})}),e.jsxs("div",{className:"flex-1 flex items-center space-x-2 bg-white rounded-full px-3 py-2",children:[e.jsx("input",{type:"text",value:d,onChange:p=>m(p.target.value),placeholder:"Написать комментарий...",className:"flex-1 border-none outline-none text-sm",onKeyPress:p=>p.key==="Enter"&&f()}),e.jsx("button",{onClick:f,disabled:!d.trim(),className:`p-1 rounded-full transition-colors ${d.trim()?"text-blue-500 hover:bg-blue-50":"text-gray-400"}`,children:e.jsx(co,{className:"w-4 h-4"})})]})]})]})]})]})},FC=({onSearchResults:t,onClose:r,className:s=""})=>{var Y;const{posts:a,searchPosts:n}=tt(),[i,o]=S.useState(""),[c,l]=S.useState([]),[d,m]=S.useState("all"),[g,h]=S.useState(""),[x,v]=S.useState(""),[u,f]=S.useState(""),[N,w]=S.useState("date"),[k,p]=S.useState(!1),[C,T]=S.useState([]),[M,j]=S.useState(!1),O=S.useRef(),B=Array.from(new Set(a.flatMap(U=>U.tags||[]))).sort(),F=Array.from(new Set(a.map(U=>({id:U.userId,name:U.userName})))).filter((U,Z,re)=>Z===re.findIndex(W=>W.id===U.id)),K=()=>{j(!0);const U={query:i.trim()||void 0,tags:c.length>0?c:void 0,userId:g||void 0,dateFrom:x||void 0,dateTo:u||void 0,type:d==="all"?void 0:d,limit:50};let Z=[...a];if(U.query){const re=U.query.toLowerCase();Z=Z.filter(W=>W.text.toLowerCase().includes(re)||W.userName.toLowerCase().includes(re))}U.tags&&U.tags.length>0&&(Z=Z.filter(re=>re.tags&&U.tags.some(W=>re.tags.includes(W)))),U.userId&&(Z=Z.filter(re=>re.userId===U.userId)),U.type&&(Z=Z.filter(re=>re.type===U.type)),U.dateFrom&&(Z=Z.filter(re=>re.date>=U.dateFrom)),U.dateTo&&(Z=Z.filter(re=>re.date<=U.dateTo)),Z.sort((re,W)=>{switch(N){case"likes":return(W.likes||0)-(re.likes||0);case"comments":return W.comments.length-re.comments.length;case"views":return(W.views||0)-(re.views||0);case"date":default:return new Date(W.date).getTime()-new Date(re.date).getTime()}}),T(Z),j(!1),t&&t(Z),n(U)};S.useEffect(()=>(O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{i.trim()||c.length>0||g||d!=="all"||x||u?K():(T([]),t&&t([]))},300),()=>{O.current&&clearTimeout(O.current)}),[i,c,g,d,x,u,N]);const G=()=>{o(""),l([]),h(""),m("all"),v(""),f(""),w("date"),T([]),t&&t([])},ae=U=>{l(Z=>Z.includes(U)?Z.filter(re=>re!==U):[...Z,U])},H=U=>{const Z=new Date(U),W=Math.floor((new Date().getTime()-Z.getTime())/(1e3*60*60));return W<1?"только что":W<24?`${W}ч назад`:W<48?"вчера":Z.toLocaleDateString("ru-RU")};return e.jsxs("div",{className:`bg-white rounded-2xl shadow-lg border border-gray-200 ${s}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Поиск записей"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>p(!k),className:`p-2 rounded-full transition-colors ${k?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,title:"Фильтры",children:e.jsx(dn,{className:"w-5 h-5"})}),e.jsx("button",{onClick:G,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Очистить поиск",children:e.jsx(Ve,{className:"w-5 h-5"})}),r&&e.jsx("button",{onClick:r,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Закрыть",children:e.jsx(Ve,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mt-4 relative",children:[e.jsx(Kr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:i,onChange:U=>o(U.target.value),placeholder:"Поиск по записям...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),M&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"})})]}),(c.length>0||g||d!=="all"||x||u)&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[c.map(U=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-700",children:[e.jsx(_d,{className:"w-3 h-3 mr-1"}),U,e.jsx("button",{onClick:()=>ae(U),className:"ml-2 hover:bg-blue-200 rounded-full p-0.5",children:e.jsx(Ve,{className:"w-3 h-3"})})]},U)),g&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-700",children:[e.jsx(ve,{className:"w-3 h-3 mr-1"}),((Y=F.find(U=>U.id===g))==null?void 0:Y.name)||g,e.jsx("button",{onClick:()=>h(""),className:"ml-2 hover:bg-green-200 rounded-full p-0.5",children:e.jsx(Ve,{className:"w-3 h-3"})})]}),d!=="all"&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 text-purple-700",children:[d==="text"&&e.jsx(Vt,{className:"w-3 h-3 mr-1"}),d==="image"&&e.jsx(Ba,{className:"w-3 h-3 mr-1"}),d==="video"&&e.jsx(Ut,{className:"w-3 h-3 mr-1"}),d==="text"?"Текст":d==="image"?"Изображения":"Видео",e.jsx("button",{onClick:()=>m("all"),className:"ml-2 hover:bg-purple-200 rounded-full p-0.5",children:e.jsx(Ve,{className:"w-3 h-3"})})]})]})]}),k&&e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тип контента"}),e.jsxs("select",{value:d,onChange:U=>m(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Все типы"}),e.jsx("option",{value:"text",children:"Только текст"}),e.jsx("option",{value:"image",children:"С изображениями"}),e.jsx("option",{value:"video",children:"С видео"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Автор"}),e.jsxs("select",{value:g,onChange:U=>h(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Все авторы"}),F.map(U=>e.jsx("option",{value:U.id,children:U.name},U.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Сортировка"}),e.jsxs("select",{value:N,onChange:U=>w(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"date",children:"По дате"}),e.jsx("option",{value:"likes",children:"По лайкам"}),e.jsx("option",{value:"comments",children:"По комментариям"}),e.jsx("option",{value:"views",children:"По просмотрам"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата от"}),e.jsx("input",{type:"date",value:x,onChange:U=>v(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата до"}),e.jsx("input",{type:"date",value:u,onChange:U=>f(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),B.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Популярные теги"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:B.slice(0,10).map(U=>e.jsxs("button",{onClick:()=>ae(U),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${c.includes(U)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["#",U]},U))})]})]}),C.length>0&&e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Найдено ",C.length," записей"]})}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:C.map(U=>e.jsx("div",{className:"p-3 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center flex-shrink-0",children:U.userAvatar?e.jsx("img",{src:U.userAvatar,alt:U.userName,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:U.userName.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:U.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:H(U.date)}),U.type!=="text"&&e.jsx("span",{className:"text-xs text-gray-500",children:U.type==="image"?e.jsx(Ba,{className:"w-3 h-3 inline"}):e.jsx(Ut,{className:"w-3 h-3 inline"})})]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2 mb-2",children:U.text}),U.tags&&U.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[U.tags.slice(0,3).map(Z=>e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["#",Z]},Z)),U.tags.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",U.tags.length-3]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(mt,{className:"w-3 h-3"}),e.jsx("span",{children:U.likes||0})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(Ue,{className:"w-3 h-3"}),e.jsx("span",{children:U.comments.length})]}),U.views&&e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(Yt,{className:"w-3 h-3"}),e.jsx("span",{children:U.views})]})]})]})]})},U.id))})]}),i.trim()&&C.length===0&&!M&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Kr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"По вашему запросу ничего не найдено"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Попробуйте изменить параметры поиска"})]})]})},UC=({className:t=""})=>{const{notifications:r,markNotificationAsRead:s,markAllNotificationsAsRead:a,deleteNotification:n}=tt(),{user:i}=Ke(),[o,c]=S.useState(!1),[l,d]=S.useState(!1),[m,g]=S.useState("all"),h=S.useRef(null),x=r.filter(p=>!p.isRead).length;S.useEffect(()=>{const p=C=>{h.current&&!h.current.contains(C.target)&&c(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const v=r.filter(p=>m==="unread"?!p.isRead:m==="read"?p.isRead:!0),u=l?v:v.slice(0,5),f=p=>{switch(p){case"new_post":return e.jsx(Vt,{className:"w-5 h-5 text-blue-500"});case"reaction":return e.jsx(mt,{className:"w-5 h-5 text-red-500"});case"comment":return e.jsx(Ue,{className:"w-5 h-5 text-green-500"});case"new_message":return e.jsx(Ue,{className:"w-5 h-5 text-blue-500"});case"follow":return e.jsx(Zr,{className:"w-5 h-5 text-purple-500"});case"lesson_reminder":return e.jsx(Ze,{className:"w-5 h-5 text-orange-500"});case"system":return e.jsx(ra,{className:"w-5 h-5 text-gray-500"});default:return e.jsx(Gr,{className:"w-5 h-5 text-gray-500"})}},N=p=>{const C=new Date(p),M=Math.floor((new Date().getTime()-C.getTime())/(1e3*60));return M<1?"только что":M<60?`${M}м назад`:M<1440?`${Math.floor(M/60)}ч назад`:C.toLocaleDateString("ru-RU")},w=()=>{i&&a(i.id)},k=p=>{var C,T;p.isRead||s(p.id),p.type==="new_message"&&((C=p.data)!=null&&C.chatId)?(window.location.href=`#chat-${p.data.chatId}`,c(!1)):(T=p.data)!=null&&T.postId};return e.jsxs("div",{className:`relative ${t}`,ref:h,children:[e.jsxs("button",{onClick:()=>c(!o),className:"relative p-2 rounded-full hover:bg-gray-100 transition-colors",children:[e.jsx(Gr,{className:"w-6 h-6 text-gray-600"}),x>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:x>99?"99+":x})]}),o&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 bg-white rounded-2xl shadow-2xl border border-gray-200 z-50 max-h-[600px] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Уведомления"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[x>0&&e.jsx("button",{onClick:w,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Отметить все как прочитанные"}),e.jsx("button",{onClick:()=>c(!1),className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Ve,{className:"w-4 h-4 text-gray-500"})})]})]}),e.jsx("div",{className:"flex items-center space-x-2 mt-3",children:[{key:"all",label:"Все",count:r.length},{key:"unread",label:"Непрочитанные",count:x},{key:"read",label:"Прочитанные",count:r.length-x}].map(({key:p,label:C,count:T})=>e.jsxs("button",{onClick:()=>g(p),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${m===p?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[C," (",T,")"]},p))})]}),e.jsx("div",{className:"overflow-y-auto max-h-[400px]",children:u.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Gr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsxs("p",{className:"text-gray-500",children:[m==="all"&&"Нет уведомлений",m==="unread"&&"Нет непрочитанных уведомлений",m==="read"&&"Нет прочитанных уведомлений"]})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:u.map(p=>e.jsx("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${p.isRead?"":"bg-blue-50"}`,onClick:()=>k(p),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:f(p.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:p.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:N(p.createdAt)})]}),!p.isRead&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center space-x-1",children:[!p.isRead&&e.jsx("button",{onClick:C=>{C.stopPropagation(),s(p.id)},className:"p-1 rounded-full hover:bg-green-100 transition-colors",title:"Отметить как прочитанное",children:e.jsx(Td,{className:"w-4 h-4 text-green-600"})}),e.jsx("button",{onClick:C=>{C.stopPropagation(),n(p.id)},className:"p-1 rounded-full hover:bg-red-100 transition-colors",title:"Удалить",children:e.jsx(Xr,{className:"w-4 h-4 text-red-600"})})]})]})},p.id))})}),v.length>5&&e.jsx("div",{className:"p-4 border-t border-gray-100",children:e.jsx("button",{onClick:()=>d(!l),className:"w-full flex items-center justify-center space-x-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:l?e.jsxs(e.Fragment,{children:[e.jsx(Dd,{className:"w-4 h-4"}),e.jsx("span",{children:"Показать меньше"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Od,{className:"w-4 h-4"}),e.jsxs("span",{children:["Показать все (",v.length,")"]})]})})})]})]})},WC=({posts:t,currentUserId:r,currentUserName:s,currentUserAvatar:a,onCreatePost:n,onReaction:i,onComment:o,onShare:c,onBookmark:l,onEdit:d,onDelete:m,showCreateButton:g=!0,title:h="Записи",showSearch:x=!0,showNotifications:v=!0,showTrending:u=!0,showBookmarks:f=!0})=>{const[N,w]=S.useState(!1),[k,p]=S.useState(!1),[C,T]=S.useState("all"),[M,j]=S.useState(t),[O,B]=S.useState([]);S.useEffect(()=>{let K=t;C==="my"?K=t.filter(G=>G.userId===r):C==="others"?K=t.filter(G=>G.userId!==r):C==="trending"?K=[...t].sort((G,ae)=>{const H=(G.likes||0)+G.comments.length;return(ae.likes||0)+ae.comments.length-H}).slice(0,20):C==="bookmarks"&&(K=t.filter(G=>{var ae;return(ae=G.bookmarks)==null?void 0:ae.includes(r)})),j(K)},[t,C,r]);const F=K=>{n(K),w(!1)};return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:h}),e.jsxs("div",{className:"flex items-center space-x-2",children:[v&&e.jsx(UC,{className:"mr-2"}),x&&e.jsx("button",{onClick:()=>p(!k),className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Поиск",children:e.jsx(Kr,{className:"w-5 h-5"})}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:C,onChange:K=>T(K.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg px-3 py-2 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Все записи"}),e.jsx("option",{value:"my",children:"Мои записи"}),e.jsx("option",{value:"others",children:"Записи других"}),u&&e.jsx("option",{value:"trending",children:"Популярные"}),f&&e.jsx("option",{value:"bookmarks",children:"Закладки"})]}),e.jsx(dn,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]}),g&&e.jsxs("button",{onClick:()=>w(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Vr,{className:"w-4 h-4"}),e.jsx("span",{children:"Создать запись"})]})]})]}),k&&e.jsx("div",{className:"mb-6",children:e.jsx(FC,{onSearchResults:B,onClose:()=>p(!1)})}),N&&e.jsx("div",{className:"mb-6",children:e.jsx(li,{onSubmit:F,onCancel:()=>w(!1),userName:s,userAvatar:a})}),e.jsxs("div",{className:"space-y-4",children:[O.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Результаты поиска (",O.length,")"]}),e.jsx("div",{className:"space-y-4",children:O.map(K=>e.jsx(on,{post:K,currentUserId:r,onReaction:i,onComment:o,onShare:c,onBookmark:l,onEdit:d,onDelete:m},K.id))})]}),M.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"text-gray-400 text-lg mb-2",children:[C==="all"&&"Пока нет записей",C==="my"&&"У вас пока нет записей",C==="others"&&"Пока нет записей от других",C==="trending"&&"Пока нет популярных записей",C==="bookmarks"&&"У вас пока нет закладок"]}),e.jsxs("p",{className:"text-gray-500",children:[C==="my"&&g&&"Создайте первую запись!",C==="others"&&"Записи от других пользователей появятся здесь",C==="trending"&&"Популярные записи появятся здесь",C==="bookmarks"&&"Добавляйте записи в закладки!"]})]}):M.map(K=>e.jsx(on,{post:K,currentUserId:r,onReaction:i,onComment:o,onShare:c,onBookmark:l,onEdit:d,onDelete:m},K.id))]})]})},BC=({userId:t,onClose:r,onMessage:s,onBookLesson:a,isModal:n=!1})=>{const{user:i}=Ke(),{posts:o,createPost:c,addReaction:l,addComment:d,sharePost:m,bookmarkPost:g,editPost:h,deletePost:x,allUsers:v}=tt(),[u,f]=S.useState(!1),[N,w]=S.useState(!1),[k,p]=S.useState(!1),[C,T]=S.useState("posts"),M=v.find(H=>H.id===t),j=(i==null?void 0:i.id)===t,O=(M==null?void 0:M.role)==="teacher",B=o.filter(H=>H.userId===t),F=M==null?void 0:M.profile,K=H=>{switch(H){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return H}},G=H=>{switch(H){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return H}};if(!M)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ve,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пользователь не найден"}),e.jsx("p",{className:"text-gray-500",children:"Пользователь с таким ID не существует"})]})});const ae=()=>{var H;return e.jsx("div",{className:`${n?"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4":""}`,children:e.jsxs("div",{className:`bg-white rounded-3xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto relative ${n?"":"border border-gray-200"}`,children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[r&&e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(cn,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!j&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>w(!N),className:`p-2 rounded-full transition-colors ${N?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(ta,{className:`w-5 h-5 ${N?"fill-current":""}`})}),e.jsx("button",{onClick:()=>f(!u),className:`p-2 rounded-full transition-colors ${u?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(mt,{className:`w-5 h-5 ${u?"fill-current":""}`})})]}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(qt,{className:"w-5 h-5"})}),j&&e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ra,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsxs("div",{className:"h-56 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"}),e.jsx("div",{className:"absolute bottom-6 left-8 right-8",children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"text-white flex-1 mr-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 leading-tight",children:(F==null?void 0:F.name)||M.name||"Пользователь"}),e.jsxs("div",{className:"flex items-center space-x-4 flex-wrap",children:[O&&(F==null?void 0:F.experience)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Ft,{className:"h-4 w-4 text-yellow-300"}),e.jsx("span",{className:"font-semibold text-xs",children:K(F.experience)})]}),(F==null?void 0:F.rating)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Dt,{className:"h-4 w-4 text-yellow-300 fill-current"}),e.jsx("span",{className:"font-semibold text-xs",children:F.rating})]}),(F==null?void 0:F.city)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(ht,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-xs",children:F.city})]})]})]}),e.jsxs("div",{className:"text-right text-white/90 flex-shrink-0",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:B.length}),e.jsx("div",{className:"text-sm opacity-80",children:"записей"})]})]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start mt-8",children:[e.jsxs("div",{className:"flex-shrink-0 -mt-12 ml-8 relative",children:[e.jsxs("div",{className:"w-36 h-36 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-6 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-3 border-white rounded-full shadow-lg"}),F!=null&&F.avatar&&F.avatar.trim()!==""?e.jsx("img",{src:F.avatar,alt:M.name,className:"w-36 h-36 object-cover rounded-full",onError:Y=>{var Z;const U=Y.target;U.style.display="none",(Z=U.nextElementSibling)==null||Z.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-36 h-36 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${F!=null&&F.avatar&&F.avatar.trim()!==""?"hidden":""}`,children:e.jsx(ve,{className:"h-20 w-20 text-white"})})]}),!j&&e.jsxs("div",{className:"absolute -bottom-2 -right-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>f(!u),className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${u?"bg-red-500 text-white scale-110":"bg-white text-gray-600 hover:bg-red-50 hover:text-red-500"}`,children:e.jsx(mt,{className:`w-5 h-5 ${u?"fill-current":""}`})}),e.jsx("button",{className:"w-10 h-10 rounded-full bg-white text-gray-600 hover:bg-gray-50 shadow-lg transition-all duration-200 flex items-center justify-center",children:e.jsx(qt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-wrap gap-4 mt-12 lg:mt-0",children:[!j&&e.jsxs(e.Fragment,{children:[O&&a&&e.jsxs("button",{onClick:()=>a(M.id),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ae,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Записаться на урок"})]}),s&&e.jsxs("button",{onClick:()=>s(M.id),className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-2xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Ue,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Написать сообщение"})]}),e.jsxs("button",{onClick:()=>p(!k),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(Yt,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Контактная информация"})]})]}),j&&e.jsxs("button",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Jr,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Редактировать профиль"})]})]})]})]}),k&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 mb-8 mt-8 border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-lg",children:"Контактная информация"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[M.phone&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(jt,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:M.phone})]}),M.email&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(un,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:M.email})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6 mt-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:B.length}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Записей"})]}),O&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(F==null?void 0:F.lessonsCount)||0}),e.jsx("div",{className:"text-green-100 text-xs",children:"Проведено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:((H=F==null?void 0:F.students)==null?void 0:H.length)||0}),e.jsx("div",{className:"text-purple-100 text-xs",children:"Учеников"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 to-orange-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(F==null?void 0:F.rating)||0}),e.jsx("div",{className:"text-orange-100 text-xs",children:"Рейтинг"})]})]}),!O&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-green-100 text-xs",children:"Посещено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-purple-100 text-xs",children:"Преподавателей"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 to-orange-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-orange-100 text-xs",children:"Дней в системе"})]})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8 mt-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"posts",label:"Записи",count:B.length},{id:"about",label:"О пользователе",count:null},{id:"lessons",label:O?"Расписание":"Мои уроки",count:0},{id:"reviews",label:"Отзывы",count:0}].map(Y=>e.jsxs("button",{onClick:()=>T(Y.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${C===Y.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[Y.label,Y.count!==null&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2 rounded-full text-xs",children:Y.count})]},Y.id))})}),e.jsxs("div",{className:"min-h-[400px]",children:[C==="posts"&&e.jsx("div",{className:"space-y-6",children:e.jsx(WC,{posts:B,currentUserId:(i==null?void 0:i.id)||"",currentUserName:(i==null?void 0:i.name)||"",currentUserAvatar:i==null?void 0:i.avatar,onCreatePost:c,onReaction:l,onComment:d,onShare:m,onBookmark:g,onEdit:h,onDelete:x,showCreateButton:j,title:`Записи ${(F==null?void 0:F.name)||M.name}`,showSearch:!0,showNotifications:!1,showTrending:!1,showBookmarks:!0})}),C==="about"&&e.jsxs("div",{className:"space-y-3",children:[(F==null?void 0:F.bio)&&e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-indigo-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-indigo-500 to-purple-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"О пользователе"]}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm rounded-md p-2 border border-indigo-200/50",children:e.jsx("p",{className:"text-indigo-800 leading-relaxed whitespace-pre-line text-xs",children:F.bio})})]}),O&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[(F==null?void 0:F.subjects)&&F.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Предметы"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:F.subjects.map((Y,U)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium border border-blue-200/50 shadow-sm",children:Y},U))})]}),(F==null?void 0:F.grades)&&F.grades.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-emerald-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 to-teal-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Классы"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:F.grades.map((Y,U)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-emerald-800 px-2 py-0.5 rounded-md text-xs font-medium border border-emerald-200/50 shadow-sm",children:Y},U))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2.5",children:[(F==null?void 0:F.hourlyRate)&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-200 rounded-lg p-2.5 text-center shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-purple-900 mb-1.5 flex items-center justify-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-purple-500 to-violet-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Стоимость"]}),e.jsxs("div",{className:"text-base font-bold text-purple-700 bg-white/60 backdrop-blur-sm rounded-md py-1 px-1.5 border border-purple-200/50",children:[F.hourlyRate," ₽/час"]})]}),(F==null?void 0:F.formats)&&F.formats.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-orange-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-orange-500 to-amber-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Форматы"]}),e.jsx("div",{className:"space-y-1",children:F.formats.map((Y,U)=>e.jsxs("div",{className:"flex items-center space-x-1.5 p-1 bg-white/60 backdrop-blur-sm rounded border border-orange-200/50",children:[e.jsx(Ct,{className:"h-3 w-3 text-orange-600"}),e.jsx("span",{className:"text-orange-800 text-xs font-medium",children:G(Y)})]},U))})]}),(F==null?void 0:F.durations)&&F.durations.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 border border-cyan-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-cyan-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-cyan-500 to-blue-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Длительность"]}),e.jsx("div",{className:"space-y-1",children:F.durations.map((Y,U)=>e.jsxs("div",{className:"flex items-center space-x-1.5 p-1 bg-white/60 backdrop-blur-sm rounded border border-cyan-200/50",children:[e.jsx(Ct,{className:"h-3 w-3 text-cyan-600"}),e.jsxs("span",{className:"text-cyan-800 text-xs font-medium",children:[Y," минут"]})]},U))})]})]})]}),!O&&F&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[F.subjects&&F.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Интересуется предметами"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:F.subjects.map((Y,U)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium border border-blue-200/50 shadow-sm",children:Y},U))})]}),F.grade&&e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-emerald-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 to-teal-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Класс"]}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm text-emerald-800 px-2 py-1 rounded-md text-xs font-medium border border-emerald-200/50 shadow-sm",children:F.grade})]})]})]}),C==="lessons"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ze,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:O?"Расписание пока не настроено":"Уроки пока не запланированы"}),e.jsx("p",{className:"text-gray-500",children:O?"Настройте расписание для проведения уроков":"Запишитесь на уроки к преподавателям"})]}),C==="reviews"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Dt,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пока нет отзывов"}),e.jsx("p",{className:"text-gray-500",children:"Отзывы о пользователе появятся здесь"})]})]})]})]})})};return n?e.jsx(ae,{}):e.jsx(ae,{})};async function Zl(t){try{const r=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");if(r[t])return console.log(" Found student profile in localStorage:",r[t]),r[t];const a=JSON.parse(localStorage.getItem("tutoring_users")||"[]").find(n=>n.id===t&&n.role==="student");if(a!=null&&a.profile)return console.log(" Found student profile in users list:",a.profile),a.profile;try{console.log(" Loading student profile from server for ID:",t);const n=await fetch(`${_e}/api/students/${t}`);if(n.ok){const i=await n.json();console.log(" Loaded student profile from server:",i);const o={...r,[t]:i};return localStorage.setItem("tutoring_studentProfiles",JSON.stringify(o)),i}}catch(n){console.warn(" Failed to load student profile from server:",n)}return}catch(r){console.error(" Error getting student profile:",r);return}}const _s=({icon:t,value:r,label:s,color:a})=>e.jsxs("div",{className:`${a} rounded-xl p-4 text-center`,children:[e.jsx("div",{className:"w-8 h-8 mx-auto mb-2 flex items-center justify-center",children:t}),e.jsx("div",{className:"text-2xl font-bold",children:r}),e.jsx("div",{className:"text-sm text-gray-600",children:s})]}),er=({icon:t,label:r,value:s,fallback:a="Не указано"})=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-gray-400",children:t}),e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[r,":"]})," ",e.jsx("span",{children:s||a})]})]}),Hr=({items:t,color:r,emptyMessage:s})=>!t||t.length===0?s?e.jsx("span",{className:"text-gray-500 text-sm",children:s}):null:e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map((a,n)=>e.jsx("span",{className:`${r} px-3 py-1 rounded-full text-sm`,children:a},n))}),HC=()=>{var me,we,Ne,Q,be;const{user:t}=Ke(),{lessons:r,createSlot:s,studentProfiles:a}=tt(),[n,i]=S.useState(null),[o,c]=S.useState(!1),[l,d]=S.useState(!1),[m,g]=S.useState(null),[h,x]=S.useState({subject:"",date:"",startTime:"",endTime:"",duration:60,lessonType:"regular",format:"online",price:1e3,experience:"beginner",grades:[],goals:[]}),[v,u]=S.useState(!1),[f,N]=S.useState(""),[w,k]=S.useState(!1),[p,C]=S.useState(null),[T,M]=S.useState(null),[j,O]=S.useState(null),[B,F]=S.useState(!1),K=r.filter(J=>J.teacherId===(t==null?void 0:t.id)),G={};K.forEach(J=>{G[J.studentId]||(G[J.studentId]={studentName:J.studentName,studentId:J.studentId,lessons:[]}),G[J.studentId].lessons.push(J)});const ae=Object.values(G);S.useEffect(()=>{(async()=>{if(n){F(!0),console.log(" Loading profile for student:",n.studentId);let V=a[n.studentId];V||(V=await Zl(n.studentId)),console.log(" Profile loaded:",V),O(V||null),F(!1)}})()},[n,a]);const H=(J,V)=>{alert(`Чат с ${V} открыт! Перейдите в раздел "Чаты" для общения.`)},Y=J=>{i(J),c(!0)},U=()=>{c(!1),i(null),O(null)},Z=async()=>{if(n){F(!0);try{console.log(" Refreshing student profile from server...");const J=await Zl(n.studentId);O(J||null)}catch(J){console.error(" Error refreshing student profile:",J)}finally{F(!1)}}},re=J=>{C(J),k(!0)},W=async()=>{if(!(!t||!m)){u(!0),N("");try{await s({...h,teacherId:t.id,teacherName:t.name},m.id,m.name,{mode:"assign"}),d(!1)}catch(J){N(J.message||"Ошибка при создании урока")}finally{u(!1)}}},xe=(J=>{var Ce,Ge,Je;if(!J)return 0;const V=[J.grade,J.age,J.school,J.city,J.phone,J.parentName,J.parentPhone,(Ce=J.subjects)==null?void 0:Ce.length,(Ge=J.goals)==null?void 0:Ge.length,(Je=J.interests)==null?void 0:Je.length,J.learningStyle,J.experience,J.bio],je=V.filter(qe=>qe&&(Array.isArray(qe)?qe.length>0:!0)).length;return Math.round(je/V.length*100)})(j);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Ученики"}),e.jsx("p",{className:"text-gray-600",children:"Здесь отображаются все ученики, которые бронировали у вас уроки, и история ваших занятий с ними"})]}),ae.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Zr,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Пока нет учеников"}),e.jsx("p",{className:"text-gray-600",children:"Ученики появятся здесь после того, как забронируют у вас уроки"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ae.map(J=>e.jsx("div",{className:"card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden cursor-pointer",onClick:()=>Y(J),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:e.jsx(ve,{className:"h-6 w-6 text-white"})}),e.jsx("div",{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:J.studentName})}),e.jsxs("div",{className:"ml-auto flex items-center space-x-1",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-blue-600",title:"Просмотреть записи",onClick:V=>{V.stopPropagation(),M(J.studentId)},children:e.jsx(Vt,{className:"h-5 w-5"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-blue-600",title:"Подробнее о профиле",onClick:V=>{V.stopPropagation(),Y(J)},children:e.jsx(Rd,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Уроки:"}),J.lessons.length>0?e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[J.lessons.slice(0,3).map((V,je)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:V.subject}),e.jsx("span",{className:"text-gray-400",children:V.date})]},V.id)),J.lessons.length>3&&e.jsxs("li",{className:"text-gray-400 text-xs",children:["и еще ",J.lessons.length-3," уроков..."]})]}):e.jsx("p",{className:"text-sm text-gray-500",children:"Нет уроков"})]})]})},J.studentId))}),o&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-5xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:U,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Ve,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:Z,disabled:B,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors flex items-center space-x-2 disabled:opacity-50",title:"Обновить данные",children:[e.jsx(Us,{className:`w-4 h-4 ${B?"animate-spin":""}`}),e.jsx("span",{children:"Обновить"})]}),e.jsxs("button",{onClick:()=>H(n.studentId,n.studentName),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{children:"Написать"})]}),e.jsxs("button",{onClick:()=>re({id:n.studentId,name:n.studentName}),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center space-x-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),e.jsx("span",{children:"Назначить урок"})]})]})]})}),e.jsx("div",{className:"p-6",children:B?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Us,{className:"w-8 h-8 mx-auto mb-4 animate-spin text-blue-500"}),e.jsx("p",{className:"text-gray-600",children:"Загружаем данные профиля..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col items-center lg:items-start",children:[j!=null&&j.avatar&&j.avatar.trim()!==""?e.jsx("img",{src:j.avatar,alt:"avatar",className:"w-32 h-32 rounded-full object-cover mb-4",onError:J=>{var je;const V=J.target;V.style.display="none",(je=V.nextElementSibling)==null||je.classList.remove("hidden")}}):null,e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-r from-blue-400 to-indigo-500 flex items-center justify-center mb-4",children:e.jsx(ve,{className:"h-16 w-16 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:n.studentName}),e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[xe>70?e.jsx(yr,{className:"w-5 h-5 text-green-500"}):xe>30?e.jsx(fi,{className:"w-5 h-5 text-yellow-500"}):e.jsx(fi,{className:"w-5 h-5 text-red-500"}),e.jsxs("span",{className:`text-sm font-medium ${xe>70?"text-green-600":xe>30?"text-yellow-600":"text-red-600"}`,children:["Профиль заполнен на ",xe,"%"]})]}),(j==null?void 0:j.grade)&&e.jsxs("div",{className:"flex items-center text-lg text-gray-600 mb-2",children:[e.jsx(ar,{className:"w-5 h-5 mr-2"}),e.jsxs("span",{children:[j.grade," класс"]})]}),(j==null?void 0:j.age)&&e.jsxs("div",{className:"text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Возраст:"})," ",j.age," лет"]})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(_s,{icon:e.jsx(Ae,{className:"w-8 h-8 text-blue-500"}),value:((me=G[n.studentId])==null?void 0:me.lessons.length)||0,label:"Всего уроков",color:"bg-blue-50"}),e.jsx(_s,{icon:e.jsx(Ft,{className:"w-8 h-8 text-green-500"}),value:((we=G[n.studentId])==null?void 0:we.lessons.filter(J=>J.status==="completed").length)||0,label:"Завершено",color:"bg-green-50"}),e.jsx(_s,{icon:e.jsx(Zr,{className:"w-8 h-8 text-purple-500"}),value:((Ne=j==null?void 0:j.subjects)==null?void 0:Ne.length)||0,label:"Предметов",color:"bg-purple-50"}),e.jsx(_s,{icon:e.jsx(hs,{className:"w-8 h-8 text-orange-500"}),value:j!=null&&j.experience?j.experience==="beginner"?"Начинающий":j.experience==="intermediate"?"Средний":"Продвинутый":"Не указан",label:"Уровень",color:"bg-orange-50"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ve,{className:"w-5 h-5 mr-2 text-blue-500"}),"Личная информация"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(er,{icon:e.jsx(mn,{className:"w-4 h-4"}),label:"Школа",value:(j==null?void 0:j.school)||"",fallback:"Не указана"}),e.jsx(er,{icon:e.jsx(ht,{className:"w-4 h-4"}),label:"Город",value:(j==null?void 0:j.city)||"",fallback:"Не указан"}),e.jsx(er,{icon:e.jsx(jt,{className:"w-4 h-4"}),label:"Телефон",value:(j==null?void 0:j.phone)||"",fallback:"Не указан"}),e.jsx(er,{icon:e.jsx(ve,{className:"w-4 h-4"}),label:"Родитель",value:(j==null?void 0:j.parentName)||"",fallback:"Не указан"}),e.jsx(er,{icon:e.jsx(jt,{className:"w-4 h-4"}),label:"Телефон родителя",value:(j==null?void 0:j.parentPhone)||"",fallback:"Не указан"}),e.jsx(er,{icon:e.jsx(Ct,{className:"w-4 h-4"}),label:"Часовой пояс",value:(j==null?void 0:j.timeZone)||"",fallback:"Не указан"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ae,{className:"w-5 h-5 mr-2 text-green-500"}),"Учебная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 block mb-2",children:"Изучаемые предметы:"}),e.jsx(Hr,{items:(j==null?void 0:j.subjects)||[],color:"bg-blue-100 text-blue-800",emptyMessage:"Не указаны"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 block mb-2",children:"Цели обучения:"}),e.jsx(Hr,{items:(j==null?void 0:j.goals)||[],color:"bg-green-100 text-green-800",emptyMessage:"Не указаны"})]}),e.jsx(er,{icon:e.jsx(fn,{className:"w-4 h-4"}),label:"Стиль обучения",value:(j==null?void 0:j.learningStyle)==="visual"?"Визуальный":(j==null?void 0:j.learningStyle)==="auditory"?"Аудиальный":(j==null?void 0:j.learningStyle)==="kinesthetic"?"Кинестетический":(j==null?void 0:j.learningStyle)==="mixed"?"Смешанный":"",fallback:"Не указан"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 block mb-2",children:"Предпочитаемые форматы:"}),e.jsx(Hr,{items:(j==null?void 0:j.preferredFormats)||[],color:"bg-purple-100 text-purple-800",emptyMessage:"Не указаны"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 block mb-2",children:"Предпочитаемая длительность:"}),e.jsx(Hr,{items:((Q=j==null?void 0:j.preferredDurations)==null?void 0:Q.map(J=>`${J} мин`))||[],color:"bg-orange-100 text-orange-800",emptyMessage:"Не указана"})]})]})]}),(j==null?void 0:j.interests)&&j.interests.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(mt,{className:"w-5 h-5 mr-2 text-red-500"}),"Интересы и хобби"]}),e.jsx(Hr,{items:j.interests,color:"bg-red-100 text-red-800"})]}),(j==null?void 0:j.bio)&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Vt,{className:"w-5 h-5 mr-2 text-indigo-500"}),"О себе"]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:j.bio})]})]}),((be=G[n.studentId])==null?void 0:be.lessons)&&G[n.studentId].lessons.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2 text-blue-500"}),"История уроков"]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:e.jsx("div",{className:"max-h-64 overflow-y-auto",children:G[n.studentId].lessons.map((J,V)=>e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:J.subject}),e.jsxs("p",{className:"text-sm text-gray-600",children:[J.date," в ",J.startTime,"-",J.endTime]}),J.comment&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:J.comment})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${J.status==="completed"?"bg-green-100 text-green-800":J.status==="scheduled"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:J.status==="completed"?"Завершен":J.status==="scheduled"?"Запланирован":"Отменен"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[J.price," ₽"]})]})]})},J.id))})})]}),!j&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(ve,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Профиль не заполнен"}),e.jsx("p",{className:"text-gray-600",children:"Ученик еще не заполнил информацию о себе"})]})]})})]})}),l&&m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:()=>d(!1),title:"Закрыть",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("h3",{children:["Назначить урок для ",m.name]}),e.jsxs("form",{className:"flex flex-col gap-2",children:[e.jsx("input",{type:"text",placeholder:"Предмет",value:h.subject,onChange:J=>x({...h,subject:J.target.value}),required:!0}),e.jsx("input",{type:"date",value:h.date,onChange:J=>x({...h,date:J.target.value}),required:!0}),e.jsx("input",{type:"time",value:h.startTime,onChange:J=>x({...h,startTime:J.target.value}),required:!0}),e.jsx("input",{type:"time",value:h.endTime,onChange:J=>x({...h,endTime:J.target.value}),required:!0}),e.jsx("input",{type:"number",placeholder:"Цена",value:h.price,onChange:J=>x({...h,price:Number(J.target.value)})}),e.jsxs("select",{value:h.lessonType,onChange:J=>x({...h,lessonType:J.target.value}),children:[e.jsx("option",{value:"regular",children:"Обычный"}),e.jsx("option",{value:"trial",children:"Пробный"})]}),e.jsxs("select",{value:h.format,onChange:J=>x({...h,format:J.target.value}),children:[e.jsx("option",{value:"online",children:"Онлайн"}),e.jsx("option",{value:"offline",children:"Оффлайн"})]}),e.jsxs("select",{value:h.experience,onChange:J=>x({...h,experience:J.target.value}),children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"})]}),f&&e.jsx("div",{className:"text-red-500",children:f}),e.jsx("button",{type:"button",className:"btn btn-success mt-2",onClick:W,disabled:v,children:v?"Назначение...":"Назначить"})]})]})}),w&&p&&e.jsx(br,{open:w,onClose:()=>k(!1),children:e.jsxs("div",{style:{minWidth:1100,minHeight:600,maxWidth:"98vw"},children:[e.jsxs("h2",{style:{marginBottom:16},children:["Назначить урок для ",p.name]}),e.jsx(sd,{mode:"assign",student:p,onAssign:()=>k(!1)})]})}),T&&e.jsx(BC,{userId:T,onClose:()=>M(null),onMessage:J=>{M(null)},onBookLesson:J=>{M(null)},isModal:!0})]})},zC=()=>{var w,k;const{user:t}=Ke(),[r,s]=S.useState([]),[a,n]=S.useState(""),[i,o]=S.useState(""),[c,l]=S.useState([]),[d,m]=S.useState(null),[g,h]=S.useState(""),x=t?`teacher_materials_${t.id}`:void 0;S.useEffect(()=>{if(x)try{const p=localStorage.getItem(x);p&&s(JSON.parse(p))}catch{}},[x]),S.useEffect(()=>{if(x)try{localStorage.setItem(x,JSON.stringify(r))}catch{}},[r,x]);const v=p=>{const C=Array.from(p.target.files||[]);l(C)},u=async()=>{if(!a.trim()&&c.length===0&&!i.trim())return;const p=await Promise.all(c.map(j=>new Promise(O=>{const B=new FileReader;B.onload=()=>{O({id:Math.random().toString(36).slice(2),title:a.trim()||j.name,fileName:j.name,fileType:j.type,dataUrl:String(B.result||""),createdAt:new Date().toISOString()})},B.readAsDataURL(j)}))),T=[i.trim()?{id:Math.random().toString(36).slice(2),title:a.trim()||i.trim(),url:i.trim(),createdAt:new Date().toISOString()}:null,...p].filter(Boolean);if(T.length===0)return;s(j=>[...T,...j]),n(""),o(""),l([]);const M=document.getElementById("materials-file-input");M&&(M.value="")},f=p=>{s(C=>C.filter(T=>T.id!==p))},N=(p,C)=>{s(T=>T.map(M=>M.id===p?{...M,title:C.trim()||M.title}:M))};return e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold gradient-text",children:"Материалы"}),e.jsx("p",{className:"text-gray-600",children:"Сохраняйте ссылки и описания материалов для занятий"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("input",{value:a,onChange:p=>n(p.target.value),placeholder:"Название материала",className:"input-modern w-full"}),e.jsx("input",{value:i,onChange:p=>o(p.target.value),placeholder:"Ссылка (необязательно)",className:"input-modern w-full"}),e.jsx("input",{id:"materials-file-input",type:"file",multiple:!0,onChange:v,className:"input-modern w-full",accept:".pdf,.doc,.docx,.ppt,.pptx,image/*,.txt,.xlsx,.xls,.csv,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf"}),e.jsx("button",{onClick:u,className:"btn-primary",children:"Добавить"})]}),c.length>0&&e.jsxs("div",{className:"mt-3 text-xs text-gray-600",children:["Выбрано файлов: ",c.length]}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{value:g,onChange:p=>h(p.target.value),placeholder:"Поиск по названию или ссылке",className:"input-modern w-full"})})]}),e.jsx("div",{className:"space-y-3",children:r.length===0?e.jsx("div",{className:"text-gray-500 text-center py-12 bg-white rounded-2xl shadow",children:"Пока нет материалов"}):r.filter(p=>{const C=g.trim().toLowerCase();return C?p.title.toLowerCase().includes(C)||(p.url?p.url.toLowerCase().includes(C):!1)||(p.fileName?p.fileName.toLowerCase().includes(C):!1):!0}).map(p=>e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(GC,{title:p.title,onSave:C=>N(p.id,C)}),p.url&&e.jsx("a",{href:p.url,target:"_blank",rel:"noreferrer",className:"text-blue-600 text-sm break-all",children:p.url}),p.dataUrl&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[p.fileName," ",p.fileType&&`• ${p.fileType}`]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[(p.dataUrl||p.url)&&e.jsx("button",{onClick:()=>{p.dataUrl?m(p):p.url&&window.open(p.url,"_blank")},className:"text-blue-600 hover:text-blue-700",children:"Открыть"}),p.dataUrl&&e.jsx("a",{href:p.dataUrl,download:p.fileName||"material",className:"text-blue-600 hover:text-blue-700",children:"Скачать"}),e.jsx("button",{onClick:()=>f(p.id),className:"text-red-600 hover:text-red-700",children:"Удалить"})]})]},p.id))}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>m(null),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full h-[80vh] overflow-hidden relative",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[e.jsx("div",{className:"font-semibold truncate pr-4",children:d.title}),e.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>m(null),children:"Закрыть"})]}),e.jsxs("div",{className:"w-full h-[calc(80vh-52px)] bg-gray-50 flex items-center justify-center",children:[d.dataUrl&&((w=d.fileType)==null?void 0:w.startsWith("image/"))&&e.jsx("img",{src:d.dataUrl,alt:d.title,className:"max-h-full max-w-full object-contain"}),d.dataUrl&&d.fileType==="application/pdf"&&e.jsx("iframe",{title:"pdf",src:d.dataUrl,className:"w-full h-full"}),d.dataUrl&&((k=d.fileType)==null?void 0:k.startsWith("text/"))&&e.jsx("iframe",{title:"text",src:d.dataUrl,className:"w-full h-full bg-white"}),d.dataUrl&&!/^(image\/|application\/pdf|text\/).*/.test(d.fileType||"")&&e.jsx("div",{className:"p-6 text-center text-gray-600",children:"Онлайн-просмотр для этого формата не поддерживается. Скачайте файл для просмотра."}),d.url&&!d.dataUrl&&e.jsx("iframe",{title:"url",src:d.url,className:"w-full h-full bg-white"})]})]})})]})},GC=({title:t,onSave:r})=>{const[s,a]=S.useState(!1),[n,i]=S.useState(t);return S.useEffect(()=>i(t),[t]),s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:n,onChange:o=>i(o.target.value),onKeyDown:o=>{o.key==="Enter"&&(r(n),a(!1))},className:"input-modern",autoFocus:!0}),e.jsx("button",{className:"btn-primary",onClick:()=>{r(n),a(!1)},children:"OK"}),e.jsx("button",{className:"btn-secondary",onClick:()=>{i(t),a(!1)},children:"Отмена"})]}):e.jsx("div",{className:"font-semibold text-gray-900 truncate max-w-md",title:t,onDoubleClick:()=>a(!0),children:t})},qC=({setActiveTab:t})=>{const{lessons:r,cancelLesson:s,rescheduleLesson:a,getOrCreateChat:n}=tt(),{user:i}=Ke(),[o,c]=S.useState(!1),[l,d]=S.useState(null),[m,g]=S.useState(""),[h,x]=S.useState(""),v=r.filter(O=>O.studentId===(i==null?void 0:i.id)),u=v.filter(O=>O.status==="scheduled"),f=v.filter(O=>O.status==="completed"),N=(O,B)=>{i&&n(i.id,O,i.name,B)},w=O=>{window.confirm("Вы уверены, что хотите отменить урок?")&&s(O)},k=()=>{l&&m&&h&&(a(l.id,m,h),c(!1),d(null),g(""),x(""))},p=O=>{d(O),g(O.date),x(O.startTime),c(!0)},C=O=>{switch(O){case"online":return e.jsx(Ut,{className:"h-4 w-4"});case"offline":return e.jsx(ht,{className:"h-4 w-4"});case"mini-group":return e.jsx(Zr,{className:"h-4 w-4"});default:return e.jsx(Ut,{className:"h-4 w-4"})}},T=O=>{switch(O){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return O}},M=O=>O==="scheduled"?e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-sm",children:[e.jsx(Gd,{className:"h-4 w-4 mr-2"}),"Запланирован"]}):e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-green-500 to-green-600 text-white shadow-sm",children:[e.jsx(yr,{className:"h-4 w-4 mr-2"}),"Завершен"]}),j=({lesson:O,isScheduled:B})=>e.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden border border-gray-100 hover:border-blue-200",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 p-4 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white opacity-10 rounded-full -translate-y-12 translate-x-12"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 bg-white opacity-10 rounded-full translate-y-8 -translate-x-8"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold mb-1",children:O.subject}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ve,{className:"h-4 w-4 text-blue-200"}),e.jsx("span",{className:"text-blue-100 text-sm font-medium",children:O.teacherName})]})]}),M(O.status)]}),e.jsxs("div",{className:"flex items-center space-x-3 text-blue-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[C(O.format),e.jsx("span",{className:"text-xs font-medium",children:T(O.format)})]}),O.lessonType==="trial"&&e.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-400 bg-opacity-20 px-2 py-1 rounded-full",children:[e.jsx(Dt,{className:"h-3 w-3 text-yellow-300"}),e.jsx("span",{className:"text-yellow-200 text-xs font-medium",children:"Пробный"})]})]})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-md",children:e.jsx(Ze,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Дата"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:O.date})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 rounded-md",children:e.jsx(Ct,{className:"h-4 w-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Время"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[O.startTime," - ",O.endTime]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-green-100 rounded-md",children:e.jsx(qd,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Длительность"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[O.duration," мин"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Стоимость"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[O.price,"₽"]})]})]}),B&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>N(O.teacherId,O.teacherName),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg text-sm font-medium hover:from-blue-600 hover:to-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{children:"Чат"})]}),O.format==="online"&&e.jsxs("button",{className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg text-sm font-medium hover:from-purple-600 hover:to-purple-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:[e.jsx(Ut,{className:"h-4 w-4"}),e.jsx("span",{children:"Видеозвонок"})]})]}),e.jsxs("div",{className:"flex space-x-2 pt-2 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>p(O),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 text-orange-600 bg-orange-50 hover:bg-orange-100 rounded-lg text-sm font-medium transition-all duration-200 border border-orange-200 hover:border-orange-300",children:[e.jsx(Jr,{className:"h-3 w-3"}),e.jsx("span",{children:"Перенести"})]}),e.jsxs("button",{onClick:()=>w(O.id),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm font-medium transition-all duration-200 border border-red-200 hover:border-red-300",children:[e.jsx(Xr,{className:"h-3 w-3"}),e.jsx("span",{children:"Отменить"})]})]})]}),!B&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 py-2 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[e.jsx(yr,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-700 text-sm font-medium",children:"Урок успешно завершен"})]})]}),e.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-3 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent",children:"Мои уроки"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed",children:"Управляйте вашими запланированными и завершенными уроками. Отслеживайте прогресс и достигайте новых высот в обучении."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ze,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:u.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Запланировано"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(yr,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:f.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Завершено"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(hs,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:v.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Всего уроков"})]})]})})]}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ze,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Запланированные уроки"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ваши предстоящие занятия"})]})]}),u.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(O=>e.jsx(j,{lesson:O,isScheduled:!0},O.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md border border-gray-100",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ze,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Нет запланированных уроков"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"Забронируйте свой первый урок на главной странице и начните свой путь к знаниям"}),e.jsxs("button",{onClick:()=>{console.log("🎯 Переход к главной странице для бронирования урока"),t("home")},className:"inline-flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[e.jsx(Kd,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать урок"})]})]})]}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Ft,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Завершенные уроки"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ваши достижения и пройденный материал"})]})]}),f.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(O=>e.jsx(j,{lesson:O,isScheduled:!1},O.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md border border-gray-100",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-green-100 to-emerald-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ft,{className:"h-8 w-8 text-green-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Нет завершенных уроков"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"После завершения уроков здесь будут отображаться ваши достижения и прогресс"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-medium",children:[e.jsx(fn,{className:"h-4 w-4"}),e.jsx("span",{children:"Достижения появятся здесь"})]})]})]}),e.jsx("div",{className:"text-center py-12 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-2xl text-white shadow-xl",children:e.jsxs("div",{className:"max-w-xl mx-auto px-6",children:[e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Готовы к следующему уроку?"}),e.jsx("p",{className:"text-lg text-blue-100 mb-6",children:"Продолжайте обучение и достигайте новых высот вместе с нашими преподавателями"}),e.jsxs("button",{onClick:()=>{console.log("🔍 Переход к главной странице для поиска преподавателя"),t("home")},className:"inline-flex items-center space-x-2 px-6 py-3 bg-white text-blue-600 rounded-lg font-semibold text-base hover:bg-gray-50 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[e.jsx(Bd,{className:"h-5 w-5"}),e.jsx("span",{children:"Найти преподавателя"})]})]})})]}),o&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full shadow-2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Перенести урок"}),e.jsx("button",{onClick:()=>c(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(Ve,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Урок:"})," ",l.subject," с ",l.teacherName]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Новая дата"}),e.jsx("input",{type:"date",value:m,onChange:O=>g(O.target.value),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Новое время"}),e.jsx("input",{type:"time",value:h,onChange:O=>x(O.target.value),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-8",children:[e.jsx("button",{onClick:k,disabled:!m||!h,className:"flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 px-6 rounded-xl font-semibold hover:from-blue-600 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Перенести урок"}),e.jsx("button",{onClick:()=>c(!1),className:"px-8 py-4 border-2 border-gray-300 rounded-xl text-gray-700 font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"Отмена"})]})]})})})]})},YC=()=>{const{chats:t,sendMessage:r,sendMessageToUser:s,allUsers:a,setAllUsers:n,teacherProfiles:i,studentProfiles:o,lessons:c,deleteChat:l,markChatAsRead:d,clearChatMessages:m,archiveChat:g,unarchiveChat:h,getOrCreateChat:x,loadChatsFromServer:v}=tt(),{user:u}=Ke(),[f,N]=S.useState(null),[w,k]=S.useState(""),[p,C]=S.useState(""),[T,M]=S.useState(!1),[j,O]=S.useState(null),[B,F]=S.useState([]),[K,G]=S.useState(null),[ae,H]=S.useState(null),[Y,U]=S.useState(!1),[Z,re]=S.useState(!1),[W,de]=S.useState(!1),[xe,me]=S.useState(!1),[we,Ne]=S.useState(!1),[Q,be]=S.useState(""),J=S.useRef(null),V=S.useRef(null),{socketRef:je}=tt(),Ce=()=>{var L;(L=J.current)==null||L.scrollIntoView({behavior:"smooth"})};S.useEffect(()=>{Ce()},[f,t]),S.useEffect(()=>{u&&(console.log("ChatList: Loading chats for user:",u.id),v())},[u,v]),S.useEffect(()=>{if(t.length>0&&!f){const L=t.find(ee=>ee.participants.includes((u==null?void 0:u.id)||"")&&!ee.archived);L&&N(L.id)}},[t,f,u]),S.useEffect(()=>{var L;if(f&&u){const ee=t.find(he=>he.id===f);ee&&((L=ee.messages)!=null&&L.some(ye=>ye.senderId!==u.id&&!ye.isRead))&&d(f)}},[f,t,u,d]);const Ge=L=>{let ee=a.find(he=>he.id===L);if(!ee){const he=i?i[L]:null;he&&(ee={id:L,role:"teacher",profile:he,avatar:he.avatar||"",name:he.name||"",email:he.email||"",nickname:""});const ye=o?o[L]:null;if(!ee&&ye&&(ee={id:L,role:"student",profile:ye,avatar:ye.avatar||"",name:ye.name||"",email:ye.email||"",nickname:""}),ee){const ut=[...a,ee];n(ut),localStorage.setItem("tutoring_users",JSON.stringify(ut))}}return ee||null},Je=t.filter(L=>L.participants.includes((u==null?void 0:u.id)||""));console.log("🔍 ChatList DEBUG INFO:"),console.log("- Current user:",{id:u==null?void 0:u.id,name:u==null?void 0:u.name,role:u==null?void 0:u.role}),console.log("- All chats count:",t.length),console.log("- User chats count:",Je.length),t.length>0&&(console.log("- All chats details:"),t.forEach((L,ee)=>{var he;console.log(`  Chat ${ee+1}:`,{id:L.id,participants:L.participants,participantNames:L.participantNames,includesUser:L.participants.includes((u==null?void 0:u.id)||""),messagesCount:((he=L.messages)==null?void 0:he.length)||0})}));const qe=Je.filter(L=>{if(L.archived&&!xe||!L.archived&&xe)return!1;const ee=L.participantNames.find(he=>he!==(u==null?void 0:u.name));return ee==null?void 0:ee.toLowerCase().includes(p.toLowerCase())});console.log("- Filtered chats count:",qe.length),console.log("🔍 END DEBUG INFO");const q=f?t.find(L=>L.id===f):null,Ee=()=>{!w.trim()||!f||!u||(r(f,u.id,u.name,w.trim()),k(""),U(!1))},fe=(L,ee)=>{if(!Q.trim()||!u)return;console.log("🔍 ChatList handleSendMessageToUser DEBUG:"),console.log("- Sender:",{id:u.id,name:u.name}),console.log("- Receiver:",{id:L,name:ee}),console.log("- Message:",Q.trim());const he=s(u.id,u.name,L,ee,Q.trim());console.log("- Chat created/opened with ID:",he),N(he),be(""),Ne(!1),console.log("🔍 END ChatList handleSendMessageToUser DEBUG")},ke=L=>{L.key==="Enter"&&!L.shiftKey&&(L.preventDefault(),Ee())},We=L=>L.participantNames.find(ee=>ee!==(u==null?void 0:u.name))||"Неизвестный пользователь",$e=L=>L.participants.find(ee=>ee!==(u==null?void 0:u.id))||"",Be=L=>{try{const ee=new Date(L);return Kl(ee)?Ye(ee,"HH:mm",{locale:bt}):Jl(ee)?"Вчера":J4(ee)?Ye(ee,"EEEE",{locale:bt}):Ye(ee,"dd.MM.yyyy",{locale:bt})}catch{return""}},at=L=>{try{const ee=new Date(L);return Kl(ee)?Ye(ee,"HH:mm",{locale:bt}):Jl(ee)?"Вчера":Ye(ee,"dd.MM",{locale:bt})}catch{return""}},b=L=>{console.log("handleDeleteChat called with chatId:",L),console.log("Current chats in component:",t.length);const ee=t.find(ye=>ye.id===L),he=ee?We(ee):"пользователем";if(confirm(`Вы уверены, что хотите удалить чат с ${he}? Это действие нельзя отменить.`))try{console.log("User confirmed deletion. Deleting chat:",L),l(L),f===L&&(console.log("Removing selection from deleted chat"),N(null)),G(null),H(null),setTimeout(()=>{console.log("Forcing state update after chat deletion"),G(null)},100),console.log("Chat deletion process completed")}catch(ye){console.error("Error deleting chat:",ye),alert("Ошибка при удалении чата. Попробуйте еще раз.")}else console.log("User cancelled chat deletion")},P=L=>{console.log("handleMarkAsRead called with chatId:",L);try{d(L),G(null),console.log("Chat marked as read successfully")}catch(ee){console.error("Error marking chat as read:",ee),alert("Ошибка при отметке чата как прочитанного.")}},A=L=>{var ye;console.log("handleClearMessages called with chatId:",L);const ee=t.find(ut=>ut.id===L),he=((ye=ee==null?void 0:ee.messages)==null?void 0:ye.length)||0;if(he===0){alert("В этом чате нет сообщений для очистки."),G(null);return}if(confirm(`Вы уверены, что хотите очистить все ${he} сообщений в этом чате? Это действие нельзя отменить.`))try{console.log("Clearing messages for chat:",L),m(L),G(null),console.log("Messages cleared successfully")}catch(ut){console.error("Error clearing messages:",ut),alert("Ошибка при очистке сообщений.")}},E=L=>{console.log("handleArchiveChat called with chatId:",L);try{g(L),G(null),f===L&&N(null),console.log("Chat archived successfully")}catch(ee){console.error("Error archiving chat:",ee),alert("Ошибка при архивировании чата.")}},y=L=>{console.log("handleUnarchiveChat called with chatId:",L);try{h(L),G(null),console.log("Chat unarchived successfully")}catch(ee){console.error("Error unarchiving chat:",ee),alert("Ошибка при восстановлении чата.")}},R=()=>{alert("Функция создания нового чата будет добавлена в следующем обновлении.")},$=L=>{const ee=L.target.files;ee&&ee.length>0&&console.log("Files to upload:",ee),de(!1)},_=L=>{console.log("handleShowProfile called with chatId:",L);try{const ee=t.find(he=>he.id===L);if(console.log("Found chat:",ee),ee){const he=$e(ee);console.log("Other participant ID:",he),he?(O(he),M(!0),console.log("Profile modal opened for user:",he)):alert("Не удалось определить пользователя для показа профиля.")}else alert("Чат не найден.");G(null)}catch(ee){console.error("Error showing profile:",ee),alert("Ошибка при открытии профиля пользователя."),G(null)}},ie=()=>{t.filter(ee=>{var he;return ee.participants.includes((u==null?void 0:u.id)||"")&&!ee.archived&&((he=ee.messages)==null?void 0:he.some(ye=>ye.senderId!==(u==null?void 0:u.id)&&!ye.isRead))}).forEach(ee=>{d(ee.id)})};S.useEffect(()=>{const L=ee=>{const he=ee.target,ye=he.closest('button[onClick*="setShowChatMenu"]'),ut=he.closest(".chat-menu");K&&!ye&&!ut&&(console.log("Click outside menu detected, closing menu"),G(null))};return document.addEventListener("mousedown",L),()=>{document.removeEventListener("mousedown",L)}},[K]);const Se=t.filter(L=>{var ee;return L.participants.includes((u==null?void 0:u.id)||"")&&!L.archived&&((ee=L.messages)==null?void 0:ee.some(he=>he.senderId!==(u==null?void 0:u.id)&&!he.isRead))}).length;return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-3 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"МОИ ЧАТЫ"}),e.jsx("p",{className:"text-gray-600 text-xs",children:Se>0?`${Se} непрочитанных сообщений`:"Общайтесь с преподавателями и учениками"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[Se>0&&e.jsx("button",{onClick:ie,className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:"Отметить все как прочитанные"}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ra,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>me(!xe),className:`px-3 py-1 text-sm rounded-lg transition-colors ${xe?"bg-gray-200 text-gray-700":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:xe?"Активные":"Архив"}),e.jsx("button",{onClick:R,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Создать новый чат",children:e.jsx(Vr,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden min-h-0",children:[e.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col flex-shrink-0",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 space-y-2 flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Kr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Поиск чатов...",value:p,onChange:L=>C(L.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("button",{onClick:()=>Ne(!0),className:"w-full bg-gradient-to-r from-green-600 to-green-700 text-white px-4 py-2 rounded-lg font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(Vr,{className:"h-4 w-4"}),e.jsx("span",{children:"Новый чат"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:qe.length>0?qe.map(L=>{var D,z;const ee=$e(L),he=Ge(ee),ye=f===L.id,ut=(D=L.messages)==null?void 0:D.some(X=>X.senderId!==(u==null?void 0:u.id)&&!X.isRead);return e.jsxs("div",{className:`relative p-4 hover:bg-gray-50 cursor-pointer transition-colors chat-menu ${ye?"bg-blue-50 border-r-2 border-blue-500":""}`,onClick:()=>N(L.id),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[he!=null&&he.avatar?e.jsx("img",{src:he.avatar,alt:"avatar",className:"h-12 w-12 rounded-full object-cover",onError:X=>{var pe;const ce=X.target;ce.style.display="none",(pe=ce.nextElementSibling)==null||pe.classList.remove("hidden")}}):e.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:We(L).charAt(0).toUpperCase()})}),ut&&e.jsx("div",{className:"absolute -top-1 -right-1 h-4 w-4 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:((z=L.messages)==null?void 0:z.filter(X=>X.senderId!==(u==null?void 0:u.id)&&!X.isRead).length)||0})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:[We(L),L.archived&&e.jsx("span",{className:"ml-2 text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded",children:"Архив"})]}),L.lastMessage&&e.jsx("span",{className:"text-xs text-gray-400",children:at(L.lastMessage.timestamp)})]}),L.lastMessage?e.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:L.lastMessage.content}):e.jsx("p",{className:"text-sm text-gray-400 italic mt-1",children:"Нет сообщений"})]}),e.jsx("button",{onClick:X=>{console.log("Menu button clicked for chat:",L.id),X.stopPropagation(),G(K===L.id?null:L.id)},className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(lo,{className:"w-4 h-4"})})]}),K===L.id&&e.jsxs("div",{className:"absolute right-2 top-12 bg-white border border-gray-200 rounded-lg shadow-xl py-1 z-50 min-w-[180px]",children:[e.jsxs("button",{onClick:X=>{console.log("Profile button clicked for chat:",L.id),X.preventDefault(),X.stopPropagation(),_(L.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(ve,{className:"w-4 h-4"}),e.jsx("span",{children:"Профиль"})]}),e.jsxs("button",{onClick:X=>{console.log("Mark as read button clicked for chat:",L.id),X.preventDefault(),X.stopPropagation(),P(L.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Yt,{className:"w-4 h-4"}),e.jsx("span",{children:"Отметить как прочитанное"})]}),e.jsxs("button",{onClick:X=>{console.log("Archive button clicked for chat:",L.id),X.preventDefault(),X.stopPropagation(),E(L.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(xi,{className:"w-4 h-4"}),e.jsx("span",{children:"Архивировать"})]}),L.archived&&e.jsxs("button",{onClick:X=>{console.log("Unarchive button clicked for chat:",L.id),X.preventDefault(),X.stopPropagation(),y(L.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(xi,{className:"w-4 h-4"}),e.jsx("span",{children:"Восстановить"})]}),e.jsxs("button",{onClick:X=>{console.log("Clear messages button clicked for chat:",L.id),X.preventDefault(),X.stopPropagation(),A(L.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Xr,{className:"w-4 h-4"}),e.jsx("span",{children:"Очистить сообщения"})]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:X=>{console.log("Delete chat button clicked for chat:",L.id),X.preventDefault(),X.stopPropagation(),b(L.id)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Xr,{className:"w-4 h-4"}),e.jsx("span",{children:"Удалить чат"})]})]})]},L.id)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx(Ue,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Нет чатов"}),e.jsx("p",{className:"text-sm text-center",children:"Начните общение с преподавателями или учениками"})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-white min-h-0",children:q?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[(()=>{const L=$e(q),ee=Ge(L);return ee!=null&&ee.avatar?e.jsx("img",{src:ee.avatar,alt:"avatar",className:"h-10 w-10 rounded-full object-cover"}):e.jsx("div",{className:"h-10 w-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:We(q).charAt(0).toUpperCase()})})})(),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:We(q)}),e.jsx("p",{className:"text-sm text-gray-500",children:(()=>{const L=$e(q),ee=Ge(L);return(ee==null?void 0:ee.role)==="teacher"?"Преподаватель":"Ученик"})()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(jt,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Ut,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{const L=$e(q);O(L),M(!0)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ve,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 min-h-0",children:[q.messages&&q.messages.length>0?q.messages.map(L=>e.jsx("div",{className:`flex ${L.senderId===(u==null?void 0:u.id)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${L.senderId===(u==null?void 0:u.id)?"bg-blue-600 text-white":"bg-white text-gray-900 shadow-sm"}`,children:[e.jsx("p",{className:"text-sm",children:L.content}),e.jsxs("div",{className:`flex items-center justify-end mt-1 space-x-1 ${L.senderId===(u==null?void 0:u.id)?"text-blue-100":"text-gray-400"}`,children:[e.jsx("span",{className:"text-xs",children:Be(L.timestamp)}),L.senderId===(u==null?void 0:u.id)&&e.jsx($d,{className:"w-3 h-3"})]})]})},L.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx(Ue,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Начните общение"}),e.jsx("p",{className:"text-sm text-center",children:"Отправьте первое сообщение"})]}),e.jsx("div",{ref:J})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-end space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("textarea",{value:w,onChange:L=>{k(L.target.value),U(L.target.value.length>0)},onKeyPress:ke,placeholder:"Введите сообщение...",className:"w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:1,style:{minHeight:"44px",maxHeight:"120px"}}),e.jsxs("div",{className:"absolute right-3 bottom-3 flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>re(!Z),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(hn,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>de(!W),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(gi,{className:"w-5 h-5"})})]})]}),e.jsx("button",{onClick:Ee,disabled:!w.trim(),className:"p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:e.jsx(co,{className:"w-5 h-5"})})]}),W&&e.jsx("div",{className:"mt-2 p-2 bg-white border border-gray-200 rounded-lg shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>{var L;return(L=V.current)==null?void 0:L.click()},className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx(gi,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Файл"})]}),e.jsxs("button",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx(Fd,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Голосовое"})]})]})}),e.jsx("input",{ref:V,type:"file",multiple:!0,onChange:$,className:"hidden"})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500",children:[e.jsx(Ue,{className:"w-24 h-24 mb-6 text-gray-300"}),e.jsx("h2",{className:"text-2xl font-medium mb-2",children:"Выберите чат"}),e.jsx("p",{className:"text-center",children:"Выберите чат из списка слева, чтобы начать общение"})]})})]}),T&&j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Профиль пользователя"}),e.jsx("button",{onClick:()=>M(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(cn,{className:"w-5 h-5"})})]}),(()=>{var ee;const L=Ge(j);return L?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[L.avatar?e.jsx("img",{src:L.avatar,alt:"avatar",className:"h-16 w-16 rounded-full object-cover"}):e.jsx("div",{className:"h-16 w-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium text-lg",children:((ee=L.name)==null?void 0:ee.charAt(0).toUpperCase())||"U"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:L.name||"Неизвестный пользователь"}),e.jsx("p",{className:"text-gray-500",children:L.role==="teacher"?"Преподаватель":"Ученик"}),L.email&&e.jsx("p",{className:"text-sm text-gray-400",children:L.email})]})]}),L.profile&&e.jsxs("div",{className:"space-y-4",children:[L.profile.bio&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"О себе"}),e.jsx("p",{className:"text-gray-600",children:L.profile.bio})]}),L.profile.subjects&&L.profile.subjects.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Предметы"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:L.profile.subjects.map((he,ye)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:he},ye))})]}),L.profile.experience&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Опыт"}),e.jsxs("p",{className:"text-gray-600",children:[L.profile.experience==="beginner"&&"Начинающий",L.profile.experience==="experienced"&&"Опытный",L.profile.experience==="professional"&&"Профессионал"]})]}),L.profile.city&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Город"}),e.jsx("p",{className:"text-gray-600",children:L.profile.city})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[e.jsxs("button",{onClick:()=>{M(!1)},className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(jt,{className:"w-4 h-4"}),e.jsx("span",{children:"Позвонить"})]}),e.jsxs("button",{onClick:()=>{M(!1)},className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Ut,{className:"w-4 h-4"}),e.jsx("span",{children:"Видео"})]})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Профиль пользователя не найден"})})})()]})})}),we&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Новый чат"}),e.jsx("button",{onClick:()=>Ne(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ve,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Сообщение"}),e.jsx("textarea",{value:Q,onChange:L=>be(L.target.value),placeholder:"Введите ваше сообщение...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Выберите получателя"}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-lg",children:a.filter(L=>L.id!==(u==null?void 0:u.id)).map(L=>e.jsxs("button",{onClick:()=>fe(L.id,L.name),className:"w-full p-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold",children:L.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:L.name}),e.jsx("div",{className:"text-sm text-gray-500 capitalize",children:L.role==="teacher"?"Преподаватель":"Ученик"})]})]},L.id))})]})]})]})})]})},ad=({isOpen:t,onClose:r,onSave:s})=>{const{user:a}=Ke(),{updateStudentProfile:n}=tt(),[i,o]=S.useState({grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""}),[c,l]=S.useState(0);S.useEffect(()=>{t&&(a!=null&&a.profile)&&(o(a.profile),d(a.profile))},[t,a]);const d=x=>{const v=["bio","age","school","city","phone","parentName","parentPhone","subjects","goals","interests","learningStyle","experience","preferredFormats","preferredDurations","timeZone"],u=v.filter(N=>{const w=x[N];return Array.isArray(w)?w.length>0:w&&w!==""}).length,f=Math.round(u/v.length*100);l(f)};S.useEffect(()=>{d(i)},[i]);const m=()=>{a&&(n(a.id,i),s(i),r())},g=x=>{var u;const v=(u=x.target.files)==null?void 0:u[0];if(v){if(v.size>5*1024*1024){alert("Размер файла не должен превышать 5MB");return}if(!v.type.startsWith("image/")){alert("Пожалуйста, выберите изображение");return}const f=new FileReader;f.onload=N=>{var k;const w=(k=N.target)==null?void 0:k.result;o({...i,avatar:w})},f.readAsDataURL(v)}},h=x=>{switch(x){case"beginner":return"Начинающий";case"intermediate":return"Средний";case"advanced":return"Продвинутый";default:return x}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Ve,{className:"w-6 h-6 text-gray-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Редактирование профиля"}),e.jsxs("button",{onClick:m,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(oo,{className:"w-4 h-4"}),e.jsx("span",{children:"Сохранить"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-6 mb-8",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-green-400 to-blue-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-lg relative",children:[i!=null&&i.avatar&&i.avatar.trim()!==""&&i.avatar!=="undefined"&&i.avatar!=="null"?e.jsx("img",{src:i.avatar,alt:a==null?void 0:a.name,className:"w-24 h-24 object-cover rounded-full",onError:x=>{const v=x.target;v.style.display="none";const u=v.nextElementSibling;u&&u.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-24 h-24 bg-gradient-to-br from-green-400 to-blue-500 rounded-full flex items-center justify-center ${i!=null&&i.avatar&&i.avatar.trim()!==""&&i.avatar!=="undefined"&&i.avatar!=="null"?"hidden":""}`,children:e.jsx(ve,{className:"h-12 w-12 text-white"})})]}),e.jsxs("label",{className:"absolute -bottom-2 -right-2 bg-blue-600 text-white rounded-full p-2 cursor-pointer hover:bg-blue-700 transition-colors",children:[e.jsx(mo,{className:"w-4 h-4"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:g})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a==null?void 0:a.name}),e.jsxs("p",{className:"text-gray-500",children:["@",a==null?void 0:a.id]})]})}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"!"})}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Профиль заполнен на ",c,"%"]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{children:"1 урок"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ar,{className:"w-4 h-4"}),e.jsx("span",{children:"0 завершено"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ve,{className:"w-4 h-4"}),e.jsx("span",{children:"0 предметов"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(hs,{className:"w-4 h-4"}),e.jsx("span",{children:i.experience?h(i.experience):"Не указан"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(ve,{className:"w-5 h-5 mr-2"}),"Личная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(mn,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Школа"}),e.jsx("input",{type:"text",value:i.school||"",onChange:x=>o({...i,school:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Название школы"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ht,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Город"}),e.jsx("input",{type:"text",value:i.city||"",onChange:x=>o({...i,city:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ваш город"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(jt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Телефон"}),e.jsx("input",{type:"tel",value:i.phone||"",onChange:x=>o({...i,phone:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Родитель"}),e.jsx("input",{type:"text",value:i.parentName||"",onChange:x=>o({...i,parentName:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Имя родителя"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(jt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Телефон родителя"}),e.jsx("input",{type:"tel",value:i.parentPhone||"",onChange:x=>o({...i,parentPhone:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ct,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Часовой пояс"}),e.jsx("input",{type:"text",value:i.timeZone||"",onChange:x=>o({...i,timeZone:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"UTC+3 (Москва)"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ae,{className:"w-5 h-5 mr-2"}),"Учебная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Изучаемые предметы"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Математика","Русский язык","Физика","Химия","Биология","История","География","Английский язык"].map(x=>{var v;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((v=i.subjects)==null?void 0:v.includes(x))||!1,onChange:u=>{u.target.checked?o({...i,subjects:[...i.subjects||[],x]}):o({...i,subjects:(i.subjects||[]).filter(f=>f!==x)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:x})]},x)})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Цели обучения"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:["Подготовка к ЕГЭ","Подготовка к ОГЭ","Повышение успеваемости","Углубленное изучение","Подготовка к олимпиаде"].map(x=>{var v;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((v=i.goals)==null?void 0:v.includes(x))||!1,onChange:u=>{u.target.checked?o({...i,goals:[...i.goals||[],x]}):o({...i,goals:(i.goals||[]).filter(f=>f!==x)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:x})]},x)})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Yt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Стиль обучения"}),e.jsxs("select",{value:i.learningStyle||"mixed",onChange:x=>o({...i,learningStyle:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"visual",children:"Визуальный"}),e.jsx("option",{value:"auditory",children:"Аудиальный"}),e.jsx("option",{value:"kinesthetic",children:"Кинестетический"}),e.jsx("option",{value:"mixed",children:"Смешанный"})]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Предпочитаемые форматы"}),e.jsx("div",{className:"flex space-x-4",children:["online","offline","mini-group"].map(x=>{var v;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((v=i.preferredFormats)==null?void 0:v.includes(x))||!1,onChange:u=>{u.target.checked?o({...i,preferredFormats:[...i.preferredFormats||[],x]}):o({...i,preferredFormats:(i.preferredFormats||[]).filter(f=>f!==x)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:x==="online"?"Онлайн":x==="offline"?"Оффлайн":"Мини-группа"})]},x)})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Предпочитаемая длительность"}),e.jsx("div",{className:"flex space-x-4",children:[30,45,60,90].map(x=>{var v;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((v=i.preferredDurations)==null?void 0:v.includes(x))||!1,onChange:u=>{u.target.checked?o({...i,preferredDurations:[...i.preferredDurations||[],x]}):o({...i,preferredDurations:(i.preferredDurations||[]).filter(f=>f!==x)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[x," мин"]})]},x)})})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"О себе"}),e.jsx("textarea",{value:i.bio||"",onChange:x=>o({...i,bio:x.target.value}),rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Расскажите о себе, своих интересах и целях..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Возраст"}),e.jsx("input",{type:"number",value:i.age||"",onChange:x=>o({...i,age:x.target.value?Number(x.target.value):void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"5",max:"25",placeholder:"Укажите возраст"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Уровень знаний"}),e.jsxs("select",{value:i.experience||"beginner",onChange:x=>o({...i,experience:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"intermediate",children:"Средний"}),e.jsx("option",{value:"advanced",children:"Продвинутый"})]})]})]})]})]})}):null},VC=({isOpen:t,onClose:r})=>{var f;const{user:s}=Ke(),{lessons:a}=tt(),[n,i]=S.useState(!1),[o,c]=S.useState(0),l=s==null?void 0:s.profile,d=a.filter(N=>N.studentId===(s==null?void 0:s.id)),m=d.filter(N=>N.status==="completed"),g=((f=l==null?void 0:l.subjects)==null?void 0:f.length)||0;S.useEffect(()=>{if(l){const N=["bio","age","school","city","phone","parentName","parentPhone","subjects","goals","interests","learningStyle","experience","preferredFormats","preferredDurations","timeZone"],w=N.filter(p=>{const C=l[p];return Array.isArray(C)?C.length>0:C&&C!==""}).length,k=Math.round(w/N.length*100);c(k)}},[l]);const h=N=>{switch(N){case"beginner":return"Начинающий";case"intermediate":return"Средний";case"advanced":return"Продвинутый";default:return N}},x=N=>{switch(N){case"visual":return"Визуальный";case"auditory":return"Аудиальный";case"kinesthetic":return"Кинестетический";case"mixed":return"Смешанный";default:return N}},v=()=>{i(!0)},u=N=>{i(!1)};return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(Ve,{className:"w-6 h-6 text-gray-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Профиль ученика"}),e.jsxs("button",{onClick:v,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Jr,{className:"w-4 h-4"}),e.jsx("span",{children:"Редактировать"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-6 mb-8",children:[e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-green-400 to-blue-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-lg relative",children:[l!=null&&l.avatar&&l.avatar.trim()!==""&&l.avatar!=="undefined"&&l.avatar!=="null"?e.jsx("img",{src:l.avatar,alt:s==null?void 0:s.name,className:"w-24 h-24 object-cover rounded-full",onError:N=>{const w=N.target;w.style.display="none";const k=w.nextElementSibling;k&&k.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-24 h-24 bg-gradient-to-br from-green-400 to-blue-500 rounded-full flex items-center justify-center ${l!=null&&l.avatar&&l.avatar.trim()!==""&&l.avatar!=="undefined"&&l.avatar!=="null"?"hidden":""}`,children:e.jsx(ve,{className:"h-12 w-12 text-white"})})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s==null?void 0:s.name}),e.jsxs("p",{className:"text-gray-500",children:["@",s==null?void 0:s.id]})]})}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"!"})}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Профиль заполнен на ",o,"%"]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsxs("span",{children:[d.length," уроков"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ar,{className:"w-4 h-4"}),e.jsxs("span",{children:[m.length," завершено"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ve,{className:"w-4 h-4"}),e.jsxs("span",{children:[g," предметов"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(hs,{className:"w-4 h-4"}),e.jsx("span",{children:l!=null&&l.experience?h(l.experience):"Не указан"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(ve,{className:"w-5 h-5 mr-2"}),"Личная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(mn,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Школа"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.school)||"Не указана"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ht,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Город"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.city)||"Не указан"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(jt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Телефон"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.phone)||"Не указан"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Родитель"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.parentName)||"Не указан"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(jt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Телефон родителя"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.parentPhone)||"Не указан"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ct,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Часовой пояс"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.timeZone)||"Не указан"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ae,{className:"w-5 h-5 mr-2"}),"Учебная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Изучаемые предметы"}),e.jsx("div",{className:"text-base text-gray-900 mt-1",children:l!=null&&l.subjects&&l.subjects.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.subjects.map((N,w)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:N},w))}):"Не указаны"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Цели обучения"}),e.jsx("div",{className:"text-base text-gray-900 mt-1",children:l!=null&&l.goals&&l.goals.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.goals.map((N,w)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:N},w))}):"Не указаны"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Yt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Стиль обучения"}),e.jsx("div",{className:"text-base text-gray-900",children:l!=null&&l.learningStyle?x(l.learningStyle):"Не указан"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Предпочитаемые форматы"}),e.jsx("div",{className:"text-base text-gray-900 mt-1",children:l!=null&&l.preferredFormats&&l.preferredFormats.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.preferredFormats.map((N,w)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full",children:N==="online"?"Онлайн":N==="offline"?"Оффлайн":"Мини-группа"},w))}):"Не указаны"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Предпочитаемая длительность"}),e.jsx("div",{className:"text-base text-gray-900 mt-1",children:l!=null&&l.preferredDurations&&l.preferredDurations.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.preferredDurations.map((N,w)=>e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full",children:[N," мин"]},w))}):"Не указана"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"О себе"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-line leading-relaxed",children:(l==null?void 0:l.bio)||"Информация о себе не указана"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Возраст"}),e.jsx("div",{className:"text-base text-gray-900",children:l!=null&&l.age?`${l.age} лет`:"Не указан"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Уровень знаний"}),e.jsx("div",{className:"text-base text-gray-900",children:l!=null&&l.experience?h(l.experience):"Не указан"})]})]})]})]})}),n&&e.jsx(ad,{isOpen:n,onClose:()=>i(!1),onSave:u})]}):null},KC=()=>{var q,Ee,fe,ke,We,$e,Be,at;const{user:t,updateProfile:r,deleteAccount:s}=Ke(),{updateStudentProfile:a,updateTeacherProfile:n,lessons:i,posts:o,createPost:c,addReaction:l,addComment:d,sharePost:m,bookmarkPost:g,editPost:h,deletePost:x}=tt(),[v,u]=S.useState(!1),[f,N]=S.useState(!1),[w,k]=S.useState(!1),[p,C]=S.useState(!1),[T,M]=S.useState({grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""}),[j,O]=S.useState({subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,teacherType:"private",education:{university:"",degree:"",graduationYear:void 0,courses:[]}}),[B,F]=S.useState(!1),[K,G]=S.useState(!1),[ae,H]=S.useState(!1),[Y,U]=S.useState(!1),[Z]=S.useState([{id:1,avatar:((q=t==null?void 0:t.profile)==null?void 0:q.avatar)||"",name:(t==null?void 0:t.name)||""}]),[re,W]=S.useState(!1),[de,xe]=S.useState(()=>typeof window<"u"&&localStorage.getItem("theme")||"light"),me=["Математика","Русский язык","Английский язык"],we=["1","2","3","4","5","6","7","8","9","10","11","Студент","Взрослый"],Ne=["подготовка к экзаменам","помощь с домашним заданием","углубленное изучение","разговорная практика"],Q=[45,60],be=["online","offline","mini-group"];S.useEffect(()=>{if(t!=null&&t.profile)if(t.role==="student"){const b=t.profile;M({...T,...b})}else{const b=t.profile;O({...j,...b,education:{university:"",degree:"",graduationYear:void 0,courses:[]}})}else if(t&&!t.profile){const b=t.role==="teacher"?{subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,teacherType:"private",education:{university:"",degree:"",graduationYear:void 0,courses:[]}}:{grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""};r(b)}},[t]);const J=b=>{switch(b){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return b}},V=b=>{switch(b){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}};let je=0,Ce=0;if(t&&t.role==="student"&&Array.isArray(i)){const b=i.filter(P=>P.studentId===t.id);je=b.length,Ce=Array.from(new Set(b.map(P=>P.teacherId))).length}if(!t)return null;const Ge=b=>{var A;const P=(A=b.target.files)==null?void 0:A[0];if(P){if(P.size>5*1024*1024){alert("Размер файла не должен превышать 5MB");return}if(!P.type.startsWith("image/")){alert("Пожалуйста, выберите изображение");return}const E=new FileReader;E.onload=y=>{var R;try{const $=(R=y.target)==null?void 0:R.result;if(t.role==="student"){const _={...T,avatar:$};M(_),r(_),a(t.id,_),console.log(" Аватар студента сохранен")}else{const _={...j,avatar:$};O(_),r(_),n(t.id,{..._,name:t.name,email:t.email}),console.log(" Аватар преподавателя сохранен")}}catch($){console.error(" Ошибка при сохранении аватара:",$),alert("Ошибка при сохранении фото. Попробуйте еще раз.")}},E.onerror=()=>{console.error(" Ошибка чтения файла"),alert("Ошибка при чтении файла. Попробуйте выбрать другое изображение.")},E.readAsDataURL(P)}},Je=b=>{M(b),t&&(r(b),a(t.id,b)),k(!1)},qe=b=>{O(b),C(!1),t&&(r(b),n(t.id,{...b,name:t.name,email:t.email})),alert("Профиль преподавателя сохранен!")};return e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 relative",children:[e.jsx("div",{className:"h-20 w-20 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center overflow-hidden shadow-lg",children:(Ee=t.profile)!=null&&Ee.avatar?e.jsx("img",{src:t.profile.avatar,alt:"Avatar",className:"h-20 w-20 rounded-full object-cover"}):e.jsx(ve,{className:"h-10 w-10 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:t?t.name:""}),t&&t.nickname&&e.jsxs("span",{className:"text-gray-400 text-sm",children:["@",t.nickname]})]}),t&&t.role==="student"&&e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[e.jsx(Ae,{className:"w-5 h-5 text-blue-500 mr-1"}),je]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Пройдено уроков"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[e.jsx(ve,{className:"w-5 h-5 text-green-500 mr-1"}),Ce]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Учителей"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[t.role==="student"?e.jsx(e.Fragment,{children:e.jsxs("button",{className:"btn-primary text-sm px-3 py-2",onClick:()=>k(!0),children:[e.jsx(Jr,{className:"w-4 h-4 mr-1"}),"Редактировать"]})}):e.jsxs("button",{className:"btn-primary text-sm px-3 py-2",onClick:()=>C(!0),children:[e.jsx(Jr,{className:"w-4 h-4 mr-1"}),"Редактировать"]}),e.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-500 hover:text-blue-600 rounded-full p-2 shadow transition-colors duration-150 focus:outline-none",style:{width:36,height:36},"aria-label":"Настройки",onClick:()=>G(!0),children:e.jsx(ra,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow p-4 mb-6 text-sm flex flex-col gap-2 card-gradient",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1 space-y-1"})})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-5 mb-6 card-gradient",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-3",children:"О себе"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-line leading-relaxed mb-4 text-sm",children:t.role==="student"?T.bio||"":((fe=t.profile)==null?void 0:fe.bio)||""}),t.role==="student"&&e.jsxs("div",{className:"space-y-3",children:[T.subjects&&T.subjects.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Предметы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:T.subjects.map((b,P)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:b},P))})]}),(T.age||T.school||T.city)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[T.age&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Возраст:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[T.age," лет"]})]}),T.school&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Школа:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:T.school})]}),T.city&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Город:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:T.city})]})]}),T.goals&&T.goals.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Цели обучения:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:T.goals.map((b,P)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:b},P))})]}),T.interests&&T.interests.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Интересы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:T.interests.map((b,P)=>e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:b},P))})]}),(T.learningStyle||T.experience)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[T.learningStyle&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Стиль обучения:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:T.learningStyle==="visual"?"Визуальный":T.learningStyle==="auditory"?"Аудиальный":T.learningStyle==="kinesthetic"?"Кинестетический":"Смешанный"})]}),T.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Уровень:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:T.experience==="beginner"?"Начинающий":T.experience==="intermediate"?"Средний":"Продвинутый"})]})]}),(T.preferredFormats&&T.preferredFormats.length>0||T.preferredDurations&&T.preferredDurations.length>0)&&e.jsxs("div",{className:"space-y-2",children:[T.preferredFormats&&T.preferredFormats.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Форматы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:T.preferredFormats.map((b,P)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full",children:b==="online"?"Онлайн":b==="offline"?"Оффлайн":"Мини-группа"},P))})]}),T.preferredDurations&&T.preferredDurations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Длительность:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:T.preferredDurations.map((b,P)=>e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full",children:[b," мин"]},P))})]})]})]}),t.role==="teacher"&&e.jsxs("div",{className:"space-y-3",children:[j.subjects&&j.subjects.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Предметы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.subjects.map((b,P)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:b},P))})]}),j.grades&&j.grades.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Классы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.grades.map((b,P)=>e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:b},P))})]}),(j.city||j.age||j.experienceYears)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[j.city&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Город:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:j.city})]}),j.age&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Возраст:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[j.age," лет"]})]}),j.experienceYears&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Опыт:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[j.experienceYears," лет"]})]})]}),(j.experience||j.teacherType)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[j.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Уровень:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:J(j.experience)})]}),j.teacherType&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Тип:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:V(j.teacherType)})]})]}),j.goals&&j.goals.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Цели обучения:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.goals.map((b,P)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:b},P))})]}),(j.formats&&j.formats.length>0||j.durations&&j.durations.length>0)&&e.jsxs("div",{className:"space-y-2",children:[j.formats&&j.formats.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Форматы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.formats.map((b,P)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full",children:b==="online"?"Онлайн":b==="offline"?"Оффлайн":"Мини-группа"},P))})]}),j.durations&&j.durations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Длительность:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.durations.map((b,P)=>e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full",children:[b," мин"]},P))})]})]}),j.hourlyRate&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Стоимость:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[j.hourlyRate," руб/час"]})]}),j.education&&(j.education.university||j.education.degree)&&e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Образование:"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[j.education.university&&e.jsx("div",{className:"text-sm text-gray-900",children:j.education.university}),j.education.degree&&e.jsx("div",{className:"text-sm text-gray-700",children:j.education.degree}),j.education.graduationYear&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Год окончания: ",j.education.graduationYear]})]})]})]})]}),e.jsx(VC,{isOpen:f,onClose:()=>N(!1)}),e.jsx(ad,{isOpen:w,onClose:()=>k(!1),onSave:Je}),e.jsx(br,{open:p,onClose:()=>C(!1),children:e.jsxs("div",{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"text-lg font-bold mb-4 text-center",children:"Редактирование профиля преподавателя"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"h-24 w-24 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center overflow-hidden shadow-lg mx-auto",children:j.avatar?e.jsx("img",{src:j.avatar,alt:"Avatar",className:"h-24 w-24 rounded-full object-cover"}):e.jsx(ve,{className:"h-12 w-12 text-white"})}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-blue-500 text-white rounded-full p-2 cursor-pointer hover:bg-blue-600 transition-colors",children:[e.jsx(mo,{className:"w-4 h-4"}),e.jsx("input",{type:"file",accept:"image/*",onChange:Ge,className:"hidden"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"О себе (био)"}),e.jsx("textarea",{value:j.bio||"",onChange:b=>O({...j,bio:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Расскажите о себе..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Город"}),e.jsx("input",{type:"text",value:j.city||"",onChange:b=>O({...j,city:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ваш город"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предметы"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:me.map(b=>{var P;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((P=j.subjects)==null?void 0:P.includes(b))||!1,onChange:A=>{const E=A.target.checked?[...j.subjects||[],b]:(j.subjects||[]).filter(y=>y!==b);O({...j,subjects:E})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:b})]},b)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Классы"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:we.map(b=>{var P;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((P=j.grades)==null?void 0:P.includes(b))||!1,onChange:A=>{const E=A.target.checked?[...j.grades||[],b]:(j.grades||[]).filter(y=>y!==b);O({...j,grades:E})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:b})]},b)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Уровень опыта"}),e.jsxs("select",{value:j.experience||"experienced",onChange:b=>O({...j,experience:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"}),e.jsx("option",{value:"professional",children:"Профессионал"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Тип преподавателя"}),e.jsxs("select",{value:j.teacherType||"private",onChange:b=>O({...j,teacherType:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"private",children:"Частный преподаватель"}),e.jsx("option",{value:"school",children:"Преподаватель школы"}),e.jsx("option",{value:"both",children:"Частный + Школа"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Возраст"}),e.jsx("input",{type:"number",value:j.age||"",onChange:b=>O({...j,age:parseInt(b.target.value)||void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ваш возраст"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Годы опыта"}),e.jsx("input",{type:"number",value:j.experienceYears||"",onChange:b=>O({...j,experienceYears:parseInt(b.target.value)||void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Количество лет опыта"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цели обучения"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ne.map(b=>{var P;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((P=j.goals)==null?void 0:P.includes(b))||!1,onChange:A=>{const E=A.target.checked?[...j.goals||[],b]:(j.goals||[]).filter(y=>y!==b);O({...j,goals:E})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:b})]},b)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Форматы занятий"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:be.map(b=>{var P;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((P=j.formats)==null?void 0:P.includes(b))||!1,onChange:A=>{const E=A.target.checked?[...j.formats||[],b]:(j.formats||[]).filter(y=>y!==b);O({...j,formats:E})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:b==="online"?"Онлайн":b==="offline"?"Оффлайн":"Мини-группа"})]},b)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Длительность занятий"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.map(b=>{var P;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((P=j.durations)==null?void 0:P.includes(b))||!1,onChange:A=>{const E=A.target.checked?[...j.durations||[],b]:(j.durations||[]).filter(y=>y!==b);O({...j,durations:E})},className:"mr-2"}),e.jsxs("span",{className:"text-sm",children:[b," мин"]})]},b)})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Стоимость за час (руб.)"}),e.jsx("input",{type:"number",value:j.hourlyRate||1500,onChange:b=>O({...j,hourlyRate:parseInt(b.target.value)||1500}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"1500"})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Образование"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Университет"}),e.jsx("input",{type:"text",value:((ke=j.education)==null?void 0:ke.university)||"",onChange:b=>O({...j,education:{...j.education,university:b.target.value}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Название университета"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Степень/Специальность"}),e.jsx("input",{type:"text",value:((We=j.education)==null?void 0:We.degree)||"",onChange:b=>O({...j,education:{...j.education,degree:b.target.value}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Степень или специальность"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Год окончания"}),e.jsx("input",{type:"number",value:(($e=j.education)==null?void 0:$e.graduationYear)||"",onChange:b=>O({...j,education:{...j.education,graduationYear:parseInt(b.target.value)||void 0}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"2020"})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Дополнительные настройки"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:j.offlineAvailable||!1,onChange:b=>O({...j,offlineAvailable:b.target.checked}),className:"mr-3"}),e.jsx("span",{className:"text-sm",children:"Доступен для оффлайн занятий"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:j.overbookingEnabled||!1,onChange:b=>O({...j,overbookingEnabled:b.target.checked}),className:"mr-3"}),e.jsx("span",{className:"text-sm",children:"Разрешить перебронирование"})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t",children:[e.jsx("button",{onClick:()=>C(!1),className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Отмена"}),e.jsxs("button",{onClick:()=>qe(j),className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(oo,{className:"w-4 h-4 mr-2 inline"}),"Сохранить"]})]})]})}),e.jsxs(br,{open:B,onClose:()=>F(!1),children:[e.jsx("div",{className:"text-base font-bold mb-2",children:"Контактная информация"}),e.jsxs("div",{className:"mb-2 text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",t.email]})]}),e.jsx(br,{open:K,onClose:()=>G(!1),children:e.jsxs("div",{className:"w-[320px] max-w-full",children:[e.jsx("div",{className:"text-lg font-bold mb-4 text-center",children:"Настройки"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",onClick:()=>{G(!1),H(!0)},children:[e.jsx(Gr,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"flex-1",children:"Push-уведомления"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(io,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"flex-1",children:"Конфиденциальность"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",onClick:()=>{G(!1),U(!0)},children:[e.jsx(ve,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"flex-1",children:"Аккаунт"})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Wd,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"flex-1",children:"Тема"})]}),e.jsx("button",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none ${de==="dark"?"bg-gray-900":"bg-gray-300"}`,onClick:()=>{const b=de==="dark"?"light":"dark";xe(b),b==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",b)},"aria-pressed":de==="dark",type:"button",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${de==="dark"?"translate-x-5":"translate-x-1"}`})})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Md,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"flex-1",children:"Память"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Ud,{className:"w-5 h-5 text-indigo-500"}),e.jsx("span",{className:"flex-1",children:"Устройства"})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Ae,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{className:"flex-1",children:"База знаний"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Ue,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"flex-1",children:"Поддержка"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Vt,{className:"w-5 h-5 text-blue-700"}),e.jsx("span",{className:"flex-1",children:"Документация"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Dt,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"flex-1",children:"Оценить приложение"})]})]})]})}),e.jsx(br,{open:ae,onClose:()=>H(!1),children:e.jsxs("div",{className:"w-[340px] max-w-full",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("button",{onClick:()=>H(!1),className:"mr-2 p-1 rounded hover:bg-gray-100",children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left w-5 h-5 text-gray-500",children:[e.jsx("path",{d:"M19 12H5"}),e.jsx("path",{d:"m12 19-7-7 7-7"})]})}),e.jsx("div",{className:"text-lg font-bold text-center flex-1",children:"Уведомления"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"СООБЩЕНИЯ"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Lt,{label:"Личные сообщения"}),e.jsx(Lt,{label:"Инфобот"}),e.jsx(Lt,{label:"Лиды"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ПУБЛИКАЦИИ ОТ ПОДПИСОК"}),e.jsx("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:e.jsx(Lt,{label:"Новые публикации"})}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ПОДПИСЧИКИ И ДЕЛОВЫЕ СВЯЗИ"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Lt,{label:"Новые подписчики"}),e.jsx(Lt,{label:"Установлена деловая связь"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"МАРКЕТСПЕЙС"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Lt,{label:"Отклики"}),e.jsx(Lt,{label:"Рекомендации"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ГОСЗАКУПКИ"}),e.jsx("div",{className:"bg-gray-50 rounded-xl mb-2 overflow-hidden",children:e.jsx(Lt,{label:"Подборка тендеров по ИНН"})})]})}),e.jsx(br,{open:Y,onClose:()=>U(!1),children:e.jsxs("div",{className:"w-[340px] max-w-full flex flex-col min-h-[340px]",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("button",{onClick:()=>U(!1),className:"mr-2 p-1 rounded hover:bg-gray-100",children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left w-5 h-5 text-gray-500",children:[e.jsx("path",{d:"M19 12H5"}),e.jsx("path",{d:"m12 19-7-7 7-7"})]})}),e.jsx("div",{className:"text-lg font-bold text-center flex-1",children:"Аккаунт"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"НОМЕР ТЕЛЕФОНА"}),e.jsxs("div",{className:"bg-white rounded-xl mb-4 overflow-hidden flex items-center justify-between px-4 py-3",children:[e.jsx("span",{className:"text-sm text-gray-900",children:"Изменить номер"}),e.jsx("span",{className:"text-gray-400 text-sm",children:t.phone||"+7 (999) 300-18-02"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 ml-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ЭЛЕКТРОННАЯ ПОЧТА"}),e.jsxs("div",{className:"bg-white rounded-xl mb-4 overflow-hidden flex items-center justify-between px-4 py-3",children:[e.jsx("span",{className:"text-sm text-gray-900",children:"Изменить эл. почту"}),e.jsx("span",{className:"text-gray-400 text-sm truncate max-w-[120px]",children:t.email}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 ml-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:s,className:"w-full mt-8 mb-2 py-3 rounded-xl bg-red-50 text-red-600 font-bold text-base hover:bg-red-100 transition",children:"Удалить аккаунт"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-bold text-base",children:"Истории"}),e.jsx("button",{className:"text-blue-500 text-xs font-medium hover:underline",onClick:()=>alert("Скоро можно будет добавлять истории!"),children:"Добавить"})]}),e.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-2",children:[e.jsxs("div",{className:"flex flex-col items-center cursor-pointer group",children:[e.jsxs("div",{className:"relative h-14 w-14 rounded-full bg-gradient-to-tr from-blue-400 to-purple-500 flex items-center justify-center overflow-hidden border-2 border-blue-400 group-hover:scale-105 transition",children:[(t.role==="student"?T.avatar:(Be=t.profile)!=null&&Be.avatar)?e.jsx("img",{src:t.role==="student"?T.avatar:(at=t.profile)==null?void 0:at.avatar,alt:"avatar",className:"h-14 w-14 object-cover rounded-full"}):e.jsx(ve,{className:"h-7 w-7 text-white"}),e.jsx("span",{className:"absolute bottom-0 right-0 bg-blue-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs border-2 border-white",children:"+"})]}),e.jsx("span",{className:"text-xs mt-1 text-gray-700",children:"Ваша история"})]}),Z.map(b=>e.jsxs("div",{className:"flex flex-col items-center cursor-pointer group",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-gradient-to-tr from-pink-400 to-yellow-400 flex items-center justify-center overflow-hidden border-2 border-pink-400 group-hover:scale-105 transition",children:b.avatar?e.jsx("img",{src:b.avatar,alt:b.name,className:"h-14 w-14 object-cover rounded-full"}):e.jsx(ve,{className:"h-7 w-7 text-white"})}),e.jsx("span",{className:"text-xs mt-1 text-gray-700 truncate max-w-[60px]",children:b.name})]},b.id))]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"font-bold text-base",children:"Мои записи"}),e.jsxs("button",{onClick:()=>W(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Vr,{className:"w-4 h-4"}),e.jsx("span",{children:"Создать запись"})]})]}),re&&e.jsx("div",{className:"mb-6",children:e.jsx(li,{onSubmit:b=>{c(b),W(!1)},onCancel:()=>W(!1),userName:(t==null?void 0:t.name)||"Пользователь",userAvatar:t==null?void 0:t.avatar})}),e.jsx("div",{className:"space-y-4",children:o.filter(b=>b.userId===(t==null?void 0:t.id)).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"У вас пока нет записей"}),e.jsx("p",{className:"text-gray-500",children:"Создайте первую запись!"})]}):o.filter(b=>b.userId===(t==null?void 0:t.id)).map(b=>e.jsx(on,{post:b,onReaction:l,onComment:d,onShare:m,onBookmark:g,onEdit:h,onDelete:x},b.id))})]})]})},Lt=({label:t})=>{const[r,s]=S.useState(!0);return e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b last:border-b-0",children:[e.jsx("span",{className:"text-sm text-gray-900",children:t}),e.jsx("button",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none ${r?"bg-green-500":"bg-gray-300"}`,onClick:()=>s(a=>!a),"aria-pressed":r,type:"button",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${r?"translate-x-5":"translate-x-1"}`})})]})},JC=()=>{const[t,r]=S.useState(null),[s,a]=S.useState(!0),[n,i]=S.useState(!1);try{const{user:o}=Ke(),[c,l]=S.useState((o==null?void 0:o.role)==="teacher"?"slots":"home");if(S.useEffect(()=>{if(o&&!n){const m=o.role==="teacher"?"slots":"home";l(m),i(!0)}a(!1)},[o,n]),s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Загрузка приложения..."})]})});if(!o)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Добро пожаловать в Nauchi"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Платформа для репетиторов и учеников"}),e.jsx(Jd,{onSuccess:()=>{}})]})});const d=()=>{try{switch(c){case"home":return o.role==="student"?e.jsx(Ua,{setActiveTab:l}):e.jsx(Wa,{});case"slots":return o.role==="teacher"?e.jsx(Wa,{}):e.jsx(Ua,{setActiveTab:l});case"calendar":return o.role==="student"?e.jsx(rd,{onClose:()=>l("home")}):e.jsx(sd,{});case"lessons":return o.role==="student"?e.jsx(qC,{setActiveTab:l}):null;case"students":return o.role==="teacher"?e.jsx(HC,{}):null;case"materials":return o.role==="teacher"?e.jsx(zC,{}):null;case"chats":return e.jsx(YC,{});case"profile":return e.jsx(KC,{});default:return o.role==="student"?e.jsx(Ua,{setActiveTab:l}):e.jsx(Wa,{})}}catch(m){return console.error("Error rendering content:",m),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Ошибка загрузки контента"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Попробуйте перезагрузить страницу"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Перезагрузить"})]})})}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Xd,{activeTab:c,onTabChange:l}),e.jsx("main",{className:c==="chats"?"h-[calc(100vh-64px)]":"container mx-auto px-4 py-8",children:d()})]})}catch(o){return console.error("Error in AppContent:",o),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Ошибка загрузки"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Произошла ошибка при загрузке приложения"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Перезагрузить страницу"})]})})}},XC=()=>e.jsx("div",{className:"App",children:e.jsx(Nd,{children:e.jsx(Sd,{children:e.jsxs(od,{children:[e.jsx(ui,{path:"/teacher/:teacherId",element:e.jsx(td,{teacher:{},onClose:()=>{},onBookLesson:()=>{}})}),e.jsx(ui,{path:"*",element:e.jsx(JC,{})})]})})})});ro(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(cd,{children:e.jsx(XC,{})})}));
