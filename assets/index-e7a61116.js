import{r as N,a as Pd,b as U,g as _t,c as Et,d as pl}from"./vendor-dfbb6397.js";import{l as Md}from"./socket-d9998155.js";import{R as _d,a as Ti,B as Ad}from"./router-90056851.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var vl={exports:{}},ha={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rd=N,Id=Symbol.for("react.element"),Ld=Symbol.for("react.fragment"),Ud=Object.prototype.hasOwnProperty,Fd=Rd.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Wd={key:!0,ref:!0,__self:!0,__source:!0};function bl(t,r,s){var a,n={},i=null,o=null;s!==void 0&&(i=""+s),r.key!==void 0&&(i=""+r.key),r.ref!==void 0&&(o=r.ref);for(a in r)Ud.call(r,a)&&!Wd.hasOwnProperty(a)&&(n[a]=r[a]);if(t&&t.defaultProps)for(a in r=t.defaultProps,r)n[a]===void 0&&(n[a]=r[a]);return{$$typeof:Id,type:t,key:i,ref:o,props:n,_owner:Fd.current}}ha.Fragment=Ld;ha.jsx=bl;ha.jsxs=bl;vl.exports=ha;var e=vl.exports,yl,Di=Pd;yl=Di.createRoot,Di.hydrateRoot;const ot=[];for(let t=0;t<256;++t)ot.push((t+256).toString(16).slice(1));function Hd(t,r=0){return(ot[t[r+0]]+ot[t[r+1]]+ot[t[r+2]]+ot[t[r+3]]+"-"+ot[t[r+4]]+ot[t[r+5]]+"-"+ot[t[r+6]]+ot[t[r+7]]+"-"+ot[t[r+8]]+ot[t[r+9]]+"-"+ot[t[r+10]]+ot[t[r+11]]+ot[t[r+12]]+ot[t[r+13]]+ot[t[r+14]]+ot[t[r+15]]).toLowerCase()}let Ua;const zd=new Uint8Array(16);function Bd(){if(!Ua){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ua=crypto.getRandomValues.bind(crypto)}return Ua(zd)}const Yd=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ei={randomUUID:Yd};function qd(t,r,s){var n;if(Ei.randomUUID&&!r&&!t)return Ei.randomUUID();t=t||{};const a=t.random??((n=t.rng)==null?void 0:n.call(t))??Bd();if(a.length<16)throw new Error("Random bytes length must be >= 16");if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,r){if(s=s||0,s<0||s+16>r.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`);for(let i=0;i<16;++i)r[s+i]=a[i];return r}return Hd(a)}const ze="https://na-uchi.onrender.com",Gd={transports:["websocket","polling"],timeout:1e4,forceNew:!0,upgrade:!0,rememberUpgrade:!0},wl=N.createContext(void 0),it=()=>{const t=N.useContext(wl);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},Tr=()=>{try{const t=localStorage.getItem("tutoring_users");return t?JSON.parse(t):[]}catch{return[]}},Fs=t=>{try{localStorage.setItem("tutoring_users",JSON.stringify(t)),window.dispatchEvent(new StorageEvent("storage",{key:"tutoring_users",newValue:JSON.stringify(t),oldValue:localStorage.getItem("tutoring_users"),storageArea:localStorage})),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_users",newValue:JSON.stringify(t),oldValue:localStorage.getItem("tutoring_users")}}))}catch{}},Ws=t=>{try{localStorage.setItem("tutoring_currentUser",JSON.stringify(t))}catch{}},Vd=()=>{try{const t=localStorage.getItem("tutoring_currentUser");return t?JSON.parse(t):null}catch{return null}},Fa=()=>{try{["tutoring_teacherProfiles","tutoring_studentProfiles","tutoring_timeSlots","tutoring_lessons","tutoring_chats","tutoring_posts","tutoring_notifications"].forEach(r=>{localStorage.removeItem(r),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:r,newValue:null,oldValue:null}}))})}catch{}},Kd=({children:t})=>{const[r,s]=N.useState(()=>{try{return Vd()}catch{return null}}),[a,n]=N.useState(!1);let i=null;try{const h=U.useContext(require("./DataContext").DataContext);h&&(i=h.deleteUserData)}catch{}if(N.useEffect(()=>{const g=setTimeout(()=>{try{const v=Tr();n(!0)}catch{n(!0)}},100);return()=>clearTimeout(g)},[]),!a)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Инициализация авторизации..."})]})});const o=async(h,g)=>{await new Promise(p=>setTimeout(p,1e3));const u=Tr().find(p=>p.email===h);return u?(s(u),Ws(u),!0):(alert("Пользователь с таким email не найден. Пожалуйста, зарегистрируйтесь."),!1)},c=async(h,g,v,u,p,w)=>{try{Fa();const y=await fetch(`${ze}/api/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:h,password:g,name:v,nickname:u,role:p,phone:w})});if(!y.ok){const j=await y.text();try{const k=JSON.parse(j);alert(k.error||"Ошибка регистрации на сервере")}catch{alert("Ошибка регистрации на сервере. Используется локальная регистрация.")}throw new Error("Server registration failed")}const D=await y.json(),T=[...Tr(),D];Fs(T),s(D),Ws(D);try{const j=await fetch(`${ze}/api/sync`);if(j.ok){const k=await j.json();console.log("✅ Данные синхронизированы после регистрации"),k.teacherProfiles&&localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(k.teacherProfiles)),k.studentProfiles&&localStorage.setItem("tutoring_studentProfiles",JSON.stringify(k.studentProfiles));const C=[];k.teacherProfiles&&Object.entries(k.teacherProfiles).forEach(([M,z])=>{C.push({id:M,email:z.email||"",name:z.name||"",nickname:z.nickname||"",role:"teacher",phone:z.phone||"",profile:z})}),k.studentProfiles&&Object.entries(k.studentProfiles).forEach(([M,z])=>{C.push({id:M,email:z.email||"",name:z.name||"",nickname:z.nickname||"",role:"student",phone:z.phone||"",profile:z})}),localStorage.setItem("tutoring_users",JSON.stringify(C)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_users",newValue:JSON.stringify(C)}}))}}catch(j){console.warn("⚠️ Не удалось синхронизировать данные после регистрации:",j)}return!0}catch{const D=Tr(),f=D.some(M=>M.email===h),T=D.some(M=>M.nickname===u);if(f)return alert("Пользователь с таким email уже существует"),!1;if(T)return alert("Пользователь с таким никнеймом уже существует"),!1;const j=p==="teacher"?{subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,education:{university:"",degree:"",graduationYear:void 0,courses:[]}}:{grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""},k={id:qd(),email:h,name:v,nickname:u,role:p,phone:w,profile:j,avatar:j.avatar},C=[...D,k];if(Fs(C),s(k),Ws(k),p==="teacher"){const M=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");M[k.id]=j,localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(M)),console.log("✅ Профиль преподавателя сохранен локально:",k.id),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_teacherProfiles",newValue:JSON.stringify(M)}}))}if(p==="student"){const M=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");M[k.id]=j,localStorage.setItem("tutoring_studentProfiles",JSON.stringify(M)),console.log("✅ Профиль студента сохранен локально:",k.id),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_studentProfiles",newValue:JSON.stringify(M)}}))}try{const M=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}"),z=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}"),I=JSON.parse(localStorage.getItem("tutoring_users")||"[]");if(Object.keys(M).length>0||Object.keys(z).length>0){const X=await fetch(`${ze}/api/upload-local-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherProfiles:M,studentProfiles:z,users:I})});if(X.ok){const G=await X.json();console.log("✅ Локальные данные загружены на сервер:",G),alert("Регистрация выполнена локально и данные синхронизированы с сервером!")}else console.warn("⚠️ Не удалось загрузить локальные данные на сервер"),alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}else alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}catch(M){console.warn("⚠️ Ошибка загрузки локальных данных на сервер:",M),alert("Регистрация выполнена локально. Данные будут синхронизированы при подключении к серверу.")}return!0}},l=()=>{s(null),localStorage.removeItem("tutoring_currentUser"),Fa()},d=h=>{if(r){const g={...r,profile:h,avatar:h.avatar};s(g),Ws(g);const u=Tr().map(p=>p.id===r.id?g:p);Fs(u),typeof window<"u"&&fetch(`${ze}/api/updateProfile`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.id,profileData:h,role:r.role})}).then(p=>{if(p.ok){console.log("Profile updated successfully on server");const w=window.socket;w&&w.emit("profileUpdated",{userId:r.id,profileData:h,role:r.role})}else console.error("Failed to update profile on server:",p.status)}).catch(p=>{console.error("Failed to update profile on server:",p)})}},m=()=>{s(null),localStorage.removeItem("tutoring_users"),localStorage.removeItem("tutoring_currentUser"),Fa()},x=async()=>{if(!r)return alert("Пользователь не найден"),!1;if(!window.confirm("Вы уверены, что хотите удалить свой аккаунт? Это действие нельзя отменить. Все ваши данные будут безвозвратно удалены."))return!1;try{(await fetch(`${ze}/api/delete-user`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.id,role:r.role})})).ok||console.warn("Не удалось удалить пользователя с сервера, продолжаем локальное удаление");const u=Tr().filter(p=>p.id!==r.id);if(Fs(u),r.role==="teacher"){const p=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");delete p[r.id],localStorage.setItem("tutoring_teacherProfiles",JSON.stringify(p)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_teacherProfiles",newValue:JSON.stringify(p)}}))}else if(r.role==="student"){const p=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");delete p[r.id],localStorage.setItem("tutoring_studentProfiles",JSON.stringify(p)),window.dispatchEvent(new CustomEvent("customStorage",{detail:{key:"tutoring_studentProfiles",newValue:JSON.stringify(p)}}))}if(i)i(r.id);else{const w=JSON.parse(localStorage.getItem("tutoring_timeSlots")||"[]").filter(z=>z.teacherId!==r.id);localStorage.setItem("tutoring_timeSlots",JSON.stringify(w));const D=JSON.parse(localStorage.getItem("tutoring_lessons")||"[]").filter(z=>z.teacherId!==r.id&&z.studentId!==r.id);localStorage.setItem("tutoring_lessons",JSON.stringify(D));const T=JSON.parse(localStorage.getItem("tutoring_chats")||"[]").filter(z=>!z.participants.includes(r.id));localStorage.setItem("tutoring_chats",JSON.stringify(T));const k=JSON.parse(localStorage.getItem("tutoring_posts")||"[]").filter(z=>z.userId!==r.id);localStorage.setItem("tutoring_posts",JSON.stringify(k));const M=JSON.parse(localStorage.getItem("tutoring_notifications")||"[]").filter(z=>z.userId!==r.id);localStorage.setItem("tutoring_notifications",JSON.stringify(M))}return l(),alert("Аккаунт успешно удален"),!0}catch(g){return console.error("Ошибка при удалении аккаунта:",g),alert("Произошла ошибка при удалении аккаунта"),!1}};return e.jsx(wl.Provider,{value:{user:r,login:o,register:c,logout:l,updateProfile:d,clearAllUsers:m,deleteAccount:x},children:t})},jl=N.createContext(void 0),ht=()=>{const t=N.useContext(jl);if(!t)throw new Error("useData must be used within a DataProvider");return t},Ct=(t,r)=>{try{const s=localStorage.getItem(t);if(s){const a=JSON.parse(s);return Array.isArray(a)?a:r}}catch{}return r},ee=(t,r)=>{try{localStorage.setItem(t,JSON.stringify(r))}catch{}},Hs=()=>{const t=new Date,r=new Date(t);r.setDate(r.getDate()+1);const s=new Date(t);s.setDate(s.getDate()+2);const a=new Date(t);return a.setDate(a.getDate()+7),{timeSlots:[],lessons:[],chats:[],studentProfiles:{},teacherProfiles:{}}},Jd=({children:t})=>{const r=N.useRef(null),[s,a]=N.useState(!0),[n,i]=N.useState(()=>{const S=Ct("tutoring_timeSlots",[]);if(S.length>0)return S;const F=Hs();return ee("tutoring_timeSlots",F.timeSlots),F.timeSlots}),[o,c]=N.useState(()=>Ct("tutoring_lessons",[])),[l,d]=N.useState(()=>Ct("tutoring_chats",[])),[m,x]=N.useState(()=>{const S=Ct("tutoring_studentProfiles",{});if(Object.keys(S).length>0)return S;const F=Hs();return ee("tutoring_studentProfiles",F.studentProfiles),F.studentProfiles}),[h,g]=N.useState(()=>{const S=Ct("tutoring_teacherProfiles",{});if(Object.keys(S).length>0)return console.log("📱 Загружены локальные профили преподавателей:",Object.keys(S).length),S;const F=Hs();return ee("tutoring_teacherProfiles",F.teacherProfiles),F.teacherProfiles}),[v,u]=N.useState(()=>{try{const S=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("🔄 Загружаем пользователей из localStorage при инициализации:",S.length);const F=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]");console.log("👨‍🏫 Зарегистрированных преподавателей (постоянно сохраненных):",F.length);const A=[...S];F.forEach(b=>{A.find(O=>O.id===b.id)||A.push(b)});const P=A.filter(b=>b.role==="teacher");return console.log("👨‍🏫 Зарегистрированных преподавателей (включая постоянно сохраненных):",P.length,P.map(b=>({id:b.id,name:b.name}))),A}catch(S){return console.error("❌ Ошибка загрузки пользователей из localStorage:",S),[]}}),[p,w]=N.useState(()=>Ct("tutoring_posts",[])),[y,D]=N.useState(()=>Ct("tutoring_notifications",[])),{user:f,updateProfile:T}=it(),j=()=>{const S=Ct("tutoring_timeSlots",[]),F=Ct("tutoring_lessons",[]),A=Ct("tutoring_chats",[]),P=Hs(),L=(S.length>0?S:P.timeSlots).filter((O,R,E)=>R===E.findIndex(B=>B.id===O.id));i(L),c(F),d(A),x(P.studentProfiles),ee("tutoring_timeSlots",L),ee("tutoring_lessons",F),ee("tutoring_chats",A),ee("tutoring_studentProfiles",P.studentProfiles),q()},k=async()=>{try{console.log("🔄 Загружаем пользователей с сервера Render...");const S=await fetch(`${ze}/api/users`);if(!S.ok)return console.warn("⚠️ Не удалось загрузить пользователей с сервера:",S.status),[];const F=await S.json();console.log("✅ Пользователи загружены с сервера Render:",F.length);const A=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("📱 Локальные пользователи:",A.length);const b=[...A,...F].filter((L,O,R)=>O===R.findIndex(E=>E.id===L.id));return console.log("✅ Уникальные пользователи:",b.length),console.log("👨‍🏫 Преподаватели (включая офлайн):",b.filter(L=>L.role==="teacher").length),console.log("👨‍🎓 Студенты:",b.filter(L=>L.role==="student").length),u(b),localStorage.setItem("tutoring_users",JSON.stringify(b)),b}catch(S){return console.error("❌ Ошибка загрузки пользователей с сервера:",S),[]}},C=async()=>{try{console.log("Loading lessons from server...");const S=await fetch(`${ze}/api/lessons`);if(!S.ok)return console.error("Failed to load lessons from server:",S.status),[];const F=await S.json();console.log("Loaded lessons from server:",F.length,F);const A=JSON.parse(localStorage.getItem("tutoring_lessons")||"[]");console.log("Local lessons:",A.length,A);const b=[...A,...F].filter((L,O,R)=>O===R.findIndex(E=>E.id===L.id));return console.log("Setting lessons in context:",b.length,b),c(b),ee("tutoring_lessons",b),b}catch(S){return console.error("Error loading lessons from server:",S),[]}},M=()=>{try{console.log("🔄 Принудительное обновление списка пользователей...");const S=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("👥 Загружено пользователей из localStorage:",S.length);const F=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]");console.log("👨‍🏫 Зарегистрированных преподавателей (постоянно сохраненных):",F.length);const A=[...S];F.forEach(R=>{A.find(B=>B.id===R.id)?console.log("⏭️ Преподаватель уже существует:",R.name):(A.push(R),console.log("✅ Добавлен зарегистрированный преподаватель:",R.name))});const P=A.filter(R=>R.role==="teacher");console.log("👨‍🏫 Зарегистрированных преподавателей (включая постоянно сохраненных):",P.length,P.map(R=>({id:R.id,name:R.name})));const L=(v||[]).filter(R=>R.role==="teacher");P.length>L.length?(u(A),console.log("✅ Обновлены пользователи, добавлено преподавателей:",P.length-L.length)):console.log("⏭️ Пользователи уже актуальны, обновление не требуется");const O=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");console.log("📱 Обновляем teacherProfiles из localStorage:",Object.keys(O).length),g(O),console.log("✅ Обновление пользователей завершено")}catch(S){console.error("❌ Ошибка при обновлении пользователей:",S),console.log("⚠️ Сохраняем текущих пользователей при ошибке")}},z=async()=>{try{console.log("👨‍🏫 Принудительная загрузка зарегистрированных преподавателей...");try{await k()}catch(b){console.warn("⚠️ Не удалось загрузить с сервера, используем локальные данные:",b)}const S=JSON.parse(localStorage.getItem("tutoring_users")||"[]"),F=S.filter(b=>b.role==="teacher");console.log("📱 Зарегистрированных преподавателей (включая офлайн):",F.length),F.forEach(b=>{console.log(`  - ${b.name} (${b.email}) - ID: ${b.id} - Статус: зарегистрирован`)});const A=F.map(b=>({...b,isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()}));localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(A)),u(S);const P=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");return g(P),console.log("🔄 Принудительное обновление состояния для гарантии видимости репетиторов..."),console.log("✅ Зарегистрированные преподаватели загружены (независимо от онлайн статуса)"),F}catch(S){return console.error("❌ Ошибка загрузки зарегистрированных преподавателей:",S),[]}},I=()=>{console.log("🔄 Принудительное обновление всех данных..."),z().catch(console.error),M(),k().catch(console.error),C().catch(console.error),r.current&&s&&(r.current.emit("requestAllSlots"),r.current.emit("requestAllUsers")),X().catch(S=>{console.error("❌ Ошибка при синхронизации данных:",S)})},X=async()=>{try{console.log("🔄 Принудительная синхронизация данных с сервера..."),await k();const S=await fetch(`${ze}/api/sync`,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(1e4)});if(!S.ok){console.warn("⚠️ Не удалось синхронизировать данные с сервера:",S.status,S.statusText);return}const F=S.headers.get("content-type");if(!F||!F.includes("application/json")){console.warn("⚠️ Сервер вернул не-JSON ответ:",F);return}const A=await S.json();console.log("✅ Данные синхронизации получены:",Object.keys(A)),A.timeSlots&&(i(A.timeSlots),ee("tutoring_timeSlots",A.timeSlots),console.log("✅ Слоты обновлены:",A.timeSlots.length)),A.lessons&&(c(A.lessons),ee("tutoring_lessons",A.lessons),console.log("✅ Уроки обновлены:",A.lessons.length)),A.chats&&(d(A.chats),ee("tutoring_chats",A.chats),console.log("✅ Чаты обновлены:",A.chats.length)),A.posts&&(w(A.posts),ee("tutoring_posts",A.posts),console.log("✅ Посты обновлены:",A.posts.length));const P=[];A.teacherProfiles&&(console.log("👨‍🏫 Обновляем профили преподавателей:",Object.keys(A.teacherProfiles).length),Object.entries(A.teacherProfiles).forEach(([b,L])=>{const O=L,R={id:b,email:String(O.email||""),name:String(O.name||""),nickname:String(O.nickname||""),role:"teacher",phone:String(O.phone||""),profile:O};P.push(R),console.log("👨‍🏫 Добавлен преподаватель:",R.id,R.name,R.email)})),A.studentProfiles&&Object.entries(A.studentProfiles).forEach(([b,L])=>{const O=L;P.push({id:b,email:String(O.email||""),name:String(O.name||""),nickname:String(O.nickname||""),role:"student",phone:String(O.phone||""),profile:O})}),u(P),ee("tutoring_users",P),console.log("✅ Синхронизация завершена успешно"),console.log("📊 Итоговые данные:"),console.log("- Всего пользователей:",P.length),console.log("- Преподавателей:",P.filter(b=>b.role==="teacher").length),console.log("- Студентов:",P.filter(b=>b.role==="student").length),console.log("- Пользователи:",P)}catch(S){console.warn("Error syncing data (continuing with local data):",S)}},G=async()=>{try{console.log("📤 Загружаем локальные данные на сервер...");const S=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}"),F=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}"),A=JSON.parse(localStorage.getItem("tutoring_users")||"[]");console.log("📊 Локальные данные:"),console.log(`   👨‍🏫 Преподаватели: ${Object.keys(S).length}`),console.log(`   👨‍🎓 Студенты: ${Object.keys(F).length}`),console.log(`   👥 Пользователи: ${A.length}`);const P=await fetch(`${ze}/api/upload-local-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherProfiles:S,studentProfiles:F,users:A})});if(!P.ok){const L=await P.json();throw new Error(L.error||"Ошибка загрузки данных на сервер")}const b=await P.json();return console.log("✅ Локальные данные успешно загружены на сервер:",b),await X(),b}catch(S){throw console.error("❌ Ошибка загрузки локальных данных на сервер:",S),S}},re=async S=>{try{console.log(`🗑️ Удаляем пользователя: ${S}`);const F=await fetch(`${ze}/api/users/${S}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!F.ok){const P=await F.json();throw new Error(P.error||"Ошибка удаления пользователя")}const A=await F.json();return console.log("✅ Пользователь успешно удален:",A),u(P=>{const b=P.filter(L=>L.id!==S);return ee("tutoring_users",b),b}),g(P=>{const b={...P};return delete b[S],ee("tutoring_teacherProfiles",b),b}),x(P=>{const b={...P};return delete b[S],ee("tutoring_studentProfiles",b),b}),i(P=>P.filter(b=>b.teacherId!==S)),c(P=>P.filter(b=>b.teacherId!==S&&b.studentId!==S)),d(P=>P.filter(b=>!b.participants.includes(S))),w(P=>P.filter(b=>b.userId!==S)),D(P=>P.filter(b=>b.userId!==S)),!0}catch(F){return console.error("❌ Ошибка удаления пользователя:",F),!1}};N.useEffect(()=>{console.log("🔄 Инициализация: загружаем локальных репетиторов..."),z();const S=async()=>{try{const A=await fetch(`${ze}/api/health`,{method:"GET",signal:AbortSignal.timeout(5e3)});if(A.ok){const P=await A.json();return console.log("Server health check passed:",P),!0}return!1}catch(A){return console.warn("Server not available, working in offline mode:",A),!1}};(async()=>{if(!await S()){console.log("Server not available, loading local data only"),j(),C(),z().catch(console.error);return}console.log("Server is available, initializing Socket.IO connection...");const P=Md(ze,{...Gd,reconnection:!0,reconnectionAttempts:3,reconnectionDelay:2e3,timeout:1e4});return r.current=P,P.on("connect",()=>{a(!0),console.log("✅ Connected to server via Socket.IO"),console.log(`🌐 Server URL: ${ze}`),console.log(`🔌 Socket ID: ${P.id}`),console.log("🔄 Первоначальное подключение - обновляем данные..."),I();const b=Ct("tutoring_timeSlots",[]);b.length>0&&b.forEach(L=>{r.current&&r.current.emit("createSlot",L)}),r.current&&(r.current.emit("requestAllPosts"),f&&(r.current.emit("requestUserNotifications",f.id),r.current.emit("subscribeNotifications",f.id)))}),P.on("disconnect",()=>{console.log("🔌 Disconnected from server")}),P.on("reconnect",b=>{a(!0),console.log(`🔄 Reconnected to server after ${b} attempts`),console.log("🔄 Восстановление соединения - обновляем данные..."),I()}),P.on("reconnect_attempt",b=>{console.log(`🔄 Reconnection attempt ${b}`)}),P.on("connect_error",b=>{console.warn("❌ Socket.IO connection error:",b),console.warn("🔧 Working in offline mode until reconnection..."),j(),C(),z().catch(console.error)}),P.on("initialData",b=>{const R=[...Ct("tutoring_timeSlots",[]),...b.timeSlots].filter((E,B,oe)=>B===oe.findIndex(ye=>ye.id===E.id));i(R),c(b.lessons),ee("tutoring_timeSlots",R),ee("tutoring_lessons",b.lessons),b.chats&&(d(b.chats),ee("tutoring_chats",b.chats))}),P.on("allSlots",b=>{console.log("✅ Received all slots from server:",b.length),i(b),ee("tutoring_timeSlots",b),console.log("✅ All slots synchronized, total slots:",b.length)}),P.on("allUsers",b=>{u(b),ee("tutoring_users",b)}),r.current&&s&&(r.current.emit("requestAllSlots"),r.current.emit("requestAllUsers")),P.on("slotCreated",b=>{console.log("✅ Slot created via WebSocket:",b),i(L=>{if(L.find(R=>R.id===b.id)){const R=L.map(E=>E.id===b.id?b:E);return ee("tutoring_timeSlots",R),console.log("✅ Existing slot updated, total slots:",R.length),R}else{const R=[...L,b];ee("tutoring_timeSlots",R),console.log("✅ New slot added, total slots:",R.length);try{const E=v||[];if(!E.find(oe=>oe.id===b.teacherId)){console.log("⚠️ Репетитор не найден в allUsers после создания слота, добавляем...");const oe={id:b.teacherId,name:b.teacherName,avatar:b.teacherAvatar||"",role:"teacher",isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()},ye=[...E,oe];u(ye),localStorage.setItem("tutoring_users",JSON.stringify(ye));const rt=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]");if(!rt.find(wt=>wt.id===b.teacherId)){const wt=[...rt,oe];localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(wt)),console.log("✅ Репетитор добавлен в зарегистрированных преподавателей")}console.log("✅ Репетитор добавлен в allUsers для гарантии отображения")}}catch(E){console.error("❌ Ошибка при проверке видимости репетитора:",E)}return R}}),console.log("🔄 Принудительно обновляем данные после создания слота..."),X().catch(console.error)}),P.on("slotBooked",b=>{console.log("Slot booked via WebSocket:",b),i(L=>{const O=L.map(R=>R.id===b.slotId?{...R,isBooked:!0,bookedStudentId:b.bookedStudentId||b.lesson.studentId}:R);return ee("tutoring_timeSlots",O),O}),c(L=>{if(!L.find(R=>R.id===b.lesson.id)){const R=[...L,b.lesson];return ee("tutoring_lessons",R),console.log("New lesson added, total lessons:",R.length),R}return L})}),P.on("slotCancelled",b=>{console.log("Slot cancelled via WebSocket:",b),i(L=>{const O=L.map(R=>R.id===b.slotId?{...R,isBooked:!1,bookedStudentId:void 0}:R);return ee("tutoring_timeSlots",O),O}),c(L=>{const O=L.filter(R=>R.id!==b.lessonId);return ee("tutoring_lessons",O),console.log("Lesson removed, total lessons:",O.length),O})}),P.on("lessonBooked",b=>{console.log("Lesson booked via WebSocket:",b),c(L=>{if(!L.find(R=>R.id===b.id)){const R=[...L,b];return ee("tutoring_lessons",R),console.log("New lesson added via WebSocket, total lessons:",R.length),R}return L})}),P.on("chatCreated",b=>{d(L=>{if(!L.find(R=>R.id===b.id)){const R=[...L,b];return ee("tutoring_chats",R),R}return L})}),P.on("receiveMessage",b=>{d(L=>L.map(O=>{if(O.id===b.chatId){const R={...O,messages:[...O.messages,b.message],lastMessage:b.message};return ee("tutoring_chats",L.map(E=>E.id===O.id?R:E)),R}return O}))}),P.on("chatDeleted",b=>{console.log("chatDeleted event received:",b),d(L=>{const O=L.filter(R=>R.id!==b.chatId);return console.log(`Chat ${b.chatId} removed from state. Total chats: ${O.length}`),ee("tutoring_chats",O),O})}),P.on("chatMarkedAsRead",b=>{d(L=>{const O=L.map(R=>R.id===b.chatId?{...R,messages:R.messages.map(E=>({...E,isRead:!0}))}:R);return ee("tutoring_chats",O),O})}),P.on("chatMessagesCleared",b=>{d(L=>{const O=L.map(R=>R.id===b.chatId?{...R,messages:[]}:R);return ee("tutoring_chats",O),O})}),P.on("chatArchived",b=>{d(L=>{const O=L.map(R=>R.id===b.chatId?{...R,archived:!0}:R);return ee("tutoring_chats",O),O})}),P.on("chatUnarchived",b=>{d(L=>{const O=L.map(R=>R.id===b.chatId?{...R,archived:!1}:R);return ee("tutoring_chats",O),O})}),P.on("newNotification",b=>{D(L=>{const O=[...L,b];return ee("tutoring_notifications",O),O})}),P.on("slotDeleted",b=>{console.log("Slot deleted via WebSocket:",b),i(L=>{const O=L.filter(R=>R.id!==b.slotId);return ee("tutoring_timeSlots",O),console.log("Slot removed, total slots:",O.length),O})}),P.on("allLessons",b=>{console.log("Received all lessons from server:",b.length),c(b),ee("tutoring_lessons",b)}),P.on("dataUpdated",b=>{if(console.log("Received dataUpdated event:",b.type),b.timeSlots&&(i(b.timeSlots),ee("tutoring_timeSlots",b.timeSlots),console.log("Slots updated via dataUpdated:",b.timeSlots.length)),b.lessons&&(c(b.lessons),ee("tutoring_lessons",b.lessons),console.log("Lessons updated via dataUpdated:",b.lessons.length)),b.teacherProfiles){g(b.teacherProfiles),ee("tutoring_teacherProfiles",b.teacherProfiles);const O=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(R=>R.role==="teacher"&&b.teacherProfiles[R.id]?{...R,profile:b.teacherProfiles[R.id]}:R);u(O),ee("tutoring_users",O)}if(b.studentProfiles){x(b.studentProfiles),ee("tutoring_studentProfiles",b.studentProfiles);const O=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(R=>R.role==="student"&&b.studentProfiles[R.id]?{...R,profile:b.studentProfiles[R.id]}:R);u(O),ee("tutoring_users",O)}}),P.on("userRegistered",b=>{u(L=>{if(!L.find(R=>R.id===b.id)){const R=[...L,b];if(ee("tutoring_users",R),b.role==="teacher"){const E=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]"),B={...b,isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()},oe=[...E,B];localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(oe)),console.log("👨‍🏫 Преподаватель сохранен для постоянного отображения:",b.name)}return R}return L});try{z(),r.current&&s&&r.current.emit("requestAllUsers")}catch{}}),P.on("userDeleted",b=>{console.log("🗑️ Получено событие удаления пользователя:",b),u(L=>{const O=L.filter(R=>R.id!==b.userId);return ee("tutoring_users",O),O}),b.userRole==="teacher"?g(L=>{const O={...L};return delete O[b.userId],ee("tutoring_teacherProfiles",O),O}):b.userRole==="student"&&x(L=>{const O={...L};return delete O[b.userId],ee("tutoring_studentProfiles",O),O}),i(L=>L.filter(O=>O.teacherId!==b.userId)),c(L=>L.filter(O=>O.teacherId!==b.userId&&O.studentId!==b.userId)),d(L=>L.filter(O=>!O.participants.includes(b.userId))),w(L=>L.filter(O=>O.userId!==b.userId)),D(L=>L.filter(O=>O.userId!==b.userId)),console.log("✅ Пользователь удален из локального состояния")}),r.current&&r.current.on("lessonCompleted",b=>{if(c(L=>{const O=L.map(R=>R.id===b.lesson.id?b.lesson:R);return ee("tutoring_lessons",O),O}),f&&f.role==="teacher"&&b.lesson.status==="completed"){const L={...f.profile};L.lessonsCount=(L.lessonsCount||0)+1,T(L)}}),P.on("studentProfiles",b=>{x(b||{});const O=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(b).forEach(([R,E])=>{const B=O.findIndex(oe=>oe.id===R);B>=0?O[B]={...O[B],profile:E}:O.push({id:R,email:E.email||"",name:E.name||"",nickname:E.nickname||"",role:"student",phone:E.phone||"",profile:E})}),localStorage.setItem("tutoring_users",JSON.stringify(O)),u(O)}),P.on("teacherProfiles",b=>{g(b),ee("tutoring_teacherProfiles",b);const O=[...JSON.parse(localStorage.getItem("tutoring_users")||"[]")];Object.entries(b).forEach(([R,E])=>{const B=O.findIndex(oe=>oe.id===R);B>=0?O[B]={...O[B],profile:E}:O.push({id:R,email:E.email||"",name:E.name||"",nickname:E.nickname||"",role:"teacher",phone:E.phone||"",profile:E})}),localStorage.setItem("tutoring_users",JSON.stringify(O)),u(O)}),P.on("studentProfileUpdated",b=>{x(L=>({...L,[b.studentId]:b.profile}))}),P.on("teacherProfileUpdated",b=>{try{const O=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(R=>R.id===b.teacherId?{...R,profile:b.profile,avatar:b.profile.avatar}:R);localStorage.setItem("tutoring_users",JSON.stringify(O)),u(O)}catch{}}),P.on("profileUpdated",b=>{try{const L=JSON.parse(localStorage.getItem("tutoring_users")||"[]");let O=!1;const R="userId"in b?b.userId:b.id,E="type"in b?b.type:b.role,B=b.profile,oe=L.map(ye=>ye.id===R?(O=!0,{...ye,profile:B,avatar:B.avatar,name:B.name||ye.name,email:B.email||ye.email}):ye);O||oe.push({id:R,role:E,profile:B,avatar:B.avatar,name:B.name||"",email:B.email||""}),localStorage.setItem("tutoring_users",JSON.stringify(oe)),u(oe),E==="teacher"?g(ye=>({...ye,[R]:B})):E==="student"&&x(ye=>({...ye,[R]:B})),console.log("Profile updated via WebSocket:",{userId:R,role:E,profile:B})}catch(L){console.error("Error processing profileUpdated event:",L)}}),P.on("userRegistered",b=>{try{const L=JSON.parse(localStorage.getItem("tutoring_users")||"[]"),O=L.findIndex(R=>R.id===b.id);if(O>=0?L[O]=b:L.push(b),localStorage.setItem("tutoring_users",JSON.stringify(L)),u(L),b.role==="teacher"){const R=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]"),E={...b,isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()},B=[...R,E];localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(B)),console.log("👨‍🏫 Преподаватель сохранен для постоянного отображения:",b.name)}z().catch(console.error),r.current&&s&&r.current.emit("requestAllUsers")}catch{}}),P.on("allPosts",b=>{w(b),ee("tutoring_posts",b)}),P.on("postCreated",b=>{w(L=>{const O=[b,...L];return ee("tutoring_posts",O),O})}),P.on("postReactionUpdated",b=>{w(L=>{const O=L.map(R=>R.id===b.postId?{...R,reactions:b.reactions,likes:b.likes}:R);return ee("tutoring_posts",O),O})}),P.on("postCommentAdded",b=>{w(L=>{const O=L.map(R=>R.id===b.postId?{...R,comments:[...R.comments,b.comment]}:R);return ee("tutoring_posts",O),O})}),P.on("postEdited",b=>{w(L=>{const O=L.map(R=>R.id===b.postId?{...R,text:b.text,tags:b.tags,editedAt:b.editedAt}:R);return ee("tutoring_posts",O),O})}),P.on("postDeleted",b=>{w(L=>{const O=L.filter(R=>R.id!==b.postId);return ee("tutoring_posts",O),O})}),P.on("postBookmarkUpdated",b=>{w(L=>{const O=L.map(R=>R.id===b.postId?{...R,bookmarks:b.bookmarks}:R);return ee("tutoring_posts",O),O})}),P.on("searchResults",b=>{}),P.on("userNotifications",b=>{D(b),ee("tutoring_notifications",b)}),P.on("notificationMarkedAsRead",b=>{D(L=>{const O=L.map(R=>R.id===b.notificationId?{...R,isRead:!0,readAt:new Date().toISOString()}:R);return ee("tutoring_notifications",O),O})}),P.on("allNotificationsMarkedAsRead",b=>{D(L=>{const O=L.map(R=>R.userId===b.userId?{...R,isRead:!0,readAt:new Date().toISOString()}:R);return ee("tutoring_notifications",O),O})}),()=>{try{P.removeAllListeners()}catch{}try{P.disconnect()}catch{}r.current=null}})()},[]),N.useEffect(()=>{const S=A=>{if(A.key==="tutoring_users")try{const P=JSON.parse(A.newValue||"[]");u(P);const b=P.filter(L=>L.role==="teacher");console.log("🔄 Обновление репетиторов через localStorage:",b.length)}catch{u([])}},F=A=>{var P,b,L;if(((P=A.detail)==null?void 0:P.key)==="tutoring_users")try{const O=JSON.parse(A.detail.newValue||"[]");u(O),console.log("🔄 Пользователи обновлены через customStorage:",O.length)}catch{u([])}if(((b=A.detail)==null?void 0:b.key)==="tutoring_teacherProfiles")try{const O=JSON.parse(A.detail.newValue||"{}");g(O),console.log("🔄 Профили преподавателей обновлены через customStorage:",Object.keys(O).length)}catch(O){console.error("❌ Ошибка обновления профилей преподавателей:",O)}if(((L=A.detail)==null?void 0:L.key)==="tutoring_studentProfiles")try{const O=JSON.parse(A.detail.newValue||"{}");x(O),console.log("🔄 Профили студентов обновлены через customStorage:",Object.keys(O).length)}catch(O){console.error("❌ Ошибка обновления профилей студентов:",O)}};return window.addEventListener("storage",S),window.addEventListener("customStorage",F),()=>{window.removeEventListener("storage",S),window.removeEventListener("customStorage",F)}},[]),N.useEffect(()=>{ee("tutoring_timeSlots",n),n.length>0&&(console.log("🔄 timeSlots изменились, принудительно синхронизируем с сервером..."),X().catch(console.error))},[n,X]),N.useEffect(()=>{ee("tutoring_lessons",o)},[o]),N.useEffect(()=>{ee("tutoring_chats",l)},[l]),N.useEffect(()=>{ee("tutoring_posts",p)},[p]),N.useEffect(()=>{ee("tutoring_notifications",y)},[y]),N.useEffect(()=>{f&&r.current&&s&&(r.current.emit("subscribeNotifications",f.id),r.current.emit("requestUserNotifications",f.id))},[f,s]);const H=S=>{const F={...S,id:`slot_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};i(A=>{const P=[...A,F];return ee("tutoring_timeSlots",P),P}),r.current&&s&&r.current.emit("createSlot",F)},$=async(S,F,A,P)=>new Promise((b,L)=>{if((P==null?void 0:P.mode)==="assign"&&(!F||!A)){alert("Ошибка: не выбран ученик для назначения урока!"),L(new Error("createSlot: assign mode without studentId/studentName"));return}const O=!!F,R={...S,id:`slot_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,isBooked:O,...O?{bookedStudentId:F}:{}};i(E=>{const B=[...E,R];return ee("tutoring_timeSlots",B),console.log("✅ Слот создан и сохранен локально:",R.id),B});try{const E=v||[];if(E.find(oe=>oe.id===R.teacherId))console.log("✅ Репетитор уже существует в allUsers");else{console.log("⚠️ Репетитор не найден в allUsers, добавляем...");const oe={id:R.teacherId,name:R.teacherName,avatar:R.teacherAvatar||"",role:"teacher",isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()},ye=[...E,oe];u(ye),localStorage.setItem("tutoring_users",JSON.stringify(ye));const rt=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]");if(!rt.find(wt=>wt.id===R.teacherId)){const wt=[...rt,oe];localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(wt)),console.log("✅ Репетитор добавлен в зарегистрированных преподавателей")}console.log("✅ Репетитор добавлен в allUsers для гарантии отображения")}}catch(E){console.error("❌ Ошибка при проверке видимости репетитора:",E)}if(r.current&&s?(r.current.emit("createSlot",R),console.log("📡 Слот отправлен на сервер")):console.log("⚠️ Нет соединения с сервером, слот сохранен локально"),O&&F&&A){const E={id:`lesson_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,studentId:F,teacherId:R.teacherId,studentName:A,teacherName:R.teacherName,subject:R.subject,date:R.date,startTime:R.startTime,endTime:R.endTime,duration:R.duration,format:R.format,status:"scheduled",price:R.price,lessonType:R.lessonType};if(c(B=>[...B,E]),ve(F,R.teacherId,A,R.teacherName),f&&f.role==="teacher"){const B={...f.profile};B.students||(B.students=[]),B.students.includes(F)||B.students.push(F),T(B)}r.current&&s&&r.current.emit("bookSlot",{slotId:R.id,lesson:E,bookedStudentId:F})}b(R)}),W=(S,F,A,P)=>{const b=n.find(O=>O.id===S);if(!b||b.isBooked)return;if(f&&f.role==="teacher"){const O={...f.profile};O.students||(O.students=[]),O.students.includes(F)||O.students.push(F),T(O)}i(O=>O.map(R=>R.id===S?{...R,isBooked:!0,bookedStudentId:F}:R));const L={id:`lesson_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,studentId:F,teacherId:b.teacherId,studentName:A,teacherName:b.teacherName,subject:b.subject,date:b.date,startTime:b.startTime,endTime:b.endTime,duration:b.duration,format:b.format,status:"scheduled",price:b.price,lessonType:b.lessonType,comment:P||""};c(O=>[...O,L]),ve(F,b.teacherId,A,b.teacherName),r.current&&s&&r.current.emit("bookSlot",{slotId:S,lesson:L,bookedStudentId:F})},Q=S=>{const F=o.find(P=>P.id===S);if(!F)return;const A=n.find(P=>P.teacherId===F.teacherId&&P.date===F.date&&P.startTime===F.startTime);c(P=>P.filter(b=>b.id!==S)),A&&(i(P=>P.map(b=>b.id===A.id?{...b,isBooked:!1,bookedStudentId:void 0}:b)),r.current&&s&&r.current.emit("cancelSlot",{slotId:A.id,lessonId:S}))},te=(S,F,A)=>{const P=o.find(L=>L.id===S);if(!P)return;const b=new Date(`2000-01-01T${A}`);b.setMinutes(b.getMinutes()+P.duration),c(L=>L.map(O=>O.id===S?{...O,date:F,startTime:A,endTime:b.toTimeString().slice(0,5)}:O)),i(L=>L.map(O=>O.teacherId===P.teacherId&&O.date===P.date&&O.startTime===P.startTime?{...O,isBooked:!1,bookedStudentId:void 0}:O))},me=S=>n.filter(A=>{var L;if(A.isBooked)return!1;const P=new Date(A.date),b=new Date;if(b.setHours(0,0,0,0),P<b||S.grade&&S.grade!==""&&(!A.grades||!A.grades.includes(S.grade))||S.subject&&S.subject!==""&&A.subject!==S.subject||S.experience&&S.experience!==""&&A.experience!==S.experience||S.lessonType&&S.lessonType!==""&&A.lessonType!==S.lessonType||S.duration&&S.duration>0&&A.duration!==S.duration||S.format&&S.format!==""&&A.format!==S.format||S.minRating&&S.minRating>0&&(A.rating||0)<S.minRating||S.goals&&S.goals.length>0&&(!A.goals||!S.goals.some(O=>A.goals.includes(O))))return!1;if(S.city&&S.city!==""){const O=v.find(E=>E.id===A.teacherId),R=((L=O==null?void 0:O.profile)==null?void 0:L.city)||"";if(R&&!R.toLowerCase().includes(S.city.toLowerCase()))return!1}return!0}),ve=(S,F,A,P)=>{console.log("🔍 getOrCreateChat DEBUG:"),console.log("- Participant 1:",{id:S,name:A}),console.log("- Participant 2:",{id:F,name:P}),console.log("- Current chats count:",l.length);const b=l.find(O=>O.participants.includes(S)&&O.participants.includes(F));if(b)return console.log("✅ Found existing chat:",b.id),b.id;console.log("🆕 Creating new chat...");const L={id:`chat_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,participants:[S,F],participantNames:[A,P],messages:[]};if(console.log("📝 New chat created:",L.id),d(O=>{const R=[...O,L];return ee("tutoring_chats",R),console.log("💾 Chat saved to localStorage, total chats:",R.length),R}),r.current&&s){console.log("📡 Sending chat to server..."),r.current.emit("createChat",L);const O={id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:F,type:"new_chat",title:"Новый чат",message:`${A} создал с вами чат`,isRead:!1,timestamp:new Date().toISOString(),data:{chatId:L.id,studentId:S,studentName:A}};r.current.emit("createNotification",O),console.log("📬 Notification sent to server")}else console.log("⚠️ Socket not connected, chat not sent to server");return console.log("🔍 END getOrCreateChat DEBUG"),L.id},Ne=(S,F,A,P)=>{console.log("🔍 sendMessage DEBUG:"),console.log("- Chat ID:",S),console.log("- Sender:",{id:F,name:A}),console.log("- Content:",P);const b=l.find(E=>E.id===S);if(!b){console.error("❌ Chat not found:",S);return}console.log("✅ Chat found:",{id:b.id,participants:b.participants,participantNames:b.participantNames});const L=b.participants.find(E=>E!==F),O=b.participantNames.find((E,B)=>b.participants[B]!==F);if(!L){console.error("❌ Receiver not found in chat participants");return}console.log("📬 Receiver:",{id:L,name:O});const R={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,senderId:F,senderName:A,receiverId:L,receiverName:O||"Неизвестный пользователь",content:P,timestamp:new Date().toISOString(),isRead:!1};console.log("📝 Message created:",R.id),d(E=>E.map(B=>{if(B.id===S){const oe={...B,messages:[...B.messages,R],lastMessage:R};return ee("tutoring_chats",E.map(ye=>ye.id===B.id?oe:ye)),console.log("💾 Message saved locally, total messages in chat:",oe.messages.length),oe}return B})),r.current&&s?(console.log("📡 Sending message to server..."),r.current.emit("sendMessage",{chatId:S,message:R}),console.log("✅ Message sent to server")):console.log("⚠️ Socket not connected, message not sent to server"),console.log("🔍 END sendMessage DEBUG")},he=(S,F,A,P,b)=>{if(console.log("🔍 sendMessageToUser DEBUG:"),console.log("- Sender:",{id:S,name:F}),console.log("- Receiver:",{id:A,name:P}),console.log("- Content:",b),!S||!F||!A||!P||!b)return console.error("❌ Missing required parameters for sendMessageToUser"),"";const L=ve(S,A,F,P);return console.log("- Chat ID:",L),L?(Ne(L,S,F,b),console.log("✅ Message sent successfully to chat:",L),console.log("🔍 END sendMessageToUser DEBUG"),L):(console.error("❌ Failed to create or find chat"),"")},Te=S=>{r.current&&s&&r.current.emit("lessonCompleted",{lessonId:S})},Z=(S,F)=>{r.current&&r.current.emit("updateStudentProfile",{studentId:S,profile:F}),x(A=>({...A,[S]:F}))},K=S=>{i(F=>{const A=F.map(P=>P.id===S?{...P,isDeleted:!0}:P);return ee("tutoring_timeSlots",A),A}),r.current&&s&&r.current.emit("deleteSlot",{slotId:S})},je=()=>{i([]),c([]),d([]),localStorage.removeItem("tutoring_timeSlots"),localStorage.removeItem("tutoring_lessons"),localStorage.removeItem("tutoring_chats"),localStorage.removeItem("tutoring_users"),localStorage.removeItem("tutoring_currentUser")},V=(S,F)=>{console.log("🔄 Обновляем профиль преподавателя:",S,F),g(A=>{const P={...A,[S]:F};return ee("tutoring_teacherProfiles",P),console.log("✅ Профиль преподавателя сохранен в teacherProfiles"),P}),r.current&&s&&(r.current.emit("updateTeacherProfile",{teacherId:S,profile:F}),console.log("📡 Профиль преподавателя отправлен на сервер"));try{const P=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(O=>O.id===S?{...O,profile:F,avatar:F.avatar}:O);localStorage.setItem("tutoring_users",JSON.stringify(P)),console.log("✅ Профиль преподавателя обновлен в tutoring_users"),u(O=>{const R=O.map(E=>E.id===S?{...E,profile:F,avatar:F.avatar}:E);return console.log("✅ allUsers обновлен, репетитор остался видимым"),R});const L=JSON.parse(localStorage.getItem("tutoring_registeredTeachers")||"[]").map(O=>O.id===S?{...O,profile:F,avatar:F.avatar}:O);localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(L)),console.log("✅ Зарегистрированные преподаватели обновлены")}catch(A){console.error("❌ Ошибка обновления списка пользователей:",A)}},ce=S=>{if(!f)return;const F=b=>{if(!b)return[];const L=/#[\wа-яё]+/gi,O=b.match(L);return O?[...new Set(O.map(R=>R.toLowerCase()))]:[]},A=S.media.map(b=>URL.createObjectURL(b)),P={id:`post_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:f.id,userName:f.name,userAvatar:f.avatar,text:S.text,media:A,type:S.type,date:new Date().toISOString(),reactions:[],comments:[],isBookmarked:!1,tags:F(S.text),likes:0,views:0,bookmarks:[]};w(b=>{const L=[P,...b];return ee("tutoring_posts",L),L}),r.current&&s&&r.current.emit("createPost",P)},De=(S,F)=>{f&&(w(A=>{const P=A.map(b=>{if(b.id===S){const L=b.reactions.find(E=>E.userId===f.id);let O=[...b.reactions],R=b.likes||0;return L?L.type===F?(O=b.reactions.filter(E=>E.userId!==f.id),R=Math.max(0,R-1)):L.type=F:(O.push({id:`reaction_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:f.id,type:F,date:new Date().toISOString()}),R++),{...b,reactions:O,likes:R}}return b});return ee("tutoring_posts",P),P}),r.current&&s&&r.current.emit("addReaction",{postId:S,reactionType:F,userId:f.id}))},Ie=(S,F)=>{if(!f)return;const A={id:`comment_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:f.id,userName:f.name,userAvatar:f.avatar,text:F,date:new Date().toISOString()};w(P=>{const b=P.map(L=>L.id===S?{...L,comments:[...L.comments,A]}:L);return ee("tutoring_posts",b),b}),r.current&&s&&r.current.emit("addComment",{postId:S,comment:A})},Le=S=>{},Xe=S=>{f&&(w(F=>{const A=F.map(P=>{if(P.id===S){const b=P.bookmarks||[],L=b.indexOf(f.id);let O=[...b];return L===-1?O.push(f.id):O.splice(L,1),{...P,bookmarks:O}}return P});return ee("tutoring_posts",A),A}),r.current&&s&&r.current.emit("bookmarkPost",{postId:S,userId:f.id}))},Qe=(S,F)=>{const A=P=>{if(!P)return[];const b=/#[\wа-яё]+/gi,L=P.match(b);return L?[...new Set(L.map(O=>O.toLowerCase()))]:[]};w(P=>{const b=P.map(L=>L.id===S?{...L,text:F,tags:A(F),editedAt:new Date().toISOString()}:L);return ee("tutoring_posts",b),b}),r.current&&s&&r.current.emit("editPost",{postId:S,newText:F})},J=S=>{w(F=>{const A=F.filter(P=>P.id!==S);return ee("tutoring_posts",A),A}),r.current&&s&&r.current.emit("deletePost",{postId:S})},$e=S=>{console.log("deleteChat called with chatId:",S),console.log("Current chats count:",l.length),d(F=>{if(!F.find(b=>b.id===S))return console.warn("Chat not found for deletion:",S),F;const P=F.filter(b=>b.id!==S);return console.log(`Chat ${S} removed. New count: ${P.length}`),ee("tutoring_chats",P),P}),r.current&&s?(console.log("Sending deleteChat event to server"),r.current.emit("deleteChat",{chatId:S})):console.warn("Socket not connected, chat deletion not synced to server")},be=S=>{d(F=>{const A=F.map(P=>P.id===S?{...P,messages:P.messages.map(b=>({...b,isRead:!0}))}:P);return ee("tutoring_chats",A),A}),r.current&&s&&r.current.emit("markChatAsRead",{chatId:S})},Me=S=>{d(F=>{const A=F.map(P=>P.id===S?{...P,messages:[]}:P);return ee("tutoring_chats",A),A}),r.current&&s&&r.current.emit("clearChatMessages",{chatId:S})},ut=S=>{d(F=>{const A=F.map(P=>P.id===S?{...P,archived:!0}:P);return ee("tutoring_chats",A),A}),r.current&&s&&r.current.emit("archiveChat",{chatId:S})},Fe=S=>{d(F=>{const A=F.map(P=>P.id===S?{...P,archived:!1}:P);return ee("tutoring_chats",A),A}),r.current&&s&&r.current.emit("unarchiveChat",{chatId:S})},q=async()=>{try{console.log("🔄 Loading chats from server:",`${ze}/api/sync`);const S=await fetch(`${ze}/api/sync`);if(S.ok){const F=S.headers.get("content-type");if(F&&F.includes("application/json")){const A=await S.json();A.chats&&(console.log("✅ Loaded chats from server:",A.chats.length),d(A.chats),ee("tutoring_chats",A.chats))}else console.warn("⚠️ Server returned non-JSON response, using local chats")}else console.error("❌ Failed to load chats from server:",S.status,S.statusText)}catch(S){console.warn("⚠️ Error loading chats from server, using local chats:",S)}},fe=S=>{console.log("🗑️ Удаляем все данные пользователя:",S),i(F=>{const A=F.filter(P=>P.teacherId!==S);return ee("tutoring_timeSlots",A),A}),c(F=>{const A=F.filter(P=>P.teacherId!==S&&P.studentId!==S);return ee("tutoring_lessons",A),A}),d(F=>{const A=F.filter(P=>!P.participants.includes(S));return ee("tutoring_chats",A),A}),w(F=>{const A=F.filter(P=>P.userId!==S);return ee("tutoring_posts",A),A}),D(F=>{const A=F.filter(P=>P.userId!==S);return ee("tutoring_notifications",A),A}),(f==null?void 0:f.role)==="teacher"?g(F=>{const A={...F};return delete A[S],ee("tutoring_teacherProfiles",A),A}):(f==null?void 0:f.role)==="student"&&x(F=>{const A={...F};return delete A[S],ee("tutoring_studentProfiles",A),A}),u(F=>{const A=F.filter(P=>P.id!==S);return ee("tutoring_users",A),A}),console.log("✅ Все данные пользователя удалены")};return e.jsx(jl.Provider,{value:{timeSlots:n,lessons:o,chats:l,posts:p,createTimeSlot:H,bookLesson:W,cancelLesson:Q,rescheduleLesson:te,getFilteredSlots:me,sendMessage:Ne,sendMessageToUser:he,getOrCreateChat:ve,clearAllData:je,isConnected:s,completeLesson:Te,studentProfiles:m,updateStudentProfile:Z,deleteSlot:K,createSlot:$,allUsers:v,setAllUsers:S=>{u(S),localStorage.setItem("tutoring_users",JSON.stringify(S));const F=S.filter(A=>A.role==="teacher");if(F.length>0){const A=F.map(P=>({...P,isRegistered:!0,isOnline:!1,lastSeen:new Date().toISOString()}));localStorage.setItem("tutoring_registeredTeachers",JSON.stringify(A))}},refreshUsers:M,loadRegisteredTeachers:z,refreshAllData:I,forceSyncData:X,uploadLocalDataToServer:G,deleteUser:re,teacherProfiles:h,updateTeacherProfile:V,socketRef:r,loadInitialData:j,createPost:ce,addReaction:De,addComment:Ie,sharePost:Le,bookmarkPost:Xe,editPost:Qe,deletePost:J,searchPosts:S=>{r.current&&s&&r.current.emit("searchPosts",S)},getPostsByUser:S=>p.filter(F=>F.userId===S),getBookmarkedPosts:S=>p.filter(F=>{var A;return(A=F.bookmarks)==null?void 0:A.includes(S)}),notifications:y,subscribeToNotifications:S=>{r.current&&s&&r.current.emit("subscribeNotifications",S)},unsubscribeFromNotifications:S=>{r.current&&s&&r.current.emit("unsubscribeNotifications",S)},markNotificationAsRead:S=>{D(F=>{const A=F.map(P=>P.id===S?{...P,isRead:!0,readAt:new Date().toISOString()}:P);return ee("tutoring_notifications",A),A}),r.current&&s&&r.current.emit("markNotificationAsRead",S)},markAllNotificationsAsRead:S=>{D(F=>{const A=F.map(P=>P.userId===S?{...P,isRead:!0,readAt:new Date().toISOString()}:P);return ee("tutoring_notifications",A),A}),r.current&&s&&r.current.emit("markAllNotificationsAsRead",S)},deleteNotification:S=>{D(F=>{const A=F.filter(P=>P.id!==S);return ee("tutoring_notifications",A),A})},deleteChat:$e,markChatAsRead:be,clearChatMessages:Me,archiveChat:ut,unarchiveChat:Fe,loadChatsFromServer:q,deleteUserData:fe},children:t})};var Xd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Qd=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Zd=(t,r)=>{const s=N.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:c,...l},d)=>N.createElement("svg",{ref:d,...Xd,width:n,height:n,stroke:a,strokeWidth:o?Number(i)*24/Number(n):i,className:`lucide lucide-${Qd(t)}`,...l},[...r.map(([m,x])=>N.createElement(m,x)),...(Array.isArray(c)?c:[c])||[]]));return s.displayName=`${t}`,s};var ue=Zd;const $i=ue("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Oi=ue("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]]),jn=ue("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Jt=ue("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),eu=ue("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),as=ue("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Be=ue("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),fa=ue("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]),lt=ue("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),tu=ue("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]),Or=ue("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),ru=ue("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),su=ue("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),au=ue("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Rt=ue("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),nu=ue("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Nl=ue("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),sr=ue("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ar=ue("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Nn=ue("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),iu=ue("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),fr=ue("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),ou=ue("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),jt=ue("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),lu=ue("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),tn=ue("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),cu=ue("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Sl=ue("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),du=ue("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Sn=ue("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Nt=ue("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),tt=ue("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),uu=ue("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),mu=ue("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),hu=ue("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),kl=ue("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),fu=ue("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Pi=ue("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),os=ue("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),$t=ue("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),gu=ue("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),xu=ue("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),ls=ue("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ea=ue("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Cl=ue("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),kn=ue("School",[["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),cs=ue("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Tl=ue("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),ga=ue("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),rr=ue("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),pu=ue("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),Cn=ue("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),vu=ue("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),zt=ue("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Tn=ue("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Dl=ue("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),bu=ue("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),ds=ue("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Ts=ue("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),El=ue("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),yu=ue("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),Ce=ue("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),us=ue("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Xt=ue("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),wu=ue("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),nt=ue("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ju=ue("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Nu=({onSuccess:t})=>{const[r,s]=N.useState(!0),[a,n]=N.useState(""),[i,o]=N.useState(""),[c,l]=N.useState(""),[d,m]=N.useState(""),[x,h]=N.useState(""),[g,v]=N.useState("student"),[u,p]=N.useState(!1),[w,y]=N.useState(!1),{login:D,register:f}=it(),T=async j=>{j.preventDefault(),p(!0);try{if(r)await D(a,i),t();else{if(!w){y(!0),p(!1);return}if(!x.trim()){alert("Пожалуйста, введите никнейм"),p(!1);return}if(!d.trim()){alert("Пожалуйста, введите номер телефона"),p(!1);return}await f(a,i,c,x,g,d)&&t()}}catch{}finally{p(!1)}};return!r&&w?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-[#0D3C69] rounded-xl flex items-center justify-center mb-4",children:e.jsx(Be,{className:"h-6 w-6 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Выберите роль"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Кто вы на нашей платформе?"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>v("student"),className:`w-full p-6 rounded-xl border-2 transition-all duration-200 ${g==="student"?"border-[#0D3C69] bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${g==="student"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(Ce,{className:`h-6 w-6 ${g==="student"?"text-[#0D3C69]":"text-gray-600"}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Ученик"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ищу репетитора для обучения"})]})]})}),e.jsx("button",{onClick:()=>v("teacher"),className:`w-full p-6 rounded-xl border-2 transition-all duration-200 ${g==="teacher"?"border-[#0D3C69] bg-blue-50 shadow-lg":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${g==="teacher"?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(yu,{className:`h-6 w-6 ${g==="teacher"?"text-[#0D3C69]":"text-gray-600"}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Преподаватель"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Провожу уроки и делюсь знаниями"})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nickname",className:"block text-sm font-medium text-gray-700 mb-1",children:"Никнейм"}),e.jsx("input",{id:"nickname",type:"text",value:x,onChange:j=>h(j.target.value),required:!0,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200",placeholder:"Введите никнейм"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Номер телефона"}),e.jsxs("div",{className:"relative",children:[e.jsx($t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",type:"tel",value:d,onChange:j=>m(j.target.value),required:!0,className:"w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsx("button",{onClick:T,disabled:u||!x.trim()||!d.trim(),className:"w-full bg-[#0D3C69] hover:bg-[#0A2F56] text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Создание аккаунта...":"Завершить регистрацию"}),e.jsx("button",{onClick:()=>y(!1),className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-4 rounded-lg transition-colors duration-200",children:"Назад"})]})]})}):e.jsxs("div",{className:"min-h-screen flex",children:[e.jsx("div",{className:"flex-1 bg-white flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Добро пожаловать"}),e.jsx("p",{className:"text-lg text-gray-600",children:r?"Войдите в свой аккаунт":"Создайте новый аккаунт"})]}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[!r&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Имя"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"name",type:"text",value:c,onChange:j=>l(j.target.value),required:!r,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"Введите ваше имя"})]})]}),!r&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Номер телефона"}),e.jsxs("div",{className:"relative",children:[e.jsx($t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"phone",type:"tel",value:d,onChange:j=>m(j.target.value),required:!r,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(Sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"email",type:"email",value:a,onChange:j=>n(j.target.value),required:!0,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:"Введите ваш email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Пароль"}),e.jsxs("div",{className:"relative",children:[e.jsx(Sl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"password",type:"password",value:i,onChange:j=>o(j.target.value),required:!0,className:"w-full pl-10 pr-3 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0D3C69] focus:border-[#0D3C69] transition-colors duration-200 text-lg",placeholder:r?"Введите пароль":"Создайте пароль"})]})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-[#0D3C69] hover:bg-[#0A2F56] text-white font-bold py-4 px-6 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-lg shadow-lg hover:shadow-xl transform hover:scale-105",children:u?r?"Вход...":"Создание аккаунта...":r?"Войти":"Создать аккаунт"})]}),e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["Продолжая, вы соглашаетесь с"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Условиями использования"})," ","и"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Политикой конфиденциальности"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-gray-600",children:r?"Нет аккаунта? ":"Уже есть аккаунт? "}),e.jsx("button",{onClick:()=>{s(!r),y(!1),n(""),o(""),l(""),m(""),h("")},className:"text-[#0D3C69] hover:text-[#0A2F56] font-medium",children:r?"Зарегистрироваться":"Войти"})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"text-[#0D3C69] hover:text-[#0A2F56] text-sm",children:"Получить помощь"})}),e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["Этот сайт защищен reCAPTCHA Enterprise и применяются"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Политика конфиденциальности"})," ","и"," ",e.jsx("a",{href:"#",className:"text-[#0D3C69] hover:underline",children:"Условия использования"})," ","Google."]})]})}),e.jsxs("div",{className:"flex-1 bg-gray-900 flex flex-col items-center justify-center p-8 relative overflow-hidden",children:[e.jsx("h2",{className:"text-5xl font-bold text-white mb-8 text-center",children:"Платформа для обучения"}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("blockquote",{className:"text-xl text-gray-300 italic leading-relaxed",children:'"Важно не количество знаний, а качество их. Можно знать очень многое не зная самого нужного."'}),e.jsx("cite",{className:"text-sm text-gray-400 mt-4 block",children:"— Л. Толстой"})]}),e.jsxs("div",{className:"relative w-full h-64 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-blue-900 via-purple-900 to-black"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 opacity-20"})}),e.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((j,k)=>e.jsx("div",{className:"absolute w-1 h-1 bg-yellow-300 rounded-full animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`}},k))})]})]})]})},Su=({activeTab:t,onTabChange:r})=>{const{user:s,logout:a}=it(),[n,i]=N.useState(!1),o=N.useRef(null),c=N.useRef(null);N.useEffect(()=>{const x=h=>{const g=h.target;n&&c.current&&!c.current.contains(g)&&o.current&&!o.current.contains(g)&&i(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[n]);const l=[{id:"home",label:"Главная",icon:lu},{id:"lessons",label:"Мои уроки",icon:lt},{id:"chats",label:"Чаты",icon:tt},{id:"profile",label:"Профиль",icon:Ce}],d=[{id:"slots",label:"Слоты",icon:lt},{id:"calendar",label:"Календарь",icon:eu},{id:"students",label:"Ученики",icon:Ce},{id:"chats",label:"Чаты",icon:tt},{id:"profile",label:"Профиль",icon:Ce}],m=(s==null?void 0:s.role)==="teacher"?d:l;return e.jsx("nav",{className:"bg-card-light dark:bg-card-dark shadow-lg border-b border-border-light dark:border-border-dark transition-colors",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-8",children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-xl flex items-center justify-center shadow-md",style:{background:"#175b8c"},children:e.jsx("span",{className:"text-white font-bold text-lg",style:{fontFamily:"Inter, sans-serif",fontSize:28},children:"Na"})}),e.jsx("span",{className:"ml-3 text-2xl font-bold",style:{color:"#175b8c",fontFamily:"Inter, sans-serif"},children:"uchi"})]}),e.jsxs("div",{className:"hidden md:flex space-x-8 relative",children:[m.map(x=>{const h=x.icon,g=(s==null?void 0:s.role)==="teacher"&&x.id==="profile";return e.jsxs("button",{ref:g?o:null,onClick:()=>{if(g){i(v=>!v);return}r(x.id)},className:`flex items-center gap-2 px-5 py-3 rounded-xl text-base font-semibold transition-all duration-200 shadow-none ${t===x.id?"bg-primary-light/10 text-primary-light dark:bg-primary-dark/20 dark:text-primary-dark shadow-md":"text-textSecondary-light dark:text-textSecondary-dark hover:bg-border-light dark:hover:bg-border-dark hover:text-primary-light dark:hover:text-primary-dark"}`,children:[e.jsx(h,{className:"h-5 w-5"}),e.jsx("span",{children:x.label})]},x.id)}),(s==null?void 0:s.role)==="teacher"&&n&&e.jsxs("div",{ref:c,className:"absolute top-14 right-0 w-64 bg-white dark:bg-card-dark border border-border-light dark:border-border-dark rounded-xl shadow-2xl py-2 z-50",children:[e.jsx("div",{className:"px-4 py-2 text-xs uppercase tracking-wide text-gray-400",children:"Профиль"}),e.jsxs("button",{onClick:()=>{i(!1),r("profile")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-blue-500"}),e.jsx("span",{children:"Просмотреть профиль"})]}),e.jsxs("button",{onClick:()=>{i(!1),r("slots")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{children:"Слоты"})]}),e.jsxs("button",{onClick:()=>{i(!1),r("calendar")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-purple-500"}),e.jsx("span",{children:"Календарь"})]}),e.jsxs("button",{onClick:()=>{i(!1),r("students")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-amber-500"}),e.jsx("span",{children:"Ученики"})]}),e.jsxs("button",{onClick:()=>{i(!1),r("materials")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-border-dark transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-pink-500"}),e.jsx("span",{children:"Материалы"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:s==null?void 0:s.nickname.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:s==null?void 0:s.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["@",s==null?void 0:s.nickname]})]}),e.jsx("span",{className:"hidden md:block text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full",children:(s==null?void 0:s.role)==="teacher"?"Преподаватель":"Ученик"})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg transition-all duration-200",title:"Выйти",children:e.jsx(du,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"md:hidden border-t border-border-light dark:border-border-dark",children:e.jsx("div",{className:"flex space-x-1 py-2 overflow-x-auto",children:m.map(x=>{const h=x.icon;return e.jsxs("button",{onClick:()=>{if((s==null?void 0:s.role)==="teacher"&&x.id==="profile"){r("profile");return}r(x.id)},className:`flex-shrink-0 flex flex-col items-center gap-1 px-4 py-3 rounded-xl text-xs font-semibold transition-all duration-200 ${t===x.id?"bg-primary-light/10 text-primary-light dark:bg-primary-dark/20 dark:text-primary-dark shadow-md":"text-textSecondary-light dark:text-textSecondary-dark hover:bg-border-light dark:hover:bg-border-dark hover:text-primary-light dark:hover:text-primary-dark"}`,children:[e.jsx(h,{className:"h-5 w-5"}),e.jsx("span",{children:x.label})]},x.id)})})})]})})};function Ot(t){"@babel/helpers - typeof";return Ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ot(t)}function ku(t,r){if(Ot(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var a=s.call(t,r||"default");if(Ot(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function $l(t){var r=ku(t,"string");return Ot(r)=="symbol"?r:r+""}function ne(t,r,s){return(r=$l(r))in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function Mi(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,a)}return s}function Re(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Mi(Object(s),!0).forEach(function(a){ne(t,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Mi(Object(s)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(s,a))})}return t}function xa(t,r){if(t==null)return{};var s={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(r.indexOf(a)!==-1)continue;s[a]=t[a]}return s}function qt(t,r){if(t==null)return{};var s,a,n=xa(t,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function xe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _i(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,$l(a.key),a)}}function pe(t,r,s){return r&&_i(t.prototype,r),s&&_i(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function Mr(t){return Mr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mr(t)}function Dn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dn=function(){return!!t})()}function de(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ol(t,r){if(r&&(Ot(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return de(t)}function ft(t,r,s){return r=Mr(r),Ol(t,Dn()?Reflect.construct(r,s||[],Mr(t).constructor):r.apply(t,s))}function ta(t,r){return ta=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},ta(t,r)}function we(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&ta(t,r)}function Pl(t){if(Array.isArray(t))return t}function Cu(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var a,n,i,o,c=[],l=!0,d=!1;try{if(i=(s=s.call(t)).next,r===0){if(Object(s)!==s)return;l=!1}else for(;!(l=(a=i.call(s)).done)&&(c.push(a.value),c.length!==r);l=!0);}catch(m){d=!0,n=m}finally{try{if(!l&&s.return!=null&&(o=s.return(),Object(o)!==o))return}finally{if(d)throw n}}return c}}function rn(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,a=Array(r);s<r;s++)a[s]=t[s];return a}function pa(t,r){if(t){if(typeof t=="string")return rn(t,r);var s={}.toString.call(t).slice(8,-1);return s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set"?Array.from(t):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?rn(t,r):void 0}}function Ml(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pr(t,r){return Pl(t)||Cu(t,r)||pa(t,r)||Ml()}function _l(t){var r,s,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t))for(r=0;r<t.length;r++)t[r]&&(s=_l(t[r]))&&(a&&(a+=" "),a+=s);else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Ke(){for(var t,r,s=0,a="";s<arguments.length;)(t=arguments[s++])&&(r=_l(t))&&(a&&(a+=" "),a+=r);return a}function Ve(){return Ve=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)({}).hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},Ve.apply(null,arguments)}var Tu=function(t,r,s,a,n,i,o,c){if(!t){var l;if(r===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[s,a,n,i,o,c],m=0;l=new Error(r.replace(/%s/g,function(){return d[m++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},Du=Tu;const ms=_t(Du);var Eu=function(){};function $u(t,r){var s={};return Object.keys(t).forEach(function(a){s[Ks(a)]=Eu}),s}function Ai(t,r){return t[r]!==void 0}function Ks(t){return"default"+t.charAt(0).toUpperCase()+t.substr(1)}function Ou(t){return!!t&&(typeof t!="function"||t.prototype&&t.prototype.isReactComponent)}function Pu(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,ta(t,r)}function Al(){var t=this.constructor.getDerivedStateFromProps(this.props,this.state);t!=null&&this.setState(t)}function Rl(t){function r(s){var a=this.constructor.getDerivedStateFromProps(t,s);return a??null}this.setState(r.bind(this))}function Il(t,r){try{var s=this.props,a=this.state;this.props=t,this.state=r,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(s,a)}finally{this.props=s,this.state=a}}Al.__suppressDeprecationWarning=!0;Rl.__suppressDeprecationWarning=!0;Il.__suppressDeprecationWarning=!0;function Mu(t){var r=t.prototype;if(!r||!r.isReactComponent)throw new Error("Can only polyfill class components");if(typeof t.getDerivedStateFromProps!="function"&&typeof r.getSnapshotBeforeUpdate!="function")return t;var s=null,a=null,n=null;if(typeof r.componentWillMount=="function"?s="componentWillMount":typeof r.UNSAFE_componentWillMount=="function"&&(s="UNSAFE_componentWillMount"),typeof r.componentWillReceiveProps=="function"?a="componentWillReceiveProps":typeof r.UNSAFE_componentWillReceiveProps=="function"&&(a="UNSAFE_componentWillReceiveProps"),typeof r.componentWillUpdate=="function"?n="componentWillUpdate":typeof r.UNSAFE_componentWillUpdate=="function"&&(n="UNSAFE_componentWillUpdate"),s!==null||a!==null||n!==null){var i=t.displayName||t.name,o=typeof t.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+i+" uses "+o+" but also contains the following legacy lifecycles:"+(s!==null?`
  `+s:"")+(a!==null?`
  `+a:"")+(n!==null?`
  `+n:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof t.getDerivedStateFromProps=="function"&&(r.componentWillMount=Al,r.componentWillReceiveProps=Rl),typeof r.getSnapshotBeforeUpdate=="function"){if(typeof r.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");r.componentWillUpdate=Il;var c=r.componentDidUpdate;r.componentDidUpdate=function(d,m,x){var h=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:x;c.call(this,d,m,h)}}return t}var _u="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function Ll(t,r,s){s===void 0&&(s=[]);var a=t.displayName||t.name||"Component",n=Ou(t),i=Object.keys(r),o=i.map(Ks);n||!s.length||ms(!1);var c=function(d){Pu(m,d);function m(){for(var h,g=arguments.length,v=new Array(g),u=0;u<g;u++)v[u]=arguments[u];h=d.call.apply(d,[this].concat(v))||this,h.handlers=Object.create(null),i.forEach(function(w){var y=r[w],D=function(T){if(h.props[y]){var j;h._notifying=!0;for(var k=arguments.length,C=new Array(k>1?k-1:0),M=1;M<k;M++)C[M-1]=arguments[M];(j=h.props)[y].apply(j,[T].concat(C)),h._notifying=!1}h.unmounted||h.setState(function(z){var I,X=z.values;return{values:Ve(Object.create(null),X,(I={},I[w]=T,I))}})};h.handlers[y]=D}),s.length&&(h.attachRef=function(w){h.inner=w});var p=Object.create(null);return i.forEach(function(w){p[w]=h.props[Ks(w)]}),h.state={values:p,prevProps:{}},h}var x=m.prototype;return x.shouldComponentUpdate=function(){return!this._notifying},m.getDerivedStateFromProps=function(g,v){var u=v.values,p=v.prevProps,w={values:Ve(Object.create(null),u),prevProps:{}};return i.forEach(function(y){w.prevProps[y]=g[y],!Ai(g,y)&&Ai(p,y)&&(w.values[y]=g[Ks(y)])}),w},x.componentWillUnmount=function(){this.unmounted=!0},x.render=function(){var g=this,v=this.props,u=v.innerRef,p=xa(v,["innerRef"]);o.forEach(function(y){delete p[y]});var w={};return i.forEach(function(y){var D=g.props[y];w[y]=D!==void 0?D:g.state.values[y]}),U.createElement(t,Ve({},p,w,this.handlers,{ref:u||this.attachRef}))},m}(U.Component);Mu(c),c.displayName="Uncontrolled("+a+")",c.propTypes=Ve({innerRef:function(){}},$u(r)),s.forEach(function(d){c.prototype[d]=function(){var x;return(x=this.inner)[d].apply(x,arguments)}});var l=c;return U.forwardRef&&(l=U.forwardRef(function(d,m){return U.createElement(c,Ve({},d,{innerRef:m,__source:{fileName:_u,lineNumber:128},__self:this}))}),l.propTypes=c.propTypes),l.ControlledComponent=t,l.deferControlTo=function(d,m,x){return m===void 0&&(m={}),Ll(d,Ve({},r,m),x)},l}var Ul={exports:{}},Au="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ru=Au,Iu=Ru;function Fl(){}function Wl(){}Wl.resetWarningCache=Fl;var Lu=function(){function t(a,n,i,o,c,l){if(l!==Iu){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}t.isRequired=t;function r(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:Wl,resetWarningCache:Fl};return s.PropTypes=s,s};Ul.exports=Lu();var Uu=Ul.exports;const se=_t(Uu);var ra="milliseconds",hs="seconds",fs="minutes",gs="hours",vr="day",_r="week",xs="month",br="year",yr="decade",wr="century",Hl={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},Fu={month:1,year:12,decade:10*12,century:100*12};function Wu(t){return[31,Hu(t),31,30,31,30,31,31,30,31,30,31]}function Hu(t){return t%4===0&&t%100!==0||t%400===0?29:28}function It(t,r,s){switch(t=new Date(t),s){case ra:case hs:case fs:case gs:case vr:case _r:return zu(t,r*Hl[s]);case xs:case br:case yr:case wr:return Bu(t,r*Fu[s])}throw new TypeError('Invalid units: "'+s+'"')}function zu(t,r){var s=new Date(+t+r);return Yu(t,s)}function Bu(t,r){var s=t.getFullYear(),a=t.getMonth(),n=t.getDate(),i=s*12+a+r,o=Math.trunc(i/12),c=i%12,l=Math.min(n,Wu(o)[c]),d=new Date(t);return d.setFullYear(o),d.setDate(1),d.setMonth(c),d.setDate(l),d}function Yu(t,r){var s=t.getTimezoneOffset(),a=r.getTimezoneOffset(),n=a-s;return new Date(+r+n*Hl.minutes)}function ps(t,r,s){return It(t,-r,s)}function ct(t,r,s){switch(t=new Date(t),r){case wr:case yr:case br:t=aa(t,0);case xs:t=Gl(t,1);case _r:case vr:t=ys(t,0);case gs:t=Ar(t,0);case fs:t=bs(t,0);case hs:t=vs(t,0)}return r===yr&&(t=ps(t,jr(t)%10,"year")),r===wr&&(t=ps(t,jr(t)%100,"year")),r===_r&&(t=Vl(t,0,s)),t}function sa(t,r,s){switch(t=new Date(t),t=ct(t,r,s),r){case wr:case yr:case br:case xs:case _r:t=It(t,1,r),t=ps(t,1,vr),t.setHours(23,59,59,999);break;case vr:t.setHours(23,59,59,999);break;case gs:case fs:case hs:t=It(t,1,r),t=ps(t,1,ra)}return t}var Wr=zr(function(t,r){return t===r}),En=zr(function(t,r){return t!==r}),va=zr(function(t,r){return t>r}),Ds=zr(function(t,r){return t>=r}),$n=zr(function(t,r){return t<r}),Hr=zr(function(t,r){return t<=r});function zl(){return new Date(Math.min.apply(Math,arguments))}function Bl(){return new Date(Math.max.apply(Math,arguments))}function Yl(t,r,s,a){return a=a||"day",(!r||Ds(t,r,a))&&(!s||Hr(t,s,a))}var vs=or("Milliseconds"),bs=or("Seconds"),Ar=or("Minutes"),ys=or("Hours"),ql=or("Day"),Gl=or("Date"),aa=or("Month"),jr=or("FullYear");function qu(t,r){return r===void 0?jr(ct(t,yr)):It(t,r+10,br)}function Gu(t,r){return r===void 0?jr(ct(t,wr)):It(t,r+100,br)}function Vl(t,r,s){var a=(ql(t)+7-(s||0))%7;return r===void 0?a:It(t,r-a,vr)}function Vu(t,r,s,a){var n,i,o;switch(s){case ra:case hs:case fs:case gs:case vr:case _r:n=r.getTime()-t.getTime();break;case xs:case br:case yr:case wr:n=(jr(r)-jr(t))*12+aa(r)-aa(t);break;default:throw new TypeError('Invalid units: "'+s+'"')}switch(s){case ra:i=1;break;case hs:i=1e3;break;case fs:i=1e3*60;break;case gs:i=1e3*60*60;break;case vr:i=1e3*60*60*24;break;case _r:i=1e3*60*60*24*7;break;case xs:i=1;break;case br:i=12;break;case yr:i=120;break;case wr:i=1200;break;default:throw new TypeError('Invalid units: "'+s+'"')}return o=n/i,a?o:Math.round(o)}function or(t){var r=function(s){switch(s){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(t);return function(s,a){if(a===void 0)return s["get"+t]();var n=new Date(s);return n["set"+t](a),r&&n["get"+t]()!=a&&(t==="Hours"||a>=r&&n.getHours()-s.getHours()<Math.floor(a/r))&&n["set"+t](a+r),n}}function zr(t){return function(r,s,a){return t(+ct(r,a),+ct(s,a))}}const Ri=Object.freeze(Object.defineProperty({__proto__:null,add:It,century:Gu,date:Gl,day:ql,decade:qu,diff:Vu,endOf:sa,eq:Wr,gt:va,gte:Ds,hours:ys,inRange:Yl,lt:$n,lte:Hr,max:Bl,milliseconds:vs,min:zl,minutes:Ar,month:aa,neq:En,seconds:bs,startOf:ct,subtract:ps,weekday:Vl,year:jr},Symbol.toStringTag,{value:"Module"}));function Ku(t){if(Array.isArray(t))return rn(t)}function Kl(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ju(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Js(t){return Ku(t)||Kl(t)||pa(t)||Ju()}function Xu(t,r,s){var a=-1,n=t.length;r<0&&(r=-r>n?0:n+r),s=s>n?n:s,s<0&&(s+=n),n=r>s?0:s-r>>>0,r>>>=0;for(var i=Array(n);++a<n;)i[a]=t[a+r];return i}var Jl=Xu;function Qu(t,r){return t===r||t!==t&&r!==r}var Es=Qu,Zu=typeof Et=="object"&&Et&&Et.Object===Object&&Et,Xl=Zu,em=Xl,tm=typeof self=="object"&&self&&self.Object===Object&&self,rm=em||tm||Function("return this")(),Gt=rm,sm=Gt,am=sm.Symbol,Br=am,Ii=Br,Ql=Object.prototype,nm=Ql.hasOwnProperty,im=Ql.toString,Qr=Ii?Ii.toStringTag:void 0;function om(t){var r=nm.call(t,Qr),s=t[Qr];try{t[Qr]=void 0;var a=!0}catch{}var n=im.call(t);return a&&(r?t[Qr]=s:delete t[Qr]),n}var lm=om,cm=Object.prototype,dm=cm.toString;function um(t){return dm.call(t)}var mm=um,Li=Br,hm=lm,fm=mm,gm="[object Null]",xm="[object Undefined]",Ui=Li?Li.toStringTag:void 0;function pm(t){return t==null?t===void 0?xm:gm:Ui&&Ui in Object(t)?hm(t):fm(t)}var Yr=pm;function vm(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var er=vm,bm=Yr,ym=er,wm="[object AsyncFunction]",jm="[object Function]",Nm="[object GeneratorFunction]",Sm="[object Proxy]";function km(t){if(!ym(t))return!1;var r=bm(t);return r==jm||r==Nm||r==wm||r==Sm}var On=km,Cm=9007199254740991;function Tm(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Cm}var Pn=Tm,Dm=On,Em=Pn;function $m(t){return t!=null&&Em(t.length)&&!Dm(t)}var $s=$m,Om=9007199254740991,Pm=/^(?:0|[1-9]\d*)$/;function Mm(t,r){var s=typeof t;return r=r??Om,!!r&&(s=="number"||s!="symbol"&&Pm.test(t))&&t>-1&&t%1==0&&t<r}var Mn=Mm,_m=Es,Am=$s,Rm=Mn,Im=er;function Lm(t,r,s){if(!Im(s))return!1;var a=typeof r;return(a=="number"?Am(s)&&Rm(r,s.length):a=="string"&&r in s)?_m(s[r],t):!1}var ba=Lm,Um=/\s/;function Fm(t){for(var r=t.length;r--&&Um.test(t.charAt(r)););return r}var Wm=Fm,Hm=Wm,zm=/^\s+/;function Bm(t){return t&&t.slice(0,Hm(t)+1).replace(zm,"")}var Ym=Bm;function qm(t){return t!=null&&typeof t=="object"}var lr=qm,Gm=Yr,Vm=lr,Km="[object Symbol]";function Jm(t){return typeof t=="symbol"||Vm(t)&&Gm(t)==Km}var Os=Jm,Xm=Ym,Fi=er,Qm=Os,Wi=0/0,Zm=/^[-+]0x[0-9a-f]+$/i,eh=/^0b[01]+$/i,th=/^0o[0-7]+$/i,rh=parseInt;function sh(t){if(typeof t=="number")return t;if(Qm(t))return Wi;if(Fi(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=Fi(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=Xm(t);var s=eh.test(t);return s||th.test(t)?rh(t.slice(2),s?2:8):Zm.test(t)?Wi:+t}var ah=sh,nh=ah,Hi=1/0,ih=17976931348623157e292;function oh(t){if(!t)return t===0?t:0;if(t=nh(t),t===Hi||t===-Hi){var r=t<0?-1:1;return r*ih}return t===t?t:0}var Zl=oh,lh=Zl;function ch(t){var r=lh(t),s=r%1;return r===r?s?r-s:r:0}var ec=ch,dh=Jl,uh=ba,mh=ec,hh=Math.ceil,fh=Math.max;function gh(t,r,s){(s?uh(t,r,s):r===void 0)?r=1:r=fh(mh(r),0);var a=t==null?0:t.length;if(!a||r<1)return[];for(var n=0,i=0,o=Array(hh(a/r));n<a;)o[i++]=dh(t,n,n+=r);return o}var xh=gh;const ph=_t(xh);function Ps(t){return t&&t.ownerDocument||document}function vh(t){var r=Ps(t);return r&&r.defaultView||window}function bh(t,r){return vh(t).getComputedStyle(t,r)}var yh=/([A-Z])/g;function wh(t){return t.replace(yh,"-$1").toLowerCase()}var jh=/^ms-/;function zs(t){return wh(t).replace(jh,"-ms-")}var Nh=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Sh(t){return!!(t&&Nh.test(t))}function Er(t,r){var s="",a="";if(typeof r=="string")return t.style.getPropertyValue(zs(r))||bh(t).getPropertyValue(zs(r));Object.keys(r).forEach(function(n){var i=r[n];!i&&i!==0?t.style.removeProperty(zs(n)):Sh(n)?a+=n+"("+i+") ":s+=zs(n)+": "+i+";"}),a&&(s+="transform: "+a+";"),t.style.cssText+=";"+s}function ws(t,r){if(t.contains)return t.contains(r);if(t.compareDocumentPosition)return t===r||!!(t.compareDocumentPosition(r)&16)}function kh(t){return"nodeType"in t&&t.nodeType===document.DOCUMENT_NODE}function _n(t){return"window"in t&&t.window===t?t:kh(t)&&t.defaultView||!1}function tc(t){var r=t==="pageXOffset"?"scrollLeft":"scrollTop";function s(a,n){var i=_n(a);if(n===void 0)return i?i[t]:a[r];i?i.scrollTo(i[t],n):a[r]=n}return s}const rc=tc("pageXOffset"),sc=tc("pageYOffset");function gr(t){var r=Ps(t),s={top:0,left:0,height:0,width:0},a=r&&r.documentElement;return!a||!ws(a,t)||(t.getBoundingClientRect!==void 0&&(s=t.getBoundingClientRect()),s={top:s.top+sc(a)-(a.clientTop||0),left:s.left+rc(a)-(a.clientLeft||0),width:s.width,height:s.height}),s}var Ch=function(r){return!!r&&"offsetParent"in r};function Th(t){for(var r=Ps(t),s=t&&t.offsetParent;Ch(s)&&s.nodeName!=="HTML"&&Er(s,"position")==="static";)s=s.offsetParent;return s||r.documentElement}var Dh=function(r){return r.nodeName&&r.nodeName.toLowerCase()};function ac(t,r){var s={top:0,left:0},a;if(Er(t,"position")==="fixed")a=t.getBoundingClientRect();else{var n=r||Th(t);a=gr(t),Dh(n)!=="html"&&(s=gr(n));var i=String(Er(n,"borderTopWidth")||0);s.top+=parseInt(i,10)-sc(n)||0;var o=String(Er(n,"borderLeftWidth")||0);s.left+=parseInt(o,10)-rc(n)||0}var c=String(Er(t,"marginTop")||0),l=String(Er(t,"marginLeft")||0);return Ve({},a,{top:a.top-s.top-(parseInt(c,10)||0),left:a.left-s.left-(parseInt(l,10)||0)})}const An=!!(typeof window<"u"&&window.document&&window.document.createElement);var zi=new Date().getTime();function Eh(t){var r=new Date().getTime(),s=Math.max(0,16-(r-zi)),a=setTimeout(t,s);return zi=r,a}var $h=["","webkit","moz","o","ms"],sn="clearTimeout",an=Eh,Bi=function(r,s){return r+(r?s[0].toUpperCase()+s.substr(1):s)+"AnimationFrame"};An&&$h.some(function(t){var r=Bi(t,"request");return r in window&&(sn=Bi(t,"cancel"),an=function(a){return window[r](a)}),!!an});var Yi=function(r){typeof window[sn]=="function"&&window[sn](r)},nc=an,Wa;function Oh(t,r){if(!Wa){var s=document.body,a=s.matches||s.matchesSelector||s.webkitMatchesSelector||s.mozMatchesSelector||s.msMatchesSelector;Wa=function(i,o){return a.call(i,o)}}return Wa(t,r)}var Ph=Function.prototype.bind.call(Function.prototype.call,[].slice);function Mh(t,r){return Ph(t.querySelectorAll(r))}var nn=!1,on=!1;try{var Ha={get passive(){return nn=!0},get once(){return on=nn=!0}};An&&(window.addEventListener("test",Ha,Ha),window.removeEventListener("test",Ha,!0))}catch{}function _h(t,r,s,a){if(a&&typeof a!="boolean"&&!on){var n=a.once,i=a.capture,o=s;!on&&n&&(o=s.__once||function c(l){this.removeEventListener(r,c,i),s.call(this,l)},s.__once=o),t.addEventListener(r,o,nn?a:i)}t.addEventListener(r,s,a)}function Ah(t){const r=N.useRef(t);return N.useEffect(()=>{r.current=t},[t]),r}function qi(t){const r=Ah(t);return N.useCallback(function(...s){return r.current&&r.current(...s)},[r])}function Gi(){return N.useState(null)}function Rh(){const t=N.useRef(!0),r=N.useRef(()=>t.current);return N.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),r.current}function Ih(t){const r=Rh();return[t[0],N.useCallback(s=>{if(r())return t[1](s)},[r,t[1]])]}var vt="top",Pt="bottom",Mt="right",bt="left",Rn="auto",Ms=[vt,Pt,Mt,bt],Rr="start",js="end",Lh="clippingParents",ic="viewport",Zr="popper",Uh="reference",Vi=Ms.reduce(function(t,r){return t.concat([r+"-"+Rr,r+"-"+js])},[]),In=[].concat(Ms,[Rn]).reduce(function(t,r){return t.concat([r,r+"-"+Rr,r+"-"+js])},[]),Fh="beforeRead",Wh="read",Hh="afterRead",zh="beforeMain",Bh="main",Yh="afterMain",qh="beforeWrite",Gh="write",Vh="afterWrite",Kh=[Fh,Wh,Hh,zh,Bh,Yh,qh,Gh,Vh];function Bt(t){return t.split("-")[0]}function St(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var r=t.ownerDocument;return r&&r.defaultView||window}return t}function Nr(t){var r=St(t).Element;return t instanceof r||t instanceof Element}function Yt(t){var r=St(t).HTMLElement;return t instanceof r||t instanceof HTMLElement}function Ln(t){if(typeof ShadowRoot>"u")return!1;var r=St(t).ShadowRoot;return t instanceof r||t instanceof ShadowRoot}var xr=Math.max,na=Math.min,Ir=Math.round;function ln(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function oc(){return!/^((?!chrome|android).)*safari/i.test(ln())}function Lr(t,r,s){r===void 0&&(r=!1),s===void 0&&(s=!1);var a=t.getBoundingClientRect(),n=1,i=1;r&&Yt(t)&&(n=t.offsetWidth>0&&Ir(a.width)/t.offsetWidth||1,i=t.offsetHeight>0&&Ir(a.height)/t.offsetHeight||1);var o=Nr(t)?St(t):window,c=o.visualViewport,l=!oc()&&s,d=(a.left+(l&&c?c.offsetLeft:0))/n,m=(a.top+(l&&c?c.offsetTop:0))/i,x=a.width/n,h=a.height/i;return{width:x,height:h,top:m,right:d+x,bottom:m+h,left:d,x:d,y:m}}function Un(t){var r=Lr(t),s=t.offsetWidth,a=t.offsetHeight;return Math.abs(r.width-s)<=1&&(s=r.width),Math.abs(r.height-a)<=1&&(a=r.height),{x:t.offsetLeft,y:t.offsetTop,width:s,height:a}}function lc(t,r){var s=r.getRootNode&&r.getRootNode();if(t.contains(r))return!0;if(s&&Ln(s)){var a=r;do{if(a&&t.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function nr(t){return t?(t.nodeName||"").toLowerCase():null}function Qt(t){return St(t).getComputedStyle(t)}function Jh(t){return["table","td","th"].indexOf(nr(t))>=0}function cr(t){return((Nr(t)?t.ownerDocument:t.document)||window.document).documentElement}function ya(t){return nr(t)==="html"?t:t.assignedSlot||t.parentNode||(Ln(t)?t.host:null)||cr(t)}function Ki(t){return!Yt(t)||Qt(t).position==="fixed"?null:t.offsetParent}function Xh(t){var r=/firefox/i.test(ln()),s=/Trident/i.test(ln());if(s&&Yt(t)){var a=Qt(t);if(a.position==="fixed")return null}var n=ya(t);for(Ln(n)&&(n=n.host);Yt(n)&&["html","body"].indexOf(nr(n))<0;){var i=Qt(n);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||r&&i.willChange==="filter"||r&&i.filter&&i.filter!=="none")return n;n=n.parentNode}return null}function _s(t){for(var r=St(t),s=Ki(t);s&&Jh(s)&&Qt(s).position==="static";)s=Ki(s);return s&&(nr(s)==="html"||nr(s)==="body"&&Qt(s).position==="static")?r:s||Xh(t)||r}function Fn(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function ns(t,r,s){return xr(t,na(r,s))}function Qh(t,r,s){var a=ns(t,r,s);return a>s?s:a}function cc(){return{top:0,right:0,bottom:0,left:0}}function dc(t){return Object.assign({},cc(),t)}function uc(t,r){return r.reduce(function(s,a){return s[a]=t,s},{})}var Zh=function(r,s){return r=typeof r=="function"?r(Object.assign({},s.rects,{placement:s.placement})):r,dc(typeof r!="number"?r:uc(r,Ms))};function ef(t){var r,s=t.state,a=t.name,n=t.options,i=s.elements.arrow,o=s.modifiersData.popperOffsets,c=Bt(s.placement),l=Fn(c),d=[bt,Mt].indexOf(c)>=0,m=d?"height":"width";if(!(!i||!o)){var x=Zh(n.padding,s),h=Un(i),g=l==="y"?vt:bt,v=l==="y"?Pt:Mt,u=s.rects.reference[m]+s.rects.reference[l]-o[l]-s.rects.popper[m],p=o[l]-s.rects.reference[l],w=_s(i),y=w?l==="y"?w.clientHeight||0:w.clientWidth||0:0,D=u/2-p/2,f=x[g],T=y-h[m]-x[v],j=y/2-h[m]/2+D,k=ns(f,j,T),C=l;s.modifiersData[a]=(r={},r[C]=k,r.centerOffset=k-j,r)}}function tf(t){var r=t.state,s=t.options,a=s.element,n=a===void 0?"[data-popper-arrow]":a;n!=null&&(typeof n=="string"&&(n=r.elements.popper.querySelector(n),!n)||lc(r.elements.popper,n)&&(r.elements.arrow=n))}const rf={name:"arrow",enabled:!0,phase:"main",fn:ef,effect:tf,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ur(t){return t.split("-")[1]}var sf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function af(t,r){var s=t.x,a=t.y,n=r.devicePixelRatio||1;return{x:Ir(s*n)/n||0,y:Ir(a*n)/n||0}}function Ji(t){var r,s=t.popper,a=t.popperRect,n=t.placement,i=t.variation,o=t.offsets,c=t.position,l=t.gpuAcceleration,d=t.adaptive,m=t.roundOffsets,x=t.isFixed,h=o.x,g=h===void 0?0:h,v=o.y,u=v===void 0?0:v,p=typeof m=="function"?m({x:g,y:u}):{x:g,y:u};g=p.x,u=p.y;var w=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),D=bt,f=vt,T=window;if(d){var j=_s(s),k="clientHeight",C="clientWidth";if(j===St(s)&&(j=cr(s),Qt(j).position!=="static"&&c==="absolute"&&(k="scrollHeight",C="scrollWidth")),j=j,n===vt||(n===bt||n===Mt)&&i===js){f=Pt;var M=x&&j===T&&T.visualViewport?T.visualViewport.height:j[k];u-=M-a.height,u*=l?1:-1}if(n===bt||(n===vt||n===Pt)&&i===js){D=Mt;var z=x&&j===T&&T.visualViewport?T.visualViewport.width:j[C];g-=z-a.width,g*=l?1:-1}}var I=Object.assign({position:c},d&&sf),X=m===!0?af({x:g,y:u},St(s)):{x:g,y:u};if(g=X.x,u=X.y,l){var G;return Object.assign({},I,(G={},G[f]=y?"0":"",G[D]=w?"0":"",G.transform=(T.devicePixelRatio||1)<=1?"translate("+g+"px, "+u+"px)":"translate3d("+g+"px, "+u+"px, 0)",G))}return Object.assign({},I,(r={},r[f]=y?u+"px":"",r[D]=w?g+"px":"",r.transform="",r))}function nf(t){var r=t.state,s=t.options,a=s.gpuAcceleration,n=a===void 0?!0:a,i=s.adaptive,o=i===void 0?!0:i,c=s.roundOffsets,l=c===void 0?!0:c,d={placement:Bt(r.placement),variation:Ur(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:n,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,Ji(Object.assign({},d,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:o,roundOffsets:l})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,Ji(Object.assign({},d,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}const of={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:nf,data:{}};var Bs={passive:!0};function lf(t){var r=t.state,s=t.instance,a=t.options,n=a.scroll,i=n===void 0?!0:n,o=a.resize,c=o===void 0?!0:o,l=St(r.elements.popper),d=[].concat(r.scrollParents.reference,r.scrollParents.popper);return i&&d.forEach(function(m){m.addEventListener("scroll",s.update,Bs)}),c&&l.addEventListener("resize",s.update,Bs),function(){i&&d.forEach(function(m){m.removeEventListener("scroll",s.update,Bs)}),c&&l.removeEventListener("resize",s.update,Bs)}}const cf={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:lf,data:{}};var df={left:"right",right:"left",bottom:"top",top:"bottom"};function Xs(t){return t.replace(/left|right|bottom|top/g,function(r){return df[r]})}var uf={start:"end",end:"start"};function Xi(t){return t.replace(/start|end/g,function(r){return uf[r]})}function Wn(t){var r=St(t),s=r.pageXOffset,a=r.pageYOffset;return{scrollLeft:s,scrollTop:a}}function Hn(t){return Lr(cr(t)).left+Wn(t).scrollLeft}function mf(t,r){var s=St(t),a=cr(t),n=s.visualViewport,i=a.clientWidth,o=a.clientHeight,c=0,l=0;if(n){i=n.width,o=n.height;var d=oc();(d||!d&&r==="fixed")&&(c=n.offsetLeft,l=n.offsetTop)}return{width:i,height:o,x:c+Hn(t),y:l}}function hf(t){var r,s=cr(t),a=Wn(t),n=(r=t.ownerDocument)==null?void 0:r.body,i=xr(s.scrollWidth,s.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=xr(s.scrollHeight,s.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),c=-a.scrollLeft+Hn(t),l=-a.scrollTop;return Qt(n||s).direction==="rtl"&&(c+=xr(s.clientWidth,n?n.clientWidth:0)-i),{width:i,height:o,x:c,y:l}}function zn(t){var r=Qt(t),s=r.overflow,a=r.overflowX,n=r.overflowY;return/auto|scroll|overlay|hidden/.test(s+n+a)}function mc(t){return["html","body","#document"].indexOf(nr(t))>=0?t.ownerDocument.body:Yt(t)&&zn(t)?t:mc(ya(t))}function is(t,r){var s;r===void 0&&(r=[]);var a=mc(t),n=a===((s=t.ownerDocument)==null?void 0:s.body),i=St(a),o=n?[i].concat(i.visualViewport||[],zn(a)?a:[]):a,c=r.concat(o);return n?c:c.concat(is(ya(o)))}function cn(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function ff(t,r){var s=Lr(t,!1,r==="fixed");return s.top=s.top+t.clientTop,s.left=s.left+t.clientLeft,s.bottom=s.top+t.clientHeight,s.right=s.left+t.clientWidth,s.width=t.clientWidth,s.height=t.clientHeight,s.x=s.left,s.y=s.top,s}function Qi(t,r,s){return r===ic?cn(mf(t,s)):Nr(r)?ff(r,s):cn(hf(cr(t)))}function gf(t){var r=is(ya(t)),s=["absolute","fixed"].indexOf(Qt(t).position)>=0,a=s&&Yt(t)?_s(t):t;return Nr(a)?r.filter(function(n){return Nr(n)&&lc(n,a)&&nr(n)!=="body"}):[]}function xf(t,r,s,a){var n=r==="clippingParents"?gf(t):[].concat(r),i=[].concat(n,[s]),o=i[0],c=i.reduce(function(l,d){var m=Qi(t,d,a);return l.top=xr(m.top,l.top),l.right=na(m.right,l.right),l.bottom=na(m.bottom,l.bottom),l.left=xr(m.left,l.left),l},Qi(t,o,a));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function hc(t){var r=t.reference,s=t.element,a=t.placement,n=a?Bt(a):null,i=a?Ur(a):null,o=r.x+r.width/2-s.width/2,c=r.y+r.height/2-s.height/2,l;switch(n){case vt:l={x:o,y:r.y-s.height};break;case Pt:l={x:o,y:r.y+r.height};break;case Mt:l={x:r.x+r.width,y:c};break;case bt:l={x:r.x-s.width,y:c};break;default:l={x:r.x,y:r.y}}var d=n?Fn(n):null;if(d!=null){var m=d==="y"?"height":"width";switch(i){case Rr:l[d]=l[d]-(r[m]/2-s[m]/2);break;case js:l[d]=l[d]+(r[m]/2-s[m]/2);break}}return l}function Ns(t,r){r===void 0&&(r={});var s=r,a=s.placement,n=a===void 0?t.placement:a,i=s.strategy,o=i===void 0?t.strategy:i,c=s.boundary,l=c===void 0?Lh:c,d=s.rootBoundary,m=d===void 0?ic:d,x=s.elementContext,h=x===void 0?Zr:x,g=s.altBoundary,v=g===void 0?!1:g,u=s.padding,p=u===void 0?0:u,w=dc(typeof p!="number"?p:uc(p,Ms)),y=h===Zr?Uh:Zr,D=t.rects.popper,f=t.elements[v?y:h],T=xf(Nr(f)?f:f.contextElement||cr(t.elements.popper),l,m,o),j=Lr(t.elements.reference),k=hc({reference:j,element:D,strategy:"absolute",placement:n}),C=cn(Object.assign({},D,k)),M=h===Zr?C:j,z={top:T.top-M.top+w.top,bottom:M.bottom-T.bottom+w.bottom,left:T.left-M.left+w.left,right:M.right-T.right+w.right},I=t.modifiersData.offset;if(h===Zr&&I){var X=I[n];Object.keys(z).forEach(function(G){var re=[Mt,Pt].indexOf(G)>=0?1:-1,H=[vt,Pt].indexOf(G)>=0?"y":"x";z[G]+=X[H]*re})}return z}function pf(t,r){r===void 0&&(r={});var s=r,a=s.placement,n=s.boundary,i=s.rootBoundary,o=s.padding,c=s.flipVariations,l=s.allowedAutoPlacements,d=l===void 0?In:l,m=Ur(a),x=m?c?Vi:Vi.filter(function(v){return Ur(v)===m}):Ms,h=x.filter(function(v){return d.indexOf(v)>=0});h.length===0&&(h=x);var g=h.reduce(function(v,u){return v[u]=Ns(t,{placement:u,boundary:n,rootBoundary:i,padding:o})[Bt(u)],v},{});return Object.keys(g).sort(function(v,u){return g[v]-g[u]})}function vf(t){if(Bt(t)===Rn)return[];var r=Xs(t);return[Xi(t),r,Xi(r)]}function bf(t){var r=t.state,s=t.options,a=t.name;if(!r.modifiersData[a]._skip){for(var n=s.mainAxis,i=n===void 0?!0:n,o=s.altAxis,c=o===void 0?!0:o,l=s.fallbackPlacements,d=s.padding,m=s.boundary,x=s.rootBoundary,h=s.altBoundary,g=s.flipVariations,v=g===void 0?!0:g,u=s.allowedAutoPlacements,p=r.options.placement,w=Bt(p),y=w===p,D=l||(y||!v?[Xs(p)]:vf(p)),f=[p].concat(D).reduce(function(Te,Z){return Te.concat(Bt(Z)===Rn?pf(r,{placement:Z,boundary:m,rootBoundary:x,padding:d,flipVariations:v,allowedAutoPlacements:u}):Z)},[]),T=r.rects.reference,j=r.rects.popper,k=new Map,C=!0,M=f[0],z=0;z<f.length;z++){var I=f[z],X=Bt(I),G=Ur(I)===Rr,re=[vt,Pt].indexOf(X)>=0,H=re?"width":"height",$=Ns(r,{placement:I,boundary:m,rootBoundary:x,altBoundary:h,padding:d}),W=re?G?Mt:bt:G?Pt:vt;T[H]>j[H]&&(W=Xs(W));var Q=Xs(W),te=[];if(i&&te.push($[X]<=0),c&&te.push($[W]<=0,$[Q]<=0),te.every(function(Te){return Te})){M=I,C=!1;break}k.set(I,te)}if(C)for(var me=v?3:1,ve=function(Z){var K=f.find(function(je){var V=k.get(je);if(V)return V.slice(0,Z).every(function(ce){return ce})});if(K)return M=K,"break"},Ne=me;Ne>0;Ne--){var he=ve(Ne);if(he==="break")break}r.placement!==M&&(r.modifiersData[a]._skip=!0,r.placement=M,r.reset=!0)}}const yf={name:"flip",enabled:!0,phase:"main",fn:bf,requiresIfExists:["offset"],data:{_skip:!1}};function Zi(t,r,s){return s===void 0&&(s={x:0,y:0}),{top:t.top-r.height-s.y,right:t.right-r.width+s.x,bottom:t.bottom-r.height+s.y,left:t.left-r.width-s.x}}function eo(t){return[vt,Mt,Pt,bt].some(function(r){return t[r]>=0})}function wf(t){var r=t.state,s=t.name,a=r.rects.reference,n=r.rects.popper,i=r.modifiersData.preventOverflow,o=Ns(r,{elementContext:"reference"}),c=Ns(r,{altBoundary:!0}),l=Zi(o,a),d=Zi(c,n,i),m=eo(l),x=eo(d);r.modifiersData[s]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:m,hasPopperEscaped:x},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":m,"data-popper-escaped":x})}const jf={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:wf};function Nf(t,r,s){var a=Bt(t),n=[bt,vt].indexOf(a)>=0?-1:1,i=typeof s=="function"?s(Object.assign({},r,{placement:t})):s,o=i[0],c=i[1];return o=o||0,c=(c||0)*n,[bt,Mt].indexOf(a)>=0?{x:c,y:o}:{x:o,y:c}}function Sf(t){var r=t.state,s=t.options,a=t.name,n=s.offset,i=n===void 0?[0,0]:n,o=In.reduce(function(m,x){return m[x]=Nf(x,r.rects,i),m},{}),c=o[r.placement],l=c.x,d=c.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=l,r.modifiersData.popperOffsets.y+=d),r.modifiersData[a]=o}const kf={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Sf};function Cf(t){var r=t.state,s=t.name;r.modifiersData[s]=hc({reference:r.rects.reference,element:r.rects.popper,strategy:"absolute",placement:r.placement})}const Tf={name:"popperOffsets",enabled:!0,phase:"read",fn:Cf,data:{}};function Df(t){return t==="x"?"y":"x"}function Ef(t){var r=t.state,s=t.options,a=t.name,n=s.mainAxis,i=n===void 0?!0:n,o=s.altAxis,c=o===void 0?!1:o,l=s.boundary,d=s.rootBoundary,m=s.altBoundary,x=s.padding,h=s.tether,g=h===void 0?!0:h,v=s.tetherOffset,u=v===void 0?0:v,p=Ns(r,{boundary:l,rootBoundary:d,padding:x,altBoundary:m}),w=Bt(r.placement),y=Ur(r.placement),D=!y,f=Fn(w),T=Df(f),j=r.modifiersData.popperOffsets,k=r.rects.reference,C=r.rects.popper,M=typeof u=="function"?u(Object.assign({},r.rects,{placement:r.placement})):u,z=typeof M=="number"?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),I=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,X={x:0,y:0};if(j){if(i){var G,re=f==="y"?vt:bt,H=f==="y"?Pt:Mt,$=f==="y"?"height":"width",W=j[f],Q=W+p[re],te=W-p[H],me=g?-C[$]/2:0,ve=y===Rr?k[$]:C[$],Ne=y===Rr?-C[$]:-k[$],he=r.elements.arrow,Te=g&&he?Un(he):{width:0,height:0},Z=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:cc(),K=Z[re],je=Z[H],V=ns(0,k[$],Te[$]),ce=D?k[$]/2-me-V-K-z.mainAxis:ve-V-K-z.mainAxis,De=D?-k[$]/2+me+V+je+z.mainAxis:Ne+V+je+z.mainAxis,Ie=r.elements.arrow&&_s(r.elements.arrow),Le=Ie?f==="y"?Ie.clientTop||0:Ie.clientLeft||0:0,Xe=(G=I==null?void 0:I[f])!=null?G:0,Qe=W+ce-Xe-Le,J=W+De-Xe,$e=ns(g?na(Q,Qe):Q,W,g?xr(te,J):te);j[f]=$e,X[f]=$e-W}if(c){var be,Me=f==="x"?vt:bt,ut=f==="x"?Pt:Mt,Fe=j[T],q=T==="y"?"height":"width",fe=Fe+p[Me],S=Fe-p[ut],F=[vt,bt].indexOf(w)!==-1,A=(be=I==null?void 0:I[T])!=null?be:0,P=F?fe:Fe-k[q]-C[q]-A+z.altAxis,b=F?Fe+k[q]+C[q]-A-z.altAxis:S,L=g&&F?Qh(P,Fe,b):ns(g?P:fe,Fe,g?b:S);j[T]=L,X[T]=L-Fe}r.modifiersData[a]=X}}const $f={name:"preventOverflow",enabled:!0,phase:"main",fn:Ef,requiresIfExists:["offset"]};function Of(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Pf(t){return t===St(t)||!Yt(t)?Wn(t):Of(t)}function Mf(t){var r=t.getBoundingClientRect(),s=Ir(r.width)/t.offsetWidth||1,a=Ir(r.height)/t.offsetHeight||1;return s!==1||a!==1}function _f(t,r,s){s===void 0&&(s=!1);var a=Yt(r),n=Yt(r)&&Mf(r),i=cr(r),o=Lr(t,n,s),c={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(a||!a&&!s)&&((nr(r)!=="body"||zn(i))&&(c=Pf(r)),Yt(r)?(l=Lr(r,!0),l.x+=r.clientLeft,l.y+=r.clientTop):i&&(l.x=Hn(i))),{x:o.left+c.scrollLeft-l.x,y:o.top+c.scrollTop-l.y,width:o.width,height:o.height}}function Af(t){var r=new Map,s=new Set,a=[];t.forEach(function(i){r.set(i.name,i)});function n(i){s.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(c){if(!s.has(c)){var l=r.get(c);l&&n(l)}}),a.push(i)}return t.forEach(function(i){s.has(i.name)||n(i)}),a}function Rf(t){var r=Af(t);return Kh.reduce(function(s,a){return s.concat(r.filter(function(n){return n.phase===a}))},[])}function If(t){var r;return function(){return r||(r=new Promise(function(s){Promise.resolve().then(function(){r=void 0,s(t())})})),r}}function Lf(t){var r=t.reduce(function(s,a){var n=s[a.name];return s[a.name]=n?Object.assign({},n,a,{options:Object.assign({},n.options,a.options),data:Object.assign({},n.data,a.data)}):a,s},{});return Object.keys(r).map(function(s){return r[s]})}var to={placement:"bottom",modifiers:[],strategy:"absolute"};function ro(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return!r.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function Uf(t){t===void 0&&(t={});var r=t,s=r.defaultModifiers,a=s===void 0?[]:s,n=r.defaultOptions,i=n===void 0?to:n;return function(c,l,d){d===void 0&&(d=i);var m={placement:"bottom",orderedModifiers:[],options:Object.assign({},to,i),modifiersData:{},elements:{reference:c,popper:l},attributes:{},styles:{}},x=[],h=!1,g={state:m,setOptions:function(w){var y=typeof w=="function"?w(m.options):w;u(),m.options=Object.assign({},i,m.options,y),m.scrollParents={reference:Nr(c)?is(c):c.contextElement?is(c.contextElement):[],popper:is(l)};var D=Rf(Lf([].concat(a,m.options.modifiers)));return m.orderedModifiers=D.filter(function(f){return f.enabled}),v(),g.update()},forceUpdate:function(){if(!h){var w=m.elements,y=w.reference,D=w.popper;if(ro(y,D)){m.rects={reference:_f(y,_s(D),m.options.strategy==="fixed"),popper:Un(D)},m.reset=!1,m.placement=m.options.placement,m.orderedModifiers.forEach(function(z){return m.modifiersData[z.name]=Object.assign({},z.data)});for(var f=0;f<m.orderedModifiers.length;f++){if(m.reset===!0){m.reset=!1,f=-1;continue}var T=m.orderedModifiers[f],j=T.fn,k=T.options,C=k===void 0?{}:k,M=T.name;typeof j=="function"&&(m=j({state:m,options:C,name:M,instance:g})||m)}}}},update:If(function(){return new Promise(function(p){g.forceUpdate(),p(m)})}),destroy:function(){u(),h=!0}};if(!ro(c,l))return g;g.setOptions(d).then(function(p){!h&&d.onFirstUpdate&&d.onFirstUpdate(p)});function v(){m.orderedModifiers.forEach(function(p){var w=p.name,y=p.options,D=y===void 0?{}:y,f=p.effect;if(typeof f=="function"){var T=f({state:m,name:w,instance:g,options:D}),j=function(){};x.push(T||j)}})}function u(){x.forEach(function(p){return p()}),x=[]}return g}}var Ff=Uf({defaultModifiers:[jf,Tf,of,cf,kf,yf,$f,rf]}),so=function(r){return{position:r,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},Wf={name:"applyStyles",enabled:!1},Hf={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(r){var s=r.state;return function(){var a=s.elements,n=a.reference,i=a.popper;if("removeAttribute"in n){var o=(n.getAttribute("aria-describedby")||"").split(",").filter(function(c){return c.trim()!==i.id});o.length?n.setAttribute("aria-describedby",o.join(",")):n.removeAttribute("aria-describedby")}}},fn:function(r){var s,a=r.state,n=a.elements,i=n.popper,o=n.reference,c=(s=i.getAttribute("role"))==null?void 0:s.toLowerCase();if(i.id&&c==="tooltip"&&"setAttribute"in o){var l=o.getAttribute("aria-describedby");if(l&&l.split(",").indexOf(i.id)!==-1)return;o.setAttribute("aria-describedby",l?l+","+i.id:i.id)}}},zf=[];function Bf(t,r,s){var a=s===void 0?{}:s,n=a.enabled,i=n===void 0?!0:n,o=a.placement,c=o===void 0?"bottom":o,l=a.strategy,d=l===void 0?"absolute":l,m=a.modifiers,x=m===void 0?zf:m,h=xa(a,["enabled","placement","strategy","modifiers"]),g=N.useRef(),v=N.useCallback(function(){var f;(f=g.current)==null||f.update()},[]),u=N.useCallback(function(){var f;(f=g.current)==null||f.forceUpdate()},[]),p=Ih(N.useState({placement:c,update:v,forceUpdate:u,attributes:{},styles:{popper:so(d),arrow:{}}})),w=p[0],y=p[1],D=N.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(T){var j=T.state,k={},C={};Object.keys(j.elements).forEach(function(M){k[M]=j.styles[M],C[M]=j.attributes[M]}),y({state:j,styles:k,attributes:C,update:v,forceUpdate:u,placement:j.placement})}}},[v,u,y]);return N.useEffect(function(){!g.current||!i||g.current.setOptions({placement:c,strategy:d,modifiers:[].concat(x,[D,Wf])})},[d,c,D,i]),N.useEffect(function(){if(!(!i||t==null||r==null))return g.current=Ff(t,r,Ve({},h,{placement:c,strategy:d,modifiers:[].concat(x,[Hf,D])})),function(){g.current!=null&&(g.current.destroy(),g.current=void 0,y(function(f){return Ve({},f,{attributes:{},styles:{popper:so(d)}})}))}},[i,t,r]),w}function Yf(t,r,s,a){var n=a&&typeof a!="boolean"?a.capture:a;t.removeEventListener(r,s,n),s.__once&&t.removeEventListener(r,s.__once,n)}function ss(t,r,s,a){return _h(t,r,s,a),function(){Yf(t,r,s,a)}}var qf=function(){},Gf=qf;const Vf=_t(Gf);function Kf(t){return t&&"setState"in t?pl.findDOMNode(t):t??null}const Jf=function(t){return Ps(Kf(t))};var Xf=27,ao=function(){};function Qf(t){return t.button===0}function Zf(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}var no=function(r){return r&&("current"in r?r.current:r)};function eg(t,r,s){var a=s===void 0?{}:s,n=a.disabled,i=a.clickTrigger,o=i===void 0?"click":i,c=N.useRef(!1),l=r||ao,d=N.useCallback(function(h){var g,v=no(t);Vf(!!v,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),c.current=!v||Zf(h)||!Qf(h)||!!ws(v,(g=h.composedPath==null?void 0:h.composedPath()[0])!=null?g:h.target)},[t]),m=qi(function(h){c.current||l(h)}),x=qi(function(h){h.keyCode===Xf&&l(h)});N.useEffect(function(){if(!(n||t==null)){var h=window.event,g=Jf(no(t)),v=ss(g,o,d,!0),u=ss(g,o,function(y){if(y===h){h=void 0;return}m(y)}),p=ss(g,"keyup",function(y){if(y===h){h=void 0;return}x(y)}),w=[];return"ontouchstart"in g.documentElement&&(w=[].slice.call(g.body.children).map(function(y){return ss(y,"mousemove",ao)})),function(){v(),u(),p(),w.forEach(function(y){return y()})}}},[t,n,o,d,m,x])}function tg(t){var r={};return Array.isArray(t)?(t==null||t.forEach(function(s){r[s.name]=s}),r):t||r}function rg(t){return t===void 0&&(t={}),Array.isArray(t)?t:Object.keys(t).map(function(r){return t[r].name=r,t[r]})}function sg(t){var r,s,a,n,i=t.enabled,o=t.enableEvents,c=t.placement,l=t.flip,d=t.offset,m=t.fixed,x=t.containerPadding,h=t.arrowElement,g=t.popperConfig,v=g===void 0?{}:g,u=tg(v.modifiers);return Ve({},v,{placement:c,enabled:i,strategy:m?"fixed":v.strategy,modifiers:rg(Ve({},u,{eventListeners:{enabled:o},preventOverflow:Ve({},u.preventOverflow,{options:x?Ve({padding:x},(r=u.preventOverflow)==null?void 0:r.options):(s=u.preventOverflow)==null?void 0:s.options}),offset:{options:Ve({offset:d},(a=u.offset)==null?void 0:a.options)},arrow:Ve({},u.arrow,{enabled:!!h,options:Ve({},(n=u.arrow)==null?void 0:n.options,{element:h})}),flip:Ve({enabled:!!l},u.flip)}))})}function ag(t,r){return t.classList?!!r&&t.classList.contains(r):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+r+" ")!==-1}function ng(t,r){t.classList?t.classList.add(r):ag(t,r)||(typeof t.className=="string"?t.className=t.className+" "+r:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+r))}function io(t,r){return t.replace(new RegExp("(^|\\s)"+r+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function ig(t,r){t.classList?t.classList.remove(r):typeof t.className=="string"?t.className=io(t.className,r):t.setAttribute("class",io(t.className&&t.className.baseVal||"",r))}var Ys;function Bn(t){if((!Ys&&Ys!==0||t)&&An){var r=document.createElement("div");r.style.position="absolute",r.style.top="-9999px",r.style.width="50px",r.style.height="50px",r.style.overflow="scroll",document.body.appendChild(r),Ys=r.offsetWidth-r.clientWidth,document.body.removeChild(r)}return Ys}var za=function(r){var s;return typeof document>"u"?null:r==null?Ps().body:(typeof r=="function"&&(r=r()),r&&"current"in r&&(r=r.current),(s=r)!=null&&s.nodeType&&r||null)};function oo(t,r){var s=N.useState(function(){return za(t)}),a=s[0],n=s[1];if(!a){var i=za(t);i&&n(i)}return N.useEffect(function(){r&&a&&r(a)},[r,a]),N.useEffect(function(){var o=za(t);o!==a&&n(o)},[t,a]),a}const lo=t=>!t||typeof t=="function"?t:r=>{t.current=r};function og(t,r){const s=lo(t),a=lo(r);return n=>{s&&s(n),a&&a(n)}}function lg(t,r){return N.useMemo(()=>og(t,r),[t,r])}var Yn=U.forwardRef(function(t,r){var s=t.flip,a=t.offset,n=t.placement,i=t.containerPadding,o=i===void 0?5:i,c=t.popperConfig,l=c===void 0?{}:c,d=t.transition,m=Gi(),x=m[0],h=m[1],g=Gi(),v=g[0],u=g[1],p=lg(h,r),w=oo(t.container),y=oo(t.target),D=N.useState(!t.show),f=D[0],T=D[1],j=Bf(y,x,sg({placement:n,enableEvents:!!t.show,containerPadding:o||5,flip:s,offset:a,arrowElement:v,popperConfig:l})),k=j.styles,C=j.attributes,M=xa(j,["styles","attributes"]);t.show?f&&T(!1):!t.transition&&!f&&T(!0);var z=function(){T(!0),t.onExited&&t.onExited.apply(t,arguments)},I=t.show||d&&!f;if(eg(x,t.onHide,{disabled:!t.rootClose||t.rootCloseDisabled,clickTrigger:t.rootCloseEvent}),!I)return null;var X=t.children(Ve({},M,{show:!!t.show,props:Ve({},C.popper,{style:k.popper,ref:p}),arrowProps:Ve({},C.arrow,{style:k.arrow,ref:u})}));if(d){var G=t.onExit,re=t.onExiting,H=t.onEnter,$=t.onEntering,W=t.onEntered;X=U.createElement(d,{in:t.show,appear:!0,onExit:G,onExiting:re,onExited:z,onEnter:H,onEntering:$,onEntered:W},X)}return w?pl.createPortal(X,w):null});Yn.displayName="Overlay";Yn.propTypes={show:se.bool,placement:se.oneOf(In),target:se.any,container:se.any,flip:se.bool,children:se.func.isRequired,containerPadding:se.number,popperConfig:se.object,rootClose:se.bool,rootCloseEvent:se.oneOf(["click","mousedown"]),rootCloseDisabled:se.bool,onHide:function(r){for(var s=arguments.length,a=new Array(s>1?s-1:0),n=1;n<s;n++)a[n-1]=arguments[n];if(r.rootClose){var i;return(i=se.func).isRequired.apply(i,[r].concat(a))}return se.func.apply(se,[r].concat(a))},transition:se.elementType,onEnter:se.func,onEntering:se.func,onEntered:se.func,onExit:se.func,onExiting:se.func,onExited:se.func};const cg=Yn;function dg(){this.__data__=[],this.size=0}var ug=dg,mg=Es;function hg(t,r){for(var s=t.length;s--;)if(mg(t[s][0],r))return s;return-1}var wa=hg,fg=wa,gg=Array.prototype,xg=gg.splice;function pg(t){var r=this.__data__,s=fg(r,t);if(s<0)return!1;var a=r.length-1;return s==a?r.pop():xg.call(r,s,1),--this.size,!0}var vg=pg,bg=wa;function yg(t){var r=this.__data__,s=bg(r,t);return s<0?void 0:r[s][1]}var wg=yg,jg=wa;function Ng(t){return jg(this.__data__,t)>-1}var Sg=Ng,kg=wa;function Cg(t,r){var s=this.__data__,a=kg(s,t);return a<0?(++this.size,s.push([t,r])):s[a][1]=r,this}var Tg=Cg,Dg=ug,Eg=vg,$g=wg,Og=Sg,Pg=Tg;function qr(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var a=t[r];this.set(a[0],a[1])}}qr.prototype.clear=Dg;qr.prototype.delete=Eg;qr.prototype.get=$g;qr.prototype.has=Og;qr.prototype.set=Pg;var ja=qr,Mg=ja;function _g(){this.__data__=new Mg,this.size=0}var Ag=_g;function Rg(t){var r=this.__data__,s=r.delete(t);return this.size=r.size,s}var Ig=Rg;function Lg(t){return this.__data__.get(t)}var Ug=Lg;function Fg(t){return this.__data__.has(t)}var Wg=Fg,Hg=Gt,zg=Hg["__core-js_shared__"],Bg=zg,Ba=Bg,co=function(){var t=/[^.]+$/.exec(Ba&&Ba.keys&&Ba.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Yg(t){return!!co&&co in t}var qg=Yg,Gg=Function.prototype,Vg=Gg.toString;function Kg(t){if(t!=null){try{return Vg.call(t)}catch{}try{return t+""}catch{}}return""}var fc=Kg,Jg=On,Xg=qg,Qg=er,Zg=fc,ex=/[\\^$.*+?()[\]{}|]/g,tx=/^\[object .+?Constructor\]$/,rx=Function.prototype,sx=Object.prototype,ax=rx.toString,nx=sx.hasOwnProperty,ix=RegExp("^"+ax.call(nx).replace(ex,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ox(t){if(!Qg(t)||Xg(t))return!1;var r=Jg(t)?ix:tx;return r.test(Zg(t))}var lx=ox;function cx(t,r){return t==null?void 0:t[r]}var dx=cx,ux=lx,mx=dx;function hx(t,r){var s=mx(t,r);return ux(s)?s:void 0}var kr=hx,fx=kr,gx=Gt,xx=fx(gx,"Map"),qn=xx,px=kr,vx=px(Object,"create"),Na=vx,uo=Na;function bx(){this.__data__=uo?uo(null):{},this.size=0}var yx=bx;function wx(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var jx=wx,Nx=Na,Sx="__lodash_hash_undefined__",kx=Object.prototype,Cx=kx.hasOwnProperty;function Tx(t){var r=this.__data__;if(Nx){var s=r[t];return s===Sx?void 0:s}return Cx.call(r,t)?r[t]:void 0}var Dx=Tx,Ex=Na,$x=Object.prototype,Ox=$x.hasOwnProperty;function Px(t){var r=this.__data__;return Ex?r[t]!==void 0:Ox.call(r,t)}var Mx=Px,_x=Na,Ax="__lodash_hash_undefined__";function Rx(t,r){var s=this.__data__;return this.size+=this.has(t)?0:1,s[t]=_x&&r===void 0?Ax:r,this}var Ix=Rx,Lx=yx,Ux=jx,Fx=Dx,Wx=Mx,Hx=Ix;function Gr(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var a=t[r];this.set(a[0],a[1])}}Gr.prototype.clear=Lx;Gr.prototype.delete=Ux;Gr.prototype.get=Fx;Gr.prototype.has=Wx;Gr.prototype.set=Hx;var zx=Gr,mo=zx,Bx=ja,Yx=qn;function qx(){this.size=0,this.__data__={hash:new mo,map:new(Yx||Bx),string:new mo}}var Gx=qx;function Vx(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}var Kx=Vx,Jx=Kx;function Xx(t,r){var s=t.__data__;return Jx(r)?s[typeof r=="string"?"string":"hash"]:s.map}var Sa=Xx,Qx=Sa;function Zx(t){var r=Qx(this,t).delete(t);return this.size-=r?1:0,r}var ep=Zx,tp=Sa;function rp(t){return tp(this,t).get(t)}var sp=rp,ap=Sa;function np(t){return ap(this,t).has(t)}var ip=np,op=Sa;function lp(t,r){var s=op(this,t),a=s.size;return s.set(t,r),this.size+=s.size==a?0:1,this}var cp=lp,dp=Gx,up=ep,mp=sp,hp=ip,fp=cp;function Vr(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var a=t[r];this.set(a[0],a[1])}}Vr.prototype.clear=dp;Vr.prototype.delete=up;Vr.prototype.get=mp;Vr.prototype.has=hp;Vr.prototype.set=fp;var Gn=Vr,gp=ja,xp=qn,pp=Gn,vp=200;function bp(t,r){var s=this.__data__;if(s instanceof gp){var a=s.__data__;if(!xp||a.length<vp-1)return a.push([t,r]),this.size=++s.size,this;s=this.__data__=new pp(a)}return s.set(t,r),this.size=s.size,this}var yp=bp,wp=ja,jp=Ag,Np=Ig,Sp=Ug,kp=Wg,Cp=yp;function Kr(t){var r=this.__data__=new wp(t);this.size=r.size}Kr.prototype.clear=jp;Kr.prototype.delete=Np;Kr.prototype.get=Sp;Kr.prototype.has=kp;Kr.prototype.set=Cp;var Vn=Kr,Tp="__lodash_hash_undefined__";function Dp(t){return this.__data__.set(t,Tp),this}var Ep=Dp;function $p(t){return this.__data__.has(t)}var Op=$p,Pp=Gn,Mp=Ep,_p=Op;function ia(t){var r=-1,s=t==null?0:t.length;for(this.__data__=new Pp;++r<s;)this.add(t[r])}ia.prototype.add=ia.prototype.push=Mp;ia.prototype.has=_p;var Ap=ia;function Rp(t,r){for(var s=-1,a=t==null?0:t.length;++s<a;)if(r(t[s],s,t))return!0;return!1}var Ip=Rp;function Lp(t,r){return t.has(r)}var Up=Lp,Fp=Ap,Wp=Ip,Hp=Up,zp=1,Bp=2;function Yp(t,r,s,a,n,i){var o=s&zp,c=t.length,l=r.length;if(c!=l&&!(o&&l>c))return!1;var d=i.get(t),m=i.get(r);if(d&&m)return d==r&&m==t;var x=-1,h=!0,g=s&Bp?new Fp:void 0;for(i.set(t,r),i.set(r,t);++x<c;){var v=t[x],u=r[x];if(a)var p=o?a(u,v,x,r,t,i):a(v,u,x,t,r,i);if(p!==void 0){if(p)continue;h=!1;break}if(g){if(!Wp(r,function(w,y){if(!Hp(g,y)&&(v===w||n(v,w,s,a,i)))return g.push(y)})){h=!1;break}}else if(!(v===u||n(v,u,s,a,i))){h=!1;break}}return i.delete(t),i.delete(r),h}var gc=Yp,qp=Gt,Gp=qp.Uint8Array,xc=Gp;function Vp(t){var r=-1,s=Array(t.size);return t.forEach(function(a,n){s[++r]=[n,a]}),s}var Kp=Vp;function Jp(t){var r=-1,s=Array(t.size);return t.forEach(function(a){s[++r]=a}),s}var Xp=Jp,ho=Br,fo=xc,Qp=Es,Zp=gc,ev=Kp,tv=Xp,rv=1,sv=2,av="[object Boolean]",nv="[object Date]",iv="[object Error]",ov="[object Map]",lv="[object Number]",cv="[object RegExp]",dv="[object Set]",uv="[object String]",mv="[object Symbol]",hv="[object ArrayBuffer]",fv="[object DataView]",go=ho?ho.prototype:void 0,Ya=go?go.valueOf:void 0;function gv(t,r,s,a,n,i,o){switch(s){case fv:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case hv:return!(t.byteLength!=r.byteLength||!i(new fo(t),new fo(r)));case av:case nv:case lv:return Qp(+t,+r);case iv:return t.name==r.name&&t.message==r.message;case cv:case uv:return t==r+"";case ov:var c=ev;case dv:var l=a&rv;if(c||(c=tv),t.size!=r.size&&!l)return!1;var d=o.get(t);if(d)return d==r;a|=sv,o.set(t,r);var m=Zp(c(t),c(r),a,n,i,o);return o.delete(t),m;case mv:if(Ya)return Ya.call(t)==Ya.call(r)}return!1}var xv=gv;function pv(t,r){for(var s=-1,a=r.length,n=t.length;++s<a;)t[n+s]=r[s];return t}var Kn=pv,vv=Array.isArray,At=vv,bv=Kn,yv=At;function wv(t,r,s){var a=r(t);return yv(t)?a:bv(a,s(t))}var pc=wv;function jv(t,r){for(var s=-1,a=t==null?0:t.length,n=0,i=[];++s<a;){var o=t[s];r(o,s,t)&&(i[n++]=o)}return i}var Nv=jv;function Sv(){return[]}var vc=Sv,kv=Nv,Cv=vc,Tv=Object.prototype,Dv=Tv.propertyIsEnumerable,xo=Object.getOwnPropertySymbols,Ev=xo?function(t){return t==null?[]:(t=Object(t),kv(xo(t),function(r){return Dv.call(t,r)}))}:Cv,Jn=Ev;function $v(t,r){for(var s=-1,a=Array(t);++s<t;)a[s]=r(s);return a}var Ov=$v,Pv=Yr,Mv=lr,_v="[object Arguments]";function Av(t){return Mv(t)&&Pv(t)==_v}var Rv=Av,po=Rv,Iv=lr,bc=Object.prototype,Lv=bc.hasOwnProperty,Uv=bc.propertyIsEnumerable,Fv=po(function(){return arguments}())?po:function(t){return Iv(t)&&Lv.call(t,"callee")&&!Uv.call(t,"callee")},Xn=Fv,oa={exports:{}};function Wv(){return!1}var Hv=Wv;oa.exports;(function(t,r){var s=Gt,a=Hv,n=r&&!r.nodeType&&r,i=n&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===n,c=o?s.Buffer:void 0,l=c?c.isBuffer:void 0,d=l||a;t.exports=d})(oa,oa.exports);var ka=oa.exports,zv=Yr,Bv=Pn,Yv=lr,qv="[object Arguments]",Gv="[object Array]",Vv="[object Boolean]",Kv="[object Date]",Jv="[object Error]",Xv="[object Function]",Qv="[object Map]",Zv="[object Number]",e0="[object Object]",t0="[object RegExp]",r0="[object Set]",s0="[object String]",a0="[object WeakMap]",n0="[object ArrayBuffer]",i0="[object DataView]",o0="[object Float32Array]",l0="[object Float64Array]",c0="[object Int8Array]",d0="[object Int16Array]",u0="[object Int32Array]",m0="[object Uint8Array]",h0="[object Uint8ClampedArray]",f0="[object Uint16Array]",g0="[object Uint32Array]",We={};We[o0]=We[l0]=We[c0]=We[d0]=We[u0]=We[m0]=We[h0]=We[f0]=We[g0]=!0;We[qv]=We[Gv]=We[n0]=We[Vv]=We[i0]=We[Kv]=We[Jv]=We[Xv]=We[Qv]=We[Zv]=We[e0]=We[t0]=We[r0]=We[s0]=We[a0]=!1;function x0(t){return Yv(t)&&Bv(t.length)&&!!We[zv(t)]}var p0=x0;function v0(t){return function(r){return t(r)}}var Ca=v0,la={exports:{}};la.exports;(function(t,r){var s=Xl,a=r&&!r.nodeType&&r,n=a&&!0&&t&&!t.nodeType&&t,i=n&&n.exports===a,o=i&&s.process,c=function(){try{var l=n&&n.require&&n.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=c})(la,la.exports);var Qn=la.exports,b0=p0,y0=Ca,vo=Qn,bo=vo&&vo.isTypedArray,w0=bo?y0(bo):b0,Zn=w0,j0=Ov,N0=Xn,S0=At,k0=ka,C0=Mn,T0=Zn,D0=Object.prototype,E0=D0.hasOwnProperty;function $0(t,r){var s=S0(t),a=!s&&N0(t),n=!s&&!a&&k0(t),i=!s&&!a&&!n&&T0(t),o=s||a||n||i,c=o?j0(t.length,String):[],l=c.length;for(var d in t)(r||E0.call(t,d))&&!(o&&(d=="length"||n&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||C0(d,l)))&&c.push(d);return c}var yc=$0,O0=Object.prototype;function P0(t){var r=t&&t.constructor,s=typeof r=="function"&&r.prototype||O0;return t===s}var ei=P0;function M0(t,r){return function(s){return t(r(s))}}var wc=M0,_0=wc,A0=_0(Object.keys,Object),R0=A0,I0=ei,L0=R0,U0=Object.prototype,F0=U0.hasOwnProperty;function W0(t){if(!I0(t))return L0(t);var r=[];for(var s in Object(t))F0.call(t,s)&&s!="constructor"&&r.push(s);return r}var H0=W0,z0=yc,B0=H0,Y0=$s;function q0(t){return Y0(t)?z0(t):B0(t)}var As=q0,G0=pc,V0=Jn,K0=As;function J0(t){return G0(t,K0,V0)}var jc=J0,yo=jc,X0=1,Q0=Object.prototype,Z0=Q0.hasOwnProperty;function eb(t,r,s,a,n,i){var o=s&X0,c=yo(t),l=c.length,d=yo(r),m=d.length;if(l!=m&&!o)return!1;for(var x=l;x--;){var h=c[x];if(!(o?h in r:Z0.call(r,h)))return!1}var g=i.get(t),v=i.get(r);if(g&&v)return g==r&&v==t;var u=!0;i.set(t,r),i.set(r,t);for(var p=o;++x<l;){h=c[x];var w=t[h],y=r[h];if(a)var D=o?a(y,w,h,r,t,i):a(w,y,h,t,r,i);if(!(D===void 0?w===y||n(w,y,s,a,i):D)){u=!1;break}p||(p=h=="constructor")}if(u&&!p){var f=t.constructor,T=r.constructor;f!=T&&"constructor"in t&&"constructor"in r&&!(typeof f=="function"&&f instanceof f&&typeof T=="function"&&T instanceof T)&&(u=!1)}return i.delete(t),i.delete(r),u}var tb=eb,rb=kr,sb=Gt,ab=rb(sb,"DataView"),nb=ab,ib=kr,ob=Gt,lb=ib(ob,"Promise"),cb=lb,db=kr,ub=Gt,mb=db(ub,"Set"),hb=mb,fb=kr,gb=Gt,xb=fb(gb,"WeakMap"),pb=xb,dn=nb,un=qn,mn=cb,hn=hb,fn=pb,Nc=Yr,Jr=fc,wo="[object Map]",vb="[object Object]",jo="[object Promise]",No="[object Set]",So="[object WeakMap]",ko="[object DataView]",bb=Jr(dn),yb=Jr(un),wb=Jr(mn),jb=Jr(hn),Nb=Jr(fn),mr=Nc;(dn&&mr(new dn(new ArrayBuffer(1)))!=ko||un&&mr(new un)!=wo||mn&&mr(mn.resolve())!=jo||hn&&mr(new hn)!=No||fn&&mr(new fn)!=So)&&(mr=function(t){var r=Nc(t),s=r==vb?t.constructor:void 0,a=s?Jr(s):"";if(a)switch(a){case bb:return ko;case yb:return wo;case wb:return jo;case jb:return No;case Nb:return So}return r});var Ta=mr,qa=Vn,Sb=gc,kb=xv,Cb=tb,Co=Ta,To=At,Do=ka,Tb=Zn,Db=1,Eo="[object Arguments]",$o="[object Array]",qs="[object Object]",Eb=Object.prototype,Oo=Eb.hasOwnProperty;function $b(t,r,s,a,n,i){var o=To(t),c=To(r),l=o?$o:Co(t),d=c?$o:Co(r);l=l==Eo?qs:l,d=d==Eo?qs:d;var m=l==qs,x=d==qs,h=l==d;if(h&&Do(t)){if(!Do(r))return!1;o=!0,m=!1}if(h&&!m)return i||(i=new qa),o||Tb(t)?Sb(t,r,s,a,n,i):kb(t,r,l,s,a,n,i);if(!(s&Db)){var g=m&&Oo.call(t,"__wrapped__"),v=x&&Oo.call(r,"__wrapped__");if(g||v){var u=g?t.value():t,p=v?r.value():r;return i||(i=new qa),n(u,p,s,a,i)}}return h?(i||(i=new qa),Cb(t,r,s,a,n,i)):!1}var Ob=$b,Pb=Ob,Po=lr;function Sc(t,r,s,a,n){return t===r?!0:t==null||r==null||!Po(t)&&!Po(r)?t!==t&&r!==r:Pb(t,r,s,a,Sc,n)}var ti=Sc,Mb=ti;function _b(t,r){return Mb(t,r)}var Ab=_b;const Rb=_t(Ab);function Ga(t,r){var s=_n(t);return s?s.innerHeight:r?t.clientHeight:gr(t).height}function kc(t,r,s){t.closest&&!s&&t.closest(r);var a=t;do{if(Oh(a,r))return a;a=a.parentElement}while(a&&a!==s&&a.nodeType===document.ELEMENT_NODE);return null}function Ib(t,r,s,a){for(var n=t.length,i=s+(a?1:-1);a?i--:++i<n;)if(r(t[i],i,t))return i;return-1}var Lb=Ib,Ub=Vn,Fb=ti,Wb=1,Hb=2;function zb(t,r,s,a){var n=s.length,i=n,o=!a;if(t==null)return!i;for(t=Object(t);n--;){var c=s[n];if(o&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++n<i;){c=s[n];var l=c[0],d=t[l],m=c[1];if(o&&c[2]){if(d===void 0&&!(l in t))return!1}else{var x=new Ub;if(a)var h=a(d,m,l,t,r,x);if(!(h===void 0?Fb(m,d,Wb|Hb,a,x):h))return!1}}return!0}var Bb=zb,Yb=er;function qb(t){return t===t&&!Yb(t)}var Cc=qb,Gb=Cc,Vb=As;function Kb(t){for(var r=Vb(t),s=r.length;s--;){var a=r[s],n=t[a];r[s]=[a,n,Gb(n)]}return r}var Jb=Kb;function Xb(t,r){return function(s){return s==null?!1:s[t]===r&&(r!==void 0||t in Object(s))}}var Tc=Xb,Qb=Bb,Zb=Jb,ey=Tc;function ty(t){var r=Zb(t);return r.length==1&&r[0][2]?ey(r[0][0],r[0][1]):function(s){return s===t||Qb(s,t,r)}}var ry=ty,sy=At,ay=Os,ny=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,iy=/^\w*$/;function oy(t,r){if(sy(t))return!1;var s=typeof t;return s=="number"||s=="symbol"||s=="boolean"||t==null||ay(t)?!0:iy.test(t)||!ny.test(t)||r!=null&&t in Object(r)}var ri=oy,Dc=Gn,ly="Expected a function";function si(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(ly);var s=function(){var a=arguments,n=r?r.apply(this,a):a[0],i=s.cache;if(i.has(n))return i.get(n);var o=t.apply(this,a);return s.cache=i.set(n,o)||i,o};return s.cache=new(si.Cache||Dc),s}si.Cache=Dc;var cy=si,dy=cy,uy=500;function my(t){var r=dy(t,function(a){return s.size===uy&&s.clear(),a}),s=r.cache;return r}var hy=my,fy=hy,gy=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xy=/\\(\\)?/g,py=fy(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(gy,function(s,a,n,i){r.push(n?i.replace(xy,"$1"):a||s)}),r}),vy=py;function by(t,r){for(var s=-1,a=t==null?0:t.length,n=Array(a);++s<a;)n[s]=r(t[s],s,t);return n}var ai=by,Mo=Br,yy=ai,wy=At,jy=Os,Ny=1/0,_o=Mo?Mo.prototype:void 0,Ao=_o?_o.toString:void 0;function Ec(t){if(typeof t=="string")return t;if(wy(t))return yy(t,Ec)+"";if(jy(t))return Ao?Ao.call(t):"";var r=t+"";return r=="0"&&1/t==-Ny?"-0":r}var Sy=Ec,ky=Sy;function Cy(t){return t==null?"":ky(t)}var Ty=Cy,Dy=At,Ey=ri,$y=vy,Oy=Ty;function Py(t,r){return Dy(t)?t:Ey(t,r)?[t]:$y(Oy(t))}var Da=Py,My=Os,_y=1/0;function Ay(t){if(typeof t=="string"||My(t))return t;var r=t+"";return r=="0"&&1/t==-_y?"-0":r}var Rs=Ay,Ry=Da,Iy=Rs;function Ly(t,r){r=Ry(r,t);for(var s=0,a=r.length;t!=null&&s<a;)t=t[Iy(r[s++])];return s&&s==a?t:void 0}var Ea=Ly,Uy=Ea;function Fy(t,r,s){var a=t==null?void 0:Uy(t,r);return a===void 0?s:a}var Wy=Fy;function Hy(t,r){return t!=null&&r in Object(t)}var zy=Hy,By=Da,Yy=Xn,qy=At,Gy=Mn,Vy=Pn,Ky=Rs;function Jy(t,r,s){r=By(r,t);for(var a=-1,n=r.length,i=!1;++a<n;){var o=Ky(r[a]);if(!(i=t!=null&&s(t,o)))break;t=t[o]}return i||++a!=n?i:(n=t==null?0:t.length,!!n&&Vy(n)&&Gy(o,n)&&(qy(t)||Yy(t)))}var Xy=Jy,Qy=zy,Zy=Xy;function ew(t,r){return t!=null&&Zy(t,r,Qy)}var tw=ew,rw=ti,sw=Wy,aw=tw,nw=ri,iw=Cc,ow=Tc,lw=Rs,cw=1,dw=2;function uw(t,r){return nw(t)&&iw(r)?ow(lw(t),r):function(s){var a=sw(s,t);return a===void 0&&a===r?aw(s,t):rw(r,a,cw|dw)}}var mw=uw;function hw(t){return t}var $a=hw;function fw(t){return function(r){return r==null?void 0:r[t]}}var gw=fw,xw=Ea;function pw(t){return function(r){return xw(r,t)}}var vw=pw,bw=gw,yw=vw,ww=ri,jw=Rs;function Nw(t){return ww(t)?bw(jw(t)):yw(t)}var Sw=Nw,kw=ry,Cw=mw,Tw=$a,Dw=At,Ew=Sw;function $w(t){return typeof t=="function"?t:t==null?Tw:typeof t=="object"?Dw(t)?Cw(t[0],t[1]):kw(t):Ew(t)}var Oa=$w,Ow=Lb,Pw=Oa,Mw=ec,_w=Math.max;function Aw(t,r,s){var a=t==null?0:t.length;if(!a)return-1;var n=s==null?0:Mw(s);return n<0&&(n=_w(a+n,0)),Ow(t,Pw(r),n)}var Rw=Aw;const Iw=_t(Rw);var Lw=Math.ceil,Uw=Math.max;function Fw(t,r,s,a){for(var n=-1,i=Uw(Lw((r-t)/(s||1)),0),o=Array(i);i--;)o[a?i:++n]=t,t+=s;return o}var Ww=Fw,Hw=Ww,zw=ba,Va=Zl;function Bw(t){return function(r,s,a){return a&&typeof a!="number"&&zw(r,s,a)&&(s=a=void 0),r=Va(r),s===void 0?(s=r,r=0):s=Va(s),a=a===void 0?r<s?1:-1:Va(a),Hw(r,s,a,t)}}var Yw=Bw,qw=Yw,Gw=qw(),Vw=Gw;const Kw=_t(Vw);var Ro=Number.isNaN||function(r){return typeof r=="number"&&r!==r};function Jw(t,r){return!!(t===r||Ro(t)&&Ro(r))}function Xw(t,r){if(t.length!==r.length)return!1;for(var s=0;s<t.length;s++)if(!Jw(t[s],r[s]))return!1;return!0}function $c(t,r){r===void 0&&(r=Xw);var s=null;function a(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(s&&s.lastThis===this&&r(n,s.lastArgs))return s.lastResult;var o=t.apply(this,n);return s={lastResult:o,lastArgs:n,lastThis:this},o}return a.clear=function(){s=null},a}function gn(t,r){var s=_n(t);return s?s.innerWidth:r?t.clientWidth:gr(t).width}var Io=Br,Qw=Xn,Zw=At,Lo=Io?Io.isConcatSpreadable:void 0;function ej(t){return Zw(t)||Qw(t)||!!(Lo&&t&&t[Lo])}var tj=ej,rj=Kn,sj=tj;function Oc(t,r,s,a,n){var i=-1,o=t.length;for(s||(s=sj),n||(n=[]);++i<o;){var c=t[i];r>0&&s(c)?r>1?Oc(c,r-1,s,a,n):rj(n,c):a||(n[n.length]=c)}return n}var Pc=Oc;function aj(t){return function(r,s,a){for(var n=-1,i=Object(r),o=a(r),c=o.length;c--;){var l=o[t?c:++n];if(s(i[l],l,i)===!1)break}return r}}var nj=aj,ij=nj,oj=ij(),lj=oj,cj=lj,dj=As;function uj(t,r){return t&&cj(t,r,dj)}var ni=uj,mj=$s;function hj(t,r){return function(s,a){if(s==null)return s;if(!mj(s))return t(s,a);for(var n=s.length,i=r?n:-1,o=Object(s);(r?i--:++i<n)&&a(o[i],i,o)!==!1;);return s}}var fj=hj,gj=ni,xj=fj,pj=xj(gj),vj=pj,bj=vj,yj=$s;function wj(t,r){var s=-1,a=yj(t)?Array(t.length):[];return bj(t,function(n,i,o){a[++s]=r(n,i,o)}),a}var jj=wj;function Nj(t,r){var s=t.length;for(t.sort(r);s--;)t[s]=t[s].value;return t}var Sj=Nj,Uo=Os;function kj(t,r){if(t!==r){var s=t!==void 0,a=t===null,n=t===t,i=Uo(t),o=r!==void 0,c=r===null,l=r===r,d=Uo(r);if(!c&&!d&&!i&&t>r||i&&o&&l&&!c&&!d||a&&o&&l||!s&&l||!n)return 1;if(!a&&!i&&!d&&t<r||d&&s&&n&&!a&&!i||c&&s&&n||!o&&n||!l)return-1}return 0}var Cj=kj,Tj=Cj;function Dj(t,r,s){for(var a=-1,n=t.criteria,i=r.criteria,o=n.length,c=s.length;++a<o;){var l=Tj(n[a],i[a]);if(l){if(a>=c)return l;var d=s[a];return l*(d=="desc"?-1:1)}}return t.index-r.index}var Ej=Dj,Ka=ai,$j=Ea,Oj=Oa,Pj=jj,Mj=Sj,_j=Ca,Aj=Ej,Rj=$a,Ij=At;function Lj(t,r,s){r.length?r=Ka(r,function(i){return Ij(i)?function(o){return $j(o,i.length===1?i[0]:i)}:i}):r=[Rj];var a=-1;r=Ka(r,_j(Oj));var n=Pj(t,function(i,o,c){var l=Ka(r,function(d){return d(i)});return{criteria:l,index:++a,value:i}});return Mj(n,function(i,o){return Aj(i,o,s)})}var Uj=Lj;function Fj(t,r,s){switch(s.length){case 0:return t.call(r);case 1:return t.call(r,s[0]);case 2:return t.call(r,s[0],s[1]);case 3:return t.call(r,s[0],s[1],s[2])}return t.apply(r,s)}var Wj=Fj,Hj=Wj,Fo=Math.max;function zj(t,r,s){return r=Fo(r===void 0?t.length-1:r,0),function(){for(var a=arguments,n=-1,i=Fo(a.length-r,0),o=Array(i);++n<i;)o[n]=a[r+n];n=-1;for(var c=Array(r+1);++n<r;)c[n]=a[n];return c[r]=s(o),Hj(t,this,c)}}var Mc=zj;function Bj(t){return function(){return t}}var Yj=Bj,qj=kr,Gj=function(){try{var t=qj(Object,"defineProperty");return t({},"",{}),t}catch{}}(),_c=Gj,Vj=Yj,Wo=_c,Kj=$a,Jj=Wo?function(t,r){return Wo(t,"toString",{configurable:!0,enumerable:!1,value:Vj(r),writable:!0})}:Kj,Xj=Jj,Qj=800,Zj=16,eN=Date.now;function tN(t){var r=0,s=0;return function(){var a=eN(),n=Zj-(a-s);if(s=a,n>0){if(++r>=Qj)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}var rN=tN,sN=Xj,aN=rN,nN=aN(sN),Ac=nN,iN=$a,oN=Mc,lN=Ac;function cN(t,r){return lN(oN(t,r,iN),t+"")}var Rc=cN,dN=Pc,uN=Uj,mN=Rc,Ho=ba,hN=mN(function(t,r){if(t==null)return[];var s=r.length;return s>1&&Ho(t,r[0],r[1])?r=[]:s>2&&Ho(r[0],r[1],r[2])&&(r=[r[0]]),uN(t,dN(r,1),[])}),fN=hN;const gN=_t(fN);function Ic(t){return Pl(t)||Kl(t)||pa(t)||Ml()}function xN(t){var r=[];if(t!=null)for(var s in Object(t))r.push(s);return r}var pN=xN,vN=er,bN=ei,yN=pN,wN=Object.prototype,jN=wN.hasOwnProperty;function NN(t){if(!vN(t))return yN(t);var r=bN(t),s=[];for(var a in t)a=="constructor"&&(r||!jN.call(t,a))||s.push(a);return s}var SN=NN,kN=yc,CN=SN,TN=$s;function DN(t){return TN(t)?kN(t,!0):CN(t)}var Pa=DN,EN=Rc,$N=Es,ON=ba,PN=Pa,Lc=Object.prototype,MN=Lc.hasOwnProperty,_N=EN(function(t,r){t=Object(t);var s=-1,a=r.length,n=a>2?r[2]:void 0;for(n&&ON(r[0],r[1],n)&&(a=1);++s<a;)for(var i=r[s],o=PN(i),c=-1,l=o.length;++c<l;){var d=o[c],m=t[d];(m===void 0||$N(m,Lc[d])&&!MN.call(t,d))&&(t[d]=i[d])}return t}),AN=_N;const RN=_t(AN);var zo=_c;function IN(t,r,s){r=="__proto__"&&zo?zo(t,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):t[r]=s}var ii=IN,LN=ii,UN=ni,FN=Oa;function WN(t,r){var s={};return r=FN(r),UN(t,function(a,n,i){LN(s,n,r(a,n,i))}),s}var HN=WN;const zN=_t(HN);function BN(t,r){for(var s=-1,a=t==null?0:t.length;++s<a&&r(t[s],s,t)!==!1;);return t}var Uc=BN,YN=ii,qN=Es,GN=Object.prototype,VN=GN.hasOwnProperty;function KN(t,r,s){var a=t[r];(!(VN.call(t,r)&&qN(a,s))||s===void 0&&!(r in t))&&YN(t,r,s)}var Fc=KN,JN=Fc,XN=ii;function QN(t,r,s,a){var n=!s;s||(s={});for(var i=-1,o=r.length;++i<o;){var c=r[i],l=a?a(s[c],t[c],c,s,t):void 0;l===void 0&&(l=t[c]),n?XN(s,c,l):JN(s,c,l)}return s}var Is=QN,ZN=Is,e1=As;function t1(t,r){return t&&ZN(r,e1(r),t)}var r1=t1,s1=Is,a1=Pa;function n1(t,r){return t&&s1(r,a1(r),t)}var i1=n1,ca={exports:{}};ca.exports;(function(t,r){var s=Gt,a=r&&!r.nodeType&&r,n=a&&!0&&t&&!t.nodeType&&t,i=n&&n.exports===a,o=i?s.Buffer:void 0,c=o?o.allocUnsafe:void 0;function l(d,m){if(m)return d.slice();var x=d.length,h=c?c(x):new d.constructor(x);return d.copy(h),h}t.exports=l})(ca,ca.exports);var o1=ca.exports;function l1(t,r){var s=-1,a=t.length;for(r||(r=Array(a));++s<a;)r[s]=t[s];return r}var c1=l1,d1=Is,u1=Jn;function m1(t,r){return d1(t,u1(t),r)}var h1=m1,f1=wc,g1=f1(Object.getPrototypeOf,Object),Ma=g1,x1=Kn,p1=Ma,v1=Jn,b1=vc,y1=Object.getOwnPropertySymbols,w1=y1?function(t){for(var r=[];t;)x1(r,v1(t)),t=p1(t);return r}:b1,Wc=w1,j1=Is,N1=Wc;function S1(t,r){return j1(t,N1(t),r)}var k1=S1,C1=pc,T1=Wc,D1=Pa;function E1(t){return C1(t,D1,T1)}var Hc=E1,$1=Object.prototype,O1=$1.hasOwnProperty;function P1(t){var r=t.length,s=new t.constructor(r);return r&&typeof t[0]=="string"&&O1.call(t,"index")&&(s.index=t.index,s.input=t.input),s}var M1=P1,Bo=xc;function _1(t){var r=new t.constructor(t.byteLength);return new Bo(r).set(new Bo(t)),r}var oi=_1,A1=oi;function R1(t,r){var s=r?A1(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.byteLength)}var I1=R1,L1=/\w*$/;function U1(t){var r=new t.constructor(t.source,L1.exec(t));return r.lastIndex=t.lastIndex,r}var F1=U1,Yo=Br,qo=Yo?Yo.prototype:void 0,Go=qo?qo.valueOf:void 0;function W1(t){return Go?Object(Go.call(t)):{}}var H1=W1,z1=oi;function B1(t,r){var s=r?z1(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.length)}var Y1=B1,q1=oi,G1=I1,V1=F1,K1=H1,J1=Y1,X1="[object Boolean]",Q1="[object Date]",Z1="[object Map]",e2="[object Number]",t2="[object RegExp]",r2="[object Set]",s2="[object String]",a2="[object Symbol]",n2="[object ArrayBuffer]",i2="[object DataView]",o2="[object Float32Array]",l2="[object Float64Array]",c2="[object Int8Array]",d2="[object Int16Array]",u2="[object Int32Array]",m2="[object Uint8Array]",h2="[object Uint8ClampedArray]",f2="[object Uint16Array]",g2="[object Uint32Array]";function x2(t,r,s){var a=t.constructor;switch(r){case n2:return q1(t);case X1:case Q1:return new a(+t);case i2:return G1(t,s);case o2:case l2:case c2:case d2:case u2:case m2:case h2:case f2:case g2:return J1(t,s);case Z1:return new a;case e2:case s2:return new a(t);case t2:return V1(t);case r2:return new a;case a2:return K1(t)}}var p2=x2,v2=er,Vo=Object.create,b2=function(){function t(){}return function(r){if(!v2(r))return{};if(Vo)return Vo(r);t.prototype=r;var s=new t;return t.prototype=void 0,s}}(),zc=b2,y2=zc,w2=Ma,j2=ei;function N2(t){return typeof t.constructor=="function"&&!j2(t)?y2(w2(t)):{}}var S2=N2,k2=Ta,C2=lr,T2="[object Map]";function D2(t){return C2(t)&&k2(t)==T2}var E2=D2,$2=E2,O2=Ca,Ko=Qn,Jo=Ko&&Ko.isMap,P2=Jo?O2(Jo):$2,M2=P2,_2=Ta,A2=lr,R2="[object Set]";function I2(t){return A2(t)&&_2(t)==R2}var L2=I2,U2=L2,F2=Ca,Xo=Qn,Qo=Xo&&Xo.isSet,W2=Qo?F2(Qo):U2,H2=W2,z2=Vn,B2=Uc,Y2=Fc,q2=r1,G2=i1,V2=o1,K2=c1,J2=h1,X2=k1,Q2=jc,Z2=Hc,eS=Ta,tS=M1,rS=p2,sS=S2,aS=At,nS=ka,iS=M2,oS=er,lS=H2,cS=As,dS=Pa,uS=1,mS=2,hS=4,Bc="[object Arguments]",fS="[object Array]",gS="[object Boolean]",xS="[object Date]",pS="[object Error]",Yc="[object Function]",vS="[object GeneratorFunction]",bS="[object Map]",yS="[object Number]",qc="[object Object]",wS="[object RegExp]",jS="[object Set]",NS="[object String]",SS="[object Symbol]",kS="[object WeakMap]",CS="[object ArrayBuffer]",TS="[object DataView]",DS="[object Float32Array]",ES="[object Float64Array]",$S="[object Int8Array]",OS="[object Int16Array]",PS="[object Int32Array]",MS="[object Uint8Array]",_S="[object Uint8ClampedArray]",AS="[object Uint16Array]",RS="[object Uint32Array]",Ue={};Ue[Bc]=Ue[fS]=Ue[CS]=Ue[TS]=Ue[gS]=Ue[xS]=Ue[DS]=Ue[ES]=Ue[$S]=Ue[OS]=Ue[PS]=Ue[bS]=Ue[yS]=Ue[qc]=Ue[wS]=Ue[jS]=Ue[NS]=Ue[SS]=Ue[MS]=Ue[_S]=Ue[AS]=Ue[RS]=!0;Ue[pS]=Ue[Yc]=Ue[kS]=!1;function Qs(t,r,s,a,n,i){var o,c=r&uS,l=r&mS,d=r&hS;if(s&&(o=n?s(t,a,n,i):s(t)),o!==void 0)return o;if(!oS(t))return t;var m=aS(t);if(m){if(o=tS(t),!c)return K2(t,o)}else{var x=eS(t),h=x==Yc||x==vS;if(nS(t))return V2(t,c);if(x==qc||x==Bc||h&&!n){if(o=l||h?{}:sS(t),!c)return l?X2(t,G2(o,t)):J2(t,q2(o,t))}else{if(!Ue[x])return n?t:{};o=rS(t,x,c)}}i||(i=new z2);var g=i.get(t);if(g)return g;i.set(t,o),lS(t)?t.forEach(function(p){o.add(Qs(p,r,s,p,t,i))}):iS(t)&&t.forEach(function(p,w){o.set(w,Qs(p,r,s,w,t,i))});var v=d?l?Z2:Q2:l?dS:cS,u=m?void 0:v(t);return B2(u||t,function(p,w){u&&(w=p,p=t[w]),Y2(o,w,Qs(p,r,s,w,t,i))}),o}var IS=Qs;function LS(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}var US=LS,FS=Ea,WS=Jl;function HS(t,r){return r.length<2?t:FS(t,WS(r,0,-1))}var zS=HS,BS=Da,YS=US,qS=zS,GS=Rs;function VS(t,r){return r=BS(r,t),t=qS(t,r),t==null||delete t[GS(YS(r))]}var KS=VS,JS=Yr,XS=Ma,QS=lr,ZS="[object Object]",ek=Function.prototype,tk=Object.prototype,Gc=ek.toString,rk=tk.hasOwnProperty,sk=Gc.call(Object);function ak(t){if(!QS(t)||JS(t)!=ZS)return!1;var r=XS(t);if(r===null)return!0;var s=rk.call(r,"constructor")&&r.constructor;return typeof s=="function"&&s instanceof s&&Gc.call(s)==sk}var nk=ak,ik=nk;function ok(t){return ik(t)?void 0:t}var lk=ok,ck=Pc;function dk(t){var r=t==null?0:t.length;return r?ck(t,1):[]}var uk=dk,mk=uk,hk=Mc,fk=Ac;function gk(t){return fk(hk(t,void 0,mk),t+"")}var xk=gk,pk=ai,vk=IS,bk=KS,yk=Da,wk=Is,jk=lk,Nk=xk,Sk=Hc,kk=1,Ck=2,Tk=4,Dk=Nk(function(t,r){var s={};if(t==null)return s;var a=!1;r=pk(r,function(i){return i=yk(i,t),a||(a=i.length>1),i}),wk(t,Sk(t),s),a&&(s=vk(s,kk|Ck|Tk,jk));for(var n=r.length;n--;)bk(s,r[n]);return s}),Ek=Dk;const $k=_t(Ek);var Ok=Uc,Pk=zc,Mk=ni,_k=Oa,Ak=Ma,Rk=At,Ik=ka,Lk=On,Uk=er,Fk=Zn;function Wk(t,r,s){var a=Rk(t),n=a||Ik(t)||Fk(t);if(r=_k(r),s==null){var i=t&&t.constructor;n?s=a?new i:[]:Uk(t)?s=Lk(i)?Pk(Ak(t)):{}:s={}}return(n?Ok:Mk)(t,function(o,c,l){return r(s,o,c,l)}),s}var Hk=Wk;const zk=_t(Hk);var Bk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(Et,function(){return function(s,a,n){a.prototype.isBetween=function(i,o,c,l){var d=n(i),m=n(o),x=(l=l||"()")[0]==="(",h=l[1]===")";return(x?this.isAfter(d,c):!this.isBefore(d,c))&&(h?this.isBefore(m,c):!this.isAfter(m,c))||(x?this.isBefore(d,c):!this.isAfter(d,c))&&(h?this.isAfter(m,c):!this.isBefore(m,c))}}})})(Bk);var Yk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(Et,function(){return function(s,a){a.prototype.isSameOrAfter=function(n,i){return this.isSame(n,i)||this.isAfter(n,i)}}})})(Yk);var qk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(Et,function(){return function(s,a){a.prototype.isSameOrBefore=function(n,i){return this.isSame(n,i)||this.isBefore(n,i)}}})})(qk);var Gk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(Et,function(){return function(s,a,n){var i=a.prototype,o=function(x){return x&&(x.indexOf?x:x.s)},c=function(x,h,g,v,u){var p=x.name?x:x.$locale(),w=o(p[h]),y=o(p[g]),D=w||y.map(function(T){return T.slice(0,v)});if(!u)return D;var f=p.weekStart;return D.map(function(T,j){return D[(j+(f||0))%7]})},l=function(){return n.Ls[n.locale()]},d=function(x,h){return x.formats[h]||function(g){return g.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(v,u,p){return u||p.slice(1)})}(x.formats[h.toUpperCase()])},m=function(){var x=this;return{months:function(h){return h?h.format("MMMM"):c(x,"months")},monthsShort:function(h){return h?h.format("MMM"):c(x,"monthsShort","months",3)},firstDayOfWeek:function(){return x.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):c(x,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):c(x,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):c(x,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return d(x.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return m.bind(this)()},n.localeData=function(){var x=l();return{firstDayOfWeek:function(){return x.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(h){return d(x,h)},meridiem:x.meridiem,ordinal:x.ordinal}},n.months=function(){return c(l(),"months")},n.monthsShort=function(){return c(l(),"monthsShort","months",3)},n.weekdays=function(x){return c(l(),"weekdays",null,null,x)},n.weekdaysShort=function(x){return c(l(),"weekdaysShort","weekdays",3,x)},n.weekdaysMin=function(x){return c(l(),"weekdaysMin","weekdays",2,x)}}})})(Gk);var Vk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(Et,function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(a,n,i){var o=n.prototype,c=o.format;i.en.formats=s,o.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var d=this.$locale().formats,m=function(x,h){return x.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(g,v,u){var p=u&&u.toUpperCase();return v||h[u]||s[u]||h[p].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(w,y,D){return y||D.slice(1)})})}(l,d===void 0?{}:d);return c.call(this,m)}}})})(Vk);var Kk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(Et,function(){return function(s,a,n){var i=function(o,c){if(!c||!c.length||c.length===1&&!c[0]||c.length===1&&Array.isArray(c[0])&&!c[0].length)return null;var l;c.length===1&&c[0].length>0&&(c=c[0]),l=(c=c.filter(function(m){return m}))[0];for(var d=1;d<c.length;d+=1)c[d].isValid()&&!c[d][o](l)||(l=c[d]);return l};n.max=function(){var o=[].slice.call(arguments,0);return i("isAfter",o)},n.min=function(){var o=[].slice.call(arguments,0);return i("isBefore",o)}}})})(Kk);var Jk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(Et,function(){var s="minute",a=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(i,o,c){var l=o.prototype;c.utc=function(u){var p={date:u,utc:!0,args:arguments};return new o(p)},l.utc=function(u){var p=c(this.toDate(),{locale:this.$L,utc:!0});return u?p.add(this.utcOffset(),s):p},l.local=function(){return c(this.toDate(),{locale:this.$L,utc:!1})};var d=l.parse;l.parse=function(u){u.utc&&(this.$u=!0),this.$utils().u(u.$offset)||(this.$offset=u.$offset),d.call(this,u)};var m=l.init;l.init=function(){if(this.$u){var u=this.$d;this.$y=u.getUTCFullYear(),this.$M=u.getUTCMonth(),this.$D=u.getUTCDate(),this.$W=u.getUTCDay(),this.$H=u.getUTCHours(),this.$m=u.getUTCMinutes(),this.$s=u.getUTCSeconds(),this.$ms=u.getUTCMilliseconds()}else m.call(this)};var x=l.utcOffset;l.utcOffset=function(u,p){var w=this.$utils().u;if(w(u))return this.$u?0:w(this.$offset)?x.call(this):this.$offset;if(typeof u=="string"&&(u=function(T){T===void 0&&(T="");var j=T.match(a);if(!j)return null;var k=(""+j[0]).match(n)||["-",0,0],C=k[0],M=60*+k[1]+ +k[2];return M===0?0:C==="+"?M:-M}(u),u===null))return this;var y=Math.abs(u)<=16?60*u:u;if(y===0)return this.utc(p);var D=this.clone();if(p)return D.$offset=y,D.$u=!1,D;var f=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(D=this.local().add(y+f,s)).$offset=y,D.$x.$localOffset=f,D};var h=l.format;l.format=function(u){var p=u||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,p)},l.valueOf=function(){var u=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*u},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var g=l.toDate;l.toDate=function(u){return u==="s"&&this.$offset?c(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var v=l.diff;l.diff=function(u,p,w){if(u&&this.$u===u.$u)return v.call(this,u,p,w);var y=this.local(),D=c(u).local();return v.call(y,D,p,w)}}})})(Jk);var Xk={exports:{}};(function(t,r){(function(s,a){t.exports=a()})(Et,function(){return function(s,a){a.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}}})})(Xk);function Lt(t){return t.children}var yt={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},xt={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},Zo=Object.keys(xt).map(function(t){return xt[t]});se.oneOfType([se.string,se.func]);se.any;se.func;se.oneOfType([se.arrayOf(se.oneOf(Zo)),se.objectOf(function(t,r){var s=Zo.indexOf(r)!==-1&&typeof t[r]=="boolean";if(s)return null;for(var a=arguments.length,n=new Array(a>2?a-2:0),i=2;i<a;i++)n[i-2]=arguments[i];return se.elementType.apply(se,[t,r].concat(n))})]);se.oneOfType([se.oneOf(["overlap","no-overlap"]),se.func]);var el={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function Vc(t,r){var s=ct(t,"month");return ct(s,"week",r.startOfWeek())}function Kc(t,r){var s=sa(t,"month");return sa(s,"week",r.startOfWeek())}function Qk(t,r){for(var s=Vc(t,r),a=Kc(t,r),n=[];Hr(s,a,"day");)n.push(s),s=It(s,1,"day");return n}function Zk(t,r){var s=ct(t,r);return Wr(s,t)?s:It(s,1,r)}function eC(t,r){for(var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",a=t,n=[];Hr(a,r,s);)n.push(a),a=It(a,1,s);return n}function tC(t,r){return r==null&&t==null?null:(r==null&&(r=new Date),t==null&&(t=new Date),t=ct(t,"day"),t=ys(t,ys(r)),t=Ar(t,Ar(r)),t=bs(t,bs(r)),vs(t,vs(r)))}function tl(t){return ys(t)===0&&Ar(t)===0&&bs(t)===0&&vs(t)===0}function rC(t,r,s,a){return s==="day"&&(s="date"),Math.abs(Ri[s](t,void 0,a)-Ri[s](r,void 0,a))}function li(t,r,s){return!s||s==="milliseconds"?Math.abs(+t-+r):Math.round(Math.abs(+ct(t,s)/el[s]-+ct(r,s)/el[s]))}var sC=se.oneOfType([se.string,se.func]);function aC(t,r,s,a,n){var i=typeof a=="function"?a(s,n,t):r.call(t,s,a,n);return ms(i==null||typeof i=="string","`localizer format(..)` must return a string, null, or undefined"),i}function nC(t,r,s){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,r+s,0,0)}function ci(t,r){return t.getTimezoneOffset()-r.getTimezoneOffset()}function iC(t,r){return li(t,r,"minutes")+ci(t,r)}function oC(t){var r=ct(t,"day");return li(r,t,"minutes")+ci(r,t)}function lC(t,r){return $n(t,r,"day")}function cC(t,r,s){var a=Wr(t,r,"minutes");return a?Ds(r,s,"minutes"):va(r,s,"minutes")}function xn(t,r){return rC(t,r,"day")}function dC(t){var r=t.evtA,s=r.start,a=r.end,n=r.allDay,i=t.evtB,o=i.start,c=i.end,l=i.allDay,d=+ct(s,"day")-+ct(o,"day"),m=xn(s,a),x=xn(o,c);return d||x-m||!!l-!!n||+s-+o||+a-+c}function uC(t){var r=t.event,s=r.start,a=r.end,n=t.range,i=n.start,o=n.end,c=ct(s,"day"),l=Hr(c,o,"day"),d=En(c,a,"minutes"),m=d?va(a,i,"minutes"):Ds(a,i,"minutes");return l&&m}function mC(t,r){return Wr(t,r,"day")}function hC(t,r){return tl(t)&&tl(r)}var fC=pe(function t(r){var s=this;xe(this,t),ms(typeof r.format=="function","date localizer `format(..)` must be a function"),ms(typeof r.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=r.propType||sC,this.formats=r.formats,this.format=function(){for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return aC.apply(void 0,[s,r.format].concat(n))},this.startOfWeek=r.firstOfWeek,this.merge=r.merge||tC,this.inRange=r.inRange||Yl,this.lt=r.lt||$n,this.lte=r.lte||Hr,this.gt=r.gt||va,this.gte=r.gte||Ds,this.eq=r.eq||Wr,this.neq=r.neq||En,this.startOf=r.startOf||ct,this.endOf=r.endOf||sa,this.add=r.add||It,this.range=r.range||eC,this.diff=r.diff||li,this.ceil=r.ceil||Zk,this.min=r.min||zl,this.max=r.max||Bl,this.minutes=r.minutes||Ar,this.daySpan=r.daySpan||xn,this.firstVisibleDay=r.firstVisibleDay||Vc,this.lastVisibleDay=r.lastVisibleDay||Kc,this.visibleDays=r.visibleDays||Qk,this.getSlotDate=r.getSlotDate||nC,this.getTimezoneOffset=r.getTimezoneOffset||function(a){return a.getTimezoneOffset()},this.getDstOffset=r.getDstOffset||ci,this.getTotalMin=r.getTotalMin||iC,this.getMinutesFromMidnight=r.getMinutesFromMidnight||oC,this.continuesPrior=r.continuesPrior||lC,this.continuesAfter=r.continuesAfter||cC,this.sortEvents=r.sortEvents||dC,this.inEventRange=r.inEventRange||uC,this.isSameDate=r.isSameDate||mC,this.startAndEndAreDateOnly=r.startAndEndAreDateOnly||hC,this.segmentOffset=r.browserTZOffset?r.browserTZOffset():0});function gC(t,r,s,a){var n=Re(Re({},t.formats),s);return Re(Re({},t),{},{messages:a,startOfWeek:function(){return t.startOfWeek(r)},format:function(o,c){return t.format(o,n[c]||c,r)}})}var xC=function(t){function r(){var s;xe(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=ft(this,r,[].concat(n)),s.navigate=function(o){s.props.onNavigate(o)},s.view=function(o){s.props.onView(o)},s}return we(r,t),pe(r,[{key:"render",value:function(){var a=this.props,n=a.localizer.messages,i=a.label;return U.createElement("div",{className:"rbc-toolbar"},U.createElement("span",{className:"rbc-btn-group"},U.createElement("button",{type:"button",onClick:this.navigate.bind(null,yt.TODAY)},n.today),U.createElement("button",{type:"button",onClick:this.navigate.bind(null,yt.PREVIOUS)},n.previous),U.createElement("button",{type:"button",onClick:this.navigate.bind(null,yt.NEXT)},n.next)),U.createElement("span",{className:"rbc-toolbar-label"},i),U.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(n)))}},{key:"viewNamesGroup",value:function(a){var n=this,i=this.props.views,o=this.props.view;if(i.length>1)return i.map(function(c){return U.createElement("button",{type:"button",key:c,className:Ke({"rbc-active":o===c}),onClick:n.view.bind(null,c)},a[c])})}}])}(U.Component);function He(t,r){t&&t.apply(null,[].concat(r))}var pC={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(r){return"+".concat(r," more")}};function vC(t){return Re(Re({},pC),t)}function bC(t){var r=t.ref,s=t.callback;N.useEffect(function(){var a=function(i){r.current&&!r.current.contains(i.target)&&s()};return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[r,s])}var yC=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],Jc=function(t){function r(){return xe(this,r),ft(this,r,arguments)}return we(r,t),pe(r,[{key:"render",value:function(){var a=this.props,n=a.style,i=a.className,o=a.event,c=a.selected,l=a.isAllDay,d=a.onSelect,m=a.onDoubleClick,x=a.onKeyPress,h=a.localizer,g=a.continuesPrior,v=a.continuesAfter,u=a.accessors,p=a.getters,w=a.children,y=a.components,D=y.event,f=y.eventWrapper,T=a.slotStart,j=a.slotEnd,k=qt(a,yC);delete k.resizable;var C=u.title(o),M=u.tooltip(o),z=u.end(o),I=u.start(o),X=u.allDay(o),G=l||X||h.diff(I,h.ceil(z,"day"),"day")>1,re=p.eventProp(o,I,z,c),H=U.createElement("div",{className:"rbc-event-content",title:M||void 0},D?U.createElement(D,{event:o,continuesPrior:g,continuesAfter:v,title:C,isAllDay:X,localizer:h,slotStart:T,slotEnd:j}):C);return U.createElement(f,Object.assign({},this.props,{type:"date"}),U.createElement("div",Object.assign({},k,{style:Re(Re({},re.style),n),className:Ke("rbc-event",i,re.className,{"rbc-selected":c,"rbc-event-allday":G,"rbc-event-continues-prior":g,"rbc-event-continues-after":v}),onClick:function(W){return d&&d(o,W)},onDoubleClick:function(W){return m&&m(o,W)},onKeyDown:function(W){return x&&x(o,W)}}),typeof w=="function"?w(H):H))}}])}(U.Component);function _a(t,r){return!t||r==null?!1:Rb(t,r)}function Xc(t,r){var s=t.right-t.left,a=s/r;return a}function Qc(t,r,s,a){var n=Xc(t,a);return s?a-1-Math.floor((r-t.left)/n):Math.floor((r-t.left)/n)}function wC(t,r){var s=r.x,a=r.y;return a>=t.top&&a<=t.bottom&&s>=t.left&&s<=t.right}function jC(t,r,s,a,n){var i=-1,o=-1,c=a-1,l=Xc(r,a),d=Qc(r,s.x,n,a),m=r.top<s.y&&r.bottom>s.y,x=r.top<t.y&&r.bottom>t.y,h=t.y>r.bottom,g=r.top>t.y,v=s.top<r.top&&s.bottom>r.bottom;return v&&(i=0,o=c),m&&(g?(i=0,o=d):h&&(i=d,o=c)),x&&(i=o=n?c-Math.floor((t.x-r.left)/l):Math.floor((t.x-r.left)/l),m?d<i?i=d:o=d:t.y<s.y?o=c:i=0),{startIdx:i,endIdx:o}}function NC(t){var r=t.target,s=t.offset,a=t.container,n=t.box,i=gr(r),o=i.top,c=i.left,l=i.width,d=i.height,m=gr(a),x=m.top,h=m.left,g=m.width,v=m.height,u=gr(n),p=u.width,w=u.height,y=x+v,D=h+g,f=o+w,T=c+p,j=s.x,k=s.y,C=f>y?o-w-k:o+k+d,M=T>D?c+j-p+l:c+j;return{topOffset:C,leftOffset:M}}function SC(t){var r=t.containerRef,s=t.accessors,a=t.getters,n=t.selected,i=t.components,o=t.localizer,c=t.position,l=t.show,d=t.events,m=t.slotStart,x=t.slotEnd,h=t.onSelect,g=t.onDoubleClick,v=t.onKeyPress,u=t.handleDragStart,p=t.popperRef,w=t.target,y=t.offset;bC({ref:p,callback:l}),N.useLayoutEffect(function(){var T=NC({target:w,offset:y,container:r.current,box:p.current}),j=T.topOffset,k=T.leftOffset;p.current.style.top="".concat(j,"px"),p.current.style.left="".concat(k,"px")},[y.x,y.y,w]);var D=c.width,f={minWidth:D+D/2};return U.createElement("div",{style:f,className:"rbc-overlay",ref:p},U.createElement("div",{className:"rbc-overlay-header"},o.format(m,"dayHeaderFormat")),d.map(function(T,j){return U.createElement(Jc,{key:j,type:"popup",localizer:o,event:T,getters:a,onSelect:h,accessors:s,components:i,onDoubleClick:g,onKeyPress:v,continuesPrior:o.lt(s.end(T),m,"day"),continuesAfter:o.gte(s.start(T),x,"day"),slotStart:m,slotEnd:x,selected:_a(T,n),draggable:!0,onDragStart:function(){return u(T)},onDragEnd:function(){return l()}})}))}var Zc=U.forwardRef(function(t,r){return U.createElement(SC,Object.assign({},t,{popperRef:r}))});Zc.propTypes={accessors:se.object.isRequired,getters:se.object.isRequired,selected:se.object,components:se.object.isRequired,localizer:se.object.isRequired,position:se.object.isRequired,show:se.func.isRequired,events:se.array.isRequired,slotStart:se.instanceOf(Date).isRequired,slotEnd:se.instanceOf(Date),onSelect:se.func,onDoubleClick:se.func,onKeyPress:se.func,handleDragStart:se.func,style:se.object,offset:se.shape({x:se.number,y:se.number})};function kC(t){var r=t.containerRef,s=t.popupOffset,a=s===void 0?5:s,n=t.overlay,i=t.accessors,o=t.localizer,c=t.components,l=t.getters,d=t.selected,m=t.handleSelectEvent,x=t.handleDoubleClickEvent,h=t.handleKeyPressEvent,g=t.handleDragStart,v=t.onHide,u=t.overlayDisplay,p=N.useRef(null);if(!n.position)return null;var w=a;isNaN(a)||(w={x:a,y:a});var y=n.position,D=n.events,f=n.date,T=n.end;return U.createElement(cg,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:v,target:n.target},function(j){var k=j.props;return U.createElement(Zc,Object.assign({},k,{containerRef:r,ref:p,target:n.target,offset:w,accessors:i,getters:l,selected:d,components:c,localizer:o,position:y,show:u,events:D,slotStart:f,slotEnd:T,onSelect:m,onDoubleClick:x,onKeyPress:h,handleDragStart:g}))})}var di=U.forwardRef(function(t,r){return U.createElement(kC,Object.assign({},t,{containerRef:r}))});di.propTypes={popupOffset:se.oneOfType([se.number,se.shape({x:se.number,y:se.number})]),overlay:se.shape({position:se.object,events:se.array,date:se.instanceOf(Date),end:se.instanceOf(Date)}),accessors:se.object.isRequired,localizer:se.object.isRequired,components:se.object.isRequired,getters:se.object.isRequired,selected:se.object,handleSelectEvent:se.func,handleDoubleClickEvent:se.func,handleKeyPressEvent:se.func,handleDragStart:se.func,onHide:se.func,overlayDisplay:se.func};function mt(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return ss(s,t,r,{passive:!1})}function CC(t,r,s){return!t||ws(t,document.elementFromPoint(r,s))}function TC(t,r){var s=r.clientX,a=r.clientY,n=document.elementFromPoint(s,a);return kc(n,".rbc-event",t)}function DC(t,r){var s=r.clientX,a=r.clientY,n=document.elementFromPoint(s,a);return kc(n,".rbc-show-more",t)}function da(t,r){return!!TC(t,r)}function EC(t,r){return!!DC(t,r)}function es(t){var r=t;return t.touches&&t.touches.length&&(r=t.touches[0]),{clientX:r.clientX,clientY:r.clientY,pageX:r.pageX,pageY:r.pageY}}var rl=5,$C=250,ed=function(){function t(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.global,n=a===void 0?!1:a,i=s.longPressThreshold,o=i===void 0?250:i,c=s.validContainers,l=c===void 0?[]:c;xe(this,t),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=r,this.globalMouse=!r||n,this.longPressThreshold=o,this.validContainers=l,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=mt("touchmove",function(){},window),this._removeKeyDownListener=mt("keydown",this._keyListener),this._removeKeyUpListener=mt("keyup",this._keyListener),this._removeDropFromOutsideListener=mt("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=mt("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return pe(t,[{key:"on",value:function(s,a){var n=this._listeners[s]||(this._listeners[s]=[]);return n.push(a),{remove:function(){var o=n.indexOf(a);o!==-1&&n.splice(o,1)}}}},{key:"emit",value:function(s){for(var a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];var o,c=this._listeners[s]||[];return c.forEach(function(l){o===void 0&&(o=l.apply(void 0,n))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(s){var a=this._selectRect;return!a||!this.selecting?!1:sl(a,Sr(s))}},{key:"filter",value:function(s){var a=this._selectRect;return!a||!this.selecting?[]:s.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(s,a){var n=this,i=null,o=null,c=null,l=function(h){i=setTimeout(function(){m(),s(h)},n.longPressThreshold),o=mt("touchmove",function(){return m()}),c=mt("touchend",function(){return m()})},d=mt("touchstart",l),m=function(){i&&clearTimeout(i),o&&o(),c&&c(),i=null,o=null,c=null};return a&&l(a),function(){m(),d()}}},{key:"_addInitialEventListener",value:function(){var s=this,a=mt("mousedown",function(i){s._removeInitialEventListener(),s._handleInitialEvent(i),s._removeInitialEventListener=mt("mousedown",s._handleInitialEvent)}),n=mt("touchstart",function(i){s._removeInitialEventListener(),s._removeInitialEventListener=s._addLongPressListener(s._handleInitialEvent,i)});this._removeInitialEventListener=function(){a(),n()}}},{key:"_dropFromOutsideListener",value:function(s){var a=es(s),n=a.pageX,i=a.pageY,o=a.clientX,c=a.clientY;this.emit("dropFromOutside",{x:n,y:i,clientX:o,clientY:c}),s.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(s){var a=es(s),n=a.pageX,i=a.pageY,o=a.clientX,c=a.clientY;this.emit("dragOverFromOutside",{x:n,y:i,clientX:o,clientY:c}),s.preventDefault()}},{key:"_handleInitialEvent",value:function(s){if(this._initialEvent=s,!this.isDetached){var a=es(s),n=a.clientX,i=a.clientY,o=a.pageX,c=a.pageY,l=this.container(),d,m;if(!(s.which===3||s.button===2||!CC(l,n,i))){if(!this.globalMouse&&l&&!ws(l,s.target)){var x=OC(0),h=x.top,g=x.left,v=x.bottom,u=x.right;if(m=Sr(l),d=sl({top:m.top-h,left:m.left-g,bottom:m.bottom+v,right:m.right+u},{top:c,left:o}),!d)return}var p=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(s.type),x:o,y:c,clientX:n,clientY:i});if(p!==!1)switch(s.type){case"mousedown":this._removeEndListener=mt("mouseup",this._handleTerminatingEvent),this._onEscListener=mt("keydown",this._handleTerminatingEvent),this._removeMoveListener=mt("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(s),this._removeEndListener=mt("touchend",this._handleTerminatingEvent),this._removeMoveListener=mt("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(s){var a=s.target,n=this.validContainers;return!n||!n.length||!a?!0:n.some(function(i){return!!a.closest(i)})}},{key:"_handleTerminatingEvent",value:function(s){var a=this.selecting,n=this._selectRect;if(!a&&s.type.includes("key")&&(s=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!s){var i=!this.container||ws(this.container(),s.target),o=this._isWithinValidContainer(s);return s.key==="Escape"||!o?this.emit("reset"):!a&&i?this._handleClickEvent(s):a?this.emit("select",n):this.emit("reset")}}},{key:"_handleClickEvent",value:function(s){var a=es(s),n=a.pageX,i=a.pageY,o=a.clientX,c=a.clientY,l=new Date().getTime();return this._lastClickData&&l-this._lastClickData.timestamp<$C?(this._lastClickData=null,this.emit("doubleClick",{x:n,y:i,clientX:o,clientY:c})):(this._lastClickData={timestamp:l},this.emit("click",{x:n,y:i,clientX:o,clientY:c}))}},{key:"_handleMoveEvent",value:function(s){if(!(this._initialEventData===null||this.isDetached)){var a=this._initialEventData,n=a.x,i=a.y,o=es(s),c=o.pageX,l=o.pageY,d=Math.abs(n-c),m=Math.abs(i-l),x=Math.min(c,n),h=Math.min(l,i),g=this.selecting,v=this.isClick(c,l);v&&!g&&!(d||m)||(!g&&!v&&this.emit("selectStart",this._initialEventData),v||(this.selecting=!0,this._selectRect={top:h,left:x,x:c,y:l,right:x+d,bottom:h+m},this.emit("selecting",this._selectRect)),s.preventDefault())}}},{key:"_keyListener",value:function(s){this.ctrl=s.metaKey||s.ctrlKey}},{key:"isClick",value:function(s,a){var n=this._initialEventData,i=n.x,o=n.y,c=n.isTouch;return!c&&Math.abs(s-i)<=rl&&Math.abs(a-o)<=rl}}])}();function OC(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return Ot(t)!=="object"&&(t={top:t,left:t,right:t,bottom:t}),t}function sl(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=Sr(t),n=a.top,i=a.left,o=a.right,c=o===void 0?i:o,l=a.bottom,d=l===void 0?n:l,m=Sr(r),x=m.top,h=m.left,g=m.right,v=g===void 0?h:g,u=m.bottom,p=u===void 0?x:u;return!(d-s<x||n+s>p||c-s<h||i+s>v)}function Sr(t){if(!t.getBoundingClientRect)return t;var r=t.getBoundingClientRect(),s=r.left+al("left"),a=r.top+al("top");return{top:a,left:s,right:(t.offsetWidth||0)+s,bottom:(t.offsetHeight||0)+a}}function al(t){if(t==="left")return window.pageXOffset||document.body.scrollLeft||0;if(t==="top")return window.pageYOffset||document.body.scrollTop||0}var PC=function(t){function r(s,a){var n;return xe(this,r),n=ft(this,r,[s,a]),n.state={selecting:!1},n.containerRef=N.createRef(),n}return we(r,t),pe(r,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(a){!a.selectable&&this.props.selectable&&this._selectable(),a.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var a=this.props,n=a.range,i=a.getNow,o=a.getters,c=a.date,l=a.components.dateCellWrapper,d=a.localizer,m=this.state,x=m.selecting,h=m.startIdx,g=m.endIdx,v=i();return U.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},n.map(function(u,p){var w=x&&p>=h&&p<=g,y=o.dayProp(u),D=y.className,f=y.style;return U.createElement(l,{key:p,value:u,range:n},U.createElement("div",{style:f,className:Ke("rbc-day-bg",D,w&&"rbc-selected-cell",d.isSameDate(u,v)&&"rbc-today",c&&d.neq(c,u,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var a=this,n=this.containerRef.current,i=this._selector=new ed(this.props.container,{longPressThreshold:this.props.longPressThreshold}),o=function(l,d){if(!da(n,l)&&!EC(n,l)){var m=Sr(n),x=a.props,h=x.range,g=x.rtl;if(wC(m,l)){var v=Qc(m,l.x,g,h.length);a._selectSlot({startIdx:v,endIdx:v,action:d,box:l})}}a._initial={},a.setState({selecting:!1})};i.on("selecting",function(c){var l=a.props,d=l.range,m=l.rtl,x=-1,h=-1;if(a.state.selecting||(He(a.props.onSelectStart,[c]),a._initial={x:c.x,y:c.y}),i.isSelected(n)){var g=Sr(n),v=jC(a._initial,g,c,d.length,m);x=v.startIdx,h=v.endIdx}a.setState({selecting:!0,startIdx:x,endIdx:h})}),i.on("beforeSelect",function(c){if(a.props.selectable==="ignoreEvents")return!da(a.containerRef.current,c)}),i.on("click",function(c){return o(c,"click")}),i.on("doubleClick",function(c){return o(c,"doubleClick")}),i.on("select",function(c){a._selectSlot(Re(Re({},a.state),{},{action:"select",bounds:c})),a._initial={},a.setState({selecting:!1}),He(a.props.onSelectEnd,[a.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(a){var n=a.endIdx,i=a.startIdx,o=a.action,c=a.bounds,l=a.box;n!==-1&&i!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:i,end:n,action:o,bounds:c,box:l,resourceId:this.props.resourceId})}}])}(U.Component),Tt={propTypes:{slotMetrics:se.object.isRequired,selected:se.object,isAllDay:se.bool,accessors:se.object.isRequired,localizer:se.object.isRequired,components:se.object.isRequired,getters:se.object.isRequired,onSelect:se.func,onDoubleClick:se.func,onKeyPress:se.func},defaultProps:{segments:[],selected:{}},renderEvent:function(r,s){var a=r.selected;r.isAllDay;var n=r.accessors,i=r.getters,o=r.onSelect,c=r.onDoubleClick,l=r.onKeyPress,d=r.localizer,m=r.slotMetrics,x=r.components,h=r.resizable,g=m.continuesPrior(s),v=m.continuesAfter(s);return U.createElement(Jc,{event:s,getters:i,localizer:d,accessors:n,components:x,onSelect:o,onDoubleClick:c,onKeyPress:l,continuesPrior:g,continuesAfter:v,slotStart:m.first,slotEnd:m.last,selected:_a(s,a),resizable:h})},renderSpan:function(r,s,a){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(s)/r*100+"%";return U.createElement("div",{key:a,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},n)}},td=function(t){function r(){return xe(this,r),ft(this,r,arguments)}return we(r,t),pe(r,[{key:"render",value:function(){var a=this,n=this.props,i=n.segments,o=n.slotMetrics.slots,c=n.className,l=1;return U.createElement("div",{className:Ke(c,"rbc-row")},i.reduce(function(d,m,x){var h=m.event,g=m.left,v=m.right,u=m.span,p="_lvl_"+x,w=g-l,y=Tt.renderEvent(a.props,h);return w&&d.push(Tt.renderSpan(o,w,"".concat(p,"_gap"))),d.push(Tt.renderSpan(o,u,p,y)),l=v+1,d},[]))}}])}(U.Component);td.defaultProps=Re({},Tt.defaultProps);function rd(t){var r=t.dateRange,s=t.unit,a=s===void 0?"day":s,n=t.localizer;return{first:r[0],last:n.add(r[r.length-1],1,a)}}function MC(t,r,s,a){var n=rd({dateRange:r,localizer:a}),i=n.first,o=n.last,c=a.diff(i,o,"day"),l=a.max(a.startOf(s.start(t),"day"),i),d=a.min(a.ceil(s.end(t),"day"),o),m=Iw(r,function(h){return a.isSameDate(h,l)}),x=a.diff(l,d,"day");return x=Math.min(x,c),x=Math.max(x-a.segmentOffset,1),{event:t,span:x,left:m+1,right:Math.max(m+x,1)}}function pn(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,s,a,n,i=[],o=[];for(s=0;s<t.length;s++){for(n=t[s],a=0;a<i.length&&_C(n,i[a]);a++);a>=r?o.push(n):(i[a]||(i[a]=[])).push(n)}for(s=0;s<i.length;s++)i[s].sort(function(c,l){return c.left-l.left});return{levels:i,extra:o}}function Ss(t,r,s,a,n){var i={start:a.start(t),end:a.end(t)},o={start:r,end:s};return n.inEventRange({event:i,range:o})}function _C(t,r){return r.some(function(s){return s.left<=t.right&&s.right>=t.left})}function AC(t,r,s){var a=Js(t),n=[],i=[];a.forEach(function(l){var d=r.start(l),m=r.end(l);s.daySpan(d,m)>1?n.push(l):i.push(l)});var o=n.sort(function(l,d){return vn(l,d,r,s)}),c=i.sort(function(l,d){return vn(l,d,r,s)});return[].concat(Js(o),Js(c))}function vn(t,r,s,a){var n={start:s.start(t),end:s.end(t),allDay:s.allDay(t)},i={start:s.start(r),end:s.end(r),allDay:s.allDay(r)};return a.sortEvents({evtA:n,evtB:i})}var bn=function(r,s){return r.left<=s&&r.right>=s},Ja=function(r,s){return r.filter(function(a){return bn(a,s)}).map(function(a){return a.event})},sd=function(t){function r(){return xe(this,r),ft(this,r,arguments)}return we(r,t),pe(r,[{key:"render",value:function(){for(var a=this.props,n=a.segments,i=a.slotMetrics.slots,o=pn(n).levels[0],c=1,l=1,d=[];c<=i;){var m="_lvl_"+c,x=o.filter(function(f){return bn(f,c)})[0]||{},h=x.event,g=x.left,v=x.right,u=x.span;if(!h){var p=this.getHiddenEventsForSlot(n,c);if(p.length>0){var w=c-l;w&&d.push(Tt.renderSpan(i,w,m+"_gap")),d.push(Tt.renderSpan(i,1,m,this.renderShowMore(n,c))),l=c=c+1;continue}c++;continue}var y=Math.max(0,g-l);if(this.canRenderSlotEvent(g,u)){var D=Tt.renderEvent(this.props,h);y&&d.push(Tt.renderSpan(i,y,m+"_gap")),d.push(Tt.renderSpan(i,u,m,D)),l=c=v+1}else y&&d.push(Tt.renderSpan(i,y,m+"_gap")),d.push(Tt.renderSpan(i,1,m,this.renderShowMore(n,c))),l=c=c+1}return U.createElement("div",{className:"rbc-row"},d)}},{key:"getHiddenEventsForSlot",value:function(a,n){var i=Ja(a,n),o=pn(a).levels[0],c=o.filter(function(l){return bn(l,n)}).map(function(l){return l.event});return i.filter(function(l){return!c.some(function(d){return d===l})})}},{key:"canRenderSlotEvent",value:function(a,n){var i=this.props.segments;return Kw(a,a+n).every(function(o){var c=Ja(i,o).length;return c===1})}},{key:"renderShowMore",value:function(a,n){var i=this,o=this.props,c=o.localizer,l=o.slotMetrics,d=o.components,m=l.getEventsForSlot(n),x=Ja(a,n),h=x.length;if(d!=null&&d.showMore){var g=d.showMore,v=l.getDateForSlot(n-1);return h?U.createElement(g,{localizer:c,slotDate:v,slot:n,count:h,events:m,remainingEvents:x}):!1}return h?U.createElement("button",{type:"button",key:"sm_"+n,className:Ke("rbc-button-link","rbc-show-more"),onClick:function(p){return i.showMore(n,p)}},c.messages.showMore(h,x,m)):!1}},{key:"showMore",value:function(a,n){n.preventDefault(),n.stopPropagation(),this.props.onShowMore(a,n.target)}}])}(U.Component);sd.defaultProps=Re({},Tt.defaultProps);var RC=function(r){var s=r.children;return U.createElement("div",{className:"rbc-row-content-scroll-container"},s)},IC=function(r,s){return r.left<=s&&r.right>=s},LC=function(r,s){return r[0].range===s[0].range&&r[0].events===s[0].events};function ad(){return $c(function(t){for(var r=t.range,s=t.events,a=t.maxRows,n=t.minRows,i=t.accessors,o=t.localizer,c=rd({dateRange:r,localizer:o}),l=c.first,d=c.last,m=s.map(function(u){return MC(u,r,i,o)}),x=pn(m,Math.max(a-1,1)),h=x.levels,g=x.extra,v=g.length>0?n-1:n;h.length<v;)h.push([]);return{first:l,last:d,levels:h,extra:g,range:r,slots:r.length,clone:function(p){var w=ad();return w(Re(Re({},t),p))},getDateForSlot:function(p){return r[p]},getSlotForDate:function(p){return r.find(function(w){return o.isSameDate(w,p)})},getEventsForSlot:function(p){return m.filter(function(w){return IC(w,p)}).map(function(w){return w.event})},continuesPrior:function(p){return o.continuesPrior(i.start(p),l)},continuesAfter:function(p){var w=i.start(p),y=i.end(p);return o.continuesAfter(w,y,d)}}},LC)}var ks=function(t){function r(){var s;xe(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=ft(this,r,[].concat(n)),s.handleSelectSlot=function(o){var c=s.props,l=c.range,d=c.onSelectSlot;d(l.slice(o.start,o.end+1),o)},s.handleShowMore=function(o,c){var l=s.props,d=l.range,m=l.onShowMore,x=s.slotMetrics(s.props),h=Mh(s.containerRef.current,".rbc-row-bg")[0],g;h&&(g=h.children[o-1]);var v=x.getEventsForSlot(o);m(v,d[o-1],g,o,c)},s.getContainer=function(){var o=s.props.container;return o?o():s.containerRef.current},s.renderHeadingCell=function(o,c){var l=s.props,d=l.renderHeader,m=l.getNow,x=l.localizer;return d({date:o,key:"header_".concat(c),className:Ke("rbc-date-cell",x.isSameDate(o,m())&&"rbc-now")})},s.renderDummy=function(){var o=s.props,c=o.className,l=o.range,d=o.renderHeader,m=o.showAllEvents;return U.createElement("div",{className:c,ref:s.containerRef},U.createElement("div",{className:Ke("rbc-row-content",m&&"rbc-row-content-scrollable")},d&&U.createElement("div",{className:"rbc-row",ref:s.headingRowRef},l.map(s.renderHeadingCell)),U.createElement("div",{className:"rbc-row",ref:s.eventRowRef},U.createElement("div",{className:"rbc-row-segment"},U.createElement("div",{className:"rbc-event"},U.createElement("div",{className:"rbc-event-content"}," "))))))},s.containerRef=N.createRef(),s.headingRowRef=N.createRef(),s.eventRowRef=N.createRef(),s.slotMetrics=ad(),s}return we(r,t),pe(r,[{key:"getRowLimit",value:function(){var a,n=Ga(this.eventRowRef.current),i=(a=this.headingRowRef)!==null&&a!==void 0&&a.current?Ga(this.headingRowRef.current):0,o=Ga(this.containerRef.current)-i;return Math.max(Math.floor(o/n),1)}},{key:"render",value:function(){var a=this.props,n=a.date,i=a.rtl,o=a.range,c=a.className,l=a.selected,d=a.selectable,m=a.renderForMeasure,x=a.accessors,h=a.getters,g=a.components,v=a.getNow,u=a.renderHeader,p=a.onSelect,w=a.localizer,y=a.onSelectStart,D=a.onSelectEnd,f=a.onDoubleClick,T=a.onKeyPress,j=a.resourceId,k=a.longPressThreshold,C=a.isAllDay,M=a.resizable,z=a.showAllEvents;if(m)return this.renderDummy();var I=this.slotMetrics(this.props),X=I.levels,G=I.extra,re=z?RC:Lt,H=g.weekWrapper,$={selected:l,accessors:x,getters:h,localizer:w,components:g,onSelect:p,onDoubleClick:f,onKeyPress:T,resourceId:j,slotMetrics:I,resizable:M};return U.createElement("div",{className:c,role:"rowgroup",ref:this.containerRef},U.createElement(PC,{localizer:w,date:n,getNow:v,rtl:i,range:o,selectable:d,container:this.getContainer,getters:h,onSelectStart:y,onSelectEnd:D,onSelectSlot:this.handleSelectSlot,components:g,longPressThreshold:k,resourceId:j}),U.createElement("div",{className:Ke("rbc-row-content",z&&"rbc-row-content-scrollable"),role:"row"},u&&U.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},o.map(this.renderHeadingCell)),U.createElement(re,null,U.createElement(H,Object.assign({isAllDay:C},$,{rtl:this.props.rtl}),X.map(function(W,Q){return U.createElement(td,Object.assign({key:Q,segments:W},$))}),!!G.length&&U.createElement(sd,Object.assign({segments:G,onShowMore:this.handleShowMore},$))))))}}])}(U.Component);ks.defaultProps={minRows:0,maxRows:1/0};var ui=function(r){var s=r.label;return U.createElement("span",{role:"columnheader","aria-sort":"none"},s)},UC=function(r){var s=r.label,a=r.drilldownView,n=r.onDrillDown;return a?U.createElement("button",{type:"button",className:"rbc-button-link",onClick:n},s):U.createElement("span",null,s)},FC=["date","className"],WC=function(r,s,a,n,i){return r.filter(function(o){return Ss(o,s,a,n,i)})},Aa=function(t){function r(){var s;xe(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=ft(this,r,[].concat(n)),s.getContainer=function(){return s.containerRef.current},s.renderWeek=function(o,c){var l=s.props,d=l.events,m=l.components,x=l.selectable,h=l.getNow,g=l.selected,v=l.date,u=l.localizer,p=l.longPressThreshold,w=l.accessors,y=l.getters,D=l.showAllEvents,f=s.state,T=f.needLimitMeasure,j=f.rowLimit,k=WC(Js(d),o[0],o[o.length-1],w,u),C=AC(k,w,u);return U.createElement(ks,{key:c,ref:c===0?s.slotRowRef:void 0,container:s.getContainer,className:"rbc-month-row",getNow:h,date:v,range:o,events:C,maxRows:D?1/0:j,selected:g,selectable:x,components:m,accessors:w,getters:y,localizer:u,renderHeader:s.readerDateHeading,renderForMeasure:T,onShowMore:s.handleShowMore,onSelect:s.handleSelectEvent,onDoubleClick:s.handleDoubleClickEvent,onKeyPress:s.handleKeyPressEvent,onSelectSlot:s.handleSelectSlot,longPressThreshold:p,rtl:s.props.rtl,resizable:s.props.resizable,showAllEvents:D})},s.readerDateHeading=function(o){var c=o.date,l=o.className,d=qt(o,FC),m=s.props,x=m.date,h=m.getDrilldownView,g=m.localizer,v=g.neq(x,c,"month"),u=g.isSameDate(c,x),p=h(c),w=g.format(c,"dateFormat"),y=s.props.components.dateHeader||UC;return U.createElement("div",Object.assign({},d,{className:Ke(l,v&&"rbc-off-range",u&&"rbc-current"),role:"cell"}),U.createElement(y,{label:w,date:c,drilldownView:p,isOffRange:v,onDrillDown:function(f){return s.handleHeadingClick(c,p,f)}}))},s.handleSelectSlot=function(o,c){s._pendingSelection=s._pendingSelection.concat(o),clearTimeout(s._selectTimer),s._selectTimer=setTimeout(function(){return s.selectDates(c)})},s.handleHeadingClick=function(o,c,l){l.preventDefault(),s.clearSelection(),He(s.props.onDrillDown,[o,c])},s.handleSelectEvent=function(){s.clearSelection();for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];He(s.props.onSelectEvent,c)},s.handleDoubleClickEvent=function(){s.clearSelection();for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];He(s.props.onDoubleClickEvent,c)},s.handleKeyPressEvent=function(){s.clearSelection();for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];He(s.props.onKeyPressEvent,c)},s.handleShowMore=function(o,c,l,d,m){var x=s.props,h=x.popup,g=x.onDrillDown,v=x.onShowMore,u=x.getDrilldownView,p=x.doShowMoreDrillDown;if(s.clearSelection(),h){var w=ac(l,s.containerRef.current);s.setState({overlay:{date:c,events:o,position:w,target:m}})}else p&&He(g,[c,u(c)||xt.DAY]);He(v,[o,c,d])},s.overlayDisplay=function(){s.setState({overlay:null})},s.state={rowLimit:5,needLimitMeasure:!0,date:null},s.containerRef=N.createRef(),s.slotRowRef=N.createRef(),s._bgRows=[],s._pendingSelection=[],s}return we(r,t),pe(r,[{key:"componentDidMount",value:function(){var a=this,n;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){n||nc(function(){n=!1,a.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.className,c=i.visibleDays(n,i),l=ph(c,7);return this._weekCount=l.length,U.createElement("div",{className:Ke("rbc-month-view",o),role:"table","aria-label":"Month View",ref:this.containerRef},U.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(l[0])),l.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(a){var n=this.props,i=n.localizer,o=n.components,c=a[0],l=a[a.length-1],d=o.header||ui;return i.range(c,l,"day").map(function(m,x){return U.createElement("div",{key:"header_"+x,className:"rbc-header"},U.createElement(d,{date:m,localizer:i,label:i.format(m,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var a,n,i=this,o=(a=(n=this.state)===null||n===void 0?void 0:n.overlay)!==null&&a!==void 0?a:{},c=this.props,l=c.accessors,d=c.localizer,m=c.components,x=c.getters,h=c.selected,g=c.popupOffset,v=c.handleDragStart,u=function(){return i.setState({overlay:null})};return U.createElement(di,{overlay:o,accessors:l,localizer:d,components:m,getters:x,selected:h,popupOffset:g,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:u})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(a){var n=this._pendingSelection.slice();this._pendingSelection=[],n.sort(function(c,l){return+c-+l});var i=new Date(n[0]),o=new Date(n[n.length-1]);o.setDate(n[n.length-1].getDate()+1),He(this.props.onSelectSlot,{slots:n,start:i,end:o,action:a.action,bounds:a.bounds,box:a.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(a,n){var i=a.date,o=a.localizer;return{date:i,needLimitMeasure:o.neq(i,n.date,"month")}}}])}(U.Component);Aa.range=function(t,r){var s=r.localizer,a=s.firstVisibleDay(t,s),n=s.lastVisibleDay(t,s);return{start:a,end:n}};Aa.navigate=function(t,r,s){var a=s.localizer;switch(r){case yt.PREVIOUS:return a.add(t,-1,"month");case yt.NEXT:return a.add(t,1,"month");default:return t}};Aa.title=function(t,r){var s=r.localizer;return s.format(t,"monthHeaderFormat")};var nl=function(r){var s=r.min,a=r.max,n=r.step,i=r.slots,o=r.localizer;return"".concat(+o.startOf(s,"minutes"))+"".concat(+o.startOf(a,"minutes"))+"".concat(n,"-").concat(i)};function mi(t){for(var r=t.min,s=t.max,a=t.step,n=t.timeslots,i=t.localizer,o=nl({start:r,end:s,step:a,timeslots:n,localizer:i}),c=1+i.getTotalMin(r,s),l=i.getMinutesFromMidnight(r),d=Math.ceil((c-1)/(a*n)),m=d*n,x=new Array(d),h=new Array(m),g=0;g<d;g++){x[g]=new Array(n);for(var v=0;v<n;v++){var u=g*n+v,p=u*a;h[u]=x[g][v]=i.getSlotDate(r,l,p)}}var w=h.length*a;h.push(i.getSlotDate(r,l,w));function y(D){var f=i.diff(r,D,"minutes")+i.getDstOffset(r,D);return Math.min(f,c)}return{groups:x,update:function(f){return nl(f)!==o?mi(f):this},dateIsInGroup:function(f,T){var j=x[T+1];return i.inRange(f,x[T][0],j?j[0]:s,"minutes")},nextSlot:function(f){var T=h[Math.min(h.findIndex(function(j){return j===f||i.eq(j,f)})+1,h.length-1)];return i.eq(T,f)&&(T=i.add(f,a,"minutes")),T},closestSlotToPosition:function(f){var T=Math.min(h.length-1,Math.max(0,Math.floor(f*m)));return h[T]},closestSlotFromPoint:function(f,T){var j=Math.abs(T.top-T.bottom);return this.closestSlotToPosition((f.y-T.top)/j)},closestSlotFromDate:function(f){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(i.lt(f,r,"minutes"))return h[0];if(i.gt(f,s,"minutes"))return h[h.length-1];var j=i.diff(r,f,"minutes");return h[(j-j%a)/a+T]},startsBeforeDay:function(f){return i.lt(f,r,"day")},startsAfterDay:function(f){return i.gt(f,s,"day")},startsBefore:function(f){return i.lt(i.merge(r,f),r,"minutes")},startsAfter:function(f){return i.gt(i.merge(s,f),s,"minutes")},getRange:function(f,T,j,k){j||(f=i.min(s,i.max(r,f))),k||(T=i.min(s,i.max(r,T)));var C=y(f),M=y(T),z=M>a*m&&!i.eq(s,T)?(C-a)/(a*m)*100:C/(a*m)*100;return{top:z,height:M/(a*m)*100-z,start:y(f),startDate:f,end:y(T),endDate:T}},getCurrentTimePosition:function(f){var T=y(f),j=T/(a*m)*100;return j}}}var HC=function(){function t(r,s){var a=s.accessors,n=s.slotMetrics;xe(this,t);var i=n.getRange(a.start(r),a.end(r)),o=i.start,c=i.startDate,l=i.end,d=i.endDate,m=i.top,x=i.height;this.start=o,this.end=l,this.startMs=+c,this.endMs=+d,this.top=m,this.height=x,this.data=r}return pe(t,[{key:"_width",get:function(){if(this.rows){var s=this.rows.reduce(function(n,i){return Math.max(n,i.leaves.length+1)},0)+1;return 100/s}if(this.leaves){var a=100-this.container._width;return a/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var s=this._width,a=Math.min(100,this._width*1.7);if(this.rows)return a;if(this.leaves)return this.leaves.length>0?a:s;var n=this.row.leaves,i=n.indexOf(this);return i===n.length-1?s:a}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var s=this.row,a=s.leaves,n=s.xOffset,i=s._width,o=a.indexOf(this)+1;return n+o*i}}])}();function zC(t,r,s){return Math.abs(r.start-t.start)<s||r.start>t.start&&r.start<t.end}function BC(t){for(var r=gN(t,["startMs",function(c){return-c.endMs}]),s=[];r.length>0;){var a=r.shift();s.push(a);for(var n=0;n<r.length;n++){var i=r[n];if(!(a.endMs>i.startMs)){if(n>0){var o=r.splice(n,1)[0];s.push(o)}break}}}return s}function nd(t){for(var r=t.events,s=t.minimumStartDifference,a=t.slotMetrics,n=t.accessors,i=r.map(function(m){return new HC(m,{slotMetrics:a,accessors:n})}),o=BC(i),c=[],l=function(){var x=o[d],h=c.find(function(u){return u.end>x.start||Math.abs(x.start-u.start)<s});if(!h)return x.rows=[],c.push(x),1;x.container=h;for(var g=null,v=h.rows.length-1;!g&&v>=0;v--)zC(h.rows[v],x,s)&&(g=h.rows[v]);g?(g.leaves.push(x),x.row=g):(x.leaves=[],h.rows.push(x))},d=0;d<o.length;d++)l();return o.map(function(m){return{event:m.data,style:{top:m.top,height:m.height,width:m.width,xOffset:Math.max(0,m.xOffset)}}})}function id(t,r,s){for(var a=0;a<t.friends.length;++a)if(!(s.indexOf(t.friends[a])>-1)){r=r>t.friends[a].idx?r:t.friends[a].idx,s.push(t.friends[a]);var n=id(t.friends[a],r,s);r=r>n?r:n}return r}function YC(t){var r=t.events,s=t.minimumStartDifference,a=t.slotMetrics,n=t.accessors,i=nd({events:r,minimumStartDifference:s,slotMetrics:a,accessors:n});i.sort(function(H,$){return H=H.style,$=$.style,H.top!==$.top?H.top>$.top?1:-1:H.height!==$.height?H.top+H.height<$.top+$.height?1:-1:0});for(var o=0;o<i.length;++o)i[o].friends=[],delete i[o].style.left,delete i[o].style.left,delete i[o].idx,delete i[o].size;for(var c=0;c<i.length-1;++c)for(var l=i[c],d=l.style.top,m=l.style.top+l.style.height,x=c+1;x<i.length;++x){var h=i[x],g=h.style.top,v=h.style.top+h.style.height;(g>=d&&v<=m||v>d&&v<=m||g>=d&&g<m)&&(l.friends.push(h),h.friends.push(l))}for(var u=0;u<i.length;++u){for(var p=i[u],w=[],y=0;y<100;++y)w.push(1);for(var D=0;D<p.friends.length;++D)p.friends[D].idx!==void 0&&(w[p.friends[D].idx]=0);p.idx=w.indexOf(1)}for(var f=0;f<i.length;++f){var T=0;if(!i[f].size){var j=[],k=id(i[f],0,j);T=100/(k+1),i[f].size=T;for(var C=0;C<j.length;++C)j[C].size=T}}for(var M=0;M<i.length;++M){var z=i[M];z.style.left=z.idx*z.size;for(var I=0,X=0;X<z.friends.length;++X){var G=z.friends[X].idx;I=I>G?I:G}I<=z.idx&&(z.size=100-z.idx*z.size);var re=z.idx===0?0:3;z.style.width="calc(".concat(z.size,"% - ").concat(re,"px)"),z.style.height="calc(".concat(z.style.height,"% - 2px)"),z.style.xOffset="calc(".concat(z.style.left,"% + ").concat(re,"px)")}return i}var il={overlap:nd,"no-overlap":YC};function qC(t){return!!(t&&t.constructor&&t.call&&t.apply)}function GC(t){t.events,t.minimumStartDifference,t.slotMetrics,t.accessors;var r=t.dayLayoutAlgorithm,s=r;return r in il&&(s=il[r]),qC(s)?s.apply(this,arguments):[]}var od=function(t){function r(){return xe(this,r),ft(this,r,arguments)}return we(r,t),pe(r,[{key:"render",value:function(){var a=this.props,n=a.renderSlot,i=a.resource,o=a.group,c=a.getters,l=a.components,d=l===void 0?{}:l,m=d.timeSlotWrapper,x=m===void 0?Lt:m,h=c?c.slotGroupProp(o):{};return U.createElement("div",Object.assign({className:"rbc-timeslot-group"},h),o.map(function(g,v){var u=c?c.slotProp(g,i):{};return U.createElement(x,{key:v,value:g,resource:i},U.createElement("div",Object.assign({},u,{className:Ke("rbc-time-slot",u.className)}),n&&n(g,v)))}))}}])}(N.Component);function Gs(t){return typeof t=="string"?t:t+"%"}function VC(t){var r=t.style,s=t.className,a=t.event,n=t.accessors,i=t.rtl,o=t.selected,c=t.label,l=t.continuesPrior,d=t.continuesAfter,m=t.getters,x=t.onClick,h=t.onDoubleClick,g=t.isBackgroundEvent,v=t.onKeyPress,u=t.components,p=u.event,w=u.eventWrapper,y=n.title(a),D=n.tooltip(a),f=n.end(a),T=n.start(a),j=m.eventProp(a,T,f,o),k=[U.createElement("div",{key:"1",className:"rbc-event-label"},c),U.createElement("div",{key:"2",className:"rbc-event-content"},p?U.createElement(p,{event:a,title:y}):y)],C=r.height,M=r.top,z=r.width,I=r.xOffset,X=Re(Re({},j.style),{},ne({top:Gs(M),height:Gs(C),width:Gs(z)},i?"right":"left",Gs(I)));return U.createElement(w,Object.assign({type:"time"},t),U.createElement("div",{role:"button",tabIndex:0,onClick:x,onDoubleClick:h,style:X,onKeyDown:v,title:D?(typeof c=="string"?c+": ":"")+D:void 0,className:Ke(g?"rbc-background-event":"rbc-event",s,j.className,{"rbc-selected":o,"rbc-event-continues-earlier":l,"rbc-event-continues-later":d})},k))}var KC=function(r){var s=r.children,a=r.className,n=r.style,i=r.innerRef;return U.createElement("div",{className:a,style:n,ref:i},s)},JC=U.forwardRef(function(t,r){return U.createElement(KC,Object.assign({},t,{innerRef:r}))}),XC=["dayProp"],QC=["eventContainerWrapper","timeIndicatorWrapper"],ld=function(t){function r(){var s;xe(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=ft(this,r,[].concat(n)),s.state={selecting:!1,timeIndicatorPosition:null},s.intervalTriggered=!1,s.renderEvents=function(o){var c=o.events,l=o.isBackgroundEvent,d=s.props,m=d.rtl,x=d.selected,h=d.accessors,g=d.localizer,v=d.getters,u=d.components,p=d.step,w=d.timeslots,y=d.dayLayoutAlgorithm,D=d.resizable,f=s,T=f.slotMetrics,j=g.messages,k=GC({events:c,accessors:h,slotMetrics:T,minimumStartDifference:Math.ceil(p*w/2),dayLayoutAlgorithm:y});return k.map(function(C,M){var z,I=C.event,X=C.style,G=h.end(I),re=h.start(I),H=(z=h.eventId(I))!==null&&z!==void 0?z:"evt_"+M,$="eventTimeRangeFormat",W,Q=T.startsBeforeDay(re),te=T.startsAfterDay(G);Q?$="eventTimeRangeEndFormat":te&&($="eventTimeRangeStartFormat"),Q&&te?W=j.allDay:W=g.format({start:re,end:G},$);var me=Q||T.startsBefore(re),ve=te||T.startsAfter(G);return U.createElement(VC,{style:X,event:I,label:W,key:H,getters:v,rtl:m,components:u,continuesPrior:me,continuesAfter:ve,accessors:h,resource:s.props.resource,selected:_a(I,x),onClick:function(he){return s._select(Re(Re(Re({},I),s.props.resource&&{sourceResource:s.props.resource}),l&&{isBackgroundEvent:!0}),he)},onDoubleClick:function(he){return s._doubleClick(I,he)},isBackgroundEvent:l,onKeyPress:function(he){return s._keyPress(I,he)},resizable:D})})},s._selectable=function(){var o=s.containerRef.current,c=s.props,l=c.longPressThreshold,d=c.localizer,m=s._selector=new ed(function(){return o},{longPressThreshold:l}),x=function(u){var p=s.props.onSelecting,w=s.state||{},y=h(u),D=y.startDate,f=y.endDate;p&&(d.eq(w.startDate,D,"minutes")&&d.eq(w.endDate,f,"minutes")||p({start:D,end:f,resourceId:s.props.resource})===!1)||(s.state.start!==y.start||s.state.end!==y.end||s.state.selecting!==y.selecting)&&s.setState(y)},h=function(u){var p=s.slotMetrics.closestSlotFromPoint(u,Sr(o));s.state.selecting||(s._initialSlot=p);var w=s._initialSlot;d.lte(w,p)?p=s.slotMetrics.nextSlot(p):d.gt(w,p)&&(w=s.slotMetrics.nextSlot(w));var y=s.slotMetrics.getRange(d.min(w,p),d.max(w,p));return Re(Re({},y),{},{selecting:!0,top:"".concat(y.top,"%"),height:"".concat(y.height,"%")})},g=function(u,p){if(!da(s.containerRef.current,u)){var w=h(u),y=w.startDate,D=w.endDate;s._selectSlot({startDate:y,endDate:D,action:p,box:u})}s.setState({selecting:!1})};m.on("selecting",x),m.on("selectStart",x),m.on("beforeSelect",function(v){if(s.props.selectable==="ignoreEvents")return!da(s.containerRef.current,v)}),m.on("click",function(v){return g(v,"click")}),m.on("doubleClick",function(v){return g(v,"doubleClick")}),m.on("select",function(v){s.state.selecting&&(s._selectSlot(Re(Re({},s.state),{},{action:"select",bounds:v})),s.setState({selecting:!1}))}),m.on("reset",function(){s.state.selecting&&s.setState({selecting:!1})})},s._teardownSelectable=function(){s._selector&&(s._selector.teardown(),s._selector=null)},s._selectSlot=function(o){for(var c=o.startDate,l=o.endDate,d=o.action,m=o.bounds,x=o.box,h=c,g=[];s.props.localizer.lte(h,l);)g.push(h),h=new Date(+h+s.props.step*60*1e3);He(s.props.onSelectSlot,{slots:g,start:c,end:l,resourceId:s.props.resource,action:d,bounds:m,box:x})},s._select=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];He(s.props.onSelectEvent,c)},s._doubleClick=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];He(s.props.onDoubleClickEvent,c)},s._keyPress=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];He(s.props.onKeyPressEvent,c)},s.slotMetrics=mi(s.props),s.containerRef=N.createRef(),s}return we(r,t),pe(r,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(a,n){this.props.selectable&&!a.selectable&&this._selectable(),!this.props.selectable&&a.selectable&&this._teardownSelectable();var i=this.props,o=i.getNow,c=i.isNow,l=i.localizer,d=i.date,m=i.min,x=i.max,h=l.neq(a.getNow(),o(),"minutes");if(a.isNow!==c||h){if(this.clearTimeIndicatorInterval(),c){var g=!h&&l.eq(a.date,d,"minutes")&&n.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(g)}}else c&&(l.neq(a.min,m,"minutes")||l.neq(a.max,x,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var a=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!n&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){a.intervalTriggered=!0,a.positionTimeIndicator(),a.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var a=this.props,n=a.min,i=a.max,o=a.getNow,c=o();if(c>=n&&c<=i){var l=this.slotMetrics.getCurrentTimePosition(c);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:l})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var a=this.props,n=a.date,i=a.max,o=a.rtl,c=a.isNow,l=a.resource,d=a.accessors,m=a.localizer,x=a.getters,h=x.dayProp,g=qt(x,XC),v=a.components,u=v.eventContainerWrapper,p=v.timeIndicatorWrapper,w=qt(v,QC);this.slotMetrics=this.slotMetrics.update(this.props);var y=this.slotMetrics,D=this.state,f=D.selecting,T=D.top,j=D.height,k=D.startDate,C=D.endDate,M={start:k,end:C},z=h(i,l),I=z.className,X=z.style,G={className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}},re=w.dayColumnWrapper||JC;return U.createElement(re,{ref:this.containerRef,date:n,style:X,className:Ke(I,"rbc-day-slot","rbc-time-column",c&&"rbc-now",c&&"rbc-today",f&&"rbc-slot-selecting"),slotMetrics:y,resource:l},y.groups.map(function(H,$){return U.createElement(od,{key:$,group:H,resource:l,getters:g,components:w})}),U.createElement(u,{localizer:m,resource:l,accessors:d,getters:g,components:w,slotMetrics:y},U.createElement("div",{className:Ke("rbc-events-container",o&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),f&&U.createElement("div",{className:"rbc-slot-selection",style:{top:T,height:j}},U.createElement("span",null,m.format(M,"selectRangeFormat"))),c&&this.intervalTriggered&&U.createElement(p,G,U.createElement("div",G)))}}])}(U.Component);ld.defaultProps={dragThroughEvents:!0,timeslots:2};var cd=function(r){var s=r.label;return U.createElement(U.Fragment,null,s)},ZC=function(t){function r(){var s;xe(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=ft(this,r,[].concat(n)),s.handleHeaderClick=function(o,c,l){l.preventDefault(),He(s.props.onDrillDown,[o,c])},s.renderRow=function(o){var c=s.props,l=c.events,d=c.rtl,m=c.selectable,x=c.getNow,h=c.range,g=c.getters,v=c.localizer,u=c.accessors,p=c.components,w=c.resizable,y=u.resourceId(o),D=o?l.filter(function(f){return u.resource(f)===y}):l;return U.createElement(ks,{isAllDay:!0,rtl:d,getNow:x,minRows:2,maxRows:s.props.allDayMaxRows+1,range:h,events:D,resourceId:y,className:"rbc-allday-cell",selectable:m,selected:s.props.selected,components:p,accessors:u,getters:g,localizer:v,onSelect:s.props.onSelectEvent,onShowMore:s.props.onShowMore,onDoubleClick:s.props.onDoubleClickEvent,onKeyPress:s.props.onKeyPressEvent,onSelectSlot:s.props.onSelectSlot,longPressThreshold:s.props.longPressThreshold,resizable:w})},s}return we(r,t),pe(r,[{key:"renderHeaderCells",value:function(a){var n=this,i=this.props,o=i.localizer,c=i.getDrilldownView,l=i.getNow,d=i.getters.dayProp,m=i.components.header,x=m===void 0?ui:m,h=l();return a.map(function(g,v){var u=c(g),p=o.format(g,"dayFormat"),w=d(g),y=w.className,D=w.style,f=U.createElement(x,{date:g,label:p,localizer:o});return U.createElement("div",{key:v,style:D,className:Ke("rbc-header",y,o.isSameDate(g,h)&&"rbc-today")},u?U.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(j){return n.handleHeaderClick(g,u,j)}},f):U.createElement("span",null,f))})}},{key:"render",value:function(){var a=this,n=this.props,i=n.width,o=n.rtl,c=n.resources,l=n.range,d=n.events,m=n.getNow,x=n.accessors,h=n.selectable,g=n.components,v=n.getters,u=n.scrollRef,p=n.localizer,w=n.isOverflowing,y=n.components,D=y.timeGutterHeader,f=y.resourceHeader,T=f===void 0?cd:f,j=n.resizable,k={};w&&(k[o?"marginLeft":"marginRight"]="".concat(Bn()-1,"px"));var C=c.groupEvents(d);return U.createElement("div",{style:k,ref:u,className:Ke("rbc-time-header",w&&"rbc-overflowing")},U.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:i,minWidth:i,maxWidth:i}},D&&U.createElement(D,null)),c.map(function(M,z){var I=pr(M,2),X=I[0],G=I[1];return U.createElement("div",{className:"rbc-time-header-content",key:X||z},G&&U.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(z)},U.createElement("div",{className:"rbc-header"},U.createElement(T,{index:z,label:x.resourceTitle(G),resource:G}))),U.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(l.length<=1?" rbc-time-header-cell-single-day":"")},a.renderHeaderCells(l)),U.createElement(ks,{isAllDay:!0,rtl:o,getNow:m,minRows:2,maxRows:a.props.allDayMaxRows+1,range:l,events:C.get(X)||[],resourceId:G&&X,className:"rbc-allday-cell",selectable:h,selected:a.props.selected,components:g,accessors:x,getters:v,localizer:p,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:j}))}))}}])}(U.Component),e5=function(t){function r(){var s;xe(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=ft(this,r,[].concat(n)),s.handleHeaderClick=function(o,c,l){l.preventDefault(),He(s.props.onDrillDown,[o,c])},s}return we(r,t),pe(r,[{key:"renderHeaderCells",value:function(a){var n=this,i=this.props,o=i.localizer,c=i.getDrilldownView,l=i.getNow,d=i.getters.dayProp,m=i.components,x=m.header,h=x===void 0?ui:x,g=m.resourceHeader,v=g===void 0?cd:g,u=i.resources,p=i.accessors,w=i.events,y=i.rtl,D=i.selectable,f=i.components,T=i.getters,j=i.resizable,k=l(),C=u.groupEvents(w);return a.map(function(M,z){var I=c(M),X=o.format(M,"dayFormat"),G=d(M),re=G.className,H=G.style,$=U.createElement(h,{date:M,label:X,localizer:o});return U.createElement("div",{key:z,className:"rbc-time-header-content rbc-resource-grouping"},U.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(a.length<=1?" rbc-time-header-cell-single-day":"")},U.createElement("div",{style:H,className:Ke("rbc-header",re,o.isSameDate(M,k)&&"rbc-today")},I?U.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(Q){return n.handleHeaderClick(M,I,Q)}},$):U.createElement("span",null,$))),U.createElement("div",{className:"rbc-row"},u.map(function(W,Q){var te=pr(W,2),me=te[0],ve=te[1];return U.createElement("div",{key:"resource_".concat(me,"_").concat(Q),className:Ke("rbc-header",re,o.isSameDate(M,k)&&"rbc-today")},U.createElement(v,{index:Q,label:p.resourceTitle(ve),resource:ve}))})),U.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},u.map(function(W,Q){var te=pr(W,2),me=te[0],ve=te[1],Ne=(C.get(me)||[]).filter(function(he){return o.isSameDate(he.start,M)||o.isSameDate(he.end,M)});return U.createElement(ks,{key:"resource_".concat(me,"_").concat(Q),isAllDay:!0,rtl:y,getNow:l,minRows:2,maxRows:n.props.allDayMaxRows+1,range:[M],events:Ne,resourceId:ve&&me,className:"rbc-allday-cell",selectable:D,selected:n.props.selected,components:f,accessors:p,getters:T,localizer:o,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:j})})))})}},{key:"render",value:function(){var a=this.props,n=a.width,i=a.rtl,o=a.range,c=a.scrollRef,l=a.isOverflowing,d=a.components.timeGutterHeader,m={};return l&&(m[i?"marginLeft":"marginRight"]="".concat(Bn()-1,"px")),U.createElement("div",{style:m,ref:c,className:Ke("rbc-time-header",l&&"rbc-overflowing")},U.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:n,minWidth:n,maxWidth:n}},d&&U.createElement(d,null)),this.renderHeaderCells(o))}}])}(U.Component);function t5(t){var r=t.min,s=t.max,a=t.localizer;return a.getTimezoneOffset(r)!==a.getTimezoneOffset(s)?{start:a.add(r,-1,"day"),end:a.add(s,-1,"day")}:{start:r,end:s}}var r5=function(r){var s=r.min,a=r.max,n=r.timeslots,i=r.step,o=r.localizer,c=r.getNow,l=r.resource,d=r.components,m=r.getters,x=r.gutterRef,h=d.timeGutterWrapper,g=N.useMemo(function(){return t5({min:s,max:a,localizer:o})},[s==null?void 0:s.toISOString(),a==null?void 0:a.toISOString(),o]),v=g.start,u=g.end,p=N.useState(mi({min:v,max:u,timeslots:n,step:i,localizer:o})),w=pr(p,2),y=w[0],D=w[1];N.useEffect(function(){y&&D(y.update({min:v,max:u,timeslots:n,step:i,localizer:o}))},[v==null?void 0:v.toISOString(),u==null?void 0:u.toISOString(),n,i]);var f=N.useCallback(function(T,j){if(j)return null;var k=y.dateIsInGroup(c(),j);return U.createElement("span",{className:Ke("rbc-label",k&&"rbc-now")},o.format(T,"timeGutterFormat"))},[y,o,c]);return U.createElement(h,{slotMetrics:y},U.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:x},y.groups.map(function(T,j){return U.createElement(od,{key:j,group:T,resource:l,components:d,renderSlot:f,getters:m})})))},s5=U.forwardRef(function(t,r){return U.createElement(r5,Object.assign({gutterRef:r},t))}),Xa={};function a5(t,r){return{map:function(a){return t?t.map(function(n,i){return a([r.resourceId(n),n],i)}):[a([Xa,null],0)]},groupEvents:function(a){var n=new Map;return t?(a.forEach(function(i){var o=r.resource(i)||Xa;if(Array.isArray(o))o.forEach(function(l){var d=n.get(l)||[];d.push(i),n.set(l,d)});else{var c=n.get(o)||[];c.push(i),n.set(o,c)}}),n):(n.set(Xa,a),n)}}}var Xr=function(t){function r(s){var a;return xe(this,r),a=ft(this,r,[s]),a.handleScroll=function(n){a.scrollRef.current&&(a.scrollRef.current.scrollLeft=n.target.scrollLeft)},a.handleResize=function(){Yi(a.rafHandle),a.rafHandle=nc(a.checkOverflow)},a.handleKeyPressEvent=function(){a.clearSelection();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];He(a.props.onKeyPressEvent,i)},a.handleSelectEvent=function(){a.clearSelection();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];He(a.props.onSelectEvent,i)},a.handleDoubleClickEvent=function(){a.clearSelection();for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];He(a.props.onDoubleClickEvent,i)},a.handleShowMore=function(n,i,o,c,l){var d=a.props,m=d.popup,x=d.onDrillDown,h=d.onShowMore,g=d.getDrilldownView,v=d.doShowMoreDrillDown;if(a.clearSelection(),m){var u=ac(o,a.containerRef.current);a.setState({overlay:{date:i,events:n,position:Re(Re({},u),{},{width:"200px"}),target:l}})}else v&&He(x,[i,g(i)||xt.DAY]);He(h,[n,i,c])},a.handleSelectAllDaySlot=function(n,i){var o=a.props.onSelectSlot,c=new Date(n[0]),l=new Date(n[n.length-1]);l.setDate(n[n.length-1].getDate()+1),He(o,{slots:n,start:c,end:l,action:i.action,resourceId:i.resourceId})},a.overlayDisplay=function(){a.setState({overlay:null})},a.checkOverflow=function(){if(!a._updatingOverflow){var n=a.contentRef.current;if(n!=null&&n.scrollHeight){var i=n.scrollHeight>n.clientHeight;a.state.isOverflowing!==i&&(a._updatingOverflow=!0,a.setState({isOverflowing:i},function(){a._updatingOverflow=!1}))}}},a.memoizedResources=$c(function(n,i){return a5(n,i)}),a.state={gutterWidth:void 0,isOverflowing:null},a.scrollRef=U.createRef(),a.contentRef=U.createRef(),a.containerRef=U.createRef(),a._scrollRatio=null,a.gutterRef=N.createRef(),a}return we(r,t),pe(r,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),Yi(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(a,n,i,o,c,l,d,m,x,h){var g=this.props,v=g.min,u=g.max,p=(o.get(n)||[]).filter(function(y){return l.inRange(a,d.start(y),d.end(y),"day")}),w=(c.get(n)||[]).filter(function(y){return l.inRange(a,d.start(y),d.end(y),"day")});return U.createElement(ld,Object.assign({},this.props,{localizer:l,min:l.merge(a,v),max:l.merge(a,u),resource:i&&n,components:m,isNow:l.isSameDate(a,h),key:"".concat(n,"-").concat(a),date:a,events:p,backgroundEvents:w,dayLayoutAlgorithm:x}))}},{key:"renderResourcesFirst",value:function(a,n,i,o,c,l,d,m,x){var h=this;return n.map(function(g){var v=pr(g,2),u=v[0],p=v[1];return a.map(function(w){return h.renderDayColumn(w,u,p,i,o,c,l,m,x,d)})})}},{key:"renderRangeFirst",value:function(a,n,i,o,c,l,d,m,x){var h=this;return a.map(function(g){return U.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:g},n.map(function(v){var u=pr(v,2),p=u[0],w=u[1];return U.createElement("div",{style:{flex:1},key:l.resourceId(w)},h.renderDayColumn(g,p,w,i,o,c,l,m,x,d))}))})}},{key:"renderEvents",value:function(a,n,i,o){var c=this.props,l=c.accessors,d=c.localizer,m=c.resourceGroupingLayout,x=c.components,h=c.dayLayoutAlgorithm,g=this.memoizedResources(this.props.resources,l),v=g.groupEvents(n),u=g.groupEvents(i);return m?this.renderRangeFirst(a,g,v,u,d,l,o,x,h):this.renderResourcesFirst(a,g,v,u,d,l,o,x,h)}},{key:"render",value:function(){var a,n=this.props,i=n.events,o=n.backgroundEvents,c=n.range,l=n.width,d=n.rtl,m=n.selected,x=n.getNow,h=n.resources,g=n.components,v=n.accessors,u=n.getters,p=n.localizer,w=n.min,y=n.max,D=n.showMultiDayTimes,f=n.longPressThreshold,T=n.resizable,j=n.resourceGroupingLayout;l=l||this.state.gutterWidth;var k=c[0],C=c[c.length-1];this.slots=c.length;var M=[],z=[],I=[];i.forEach(function(G){if(Ss(G,k,C,v,p)){var re=v.start(G),H=v.end(G);v.allDay(G)||p.startAndEndAreDateOnly(re,H)||!D&&!p.isSameDate(re,H)?M.push(G):z.push(G)}}),o.forEach(function(G){Ss(G,k,C,v,p)&&I.push(G)}),M.sort(function(G,re){return vn(G,re,v,p)});var X={range:c,events:M,width:l,rtl:d,getNow:x,localizer:p,selected:m,allDayMaxRows:this.props.showAllEvents?1/0:(a=this.props.allDayMaxRows)!==null&&a!==void 0?a:1/0,resources:this.memoizedResources(h,v),selectable:this.props.selectable,accessors:v,getters:u,components:g,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:f,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:T};return U.createElement("div",{className:Ke("rbc-time-view",h&&"rbc-time-view-resources"),ref:this.containerRef},h&&h.length>1&&j?U.createElement(e5,X):U.createElement(ZC,X),this.props.popup&&this.renderOverlay(),U.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},U.createElement(s5,{date:k,ref:this.gutterRef,localizer:p,min:p.merge(k,w),max:p.merge(k,y),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:g,className:"rbc-time-gutter",getters:u}),this.renderEvents(c,z,I,x())))}},{key:"renderOverlay",value:function(){var a,n,i=this,o=(a=(n=this.state)===null||n===void 0?void 0:n.overlay)!==null&&a!==void 0?a:{},c=this.props,l=c.accessors,d=c.localizer,m=c.components,x=c.getters,h=c.selected,g=c.popupOffset,v=c.handleDragStart,u=function(){return i.setState({overlay:null})};return U.createElement(di,{overlay:o,accessors:l,localizer:d,components:m,getters:x,selected:h,popupOffset:g,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:u})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var a=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var n,i=(n=a.gutterRef)!==null&&n!==void 0&&n.current?gn(a.gutterRef.current):void 0;i&&a.state.gutterWidth!==i&&a.setState({gutterWidth:i})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var a=this.contentRef.current;a.scrollTop=a.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,n=a.min,i=a.max,o=a.scrollToTime,c=a.localizer,l=c.diff(c.merge(o,n),o,"milliseconds"),d=c.diff(n,i,"milliseconds");this._scrollRatio=l/d}}])}(N.Component);Xr.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var n5=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Ra=function(t){function r(){return xe(this,r),ft(this,r,arguments)}return we(r,t),pe(r,[{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.min,c=o===void 0?i.startOf(new Date,"day"):o,l=a.max,d=l===void 0?i.endOf(new Date,"day"):l,m=a.scrollToTime,x=m===void 0?i.startOf(new Date,"day"):m,h=a.enableAutoScroll,g=h===void 0?!0:h,v=qt(a,n5),u=r.range(n,{localizer:i});return U.createElement(Xr,Object.assign({},v,{range:u,eventOffset:10,localizer:i,min:c,max:d,scrollToTime:x,enableAutoScroll:g}))}}])}(U.Component);Ra.range=function(t,r){var s=r.localizer;return[s.startOf(t,"day")]};Ra.navigate=function(t,r,s){var a=s.localizer;switch(r){case yt.PREVIOUS:return a.add(t,-1,"day");case yt.NEXT:return a.add(t,1,"day");default:return t}};Ra.title=function(t,r){var s=r.localizer;return s.format(t,"dayHeaderFormat")};var i5=["date","localizer","min","max","scrollToTime","enableAutoScroll"],ir=function(t){function r(){return xe(this,r),ft(this,r,arguments)}return we(r,t),pe(r,[{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.min,c=o===void 0?i.startOf(new Date,"day"):o,l=a.max,d=l===void 0?i.endOf(new Date,"day"):l,m=a.scrollToTime,x=m===void 0?i.startOf(new Date,"day"):m,h=a.enableAutoScroll,g=h===void 0?!0:h,v=qt(a,i5),u=r.range(n,this.props);return U.createElement(Xr,Object.assign({},v,{range:u,eventOffset:15,localizer:i,min:c,max:d,scrollToTime:x,enableAutoScroll:g}))}}])}(U.Component);ir.defaultProps=Xr.defaultProps;ir.navigate=function(t,r,s){var a=s.localizer;switch(r){case yt.PREVIOUS:return a.add(t,-1,"week");case yt.NEXT:return a.add(t,1,"week");default:return t}};ir.range=function(t,r){var s=r.localizer,a=s.startOfWeek(),n=s.startOf(t,"week",a),i=s.endOf(t,"week",a);return s.range(n,i)};ir.title=function(t,r){var s=r.localizer,a=ir.range(t,{localizer:s}),n=Ic(a),i=n[0],o=n.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var o5=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function hi(t,r){return ir.range(t,r).filter(function(s){return[6,0].indexOf(s.getDay())===-1})}var Ls=function(t){function r(){return xe(this,r),ft(this,r,arguments)}return we(r,t),pe(r,[{key:"render",value:function(){var a=this.props,n=a.date,i=a.localizer,o=a.min,c=o===void 0?i.startOf(new Date,"day"):o,l=a.max,d=l===void 0?i.endOf(new Date,"day"):l,m=a.scrollToTime,x=m===void 0?i.startOf(new Date,"day"):m,h=a.enableAutoScroll,g=h===void 0?!0:h,v=qt(a,o5),u=hi(n,this.props);return U.createElement(Xr,Object.assign({},v,{range:u,eventOffset:15,localizer:i,min:c,max:d,scrollToTime:x,enableAutoScroll:g}))}}])}(U.Component);Ls.defaultProps=Xr.defaultProps;Ls.range=hi;Ls.navigate=ir.navigate;Ls.title=function(t,r){var s=r.localizer,a=hi(t,{localizer:s}),n=Ic(a),i=n[0],o=n.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var Ia=30;function La(t){var r=t.accessors,s=t.components,a=t.date,n=t.events,i=t.getters,o=t.length,c=o===void 0?Ia:o,l=t.localizer,d=t.onDoubleClickEvent,m=t.onSelectEvent,x=t.selected,h=N.useRef(null),g=N.useRef(null),v=N.useRef(null),u=N.useRef(null),p=N.useRef(null);N.useEffect(function(){D()});var w=function(C,M,z){var I=s.event,X=s.date;return M=M.filter(function(G){return Ss(G,l.startOf(C,"day"),l.endOf(C,"day"),r,l)}),M.map(function(G,re){var H=r.title(G),$=r.end(G),W=r.start(G),Q=i.eventProp(G,W,$,_a(G,x)),te=re===0&&l.format(C,"agendaDateFormat"),me=re===0?U.createElement("td",{rowSpan:M.length,className:"rbc-agenda-date-cell"},X?U.createElement(X,{day:C,label:te}):te):!1;return U.createElement("tr",{key:z+"_"+re,className:Q.className,style:Q.style},me,U.createElement("td",{className:"rbc-agenda-time-cell"},y(C,G)),U.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(Ne){return m&&m(G,Ne)},onDoubleClick:function(Ne){return d&&d(G,Ne)}},I?U.createElement(I,{event:G,title:H}):H))},[])},y=function(C,M){var z="",I=s.time,X=l.messages.allDay,G=r.end(M),re=r.start(M);return r.allDay(M)||(l.eq(re,G)?X=l.format(re,"agendaTimeFormat"):l.isSameDate(re,G)?X=l.format({start:re,end:G},"agendaTimeRangeFormat"):l.isSameDate(C,re)?X=l.format(re,"agendaTimeFormat"):l.isSameDate(C,G)&&(X=l.format(G,"agendaTimeFormat"))),l.gt(C,re,"day")&&(z="rbc-continues-prior"),l.lt(C,G,"day")&&(z+=" rbc-continues-after"),U.createElement("span",{className:z.trim()},I?U.createElement(I,{event:M,day:C,label:X}):X)},D=function(){if(p.current){var C=h.current,M=p.current.firstChild;if(M){var z=u.current.scrollHeight>u.current.clientHeight,I=[],X=I;I=[gn(M.children[0]),gn(M.children[1])],(X[0]!==I[0]||X[1]!==I[1])&&(g.current.style.width=I[0]+"px",v.current.style.width=I[1]+"px"),z?(ng(C,"rbc-header-overflowing"),C.style.marginRight=Bn()+"px"):ig(C,"rbc-header-overflowing")}}},f=l.messages,T=l.add(a,c,"day"),j=l.range(a,T,"day");return n=n.filter(function(k){return Ss(k,l.startOf(a,"day"),l.endOf(T,"day"),r,l)}),n.sort(function(k,C){return+r.start(k)-+r.start(C)}),U.createElement("div",{className:"rbc-agenda-view"},n.length!==0?U.createElement(U.Fragment,null,U.createElement("table",{ref:h,className:"rbc-agenda-table"},U.createElement("thead",null,U.createElement("tr",null,U.createElement("th",{className:"rbc-header",ref:g},f.date),U.createElement("th",{className:"rbc-header",ref:v},f.time),U.createElement("th",{className:"rbc-header"},f.event)))),U.createElement("div",{className:"rbc-agenda-content",ref:u},U.createElement("table",{className:"rbc-agenda-table"},U.createElement("tbody",{ref:p},j.map(function(k,C){return w(k,n,C)}))))):U.createElement("span",{className:"rbc-agenda-empty"},f.noEventsInRange))}La.range=function(t,r){var s=r.length,a=s===void 0?Ia:s,n=r.localizer,i=n.add(t,a,"day");return{start:t,end:i}};La.navigate=function(t,r,s){var a=s.length,n=a===void 0?Ia:a,i=s.localizer;switch(r){case yt.PREVIOUS:return i.add(t,-n,"day");case yt.NEXT:return i.add(t,n,"day");default:return t}};La.title=function(t,r){var s=r.length,a=s===void 0?Ia:s,n=r.localizer,i=n.add(t,a,"day");return n.format({start:t,end:i},"agendaHeaderFormat")};var Zs=ne(ne(ne(ne(ne({},xt.MONTH,Aa),xt.WEEK,ir),xt.WORK_WEEK,Ls),xt.DAY,Ra),xt.AGENDA,La),l5=["action","date","today"];function c5(t,r){var s=r.action,a=r.date,n=r.today,i=qt(r,l5);switch(t=typeof t=="string"?Zs[t]:t,s){case yt.TODAY:a=n||new Date;break;case yt.DATE:break;default:ms(t&&typeof t.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),a=t.navigate(a,s,i)}return a}function d5(t,r){var s=null;return typeof r=="function"?s=r(t):typeof r=="string"&&Ot(t)==="object"&&t!=null&&r in t&&(s=t[r]),s}var Vt=function(r){return function(s){return d5(s,r)}},u5=["view","date","getNow","onNavigate"],m5=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function dd(t){if(Array.isArray(t))return t;for(var r=[],s=0,a=Object.entries(t);s<a.length;s++){var n=pr(a[s],2),i=n[0],o=n[1];o&&r.push(i)}return r}function h5(t,r){var s=r.views,a=dd(s);return a.indexOf(t)!==-1}var ud=function(t){function r(){var s;xe(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=ft(this,r,[].concat(n)),s.getViews=function(){var o=s.props.views;return Array.isArray(o)?zk(o,function(c,l){return c[l]=Zs[l]},{}):Ot(o)==="object"?zN(o,function(c,l){return c===!0?Zs[l]:c}):Zs},s.getView=function(){var o=s.getViews();return o[s.props.view]},s.getDrilldownView=function(o){var c=s.props,l=c.view,d=c.drilldownView,m=c.getDrilldownView;return m?m(o,l,Object.keys(s.getViews())):d},s.handleRangeChange=function(o,c,l){var d=s.props,m=d.onRangeChange,x=d.localizer;m&&c.range&&m(c.range(o,{localizer:x}),l)},s.handleNavigate=function(o,c){var l=s.props,d=l.view,m=l.date,x=l.getNow,h=l.onNavigate,g=qt(l,u5),v=s.getView(),u=x();m=c5(v,Re(Re({},g),{},{action:o,date:c||m||u,today:u})),h(m,d,o),s.handleRangeChange(m,v)},s.handleViewChange=function(o){o!==s.props.view&&h5(o,s.props)&&s.props.onView(o);var c=s.getViews();s.handleRangeChange(s.props.date||s.props.getNow(),c[o],o)},s.handleSelectEvent=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];He(s.props.onSelectEvent,c)},s.handleDoubleClickEvent=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];He(s.props.onDoubleClickEvent,c)},s.handleKeyPressEvent=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];He(s.props.onKeyPressEvent,c)},s.handleSelectSlot=function(o){He(s.props.onSelectSlot,o)},s.handleDrillDown=function(o,c){var l=s.props.onDrillDown;if(l){l(o,c,s.drilldownView);return}c&&s.handleViewChange(c),s.handleNavigate(yt.DATE,o)},s.state={context:r.getContext(s.props)},s}return we(r,t),pe(r,[{key:"render",value:function(){var a=this.props,n=a.view,i=a.toolbar,o=a.events,c=a.backgroundEvents,l=a.resourceGroupingLayout,d=a.style,m=a.className,x=a.elementProps,h=a.date,g=a.getNow,v=a.length,u=a.showMultiDayTimes,p=a.onShowMore,w=a.doShowMoreDrillDown;a.components,a.formats,a.messages,a.culture;var y=qt(a,m5);h=h||g();var D=this.getView(),f=this.state.context,T=f.accessors,j=f.components,k=f.getters,C=f.localizer,M=f.viewNames,z=j.toolbar||xC,I=D.title(h,{localizer:C,length:v});return U.createElement("div",Object.assign({},x,{className:Ke(m,"rbc-calendar",y.rtl&&"rbc-rtl"),style:d}),i&&U.createElement(z,{date:h,view:n,views:M,label:I,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:C}),U.createElement(D,Object.assign({},y,{events:o,backgroundEvents:c,date:h,getNow:g,length:v,localizer:C,getters:k,components:j,accessors:T,showMultiDayTimes:u,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:p,doShowMoreDrillDown:w,resourceGroupingLayout:l})))}}],[{key:"getDerivedStateFromProps",value:function(a){return{context:r.getContext(a)}}},{key:"getContext",value:function(a){var n=a.startAccessor,i=a.endAccessor,o=a.allDayAccessor,c=a.tooltipAccessor,l=a.titleAccessor,d=a.resourceAccessor,m=a.resourceIdAccessor,x=a.resourceTitleAccessor,h=a.eventIdAccessor,g=a.eventPropGetter,v=a.backgroundEventPropGetter,u=a.slotPropGetter,p=a.slotGroupPropGetter,w=a.dayPropGetter,y=a.view,D=a.views,f=a.localizer,T=a.culture,j=a.messages,k=j===void 0?{}:j,C=a.components,M=C===void 0?{}:C,z=a.formats,I=z===void 0?{}:z,X=dd(D),G=vC(k);return{viewNames:X,localizer:gC(f,T,I,G),getters:{eventProp:function(){return g&&g.apply(void 0,arguments)||{}},backgroundEventProp:function(){return v&&v.apply(void 0,arguments)||{}},slotProp:function(){return u&&u.apply(void 0,arguments)||{}},slotGroupProp:function(){return p&&p.apply(void 0,arguments)||{}},dayProp:function(){return w&&w.apply(void 0,arguments)||{}}},components:RN(M[y]||{},$k(M,X),{eventWrapper:Lt,backgroundEventWrapper:Lt,eventContainerWrapper:Lt,dateCellWrapper:Lt,weekWrapper:Lt,timeSlotWrapper:Lt,timeGutterWrapper:Lt,timeIndicatorWrapper:Lt}),accessors:{start:Vt(n),end:Vt(i),allDay:Vt(o),tooltip:Vt(c),title:Vt(l),resource:Vt(d),resourceId:Vt(m),resourceTitle:Vt(x),eventId:Vt(h)}}}}])}(U.Component);ud.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:xt.MONTH,views:[xt.MONTH,xt.WEEK,xt.DAY,xt.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:xt.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var fi=Ll(ud,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),f5=function(r,s,a){var n=r.start,i=r.end;return"".concat(a.format(n,"P",s)," – ").concat(a.format(i,"P",s))},Qa=function(r,s,a){var n=r.start,i=r.end;return"".concat(a.format(n,"p",s)," – ").concat(a.format(i,"p",s))},g5=function(r,s,a){var n=r.start;return"".concat(a.format(n,"h:mma",s)," – ")},x5=function(r,s,a){var n=r.end;return" – ".concat(a.format(n,"h:mma",s))},p5=function(r,s,a){var n=r.start,i=r.end;return"".concat(a.format(n,"MMMM dd",s)," – ").concat(a.format(i,Wr(n,i,"month")?"dd":"MMMM dd",s))},v5={dateFormat:"dd",dayFormat:"dd eee",weekdayFormat:"ccc",selectRangeFormat:Qa,eventTimeRangeFormat:Qa,eventTimeRangeStartFormat:g5,eventTimeRangeEndFormat:x5,timeGutterFormat:"p",monthHeaderFormat:"MMMM yyyy",dayHeaderFormat:"cccc MMM dd",dayRangeHeaderFormat:p5,agendaHeaderFormat:f5,agendaDateFormat:"ccc MMM dd",agendaTimeFormat:"p",agendaTimeRangeFormat:Qa},gi=function(r){var s=r.startOfWeek,a=r.getDay,n=r.format,i=r.locales;return new fC({formats:v5,firstOfWeek:function(c){return a(s(new Date,{locale:i[c]}))},format:function(c,l,d){return n(new Date(c),l,{locale:i[d]})}})};function dt(t){if(t===null||t===!0||t===!1)return NaN;var r=Number(t);return isNaN(r)?r:r<0?Math.ceil(r):Math.floor(r)}function Oe(t,r){if(r.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+r.length+" present")}function st(t){Oe(1,arguments);var r=Object.prototype.toString.call(t);return t instanceof Date||Ot(t)==="object"&&r==="[object Date]"?new Date(t.getTime()):typeof t=="number"||r==="[object Number]"?new Date(t):((typeof t=="string"||r==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function b5(t,r){Oe(2,arguments);var s=st(t),a=dt(r);return isNaN(a)?new Date(NaN):(a&&s.setDate(s.getDate()+a),s)}function y5(t,r){Oe(2,arguments);var s=st(t).getTime(),a=dt(r);return new Date(s+a)}var w5={};function Cr(){return w5}function Cs(t,r){var s,a,n,i,o,c,l,d;Oe(1,arguments);var m=Cr(),x=dt((s=(a=(n=(i=r==null?void 0:r.weekStartsOn)!==null&&i!==void 0?i:r==null||(o=r.locale)===null||o===void 0||(c=o.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&n!==void 0?n:m.weekStartsOn)!==null&&a!==void 0?a:(l=m.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&s!==void 0?s:0);if(!(x>=0&&x<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=st(t),g=h.getDay(),v=(g<x?7:0)+g-x;return h.setDate(h.getDate()-v),h.setHours(0,0,0,0),h}function md(t){var r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),t.getTime()-r.getTime()}function ol(t){Oe(1,arguments);var r=st(t);return r.setHours(0,0,0,0),r}var j5=6e4,N5=36e5,S5=1e3;function hd(t,r){Oe(2,arguments);var s=ol(t),a=ol(r);return s.getTime()===a.getTime()}function k5(t){return Oe(1,arguments),t instanceof Date||Ot(t)==="object"&&Object.prototype.toString.call(t)==="[object Date]"}function C5(t){if(Oe(1,arguments),!k5(t)&&typeof t!="number")return!1;var r=st(t);return!isNaN(Number(r))}function fd(t,r){Oe(2,arguments);var s=dt(r);return y5(t,-s)}var T5=864e5;function D5(t){Oe(1,arguments);var r=st(t),s=r.getTime();r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0);var a=r.getTime(),n=s-a;return Math.floor(n/T5)+1}function Fr(t){Oe(1,arguments);var r=1,s=st(t),a=s.getUTCDay(),n=(a<r?7:0)+a-r;return s.setUTCDate(s.getUTCDate()-n),s.setUTCHours(0,0,0,0),s}function gd(t){Oe(1,arguments);var r=st(t),s=r.getUTCFullYear(),a=new Date(0);a.setUTCFullYear(s+1,0,4),a.setUTCHours(0,0,0,0);var n=Fr(a),i=new Date(0);i.setUTCFullYear(s,0,4),i.setUTCHours(0,0,0,0);var o=Fr(i);return r.getTime()>=n.getTime()?s+1:r.getTime()>=o.getTime()?s:s-1}function E5(t){Oe(1,arguments);var r=gd(t),s=new Date(0);s.setUTCFullYear(r,0,4),s.setUTCHours(0,0,0,0);var a=Fr(s);return a}var $5=6048e5;function xd(t){Oe(1,arguments);var r=st(t),s=Fr(r).getTime()-E5(r).getTime();return Math.round(s/$5)+1}function Zt(t,r){var s,a,n,i,o,c,l,d;Oe(1,arguments);var m=Cr(),x=dt((s=(a=(n=(i=r==null?void 0:r.weekStartsOn)!==null&&i!==void 0?i:r==null||(o=r.locale)===null||o===void 0||(c=o.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&n!==void 0?n:m.weekStartsOn)!==null&&a!==void 0?a:(l=m.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&s!==void 0?s:0);if(!(x>=0&&x<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=st(t),g=h.getUTCDay(),v=(g<x?7:0)+g-x;return h.setUTCDate(h.getUTCDate()-v),h.setUTCHours(0,0,0,0),h}function xi(t,r){var s,a,n,i,o,c,l,d;Oe(1,arguments);var m=st(t),x=m.getUTCFullYear(),h=Cr(),g=dt((s=(a=(n=(i=r==null?void 0:r.firstWeekContainsDate)!==null&&i!==void 0?i:r==null||(o=r.locale)===null||o===void 0||(c=o.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:h.firstWeekContainsDate)!==null&&a!==void 0?a:(l=h.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(g>=1&&g<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setUTCFullYear(x+1,0,g),v.setUTCHours(0,0,0,0);var u=Zt(v,r),p=new Date(0);p.setUTCFullYear(x,0,g),p.setUTCHours(0,0,0,0);var w=Zt(p,r);return m.getTime()>=u.getTime()?x+1:m.getTime()>=w.getTime()?x:x-1}function O5(t,r){var s,a,n,i,o,c,l,d;Oe(1,arguments);var m=Cr(),x=dt((s=(a=(n=(i=r==null?void 0:r.firstWeekContainsDate)!==null&&i!==void 0?i:r==null||(o=r.locale)===null||o===void 0||(c=o.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:m.firstWeekContainsDate)!==null&&a!==void 0?a:(l=m.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:1),h=xi(t,r),g=new Date(0);g.setUTCFullYear(h,0,x),g.setUTCHours(0,0,0,0);var v=Zt(g,r);return v}var P5=6048e5;function pd(t,r){Oe(1,arguments);var s=st(t),a=Zt(s,r).getTime()-O5(s,r).getTime();return Math.round(a/P5)+1}function Ae(t,r){for(var s=t<0?"-":"",a=Math.abs(t).toString();a.length<r;)a="0"+a;return s+a}var M5={y:function(r,s){var a=r.getUTCFullYear(),n=a>0?a:1-a;return Ae(s==="yy"?n%100:n,s.length)},M:function(r,s){var a=r.getUTCMonth();return s==="M"?String(a+1):Ae(a+1,2)},d:function(r,s){return Ae(r.getUTCDate(),s.length)},a:function(r,s){var a=r.getUTCHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h:function(r,s){return Ae(r.getUTCHours()%12||12,s.length)},H:function(r,s){return Ae(r.getUTCHours(),s.length)},m:function(r,s){return Ae(r.getUTCMinutes(),s.length)},s:function(r,s){return Ae(r.getUTCSeconds(),s.length)},S:function(r,s){var a=s.length,n=r.getUTCMilliseconds(),i=Math.floor(n*Math.pow(10,a-3));return Ae(i,s.length)}};const tr=M5;var Dr={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},_5={G:function(r,s,a){var n=r.getUTCFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return a.era(n,{width:"abbreviated"});case"GGGGG":return a.era(n,{width:"narrow"});case"GGGG":default:return a.era(n,{width:"wide"})}},y:function(r,s,a){if(s==="yo"){var n=r.getUTCFullYear(),i=n>0?n:1-n;return a.ordinalNumber(i,{unit:"year"})}return tr.y(r,s)},Y:function(r,s,a,n){var i=xi(r,n),o=i>0?i:1-i;if(s==="YY"){var c=o%100;return Ae(c,2)}return s==="Yo"?a.ordinalNumber(o,{unit:"year"}):Ae(o,s.length)},R:function(r,s){var a=gd(r);return Ae(a,s.length)},u:function(r,s){var a=r.getUTCFullYear();return Ae(a,s.length)},Q:function(r,s,a){var n=Math.ceil((r.getUTCMonth()+1)/3);switch(s){case"Q":return String(n);case"QQ":return Ae(n,2);case"Qo":return a.ordinalNumber(n,{unit:"quarter"});case"QQQ":return a.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(n,{width:"wide",context:"formatting"})}},q:function(r,s,a){var n=Math.ceil((r.getUTCMonth()+1)/3);switch(s){case"q":return String(n);case"qq":return Ae(n,2);case"qo":return a.ordinalNumber(n,{unit:"quarter"});case"qqq":return a.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(n,{width:"wide",context:"standalone"})}},M:function(r,s,a){var n=r.getUTCMonth();switch(s){case"M":case"MM":return tr.M(r,s);case"Mo":return a.ordinalNumber(n+1,{unit:"month"});case"MMM":return a.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(n,{width:"wide",context:"formatting"})}},L:function(r,s,a){var n=r.getUTCMonth();switch(s){case"L":return String(n+1);case"LL":return Ae(n+1,2);case"Lo":return a.ordinalNumber(n+1,{unit:"month"});case"LLL":return a.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(n,{width:"wide",context:"standalone"})}},w:function(r,s,a,n){var i=pd(r,n);return s==="wo"?a.ordinalNumber(i,{unit:"week"}):Ae(i,s.length)},I:function(r,s,a){var n=xd(r);return s==="Io"?a.ordinalNumber(n,{unit:"week"}):Ae(n,s.length)},d:function(r,s,a){return s==="do"?a.ordinalNumber(r.getUTCDate(),{unit:"date"}):tr.d(r,s)},D:function(r,s,a){var n=D5(r);return s==="Do"?a.ordinalNumber(n,{unit:"dayOfYear"}):Ae(n,s.length)},E:function(r,s,a){var n=r.getUTCDay();switch(s){case"E":case"EE":case"EEE":return a.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(n,{width:"short",context:"formatting"});case"EEEE":default:return a.day(n,{width:"wide",context:"formatting"})}},e:function(r,s,a,n){var i=r.getUTCDay(),o=(i-n.weekStartsOn+8)%7||7;switch(s){case"e":return String(o);case"ee":return Ae(o,2);case"eo":return a.ordinalNumber(o,{unit:"day"});case"eee":return a.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(i,{width:"short",context:"formatting"});case"eeee":default:return a.day(i,{width:"wide",context:"formatting"})}},c:function(r,s,a,n){var i=r.getUTCDay(),o=(i-n.weekStartsOn+8)%7||7;switch(s){case"c":return String(o);case"cc":return Ae(o,s.length);case"co":return a.ordinalNumber(o,{unit:"day"});case"ccc":return a.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(i,{width:"narrow",context:"standalone"});case"cccccc":return a.day(i,{width:"short",context:"standalone"});case"cccc":default:return a.day(i,{width:"wide",context:"standalone"})}},i:function(r,s,a){var n=r.getUTCDay(),i=n===0?7:n;switch(s){case"i":return String(i);case"ii":return Ae(i,s.length);case"io":return a.ordinalNumber(i,{unit:"day"});case"iii":return a.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(n,{width:"short",context:"formatting"});case"iiii":default:return a.day(n,{width:"wide",context:"formatting"})}},a:function(r,s,a){var n=r.getUTCHours(),i=n/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(r,s,a){var n=r.getUTCHours(),i;switch(n===12?i=Dr.noon:n===0?i=Dr.midnight:i=n/12>=1?"pm":"am",s){case"b":case"bb":return a.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(r,s,a){var n=r.getUTCHours(),i;switch(n>=17?i=Dr.evening:n>=12?i=Dr.afternoon:n>=4?i=Dr.morning:i=Dr.night,s){case"B":case"BB":case"BBB":return a.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(r,s,a){if(s==="ho"){var n=r.getUTCHours()%12;return n===0&&(n=12),a.ordinalNumber(n,{unit:"hour"})}return tr.h(r,s)},H:function(r,s,a){return s==="Ho"?a.ordinalNumber(r.getUTCHours(),{unit:"hour"}):tr.H(r,s)},K:function(r,s,a){var n=r.getUTCHours()%12;return s==="Ko"?a.ordinalNumber(n,{unit:"hour"}):Ae(n,s.length)},k:function(r,s,a){var n=r.getUTCHours();return n===0&&(n=24),s==="ko"?a.ordinalNumber(n,{unit:"hour"}):Ae(n,s.length)},m:function(r,s,a){return s==="mo"?a.ordinalNumber(r.getUTCMinutes(),{unit:"minute"}):tr.m(r,s)},s:function(r,s,a){return s==="so"?a.ordinalNumber(r.getUTCSeconds(),{unit:"second"}):tr.s(r,s)},S:function(r,s){return tr.S(r,s)},X:function(r,s,a,n){var i=n._originalDate||r,o=i.getTimezoneOffset();if(o===0)return"Z";switch(s){case"X":return cl(o);case"XXXX":case"XX":return hr(o);case"XXXXX":case"XXX":default:return hr(o,":")}},x:function(r,s,a,n){var i=n._originalDate||r,o=i.getTimezoneOffset();switch(s){case"x":return cl(o);case"xxxx":case"xx":return hr(o);case"xxxxx":case"xxx":default:return hr(o,":")}},O:function(r,s,a,n){var i=n._originalDate||r,o=i.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+ll(o,":");case"OOOO":default:return"GMT"+hr(o,":")}},z:function(r,s,a,n){var i=n._originalDate||r,o=i.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+ll(o,":");case"zzzz":default:return"GMT"+hr(o,":")}},t:function(r,s,a,n){var i=n._originalDate||r,o=Math.floor(i.getTime()/1e3);return Ae(o,s.length)},T:function(r,s,a,n){var i=n._originalDate||r,o=i.getTime();return Ae(o,s.length)}};function ll(t,r){var s=t>0?"-":"+",a=Math.abs(t),n=Math.floor(a/60),i=a%60;if(i===0)return s+String(n);var o=r||"";return s+String(n)+o+Ae(i,2)}function cl(t,r){if(t%60===0){var s=t>0?"-":"+";return s+Ae(Math.abs(t)/60,2)}return hr(t,r)}function hr(t,r){var s=r||"",a=t>0?"-":"+",n=Math.abs(t),i=Ae(Math.floor(n/60),2),o=Ae(n%60,2);return a+i+s+o}const A5=_5;var dl=function(r,s){switch(r){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},vd=function(r,s){switch(r){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},R5=function(r,s){var a=r.match(/(P+)(p+)?/)||[],n=a[1],i=a[2];if(!i)return dl(r,s);var o;switch(n){case"P":o=s.dateTime({width:"short"});break;case"PP":o=s.dateTime({width:"medium"});break;case"PPP":o=s.dateTime({width:"long"});break;case"PPPP":default:o=s.dateTime({width:"full"});break}return o.replace("{{date}}",dl(n,s)).replace("{{time}}",vd(i,s))},I5={p:vd,P:R5};const yn=I5;var L5=["D","DD"],U5=["YY","YYYY"];function bd(t){return L5.indexOf(t)!==-1}function yd(t){return U5.indexOf(t)!==-1}function ua(t,r,s){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(r,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(r,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(r,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(r,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var F5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},W5=function(r,s,a){var n,i=F5[r];return typeof i=="string"?n=i:s===1?n=i.one:n=i.other.replace("{{count}}",s.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+n:n+" ago":n};const H5=W5;function Pr(t){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=r.width?String(r.width):t.defaultWidth,a=t.formats[s]||t.formats[t.defaultWidth];return a}}var z5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},B5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Y5={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},q5={date:Pr({formats:z5,defaultWidth:"full"}),time:Pr({formats:B5,defaultWidth:"full"}),dateTime:Pr({formats:Y5,defaultWidth:"full"})};const G5=q5;var V5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},K5=function(r,s,a,n){return V5[r]};const J5=K5;function Ut(t){return function(r,s){var a=s!=null&&s.context?String(s.context):"standalone",n;if(a==="formatting"&&t.formattingValues){var i=t.defaultFormattingWidth||t.defaultWidth,o=s!=null&&s.width?String(s.width):i;n=t.formattingValues[o]||t.formattingValues[i]}else{var c=t.defaultWidth,l=s!=null&&s.width?String(s.width):t.defaultWidth;n=t.values[l]||t.values[c]}var d=t.argumentCallback?t.argumentCallback(r):r;return n[d]}}var X5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Q5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Z5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},eT={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},tT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},rT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},sT=function(r,s){var a=Number(r),n=a%100;if(n>20||n<10)switch(n%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},aT={ordinalNumber:sT,era:Ut({values:X5,defaultWidth:"wide"}),quarter:Ut({values:Q5,defaultWidth:"wide",argumentCallback:function(r){return r-1}}),month:Ut({values:Z5,defaultWidth:"wide"}),day:Ut({values:eT,defaultWidth:"wide"}),dayPeriod:Ut({values:tT,defaultWidth:"wide",formattingValues:rT,defaultFormattingWidth:"wide"})};const nT=aT;function Ft(t){return function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.width,n=a&&t.matchPatterns[a]||t.matchPatterns[t.defaultMatchWidth],i=r.match(n);if(!i)return null;var o=i[0],c=a&&t.parsePatterns[a]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(c)?oT(c,function(x){return x.test(o)}):iT(c,function(x){return x.test(o)}),d;d=t.valueCallback?t.valueCallback(l):l,d=s.valueCallback?s.valueCallback(d):d;var m=r.slice(o.length);return{value:d,rest:m}}}function iT(t,r){for(var s in t)if(t.hasOwnProperty(s)&&r(t[s]))return s}function oT(t,r){for(var s=0;s<t.length;s++)if(r(t[s]))return s}function wd(t){return function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.match(t.matchPattern);if(!a)return null;var n=a[0],i=r.match(t.parsePattern);if(!i)return null;var o=t.valueCallback?t.valueCallback(i[0]):i[0];o=s.valueCallback?s.valueCallback(o):o;var c=r.slice(n.length);return{value:o,rest:c}}}var lT=/^(\d+)(th|st|nd|rd)?/i,cT=/\d+/i,dT={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},uT={any:[/^b/i,/^(a|c)/i]},mT={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},hT={any:[/1/i,/2/i,/3/i,/4/i]},fT={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},gT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},xT={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pT={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},vT={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},bT={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},yT={ordinalNumber:wd({matchPattern:lT,parsePattern:cT,valueCallback:function(r){return parseInt(r,10)}}),era:Ft({matchPatterns:dT,defaultMatchWidth:"wide",parsePatterns:uT,defaultParseWidth:"any"}),quarter:Ft({matchPatterns:mT,defaultMatchWidth:"wide",parsePatterns:hT,defaultParseWidth:"any",valueCallback:function(r){return r+1}}),month:Ft({matchPatterns:fT,defaultMatchWidth:"wide",parsePatterns:gT,defaultParseWidth:"any"}),day:Ft({matchPatterns:xT,defaultMatchWidth:"wide",parsePatterns:pT,defaultParseWidth:"any"}),dayPeriod:Ft({matchPatterns:vT,defaultMatchWidth:"any",parsePatterns:bT,defaultParseWidth:"any"})};const wT=yT;var jT={code:"en-US",formatDistance:H5,formatLong:G5,formatRelative:J5,localize:nT,match:wT,options:{weekStartsOn:0,firstWeekContainsDate:1}};const jd=jT;var NT=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ST=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,kT=/^'([^]*?)'?$/,CT=/''/g,TT=/[a-zA-Z]/;function at(t,r,s){var a,n,i,o,c,l,d,m,x,h,g,v,u,p,w,y,D,f;Oe(2,arguments);var T=String(r),j=Cr(),k=(a=(n=s==null?void 0:s.locale)!==null&&n!==void 0?n:j.locale)!==null&&a!==void 0?a:jd,C=dt((i=(o=(c=(l=s==null?void 0:s.firstWeekContainsDate)!==null&&l!==void 0?l:s==null||(d=s.locale)===null||d===void 0||(m=d.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&c!==void 0?c:j.firstWeekContainsDate)!==null&&o!==void 0?o:(x=j.locale)===null||x===void 0||(h=x.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(C>=1&&C<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var M=dt((g=(v=(u=(p=s==null?void 0:s.weekStartsOn)!==null&&p!==void 0?p:s==null||(w=s.locale)===null||w===void 0||(y=w.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&u!==void 0?u:j.weekStartsOn)!==null&&v!==void 0?v:(D=j.locale)===null||D===void 0||(f=D.options)===null||f===void 0?void 0:f.weekStartsOn)!==null&&g!==void 0?g:0);if(!(M>=0&&M<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!k.localize)throw new RangeError("locale must contain localize property");if(!k.formatLong)throw new RangeError("locale must contain formatLong property");var z=st(t);if(!C5(z))throw new RangeError("Invalid time value");var I=md(z),X=fd(z,I),G={firstWeekContainsDate:C,weekStartsOn:M,locale:k,_originalDate:z},re=T.match(ST).map(function(H){var $=H[0];if($==="p"||$==="P"){var W=yn[$];return W(H,k.formatLong)}return H}).join("").match(NT).map(function(H){if(H==="''")return"'";var $=H[0];if($==="'")return DT(H);var W=A5[$];if(W)return!(s!=null&&s.useAdditionalWeekYearTokens)&&yd(H)&&ua(H,r,String(t)),!(s!=null&&s.useAdditionalDayOfYearTokens)&&bd(H)&&ua(H,r,String(t)),W(X,H,k.localize,G);if($.match(TT))throw new RangeError("Format string contains an unescaped latin alphabet character `"+$+"`");return H}).join("");return re}function DT(t){var r=t.match(kT);return r?r[1].replace(CT,"'"):t}function ET(t,r){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s]);return t}function pi(t){Oe(1,arguments);var r=st(t),s=r.getDay();return s}function ul(t,r){var s=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!s){if(Array.isArray(t)||(s=pa(t))||r&&t&&typeof t.length=="number"){s&&(t=s);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(d){throw d},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,o=!0,c=!1;return{s:function(){s=s.call(t)},n:function(){var d=s.next();return o=d.done,d},e:function(d){c=!0,i=d},f:function(){try{o||s.return==null||s.return()}finally{if(c)throw i}}}}function Ee(t){var r=Dn();return function(){var s,a=Mr(t);if(r){var n=Mr(this).constructor;s=Reflect.construct(a,arguments,n)}else s=a.apply(this,arguments);return Ol(this,s)}}var $T=10,Nd=function(){function t(){xe(this,t),ne(this,"priority",void 0),ne(this,"subPriority",0)}return pe(t,[{key:"validate",value:function(s,a){return!0}}]),t}(),OT=function(t){we(s,t);var r=Ee(s);function s(a,n,i,o,c){var l;return xe(this,s),l=r.call(this),l.value=a,l.validateValue=n,l.setValue=i,l.priority=o,c&&(l.subPriority=c),l}return pe(s,[{key:"validate",value:function(n,i){return this.validateValue(n,this.value,i)}},{key:"set",value:function(n,i,o){return this.setValue(n,i,this.value,o)}}]),s}(Nd),PT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",$T),ne(de(a),"subPriority",-1),a}return pe(s,[{key:"set",value:function(n,i){if(i.timestampIsSet)return n;var o=new Date(0);return o.setFullYear(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()),o.setHours(n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds()),o}}]),s}(Nd),Pe=function(){function t(){xe(this,t),ne(this,"incompatibleTokens",void 0),ne(this,"priority",void 0),ne(this,"subPriority",void 0)}return pe(t,[{key:"run",value:function(s,a,n,i){var o=this.parse(s,a,n,i);return o?{setter:new OT(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(s,a,n){return!0}}]),t}(),MT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",140),ne(de(a),"incompatibleTokens",["R","u","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"G":case"GG":case"GGG":return o.era(n,{width:"abbreviated"})||o.era(n,{width:"narrow"});case"GGGGG":return o.era(n,{width:"narrow"});case"GGGG":default:return o.era(n,{width:"wide"})||o.era(n,{width:"abbreviated"})||o.era(n,{width:"narrow"})}}},{key:"set",value:function(n,i,o){return i.era=o,n.setUTCFullYear(o,0,1),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),Ze={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Wt={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function et(t,r){return t&&{value:r(t.value),rest:t.rest}}function qe(t,r){var s=r.match(t);return s?{value:parseInt(s[0],10),rest:r.slice(s[0].length)}:null}function Ht(t,r){var s=r.match(t);if(!s)return null;if(s[0]==="Z")return{value:0,rest:r.slice(1)};var a=s[1]==="+"?1:-1,n=s[2]?parseInt(s[2],10):0,i=s[3]?parseInt(s[3],10):0,o=s[5]?parseInt(s[5],10):0;return{value:a*(n*N5+i*j5+o*S5),rest:r.slice(s[0].length)}}function Sd(t){return qe(Ze.anyDigitsSigned,t)}function Je(t,r){switch(t){case 1:return qe(Ze.singleDigit,r);case 2:return qe(Ze.twoDigits,r);case 3:return qe(Ze.threeDigits,r);case 4:return qe(Ze.fourDigits,r);default:return qe(new RegExp("^\\d{1,"+t+"}"),r)}}function ma(t,r){switch(t){case 1:return qe(Ze.singleDigitSigned,r);case 2:return qe(Ze.twoDigitsSigned,r);case 3:return qe(Ze.threeDigitsSigned,r);case 4:return qe(Ze.fourDigitsSigned,r);default:return qe(new RegExp("^-?\\d{1,"+t+"}"),r)}}function vi(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function kd(t,r){var s=r>0,a=s?r:1-r,n;if(a<=50)n=t||100;else{var i=a+50,o=Math.floor(i/100)*100,c=t>=i%100;n=t+o-(c?100:0)}return s?n:1-n}function Cd(t){return t%400===0||t%4===0&&t%100!==0}var _T=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",130),ne(de(a),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){var c=function(d){return{year:d,isTwoDigitYear:i==="yy"}};switch(i){case"y":return et(Je(4,n),c);case"yo":return et(o.ordinalNumber(n,{unit:"year"}),c);default:return et(Je(i.length,n),c)}}},{key:"validate",value:function(n,i){return i.isTwoDigitYear||i.year>0}},{key:"set",value:function(n,i,o){var c=n.getUTCFullYear();if(o.isTwoDigitYear){var l=kd(o.year,c);return n.setUTCFullYear(l,0,1),n.setUTCHours(0,0,0,0),n}var d=!("era"in i)||i.era===1?o.year:1-o.year;return n.setUTCFullYear(d,0,1),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),AT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",130),ne(de(a),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){var c=function(d){return{year:d,isTwoDigitYear:i==="YY"}};switch(i){case"Y":return et(Je(4,n),c);case"Yo":return et(o.ordinalNumber(n,{unit:"year"}),c);default:return et(Je(i.length,n),c)}}},{key:"validate",value:function(n,i){return i.isTwoDigitYear||i.year>0}},{key:"set",value:function(n,i,o,c){var l=xi(n,c);if(o.isTwoDigitYear){var d=kd(o.year,l);return n.setUTCFullYear(d,0,c.firstWeekContainsDate),n.setUTCHours(0,0,0,0),Zt(n,c)}var m=!("era"in i)||i.era===1?o.year:1-o.year;return n.setUTCFullYear(m,0,c.firstWeekContainsDate),n.setUTCHours(0,0,0,0),Zt(n,c)}}]),s}(Pe),RT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",130),ne(de(a),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i){return ma(i==="R"?4:i.length,n)}},{key:"set",value:function(n,i,o){var c=new Date(0);return c.setUTCFullYear(o,0,4),c.setUTCHours(0,0,0,0),Fr(c)}}]),s}(Pe),IT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",130),ne(de(a),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i){return ma(i==="u"?4:i.length,n)}},{key:"set",value:function(n,i,o){return n.setUTCFullYear(o,0,1),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),LT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",120),ne(de(a),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"Q":case"QQ":return Je(i.length,n);case"Qo":return o.ordinalNumber(n,{unit:"quarter"});case"QQQ":return o.quarter(n,{width:"abbreviated",context:"formatting"})||o.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(n,{width:"wide",context:"formatting"})||o.quarter(n,{width:"abbreviated",context:"formatting"})||o.quarter(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,i){return i>=1&&i<=4}},{key:"set",value:function(n,i,o){return n.setUTCMonth((o-1)*3,1),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),UT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",120),ne(de(a),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"q":case"qq":return Je(i.length,n);case"qo":return o.ordinalNumber(n,{unit:"quarter"});case"qqq":return o.quarter(n,{width:"abbreviated",context:"standalone"})||o.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(n,{width:"wide",context:"standalone"})||o.quarter(n,{width:"abbreviated",context:"standalone"})||o.quarter(n,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(n,i){return i>=1&&i<=4}},{key:"set",value:function(n,i,o){return n.setUTCMonth((o-1)*3,1),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),FT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),ne(de(a),"priority",110),a}return pe(s,[{key:"parse",value:function(n,i,o){var c=function(d){return d-1};switch(i){case"M":return et(qe(Ze.month,n),c);case"MM":return et(Je(2,n),c);case"Mo":return et(o.ordinalNumber(n,{unit:"month"}),c);case"MMM":return o.month(n,{width:"abbreviated",context:"formatting"})||o.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return o.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(n,{width:"wide",context:"formatting"})||o.month(n,{width:"abbreviated",context:"formatting"})||o.month(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,i){return i>=0&&i<=11}},{key:"set",value:function(n,i,o){return n.setUTCMonth(o,1),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),WT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",110),ne(de(a),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){var c=function(d){return d-1};switch(i){case"L":return et(qe(Ze.month,n),c);case"LL":return et(Je(2,n),c);case"Lo":return et(o.ordinalNumber(n,{unit:"month"}),c);case"LLL":return o.month(n,{width:"abbreviated",context:"standalone"})||o.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return o.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(n,{width:"wide",context:"standalone"})||o.month(n,{width:"abbreviated",context:"standalone"})||o.month(n,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(n,i){return i>=0&&i<=11}},{key:"set",value:function(n,i,o){return n.setUTCMonth(o,1),n.setUTCHours(0,0,0,0),n}}]),s}(Pe);function HT(t,r,s){Oe(2,arguments);var a=st(t),n=dt(r),i=pd(a,s)-n;return a.setUTCDate(a.getUTCDate()-i*7),a}var zT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",100),ne(de(a),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"w":return qe(Ze.week,n);case"wo":return o.ordinalNumber(n,{unit:"week"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){return i>=1&&i<=53}},{key:"set",value:function(n,i,o,c){return Zt(HT(n,o,c),c)}}]),s}(Pe);function BT(t,r){Oe(2,arguments);var s=st(t),a=dt(r),n=xd(s)-a;return s.setUTCDate(s.getUTCDate()-n*7),s}var YT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",100),ne(de(a),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"I":return qe(Ze.week,n);case"Io":return o.ordinalNumber(n,{unit:"week"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){return i>=1&&i<=53}},{key:"set",value:function(n,i,o){return Fr(BT(n,o))}}]),s}(Pe),qT=[31,28,31,30,31,30,31,31,30,31,30,31],GT=[31,29,31,30,31,30,31,31,30,31,30,31],VT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",90),ne(de(a),"subPriority",1),ne(de(a),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"d":return qe(Ze.date,n);case"do":return o.ordinalNumber(n,{unit:"date"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){var o=n.getUTCFullYear(),c=Cd(o),l=n.getUTCMonth();return c?i>=1&&i<=GT[l]:i>=1&&i<=qT[l]}},{key:"set",value:function(n,i,o){return n.setUTCDate(o),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),KT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",90),ne(de(a),"subpriority",1),ne(de(a),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"D":case"DD":return qe(Ze.dayOfYear,n);case"Do":return o.ordinalNumber(n,{unit:"date"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){var o=n.getUTCFullYear(),c=Cd(o);return c?i>=1&&i<=366:i>=1&&i<=365}},{key:"set",value:function(n,i,o){return n.setUTCMonth(0,o),n.setUTCHours(0,0,0,0),n}}]),s}(Pe);function bi(t,r,s){var a,n,i,o,c,l,d,m;Oe(2,arguments);var x=Cr(),h=dt((a=(n=(i=(o=s==null?void 0:s.weekStartsOn)!==null&&o!==void 0?o:s==null||(c=s.locale)===null||c===void 0||(l=c.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&i!==void 0?i:x.weekStartsOn)!==null&&n!==void 0?n:(d=x.locale)===null||d===void 0||(m=d.options)===null||m===void 0?void 0:m.weekStartsOn)!==null&&a!==void 0?a:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=st(t),v=dt(r),u=g.getUTCDay(),p=v%7,w=(p+7)%7,y=(w<h?7:0)+v-u;return g.setUTCDate(g.getUTCDate()+y),g}var JT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",90),ne(de(a),"incompatibleTokens",["D","i","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"E":case"EE":case"EEE":return o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(n,{width:"wide",context:"formatting"})||o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,i){return i>=0&&i<=6}},{key:"set",value:function(n,i,o,c){return n=bi(n,o,c),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),XT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",90),ne(de(a),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o,c){var l=function(m){var x=Math.floor((m-1)/7)*7;return(m+c.weekStartsOn+6)%7+x};switch(i){case"e":case"ee":return et(Je(i.length,n),l);case"eo":return et(o.ordinalNumber(n,{unit:"day"}),l);case"eee":return o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"eeeee":return o.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return o.day(n,{width:"wide",context:"formatting"})||o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,i){return i>=0&&i<=6}},{key:"set",value:function(n,i,o,c){return n=bi(n,o,c),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),QT=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",90),ne(de(a),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o,c){var l=function(m){var x=Math.floor((m-1)/7)*7;return(m+c.weekStartsOn+6)%7+x};switch(i){case"c":case"cc":return et(Je(i.length,n),l);case"co":return et(o.ordinalNumber(n,{unit:"day"}),l);case"ccc":return o.day(n,{width:"abbreviated",context:"standalone"})||o.day(n,{width:"short",context:"standalone"})||o.day(n,{width:"narrow",context:"standalone"});case"ccccc":return o.day(n,{width:"narrow",context:"standalone"});case"cccccc":return o.day(n,{width:"short",context:"standalone"})||o.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return o.day(n,{width:"wide",context:"standalone"})||o.day(n,{width:"abbreviated",context:"standalone"})||o.day(n,{width:"short",context:"standalone"})||o.day(n,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(n,i){return i>=0&&i<=6}},{key:"set",value:function(n,i,o,c){return n=bi(n,o,c),n.setUTCHours(0,0,0,0),n}}]),s}(Pe);function ZT(t,r){Oe(2,arguments);var s=dt(r);s%7===0&&(s=s-7);var a=1,n=st(t),i=n.getUTCDay(),o=s%7,c=(o+7)%7,l=(c<a?7:0)+s-i;return n.setUTCDate(n.getUTCDate()+l),n}var e4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",90),ne(de(a),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){var c=function(d){return d===0?7:d};switch(i){case"i":case"ii":return Je(i.length,n);case"io":return o.ordinalNumber(n,{unit:"day"});case"iii":return et(o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"}),c);case"iiiii":return et(o.day(n,{width:"narrow",context:"formatting"}),c);case"iiiiii":return et(o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"}),c);case"iiii":default:return et(o.day(n,{width:"wide",context:"formatting"})||o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"}),c)}}},{key:"validate",value:function(n,i){return i>=1&&i<=7}},{key:"set",value:function(n,i,o){return n=ZT(n,o),n.setUTCHours(0,0,0,0),n}}]),s}(Pe),t4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",80),ne(de(a),"incompatibleTokens",["b","B","H","k","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"a":case"aa":case"aaa":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(n,{width:"wide",context:"formatting"})||o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(n,i,o){return n.setUTCHours(vi(o),0,0,0),n}}]),s}(Pe),r4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",80),ne(de(a),"incompatibleTokens",["a","B","H","k","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"b":case"bb":case"bbb":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(n,{width:"wide",context:"formatting"})||o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(n,i,o){return n.setUTCHours(vi(o),0,0,0),n}}]),s}(Pe),s4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",80),ne(de(a),"incompatibleTokens",["a","b","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"B":case"BB":case"BBB":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(n,{width:"wide",context:"formatting"})||o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(n,i,o){return n.setUTCHours(vi(o),0,0,0),n}}]),s}(Pe),a4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",70),ne(de(a),"incompatibleTokens",["H","K","k","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"h":return qe(Ze.hour12h,n);case"ho":return o.ordinalNumber(n,{unit:"hour"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){return i>=1&&i<=12}},{key:"set",value:function(n,i,o){var c=n.getUTCHours()>=12;return c&&o<12?n.setUTCHours(o+12,0,0,0):!c&&o===12?n.setUTCHours(0,0,0,0):n.setUTCHours(o,0,0,0),n}}]),s}(Pe),n4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",70),ne(de(a),"incompatibleTokens",["a","b","h","K","k","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"H":return qe(Ze.hour23h,n);case"Ho":return o.ordinalNumber(n,{unit:"hour"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){return i>=0&&i<=23}},{key:"set",value:function(n,i,o){return n.setUTCHours(o,0,0,0),n}}]),s}(Pe),i4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",70),ne(de(a),"incompatibleTokens",["h","H","k","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"K":return qe(Ze.hour11h,n);case"Ko":return o.ordinalNumber(n,{unit:"hour"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){return i>=0&&i<=11}},{key:"set",value:function(n,i,o){var c=n.getUTCHours()>=12;return c&&o<12?n.setUTCHours(o+12,0,0,0):n.setUTCHours(o,0,0,0),n}}]),s}(Pe),o4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",70),ne(de(a),"incompatibleTokens",["a","b","h","H","K","t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"k":return qe(Ze.hour24h,n);case"ko":return o.ordinalNumber(n,{unit:"hour"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){return i>=1&&i<=24}},{key:"set",value:function(n,i,o){var c=o<=24?o%24:o;return n.setUTCHours(c,0,0,0),n}}]),s}(Pe),l4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",60),ne(de(a),"incompatibleTokens",["t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"m":return qe(Ze.minute,n);case"mo":return o.ordinalNumber(n,{unit:"minute"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){return i>=0&&i<=59}},{key:"set",value:function(n,i,o){return n.setUTCMinutes(o,0,0),n}}]),s}(Pe),c4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",50),ne(de(a),"incompatibleTokens",["t","T"]),a}return pe(s,[{key:"parse",value:function(n,i,o){switch(i){case"s":return qe(Ze.second,n);case"so":return o.ordinalNumber(n,{unit:"second"});default:return Je(i.length,n)}}},{key:"validate",value:function(n,i){return i>=0&&i<=59}},{key:"set",value:function(n,i,o){return n.setUTCSeconds(o,0),n}}]),s}(Pe),d4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",30),ne(de(a),"incompatibleTokens",["t","T"]),a}return pe(s,[{key:"parse",value:function(n,i){var o=function(l){return Math.floor(l*Math.pow(10,-i.length+3))};return et(Je(i.length,n),o)}},{key:"set",value:function(n,i,o){return n.setUTCMilliseconds(o),n}}]),s}(Pe),u4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",10),ne(de(a),"incompatibleTokens",["t","T","x"]),a}return pe(s,[{key:"parse",value:function(n,i){switch(i){case"X":return Ht(Wt.basicOptionalMinutes,n);case"XX":return Ht(Wt.basic,n);case"XXXX":return Ht(Wt.basicOptionalSeconds,n);case"XXXXX":return Ht(Wt.extendedOptionalSeconds,n);case"XXX":default:return Ht(Wt.extended,n)}}},{key:"set",value:function(n,i,o){return i.timestampIsSet?n:new Date(n.getTime()-o)}}]),s}(Pe),m4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",10),ne(de(a),"incompatibleTokens",["t","T","X"]),a}return pe(s,[{key:"parse",value:function(n,i){switch(i){case"x":return Ht(Wt.basicOptionalMinutes,n);case"xx":return Ht(Wt.basic,n);case"xxxx":return Ht(Wt.basicOptionalSeconds,n);case"xxxxx":return Ht(Wt.extendedOptionalSeconds,n);case"xxx":default:return Ht(Wt.extended,n)}}},{key:"set",value:function(n,i,o){return i.timestampIsSet?n:new Date(n.getTime()-o)}}]),s}(Pe),h4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",40),ne(de(a),"incompatibleTokens","*"),a}return pe(s,[{key:"parse",value:function(n){return Sd(n)}},{key:"set",value:function(n,i,o){return[new Date(o*1e3),{timestampIsSet:!0}]}}]),s}(Pe),f4=function(t){we(s,t);var r=Ee(s);function s(){var a;xe(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=r.call.apply(r,[this].concat(i)),ne(de(a),"priority",20),ne(de(a),"incompatibleTokens","*"),a}return pe(s,[{key:"parse",value:function(n){return Sd(n)}},{key:"set",value:function(n,i,o){return[new Date(o),{timestampIsSet:!0}]}}]),s}(Pe),g4={G:new MT,y:new _T,Y:new AT,R:new RT,u:new IT,Q:new LT,q:new UT,M:new FT,L:new WT,w:new zT,I:new YT,d:new VT,D:new KT,E:new JT,e:new XT,c:new QT,i:new e4,a:new t4,b:new r4,B:new s4,h:new a4,H:new n4,K:new i4,k:new o4,m:new l4,s:new c4,S:new d4,X:new u4,x:new m4,t:new h4,T:new f4},x4=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,p4=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,v4=/^'([^]*?)'?$/,b4=/''/g,y4=/\S/,w4=/[a-zA-Z]/;function yi(t,r,s,a){var n,i,o,c,l,d,m,x,h,g,v,u,p,w,y,D,f,T;Oe(3,arguments);var j=String(t),k=String(r),C=Cr(),M=(n=(i=a==null?void 0:a.locale)!==null&&i!==void 0?i:C.locale)!==null&&n!==void 0?n:jd;if(!M.match)throw new RangeError("locale must contain match property");var z=dt((o=(c=(l=(d=a==null?void 0:a.firstWeekContainsDate)!==null&&d!==void 0?d:a==null||(m=a.locale)===null||m===void 0||(x=m.options)===null||x===void 0?void 0:x.firstWeekContainsDate)!==null&&l!==void 0?l:C.firstWeekContainsDate)!==null&&c!==void 0?c:(h=C.locale)===null||h===void 0||(g=h.options)===null||g===void 0?void 0:g.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(z>=1&&z<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var I=dt((v=(u=(p=(w=a==null?void 0:a.weekStartsOn)!==null&&w!==void 0?w:a==null||(y=a.locale)===null||y===void 0||(D=y.options)===null||D===void 0?void 0:D.weekStartsOn)!==null&&p!==void 0?p:C.weekStartsOn)!==null&&u!==void 0?u:(f=C.locale)===null||f===void 0||(T=f.options)===null||T===void 0?void 0:T.weekStartsOn)!==null&&v!==void 0?v:0);if(!(I>=0&&I<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(k==="")return j===""?st(s):new Date(NaN);var X={firstWeekContainsDate:z,weekStartsOn:I,locale:M},G=[new PT],re=k.match(p4).map(function(V){var ce=V[0];if(ce in yn){var De=yn[ce];return De(V,M.formatLong)}return V}).join("").match(x4),H=[],$=ul(re),W;try{var Q=function(){var ce=W.value;!(a!=null&&a.useAdditionalWeekYearTokens)&&yd(ce)&&ua(ce,k,t),!(a!=null&&a.useAdditionalDayOfYearTokens)&&bd(ce)&&ua(ce,k,t);var De=ce[0],Ie=g4[De];if(Ie){var Le=Ie.incompatibleTokens;if(Array.isArray(Le)){var Xe=H.find(function(J){return Le.includes(J.token)||J.token===De});if(Xe)throw new RangeError("The format string mustn't contain `".concat(Xe.fullToken,"` and `").concat(ce,"` at the same time"))}else if(Ie.incompatibleTokens==="*"&&H.length>0)throw new RangeError("The format string mustn't contain `".concat(ce,"` and any other token at the same time"));H.push({token:De,fullToken:ce});var Qe=Ie.run(j,ce,M.match,X);if(!Qe)return{v:new Date(NaN)};G.push(Qe.setter),j=Qe.rest}else{if(De.match(w4))throw new RangeError("Format string contains an unescaped latin alphabet character `"+De+"`");if(ce==="''"?ce="'":De==="'"&&(ce=j4(ce)),j.indexOf(ce)===0)j=j.slice(ce.length);else return{v:new Date(NaN)}}};for($.s();!(W=$.n()).done;){var te=Q();if(Ot(te)==="object")return te.v}}catch(V){$.e(V)}finally{$.f()}if(j.length>0&&y4.test(j))return new Date(NaN);var me=G.map(function(V){return V.priority}).sort(function(V,ce){return ce-V}).filter(function(V,ce,De){return De.indexOf(V)===ce}).map(function(V){return G.filter(function(ce){return ce.priority===V}).sort(function(ce,De){return De.subPriority-ce.subPriority})}).map(function(V){return V[0]}),ve=st(s);if(isNaN(ve.getTime()))return new Date(NaN);var Ne=fd(ve,md(ve)),he={},Te=ul(me),Z;try{for(Te.s();!(Z=Te.n()).done;){var K=Z.value;if(!K.validate(Ne,X))return new Date(NaN);var je=K.set(Ne,he,X);Array.isArray(je)?(Ne=je[0],ET(he,je[1])):Ne=je}}catch(V){Te.e(V)}finally{Te.f()}return Ne}function j4(t){return t.match(v4)[1].replace(b4,"'")}function N4(t,r,s){Oe(2,arguments);var a=Cs(t,s),n=Cs(r,s);return a.getTime()===n.getTime()}function S4(t,r){return Oe(1,arguments),N4(t,Date.now(),r)}function ml(t){return Oe(1,arguments),hd(t,Date.now())}function k4(t,r){Oe(2,arguments);var s=dt(r);return b5(t,-s)}function hl(t){return Oe(1,arguments),hd(t,k4(Date.now(),1))}function fl(t,r,s){Oe(2,arguments);var a=Zt(t,s),n=Zt(r,s);return a.getTime()===n.getTime()}function ts(t,r){if(t.one!==void 0&&r===1)return t.one;var s=r%10,a=r%100;return s===1&&a!==11?t.singularNominative.replace("{{count}}",String(r)):s>=2&&s<=4&&(a<10||a>20)?t.singularGenitive.replace("{{count}}",String(r)):t.pluralGenitive.replace("{{count}}",String(r))}function gt(t){return function(r,s){return s!=null&&s.addSuffix?s.comparison&&s.comparison>0?t.future?ts(t.future,r):"через "+ts(t.regular,r):t.past?ts(t.past,r):ts(t.regular,r)+" назад":ts(t.regular,r)}}var C4={lessThanXSeconds:gt({regular:{one:"меньше секунды",singularNominative:"меньше {{count}} секунды",singularGenitive:"меньше {{count}} секунд",pluralGenitive:"меньше {{count}} секунд"},future:{one:"меньше, чем через секунду",singularNominative:"меньше, чем через {{count}} секунду",singularGenitive:"меньше, чем через {{count}} секунды",pluralGenitive:"меньше, чем через {{count}} секунд"}}),xSeconds:gt({regular:{singularNominative:"{{count}} секунда",singularGenitive:"{{count}} секунды",pluralGenitive:"{{count}} секунд"},past:{singularNominative:"{{count}} секунду назад",singularGenitive:"{{count}} секунды назад",pluralGenitive:"{{count}} секунд назад"},future:{singularNominative:"через {{count}} секунду",singularGenitive:"через {{count}} секунды",pluralGenitive:"через {{count}} секунд"}}),halfAMinute:function(r,s){return s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"через полминуты":"полминуты назад":"полминуты"},lessThanXMinutes:gt({regular:{one:"меньше минуты",singularNominative:"меньше {{count}} минуты",singularGenitive:"меньше {{count}} минут",pluralGenitive:"меньше {{count}} минут"},future:{one:"меньше, чем через минуту",singularNominative:"меньше, чем через {{count}} минуту",singularGenitive:"меньше, чем через {{count}} минуты",pluralGenitive:"меньше, чем через {{count}} минут"}}),xMinutes:gt({regular:{singularNominative:"{{count}} минута",singularGenitive:"{{count}} минуты",pluralGenitive:"{{count}} минут"},past:{singularNominative:"{{count}} минуту назад",singularGenitive:"{{count}} минуты назад",pluralGenitive:"{{count}} минут назад"},future:{singularNominative:"через {{count}} минуту",singularGenitive:"через {{count}} минуты",pluralGenitive:"через {{count}} минут"}}),aboutXHours:gt({regular:{singularNominative:"около {{count}} часа",singularGenitive:"около {{count}} часов",pluralGenitive:"около {{count}} часов"},future:{singularNominative:"приблизительно через {{count}} час",singularGenitive:"приблизительно через {{count}} часа",pluralGenitive:"приблизительно через {{count}} часов"}}),xHours:gt({regular:{singularNominative:"{{count}} час",singularGenitive:"{{count}} часа",pluralGenitive:"{{count}} часов"}}),xDays:gt({regular:{singularNominative:"{{count}} день",singularGenitive:"{{count}} дня",pluralGenitive:"{{count}} дней"}}),aboutXWeeks:gt({regular:{singularNominative:"около {{count}} недели",singularGenitive:"около {{count}} недель",pluralGenitive:"около {{count}} недель"},future:{singularNominative:"приблизительно через {{count}} неделю",singularGenitive:"приблизительно через {{count}} недели",pluralGenitive:"приблизительно через {{count}} недель"}}),xWeeks:gt({regular:{singularNominative:"{{count}} неделя",singularGenitive:"{{count}} недели",pluralGenitive:"{{count}} недель"}}),aboutXMonths:gt({regular:{singularNominative:"около {{count}} месяца",singularGenitive:"около {{count}} месяцев",pluralGenitive:"около {{count}} месяцев"},future:{singularNominative:"приблизительно через {{count}} месяц",singularGenitive:"приблизительно через {{count}} месяца",pluralGenitive:"приблизительно через {{count}} месяцев"}}),xMonths:gt({regular:{singularNominative:"{{count}} месяц",singularGenitive:"{{count}} месяца",pluralGenitive:"{{count}} месяцев"}}),aboutXYears:gt({regular:{singularNominative:"около {{count}} года",singularGenitive:"около {{count}} лет",pluralGenitive:"около {{count}} лет"},future:{singularNominative:"приблизительно через {{count}} год",singularGenitive:"приблизительно через {{count}} года",pluralGenitive:"приблизительно через {{count}} лет"}}),xYears:gt({regular:{singularNominative:"{{count}} год",singularGenitive:"{{count}} года",pluralGenitive:"{{count}} лет"}}),overXYears:gt({regular:{singularNominative:"больше {{count}} года",singularGenitive:"больше {{count}} лет",pluralGenitive:"больше {{count}} лет"},future:{singularNominative:"больше, чем через {{count}} год",singularGenitive:"больше, чем через {{count}} года",pluralGenitive:"больше, чем через {{count}} лет"}}),almostXYears:gt({regular:{singularNominative:"почти {{count}} год",singularGenitive:"почти {{count}} года",pluralGenitive:"почти {{count}} лет"},future:{singularNominative:"почти через {{count}} год",singularGenitive:"почти через {{count}} года",pluralGenitive:"почти через {{count}} лет"}})},T4=function(r,s,a){return C4[r](s,a)};const D4=T4;var E4={full:"EEEE, d MMMM y 'г.'",long:"d MMMM y 'г.'",medium:"d MMM y 'г.'",short:"dd.MM.y"},$4={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},O4={any:"{{date}}, {{time}}"},P4={date:Pr({formats:E4,defaultWidth:"full"}),time:Pr({formats:$4,defaultWidth:"full"}),dateTime:Pr({formats:O4,defaultWidth:"any"})};const M4=P4;var wi=["воскресенье","понедельник","вторник","среду","четверг","пятницу","субботу"];function _4(t){var r=wi[t];switch(t){case 0:return"'в прошлое "+r+" в' p";case 1:case 2:case 4:return"'в прошлый "+r+" в' p";case 3:case 5:case 6:return"'в прошлую "+r+" в' p"}}function gl(t){var r=wi[t];return t===2?"'во "+r+" в' p":"'в "+r+" в' p"}function A4(t){var r=wi[t];switch(t){case 0:return"'в следующее "+r+" в' p";case 1:case 2:case 4:return"'в следующий "+r+" в' p";case 3:case 5:case 6:return"'в следующую "+r+" в' p"}}var R4={lastWeek:function(r,s,a){var n=r.getUTCDay();return fl(r,s,a)?gl(n):_4(n)},yesterday:"'вчера в' p",today:"'сегодня в' p",tomorrow:"'завтра в' p",nextWeek:function(r,s,a){var n=r.getUTCDay();return fl(r,s,a)?gl(n):A4(n)},other:"P"},I4=function(r,s,a,n){var i=R4[r];return typeof i=="function"?i(s,a,n):i};const L4=I4;var U4={narrow:["до н.э.","н.э."],abbreviated:["до н. э.","н. э."],wide:["до нашей эры","нашей эры"]},F4={narrow:["1","2","3","4"],abbreviated:["1-й кв.","2-й кв.","3-й кв.","4-й кв."],wide:["1-й квартал","2-й квартал","3-й квартал","4-й квартал"]},W4={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],wide:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"]},H4={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],wide:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"]},z4={narrow:["В","П","В","С","Ч","П","С"],short:["вс","пн","вт","ср","чт","пт","сб"],abbreviated:["вск","пнд","втр","срд","чтв","птн","суб"],wide:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"]},B4={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утро",afternoon:"день",evening:"вечер",night:"ночь"}},Y4={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утра",afternoon:"дня",evening:"вечера",night:"ночи"}},q4=function(r,s){var a=Number(r),n=s==null?void 0:s.unit,i;return n==="date"?i="-е":n==="week"||n==="minute"||n==="second"?i="-я":i="-й",a+i},G4={ordinalNumber:q4,era:Ut({values:U4,defaultWidth:"wide"}),quarter:Ut({values:F4,defaultWidth:"wide",argumentCallback:function(r){return r-1}}),month:Ut({values:W4,defaultWidth:"wide",formattingValues:H4,defaultFormattingWidth:"wide"}),day:Ut({values:z4,defaultWidth:"wide"}),dayPeriod:Ut({values:B4,defaultWidth:"any",formattingValues:Y4,defaultFormattingWidth:"wide"})};const V4=G4;var K4=/^(\d+)(-?(е|я|й|ое|ье|ая|ья|ый|ой|ий|ый))?/i,J4=/\d+/i,X4={narrow:/^((до )?н\.?\s?э\.?)/i,abbreviated:/^((до )?н\.?\s?э\.?)/i,wide:/^(до нашей эры|нашей эры|наша эра)/i},Q4={any:[/^д/i,/^н/i]},Z4={narrow:/^[1234]/i,abbreviated:/^[1234](-?[ыои]?й?)? кв.?/i,wide:/^[1234](-?[ыои]?й?)? квартал/i},e3={any:[/1/i,/2/i,/3/i,/4/i]},t3={narrow:/^[яфмаисонд]/i,abbreviated:/^(янв|фев|март?|апр|ма[йя]|июн[ья]?|июл[ья]?|авг|сент?|окт|нояб?|дек)\.?/i,wide:/^(январ[ья]|феврал[ья]|марта?|апрел[ья]|ма[йя]|июн[ья]|июл[ья]|августа?|сентябр[ья]|октябр[ья]|октябр[ья]|ноябр[ья]|декабр[ья])/i},r3={narrow:[/^я/i,/^ф/i,/^м/i,/^а/i,/^м/i,/^и/i,/^и/i,/^а/i,/^с/i,/^о/i,/^н/i,/^я/i],any:[/^я/i,/^ф/i,/^мар/i,/^ап/i,/^ма[йя]/i,/^июн/i,/^июл/i,/^ав/i,/^с/i,/^о/i,/^н/i,/^д/i]},s3={narrow:/^[впсч]/i,short:/^(вс|во|пн|по|вт|ср|чт|че|пт|пя|сб|су)\.?/i,abbreviated:/^(вск|вос|пнд|пон|втр|вто|срд|сре|чтв|чет|птн|пят|суб).?/i,wide:/^(воскресень[ея]|понедельника?|вторника?|сред[аы]|четверга?|пятниц[аы]|суббот[аы])/i},a3={narrow:[/^в/i,/^п/i,/^в/i,/^с/i,/^ч/i,/^п/i,/^с/i],any:[/^в[ос]/i,/^п[он]/i,/^в/i,/^ср/i,/^ч/i,/^п[ят]/i,/^с[уб]/i]},n3={narrow:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,abbreviated:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,wide:/^([дп]п|полночь|полдень|утр[оа]|день|дня|вечера?|ноч[ьи])/i},i3={any:{am:/^дп/i,pm:/^пп/i,midnight:/^полн/i,noon:/^полд/i,morning:/^у/i,afternoon:/^д[ен]/i,evening:/^в/i,night:/^н/i}},o3={ordinalNumber:wd({matchPattern:K4,parsePattern:J4,valueCallback:function(r){return parseInt(r,10)}}),era:Ft({matchPatterns:X4,defaultMatchWidth:"wide",parsePatterns:Q4,defaultParseWidth:"any"}),quarter:Ft({matchPatterns:Z4,defaultMatchWidth:"wide",parsePatterns:e3,defaultParseWidth:"any",valueCallback:function(r){return r+1}}),month:Ft({matchPatterns:t3,defaultMatchWidth:"wide",parsePatterns:r3,defaultParseWidth:"any"}),day:Ft({matchPatterns:s3,defaultMatchWidth:"wide",parsePatterns:a3,defaultParseWidth:"any"}),dayPeriod:Ft({matchPatterns:n3,defaultMatchWidth:"wide",parsePatterns:i3,defaultParseWidth:"any"})};const l3=o3;var c3={code:"ru",formatDistance:D4,formatLong:M4,formatRelative:L4,localize:V4,match:l3,options:{weekStartsOn:1,firstWeekContainsDate:1}};const Dt=c3;const ji=({isOpen:t,onClose:r,onConfirm:s,slot:a,teacher:n,student:i})=>{var v;const[o,c]=N.useState(""),[l,d]=N.useState(!1),m=async()=>{d(!0);try{await s(o),r()}catch{}finally{d(!1)}},x=u=>{switch(u){case"online":return e.jsx(Be,{className:"h-4 w-4"});case"offline":return e.jsx(Nt,{className:"h-4 w-4"});case"mini-group":return e.jsx(us,{className:"h-4 w-4"});default:return e.jsx(Be,{className:"h-4 w-4"})}},h=u=>{switch(u){case"online":return"Онлайн";case"offline":return"Очно";case"mini-group":return"Мини-группа";default:return u}},g=u=>{switch(u){case"regular":return"Обычный урок";case"consultation":return"Консультация";case"exam_prep":return"Подготовка к экзамену";case"homework_help":return"Помощь с домашним заданием";default:return u}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Подтверждение бронирования"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(nt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Преподаватель"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[n!=null&&n.avatar?e.jsx("img",{src:n.avatar,alt:n.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:(n==null?void 0:n.name)||"Преподаватель"}),e.jsx("p",{className:"text-sm text-gray-600",children:a==null?void 0:a.subject}),((v=n==null?void 0:n.profile)==null?void 0:v.rating)&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-yellow-500",children:"★"}),e.jsx("span",{className:"text-sm text-gray-600 ml-1",children:n.profile.rating})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Детали урока"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(lt,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Дата: ",new Date(a==null?void 0:a.date).toLocaleDateString("ru-RU")]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Rt,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Время: ",a==null?void 0:a.startTime," - ",a==null?void 0:a.endTime]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Be,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Предмет: ",a==null?void 0:a.subject]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[x(a==null?void 0:a.format),e.jsxs("span",{className:"text-sm",children:["Формат: ",h(a==null?void 0:a.format)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(uu,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Тип: ",g(a==null?void 0:a.lessonType)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-700",children:[e.jsx(Nl,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:["Стоимость: ",a==null?void 0:a.price," ₽"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Студент"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[i!=null&&i.avatar?e.jsx("img",{src:i.avatar,alt:i.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:i==null?void 0:i.name}),e.jsx("p",{className:"text-sm text-gray-600",children:"Студент"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Примечание к уроку"}),e.jsx("textarea",{value:o,onChange:u=>c(u.target.value),placeholder:"Опишите ваши цели, задачи или особые пожелания к уроку...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:4}),e.jsx("p",{className:"text-sm text-gray-500",children:"Это поможет преподавателю лучше подготовиться к уроку"})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Отмена"}),e.jsx("button",{onClick:m,disabled:l,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Бронирование..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать урок"})]})})]})]})}):null},Td=({teacher:t,onClose:r,onBookLesson:s,onMessage:a})=>{var Te;const{user:n}=it(),{timeSlots:i,bookLesson:o,posts:c,createPost:l,addReaction:d,addComment:m,sharePost:x,bookmarkPost:h,editPost:g,deletePost:v}=ht(),[u,p]=N.useState(!1),[w,y]=N.useState(!1),[D,f]=N.useState(!1),[T,j]=N.useState(!1),[k,C]=N.useState(!1),[M,z]=N.useState(null),[I,X]=N.useState("about");N.useState(null),N.useState({});const G=i.filter(Z=>Z.teacherId===t.id),re=G.filter(Z=>!Z.isBooked),H=G.filter(Z=>Z.isBooked),$=t.profile,W=c.filter(Z=>Z.userId===t.id),Q=Z=>{switch(Z){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return Z}},te=Z=>{switch(Z){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}},me=Z=>{switch(Z){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return Z}},ve=Z=>{z(Z),C(!0)},Ne=async Z=>{n&&M&&(o(M.id,n.id,n.name,Z),C(!1),z(null))},he=(Z,K)=>new Date(`${Z}T${K}`).toLocaleDateString("ru-RU",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(jn,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>y(!w),className:`p-2 rounded-full transition-colors ${w?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(fa,{className:`w-5 h-5 ${w?"fill-current":""}`})}),e.jsx("button",{onClick:()=>p(!u),className:`p-2 rounded-full transition-colors ${u?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(jt,{className:`w-5 h-5 ${u?"fill-current":""}`})}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(rr,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsxs("div",{className:"h-56 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"}),e.jsx("div",{className:"absolute bottom-6 left-8 right-8",children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"text-white flex-1 mr-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 leading-tight",children:($==null?void 0:$.name)||t.name||"Репетитор"}),e.jsxs("div",{className:"flex items-center space-x-4 flex-wrap",children:[($==null?void 0:$.experience)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Jt,{className:"h-4 w-4 text-yellow-300"}),e.jsx("span",{className:"font-semibold text-xs",children:Q($.experience)})]}),($==null?void 0:$.rating)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(zt,{className:"h-4 w-4 text-yellow-300 fill-current"}),e.jsx("span",{className:"font-semibold text-xs",children:$.rating})]}),($==null?void 0:$.city)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Nt,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-xs",children:$.city})]})]})]}),e.jsxs("div",{className:"text-right text-white/90 flex-shrink-0",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:($==null?void 0:$.lessonsCount)||0}),e.jsx("div",{className:"text-sm opacity-80",children:"уроков"})]})]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start mt-8",children:[e.jsxs("div",{className:"flex-shrink-0 -mt-12 ml-8 relative",children:[e.jsxs("div",{className:"w-36 h-36 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-6 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-3 border-white rounded-full shadow-lg"}),$!=null&&$.avatar&&$.avatar.trim()!==""&&$.avatar!=="undefined"&&$.avatar!=="null"?e.jsx("img",{src:$.avatar,alt:($==null?void 0:$.name)||t.name||"Репетитор",className:"w-36 h-36 object-cover rounded-full",onError:Z=>{const K=Z.target;K.style.display="none";const je=K.nextElementSibling;je&&je.classList.remove("hidden")},onLoad:Z=>{const je=Z.target.nextElementSibling;je&&je.classList.add("hidden")}}):null,e.jsx("div",{className:`w-36 h-36 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${$!=null&&$.avatar&&$.avatar.trim()!==""&&$.avatar!=="undefined"&&$.avatar!=="null"?"hidden":""}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"h-16 w-16 text-white mb-2"}),e.jsx("div",{className:"text-white text-sm font-semibold",children:(($==null?void 0:$.name)||t.name||"Репетитор").charAt(0).toUpperCase()})]})})]}),e.jsxs("div",{className:"absolute -bottom-2 -right-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>p(!u),className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${u?"bg-red-500 text-white scale-110":"bg-white text-gray-600 hover:bg-red-50 hover:text-red-500"}`,children:e.jsx(jt,{className:`w-5 h-5 ${u?"fill-current":""}`})}),e.jsx("button",{className:"w-10 h-10 rounded-full bg-white text-gray-600 hover:bg-gray-50 shadow-lg transition-all duration-200 flex items-center justify-center",children:e.jsx(rr,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-wrap gap-4 mt-12 lg:mt-0",children:[e.jsxs("button",{onClick:()=>s(t.id),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Be,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Записаться на урок"})]}),a&&e.jsxs("button",{onClick:()=>a(t.id),className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-2xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(tt,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Написать сообщение"})]}),e.jsxs("button",{onClick:()=>j(!T),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(lt,{className:"h-6 w-6"}),e.jsxs("span",{className:"text-lg",children:["Слоты (",re.length,")"]})]}),e.jsxs("button",{onClick:()=>f(!D),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(sr,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Контактная информация"})]})]})]})]}),D&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 mb-8 mt-8 border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-lg",children:"Контактная информация"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.phone&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx($t,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:t.phone})]}),t.email&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(Sn,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:t.email})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6 mt-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:($==null?void 0:$.lessonsCount)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Проведено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:((Te=$==null?void 0:$.students)==null?void 0:Te.length)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Учеников"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:($==null?void 0:$.rating)||0}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Рейтинг"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:re.length}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Свободных слотов"})]})]}),W.length>0&&e.jsxs("div",{className:"mb-8 mt-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx(ar,{className:"w-5 h-5 mr-2 text-blue-600"}),"Записи ",($==null?void 0:$.name)||t.name,e.jsx("span",{className:"ml-2 bg-blue-100 text-blue-800 py-0.5 px-2 rounded-full text-sm",children:W.length})]})}),e.jsxs("div",{className:"space-y-4",children:[W.slice(0,3).map(Z=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:(($==null?void 0:$.name)||t.name).charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:($==null?void 0:$.name)||t.name}),e.jsx("span",{className:"text-gray-500 text-sm",children:new Date(Z.date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})})]}),e.jsx("div",{className:"text-gray-700 mb-3 whitespace-pre-line",children:Z.text.length>200?`${Z.text.substring(0,200)}...`:Z.text}),Z.tags&&Z.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[Z.tags.slice(0,3).map((K,je)=>e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-1 rounded-md text-xs font-medium",children:["#",K]},je)),Z.tags.length>3&&e.jsxs("span",{className:"text-gray-500 text-xs",children:["+",Z.tags.length-3," еще"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(jt,{className:"w-4 h-4"}),e.jsx("span",{children:Z.likes||Z.reactions.length})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(tt,{className:"w-4 h-4"}),e.jsx("span",{children:Z.comments.length})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(sr,{className:"w-4 h-4"}),e.jsx("span",{children:Z.views||0})]})]})]})]})},Z.id)),W.length>3&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"text-blue-600 hover:text-blue-800 font-medium",children:["Показать все записи (",W.length,")"]})})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8 mt-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"about",label:"О преподавателе",count:null},{id:"slots",label:"Расписание",count:re.length},{id:"reviews",label:"Отзывы",count:0}].map(Z=>e.jsxs("button",{onClick:()=>X(Z.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${I===Z.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[Z.label,Z.count!==null&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2 rounded-full text-xs",children:Z.count})]},Z.id))})}),e.jsxs("div",{className:"min-h-[400px]",children:[I==="about"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Основная информация"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Имя"}),e.jsx("div",{className:"font-semibold text-gray-900",children:($==null?void 0:$.name)||t.name||"Репетитор"})]})]}),($==null?void 0:$.experience)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Jt,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Опыт"}),e.jsx("div",{className:"font-semibold text-gray-900",children:Q($.experience)})]})]}),($==null?void 0:$.experienceYears)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ts,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Лет преподавания"}),e.jsx("div",{className:"font-semibold text-gray-900",children:$.experienceYears})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fr,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Тип преподавателя"}),e.jsx("div",{className:"font-semibold text-gray-900",children:te(($==null?void 0:$.teacherType)||"private")})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[($==null?void 0:$.rating)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(zt,{className:"w-5 h-5 text-yellow-500 fill-current"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Рейтинг"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[$.rating,"/5"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Be,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Проведено уроков"}),e.jsx("div",{className:"font-semibold text-gray-900",children:($==null?void 0:$.lessonsCount)||0})]})]}),($==null?void 0:$.hourlyRate)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-green-600 font-bold text-lg",children:"₽"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Стоимость урока"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[$.hourlyRate," ₽/час"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[($==null?void 0:$.subjects)&&$.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-green-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-green-500 to-emerald-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Предметы"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:$.subjects.map((Z,K)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-green-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-green-200/50 shadow-sm",children:Z},K))})]}),($==null?void 0:$.grades)&&$.grades.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-purple-500 to-pink-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Классы"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:$.grades.map((Z,K)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-purple-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-purple-200/50 shadow-sm",children:Z},K))})]})]}),($==null?void 0:$.education)&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-orange-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-orange-500 to-red-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Образование"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[$.education.university&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"🎓"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Университет"}),e.jsx("div",{className:"font-semibold text-gray-900",children:$.education.university})]})]}),$.education.degree&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"📜"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Степень"}),e.jsx("div",{className:"font-semibold text-gray-900",children:$.education.degree})]})]}),$.education.graduationYear&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-orange-600 font-bold text-lg",children:"📅"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Год выпуска"}),e.jsx("div",{className:"font-semibold text-gray-900",children:$.education.graduationYear})]})]})]})]}),($==null?void 0:$.bio)&&e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-indigo-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-indigo-500 to-purple-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"О преподавателе"]}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm rounded-lg p-4 border border-indigo-200/50",children:e.jsx("p",{className:"text-indigo-800 leading-relaxed whitespace-pre-line",children:$.bio})})]}),($==null?void 0:$.formats)&&$.formats.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 border border-teal-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-teal-900 mb-4 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-teal-500 to-cyan-600 rounded flex items-center justify-center mr-3",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"})}),"Форматы обучения"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:$.formats.map((Z,K)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-teal-800 px-3 py-1.5 rounded-lg text-sm font-medium border border-teal-200/50 shadow-sm",children:me(Z)},K))})]})]}),I==="slots"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Доступные слоты"}),re.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:re.map(Z=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:Z.subject}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx("span",{children:he(Z.date,Z.startTime)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Nt,{className:"h-4 w-4"}),e.jsx("span",{children:me(Z.format)})]})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600 mt-3",children:[Z.price," ₽"]})]})}),e.jsxs("button",{onClick:()=>ve(Z),className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать"})]})]},Z.id))}):e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-8 text-center",children:[e.jsx(lt,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg mb-2",children:"Нет доступных слотов"}),e.jsx("p",{className:"text-gray-500",children:"Попробуйте позже или свяжитесь с преподавателем"})]})]}),H.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Забронированные уроки"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:H.map(Z=>e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:Z.subject}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx("span",{children:he(Z.date,Z.startTime)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Nt,{className:"h-4 w-4"}),e.jsx("span",{children:me(Z.format)})]})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-600 mt-3",children:[Z.price," ₽"]})]})}),e.jsx("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded-xl text-sm font-medium text-center",children:"Забронировано"})]},Z.id))})]})]}),I==="reviews"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(zt,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пока нет отзывов"}),e.jsx("p",{className:"text-gray-500",children:"Будьте первым, кто оставит отзыв о преподавателе"})]})]})]})]}),k&&M&&e.jsx(ji,{isOpen:k,slot:M,onClose:()=>C(!1),onConfirm:Ne,teacher:t,student:n})]})},d3=({teacher:t,onClose:r,onBookLesson:s,onMessage:a})=>{var I,X,G,re;const{timeSlots:n,posts:i,lessons:o,refreshUsers:c,forceSyncData:l}=ht(),[d,m]=N.useState(!1),[x,h]=N.useState(!1),[g,v]=N.useState(!1),u=async()=>{var H,$;v(!0);try{const W=await fetch(`${ze}/api/users/${t.id}`);if(W.ok){const Q=await W.json();console.log("Fresh teacher data from refresh button:",Q);const me=JSON.parse(localStorage.getItem("allUsers")||"[]").map(Ne=>Ne.id===Q.id?Q:Ne);localStorage.setItem("allUsers",JSON.stringify(me)),c(),await l();const ve={...t,name:Q.name||t.name,email:Q.email||t.email,avatar:((H=Q.profile)==null?void 0:H.avatar)||Q.avatar||t.avatar,profile:{...t.profile,...Q.profile,avatar:(($=Q.profile)==null?void 0:$.avatar)||Q.avatar||t.avatar,name:Q.name||t.name,email:Q.email||t.email}};console.log("Updated teacher data in modal:",ve)}else console.warn("Failed to refresh teacher data:",W.status)}catch(W){console.error("Error refreshing teacher data:",W)}finally{v(!1)}},p=t.profile;console.log("Teacher in modal:",t),console.log("Profile in modal:",p),N.useEffect(()=>{(async()=>{var $,W;try{const Q=await fetch(`${ze}/api/users/${t.id}`);if(Q.ok){const te=await Q.json();console.log("Fresh teacher data in modal:",te);const ve=JSON.parse(localStorage.getItem("allUsers")||"[]").map(he=>he.id===te.id?te:he);localStorage.setItem("allUsers",JSON.stringify(ve)),c(),await l();const Ne={...t,name:te.name||t.name,email:te.email||t.email,avatar:(($=te.profile)==null?void 0:$.avatar)||te.avatar||t.avatar,profile:{...t.profile,...te.profile,avatar:((W=te.profile)==null?void 0:W.avatar)||te.avatar||t.avatar,name:te.name||t.name,email:te.email||t.email}};console.log("Updated teacher data in modal useEffect:",Ne)}else console.warn("Failed to refresh teacher data in modal:",Q.status)}catch(Q){console.error("Error refreshing teacher data in modal:",Q)}})()},[t.id]);const y=n.filter(H=>H.teacherId===t.id).filter(H=>!H.isBooked),D=i.filter(H=>H.userId===t.id),T=o.filter(H=>H.teacherId===t.id).filter(H=>H.status==="completed"),j=H=>{switch(H){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return H}},k=H=>{switch(H){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}},C=H=>{switch(H){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return H}},M=H=>{const $=new Date(H),Q=Math.floor((new Date().getTime()-$.getTime())/(1e3*60*60));return Q<1?"только что":Q<24?`${Q}ч назад`:Q<48?"вчера":$.toLocaleDateString("ru-RU")},z=H=>new Date(H).toLocaleDateString("ru-RU",{weekday:"short",month:"short",day:"numeric"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(nt,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>h(!x),className:`p-2 rounded-full transition-colors ${x?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(fa,{className:`w-5 h-5 ${x?"fill-current":""}`})}),e.jsx("button",{onClick:()=>m(!d),className:`p-2 rounded-full transition-colors ${d?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(jt,{className:`w-5 h-5 ${d?"fill-current":""}`})}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(rr,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-6 mb-6",children:[e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-lg relative",children:[e.jsx("div",{className:"absolute top-1 right-1 w-4 h-4 bg-green-500 border-2 border-white rounded-full shadow-sm"}),(()=>{const H=(p==null?void 0:p.avatar)||t.avatar;return H&&H.trim()!==""&&H!=="undefined"&&H!=="null"?e.jsx("img",{src:H,alt:t.name,className:"w-24 h-24 object-cover rounded-full",onError:W=>{const Q=W.target;Q.style.display="none";const te=Q.nextElementSibling;te&&te.classList.remove("hidden")},onLoad:W=>{const te=W.target.nextElementSibling;te&&te.classList.add("hidden")}}):null})(),e.jsx("div",{className:`w-24 h-24 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${(()=>{const H=(p==null?void 0:p.avatar)||t.avatar;return H&&H.trim()!==""&&H!=="undefined"&&H!=="null"?"hidden":""})()}`,children:e.jsx(Ce,{className:"h-12 w-12 text-white"})})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:u,disabled:g,className:"p-2 text-gray-400 hover:text-blue-600 transition-colors disabled:opacity-50",title:"Обновить данные",children:e.jsx(ea,{className:`w-5 h-5 ${g?"animate-spin":""}`})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(rr,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[(p==null?void 0:p.rating)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(zt,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{children:p.rating})]}),(p==null?void 0:p.lessonsCount)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsxs("span",{children:[p.lessonsCount," уроков"]})]}),(p==null?void 0:p.experienceYears)&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Jt,{className:"w-4 h-4"}),e.jsxs("span",{children:[p.experienceYears," лет опыта"]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-3",children:"Статистика"}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600 mb-1",children:T.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Проведено уроков"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600 mb-1",children:y.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Свободных слотов"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600 mb-1",children:D.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Записей"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600 mb-1",children:(p==null?void 0:p.reviewsCount)||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Отзывов"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>s(t.id),className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(Be,{className:"w-5 h-5"}),e.jsx("span",{children:"Записаться на урок"})]}),e.jsxs("button",{onClick:()=>a(t.id),className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(tt,{className:"w-5 h-5"}),e.jsx("span",{children:"Написать сообщение"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"О преподавателе"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Be,{className:"w-3 h-3 mr-1"}),"Предметы:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((I=p==null?void 0:p.subjects)==null?void 0:I.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:p.subjects.map((H,$)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium",children:H},$))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(fr,{className:"w-3 h-3 mr-1"}),"Классы:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((X=p==null?void 0:p.grades)==null?void 0:X.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:p.grades.map((H,$)=>e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs font-medium",children:H},$))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Tn,{className:"w-3 h-3 mr-1"}),"Цели обучения:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:((G=p==null?void 0:p.goals)==null?void 0:G.length)>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:p.goals.map((H,$)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full text-xs font-medium",children:H},$))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Jt,{className:"w-3 h-3 mr-1"}),"Опыт:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:p!=null&&p.experience?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-0.5 rounded-full text-xs font-medium",children:j(p.experience)}),p.experienceYears&&e.jsxs("span",{className:"text-gray-600 text-xs",children:["(",p.experienceYears," лет)"]})]}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(fr,{className:"w-3 h-3 mr-1"}),"Тип преподавателя:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:e.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded-full text-xs font-medium",children:k((p==null?void 0:p.teacherType)||"private")})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(Nt,{className:"w-3 h-3 mr-1"}),"Город:"]}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:p!=null&&p.city?e.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-0.5 rounded-full text-xs font-medium",children:p.city}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center",children:[e.jsx(iu,{className:"w-3 h-3 mr-1"}),"Форматы обучения:"]}),e.jsx("div",{className:"text-base text-gray-900 mt-2",children:((re=p==null?void 0:p.formats)==null?void 0:re.length)>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:p.formats.map((H,$)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium",children:C(H)},$))}):e.jsx("span",{className:"text-gray-500",children:"Не указано"})})]})]})]})]}),(p==null?void 0:p.education)&&e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(fr,{className:"w-4 h-4 mr-2"}),"Образование"]}),e.jsxs("div",{className:"space-y-2",children:[p.education.university&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Университет:"}),e.jsx("div",{className:"text-sm text-gray-900",children:p.education.university})]}),p.education.degree&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Специальность:"}),e.jsx("div",{className:"text-sm text-gray-900",children:p.education.degree})]}),p.education.graduationYear&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Год выпуска:"}),e.jsx("div",{className:"text-sm text-gray-900",children:p.education.graduationYear})]}),p.education.courses&&p.education.courses.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Курсы:"}),e.jsx("div",{className:"space-y-1 mt-1",children:p.education.courses.map((H,$)=>e.jsxs("div",{className:"text-xs text-gray-700",children:["• ",H.name," (",H.institution,", ",H.year,")"]},$))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(Nl,{className:"w-4 h-4 mr-2"}),"Стоимость и услуги"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Базовая стоимость:"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 mt-1",children:p!=null&&p.hourlyRate?`${p.hourlyRate} ₽/час`:"Не указана"})]}),(p==null?void 0:p.durations)&&p.durations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Длительности занятий:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:p.durations.map((H,$)=>e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded-lg text-xs font-medium",children:[H," мин"]},$))})]}),(p==null?void 0:p.lessonTypes)&&p.lessonTypes.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Типы уроков:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:p.lessonTypes.map((H,$)=>e.jsx("span",{className:"bg-green-50 text-green-700 px-2 py-0.5 rounded-lg text-xs font-medium",children:H},$))})]})]}),e.jsxs("div",{className:"space-y-3",children:[(p==null?void 0:p.rating)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Рейтинг:"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(H=>e.jsx(zt,{className:`w-4 h-4 ${H<=(p.rating||0)?"text-yellow-400 fill-current":"text-gray-300"}`},H))}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[p.rating,"/5"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Автоподбор:"}),e.jsx("div",{className:"text-sm text-gray-900 mt-1",children:p!=null&&p.overbookingEnabled?e.jsx("span",{className:"text-green-600 font-medium",children:"✓ Доступен"}):e.jsx("span",{className:"text-gray-500",children:"Недоступен"})})]})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-700",children:"💡 Стоимость может варьироваться в зависимости от формата, длительности занятия и сложности материала"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-3 flex items-center",children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),"Доступные слоты (",y.length,")"]}),y.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Сводка по ценам:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Минимальная цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.min(...y.map(H=>H.price))," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Максимальная цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.max(...y.map(H=>H.price))," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Средняя цена:"}),e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.round(y.reduce((H,$)=>H+$.price,0)/y.length)," ₽"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Всего слотов:"}),e.jsx("div",{className:"font-semibold text-blue-600",children:y.length})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:y.slice(0,6).map(H=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:H.subject})]}),e.jsxs("span",{className:"text-base font-bold text-green-600",children:[H.price," ₽"]})]}),e.jsxs("div",{className:"space-y-1 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Rt,{className:"w-3 h-3"}),e.jsxs("span",{children:[z(H.date)," • ",H.startTime,"-",H.endTime]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Nt,{className:"w-3 h-3"}),e.jsxs("span",{children:[C(H.format)," • ",H.duration," мин"]})]}),H.experience&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Jt,{className:"w-3 h-3"}),e.jsxs("span",{children:["Опыт: ",j(H.experience)]})]})]}),e.jsxs("button",{onClick:()=>s(t.id),className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-2 px-4 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 text-sm font-semibold",children:["Записаться за ",H.price," ₽"]})]},H.id))}),y.length>6&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:["И еще ",y.length-6," доступных слотов"]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(lt,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"Нет доступных слотов"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Следите за обновлениями расписания"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h3",{className:"text-base font-bold text-gray-900 flex items-center",children:[e.jsx(ar,{className:"w-4 h-4 mr-2"}),"Записи преподавателя (",D.length,")"]})}),D.length>0?e.jsxs("div",{className:"space-y-3",children:[D.slice(0,3).map(H=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center flex-shrink-0",children:e.jsx(Ce,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:H.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:M(H.date)})]}),e.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed text-sm",children:H.text}),H.tags&&H.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:H.tags.map(($,W)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium",children:$},W))}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(Dl,{className:"w-3 h-3"}),e.jsx("span",{children:H.reactions.length})]}),e.jsxs("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(tt,{className:"w-3 h-3"}),e.jsx("span",{children:H.comments.length})]}),e.jsx("button",{className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:e.jsx(rr,{className:"w-3 h-3"})})]})]})]})},H.id)),D.length>3&&e.jsx("div",{className:"text-center pt-3",children:e.jsxs("p",{className:"text-gray-600 text-xs",children:["И еще ",D.length-3," записей"]})})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(ar,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"У преподавателя пока нет записей"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Записи появятся здесь, когда преподаватель начнет публиковать контент"})]})]})]})]})})},u3={ru:Dt},m3=gi({format:at,parse:yi,startOfWeek:Cs,getDay:pi,locales:u3}),Dd=({onClose:t})=>{const{timeSlots:r,bookLesson:s}=ht(),{user:a}=it(),[n,i]=N.useState(null),[o,c]=N.useState(!1),[l,d]=N.useState(!1),[m,x]=N.useState(null),g=r.filter(f=>!f.isBooked).map(f=>({id:f.id,title:`${f.teacherName} - ${f.subject}`,start:new Date(`${f.date}T${f.startTime}`),end:new Date(`${f.date}T${f.endTime}`),slot:f,teacherName:f.teacherName,subject:f.subject,price:f.price,format:f.format,experience:f.experience,rating:f.rating,city:f.city,teacherAvatar:f.teacherAvatar})),v=N.useCallback(f=>{let T={backgroundColor:"#3B82F6",borderRadius:"6px",opacity:.95,color:"white",border:"0px",display:"block",padding:"3px 6px",fontSize:"11px",fontWeight:"500",margin:"1px 0",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",transition:"all 0.2s ease"};return f.format==="offline"?T.backgroundColor="#10B981":f.format==="mini-group"&&(T.backgroundColor="#8B5CF6"),{style:T}},[]),u=N.useCallback(f=>{i(f),c(!0)},[]),p=f=>{if(!a){alert("Пожалуйста, войдите в систему для бронирования");return}x(f),d(!0),c(!1)},w=async f=>{if(a&&m)try{await s(m.id,a.id,a.name,f),d(!1),x(null),window.location.reload()}catch{alert("Произошла ошибка при бронировании. Попробуйте еще раз.")}},y=f=>{switch(f){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return f}},D=f=>{switch(f){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return f}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9998] p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-7xl w-full max-h-[90vh] overflow-hidden relative",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 p-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Календарь свободных слотов"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Выберите удобное время для занятия с преподавателем"})]}),e.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(nt,{className:"w-6 h-6 text-gray-600"})})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:e.jsx(fi,{localizer:m3,events:g,startAccessor:"start",endAccessor:"end",style:{height:600},eventPropGetter:v,onSelectEvent:u,views:["month","week","day"],messages:{next:"Следующий",previous:"Предыдущий",today:"Сегодня",month:"Месяц",week:"Неделя",day:"День",noEventsInRange:"Нет свободных слотов в выбранном диапазоне",showMore:f=>`+${f} еще`}})})}),o&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",onClick:f=>{f.target===f.currentTarget&&c(!1)},children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Детали слота"}),e.jsx("button",{onClick:()=>c(!1),className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(nt,{className:"w-5 h-5 text-gray-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden",children:n.teacherAvatar?e.jsx("img",{src:n.teacherAvatar,alt:n.teacherName,className:"w-12 h-12 object-cover rounded-full"}):e.jsx(Ce,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:n.teacherName}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[n.rating&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(zt,{className:"h-3 w-3 text-yellow-400 fill-current"}),e.jsx("span",{children:n.rating})]}),n.experience&&e.jsx("span",{className:"text-blue-600",children:y(n.experience)})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:n.subject})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-gray-700",children:[at(n.start,"dd MMMM yyyy, HH:mm",{locale:Dt})," - ",at(n.end,"HH:mm",{locale:Dt})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Nt,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:D(n.format)})]}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[n.price," ₽"]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsxs("button",{onClick:()=>p(n.slot),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать"})]}),e.jsx("button",{onClick:()=>c(!1),className:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Отмена"})]})]})]})}),l&&m&&e.jsx(ji,{slot:m,onClose:()=>d(!1),onConfirm:w})]})})},h3=({title:t,description:r,actionPrimary:s,actionSecondary:a,icon:n})=>e.jsx("div",{className:"col-span-full text-center py-14 card-gradient",children:e.jsxs("div",{className:"flex flex-col items-center",children:[n&&e.jsx("div",{className:"mb-3 text-blue-500",children:n}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),r&&e.jsx("p",{className:"text-gray-500 max-w-xl mx-auto mb-5",children:r}),e.jsxs("div",{className:"flex items-center gap-3 justify-center",children:[s&&e.jsx("button",{type:"button",onClick:s.onClick,className:`btn-primary px-5 py-2 rounded-lg ${s.variant==="secondary"?"btn-secondary":""}`,"aria-label":s.label,children:s.label}),a&&e.jsx("button",{type:"button",onClick:a.onClick,className:`btn-secondary px-5 py-2 rounded-lg ${a.variant==="primary"?"btn-primary":""}`,"aria-label":a.label,children:a.label})]})]})}),Za=({setActiveTab:t})=>{var _e;const{bookLesson:r,timeSlots:s,allUsers:a,refreshUsers:n,refreshAllData:i,forceSyncData:o,sendMessageToUser:c,teacherProfiles:l,loadRegisteredTeachers:d,setAllUsers:m,socketRef:x,isConnected:h}=ht(),g=()=>{console.log("🔄 Принудительное обновление данных..."),i()};U.useEffect(()=>{console.log("🔄 StudentHome: Автоматическая загрузка зарегистрированных преподавателей и слотов...");const _=async()=>{try{await d(),await o(),console.log("✅ Данные загружены успешно")}catch(ie){console.error("❌ Ошибка загрузки данных:",ie),setTimeout(async()=>{try{await d(),await o(),console.log("✅ Данные загружены при повторной попытке")}catch(ge){console.error("❌ Ошибка при повторной попытке:",ge)}},2e3)}};_();const Y=setInterval(()=>{document.visibilityState==="visible"&&(console.log("⏰ StudentHome: Периодическая загрузка зарегистрированных преподавателей и слотов..."),_())},15e3);return()=>clearInterval(Y)},[d,o]);const{user:v}=it(),[u,p]=N.useState({}),[w,y]=N.useState(!1),[D,f]=N.useState(!1),[T,j]=N.useState(!1),[k,C]=N.useState({grade:"",subject:"",goals:[],experience:"",duration:60,format:"online",city:"",date:"",startTime:"",comment:""}),[M,z]=N.useState(!1),[I,X]=N.useState(null),[G,re]=N.useState(!1),[H,$]=N.useState(!1),[W,Q]=N.useState(null),[te,me]=N.useState(()=>{const _=new Date,Y=_.getDay(),ie=_.getDate()-Y+(Y===0?-6:1);return new Date(_.setDate(ie))}),[ve,Ne]=N.useState(null),[he,Te]=N.useState(null),[Z,K]=N.useState(""),[je,V]=N.useState(""),ce=["Математика","Русский язык","Английский язык"],De=["1","2","3","4","5","6","7","8","9","10","11","Студент","Взрослый"],Ie=["подготовка к экзаменам","помощь с домашним заданием","углубленное изучение","разговорная практика"],Le=["beginner","experienced","professional"],Xe=["online","offline","mini-group"],Qe=[45,60],$e=gi({format:at,parse:yi,startOfWeek:Cs,getDay:pi,locales:{ru:Dt}}),[be,Me]=N.useState([]),ut=async()=>{try{console.log("🔄 Загружаем всех преподавателей..."),console.log("🌐 SERVER_URL:",ze),console.log("🔄 Синхронизируем данные с сервера..."),await o(),console.log("📡 Запрашиваем пользователей с сервера...");const _=await fetch(`${ze}/api/users`);if(console.log("📡 Ответ сервера:",_.status,_.statusText),_.ok){const ie=_.headers.get("content-type");if(console.log("📡 Content-Type:",ie),ie&&ie.includes("application/json")){const ge=await _.json();console.log("✅ Все пользователи загружены с сервера:",ge.length,ge);const ke=ge.filter(ae=>ae.role==="teacher");if(console.log("✅ Преподаватели найдены:",ke.length,ke),Me(ke),Array.isArray(ge)){const ae=a||[],Se=[...ae];ge.forEach(le=>{Se.find(Ge=>Ge.id===le.id)?console.log("⏭️ Пользователь уже существует:",le.name):(Se.push(le),console.log("➕ Добавлен новый пользователь с сервера:",le.name))}),Se.length!==ae.length&&(m(Se),console.log("✅ Обновлены пользователи, добавлено новых:",Se.length-ae.length))}}else console.warn("⚠️ Сервер вернул не-JSON ответ для пользователей"),Me([])}else console.warn("⚠️ Не удалось загрузить пользователей с сервера:",_.status),Me([]);console.log("📡 Запрашиваем преподавателей через /api/teachers...");const Y=await fetch(`${ze}/api/teachers`);if(console.log("📡 Ответ /api/teachers:",Y.status,Y.statusText),Y.ok){const ie=Y.headers.get("content-type");if(console.log("📡 Content-Type /api/teachers:",ie),ie&&ie.includes("application/json")){const ge=await Y.json();console.log("✅ Преподаватели загружены через /api/teachers:",ge.length,ge),Me(ke=>{const Se=[...ke,...ge].filter((le,Ye,Ge)=>Ye===Ge.findIndex(kt=>kt.id===le.id));return console.log("✅ Объединенные преподаватели:",Se.length,Se),Se});try{const ke=Array.isArray(a)?a:[],ae=[...ke];ge.forEach(le=>{ae.find(Ge=>Ge.id===le.id)||(ae.push(le),console.log("➕ Добавлен новый преподаватель через /api/teachers:",le.name))});const Se=ae.filter((le,Ye,Ge)=>Ye===Ge.findIndex(kt=>kt.id===le.id));Se.length!==ke.length&&(m(Se),console.log("✅ Обновлены пользователи через /api/teachers, добавлено новых:",Se.length-ke.length))}catch{}}else console.warn("⚠️ Сервер вернул не-JSON ответ для преподавателей")}else console.warn("⚠️ Не удалось загрузить преподавателей через /api/teachers:",Y.status)}catch(_){console.error("❌ Ошибка загрузки преподавателей с сервера:",_),Me([])}};N.useEffect(()=>{console.log("🚀 Компонент StudentHome смонтирован, загружаем преподавателей..."),ut();const _=JSON.parse(localStorage.getItem("tutoring_teacherProfiles")||"{}");console.log("📱 Локальные профили преподавателей при монтировании:",Object.keys(_).length);const Y=setInterval(()=>{document.visibilityState==="visible"&&(console.log("🔄 Периодическое обновление списка преподавателей (каждые 30 сек)..."),ut())},3e4);return()=>clearInterval(Y)},[o,n]),N.useEffect(()=>{const _=setTimeout(()=>{V(Z)},300);return()=>clearTimeout(_)},[Z]),N.useEffect(()=>{const _=ie=>{ie.key==="tutoring_users"&&ie.newValue&&(console.log("🔄 Обнаружены изменения в пользователях, обновляем список преподавателей"),ut())},Y=ie=>{var ge;((ge=ie.detail)==null?void 0:ge.key)==="tutoring_users"&&(console.log("🔄 Обнаружены кастомные изменения в пользователях, обновляем список преподавателей"),ut())};return window.addEventListener("storage",_),window.addEventListener("customStorage",Y),()=>{window.removeEventListener("storage",_),window.removeEventListener("customStorage",Y)}},[]),N.useEffect(()=>{console.log("📱 teacherProfiles изменились:",Object.keys(l).length),Object.keys(l).length>0&&(console.log("✅ Найдены локальные профили преподавателей:",Object.keys(l)),d().catch(console.error),o().catch(console.error))},[l,d,o]);const Fe=()=>s.filter(Y=>{if(Y.isBooked)return!1;const ie=new Date(Y.date),ge=new Date;return ge.setHours(0,0,0,0),!(ie<ge)}),q=(_=!1)=>{f(!0);try{let Y=s.filter(ie=>{if(ie.isBooked)return!1;const ge=new Date(ie.date),ke=new Date;return ke.setHours(0,0,0,0),!(ge<ke)});if(u.grade&&u.grade!==""&&(Y=Y.filter(ie=>ie.grades&&ie.grades.includes(u.grade))),u.subject&&u.subject!==""&&(Y=Y.filter(ie=>ie.subject===u.subject)),u.experience&&u.experience!==""&&(Y=Y.filter(ie=>ie.experience===u.experience)),u.format&&u.format!==""&&(Y=Y.filter(ie=>ie.format===u.format)),u.duration&&u.duration>0&&(Y=Y.filter(ie=>ie.duration===u.duration)),u.minRating&&u.minRating>0&&(Y=Y.filter(ie=>(ie.rating||0)>=u.minRating)),u.goals&&u.goals.length>0&&(Y=Y.filter(ie=>ie.goals&&u.goals.some(ge=>ie.goals.includes(ge)))),ve){const ie=at(ve,"yyyy-MM-dd");Y=Y.filter(ge=>ge.date===ie)}he&&(Y=Y.filter(ie=>{const ge=parseInt(ie.startTime.split(":")[0]),ke=parseInt(he.start.split(":")[0]),ae=parseInt(he.end.split(":")[0]);return ge>=ke&&ge<ae})),_&&y(!1)}catch(Y){console.error("Error applying filters:",Y)}finally{f(!1)}},fe=()=>{p({}),Ne(null),Te(null),K(""),Fe(),y(!1)},S=async _=>{v&&I&&(r(I.id,v.id,v.name,_),setTimeout(()=>{Object.keys(u).length===0&&!ve&&!he?Fe():q(!1)},100))},F=()=>{if(j(!1),x!=null&&x.current){const _={studentId:v==null?void 0:v.id,studentName:v==null?void 0:v.name,...k};x.current.emit("overbookingRequest",_)}alert("Заявка на овербукинг отправлена! Мы подберем лучшего преподавателя за 5 часов до занятия.")},A=_=>{switch(_){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return _}},P=U.useMemo(()=>{console.log("🔄 Собираем всех преподавателей..."),console.log("📊 Исходные данные:"),console.log("- serverTeachers:",be.length,be),console.log("- allUsers:",(a==null?void 0:a.length)||0,a),console.log("- teacherProfiles:",Object.keys(l).length,l),console.log("- timeSlots:",s.length);const _=(a==null?void 0:a.filter(le=>le.role==="teacher").map(le=>{var Ye,Ge,kt;return{id:le.id,name:le.name||((Ye=le.profile)==null?void 0:Ye.name)||"Репетитор",avatar:le.avatar||((Ge=le.profile)==null?void 0:Ge.avatar)||"",rating:((kt=le.profile)==null?void 0:kt.rating)||0,profile:le.profile||{},isRegistered:!0,source:"registered"}}))||[];console.log("👥 ЗАРЕГИСТРИРОВАННЫЕ преподаватели (ПРИОРИТЕТ):",_.length,_);const Y=Object.entries(l).map(([le,Ye])=>({id:le,name:Ye.name||"Репетитор",avatar:Ye.avatar||"",rating:Ye.rating||0,profile:Ye,isRegistered:!1,source:"profiles"}));console.log("📱 Преподаватели из teacherProfiles:",Y.length,Y);const ie=be.map(le=>{var Ye,Ge,kt;return{id:le.id,name:le.name||((Ye=le.profile)==null?void 0:Ye.name)||"Репетитор",avatar:le.avatar||((Ge=le.profile)==null?void 0:Ge.avatar)||"",rating:((kt=le.profile)==null?void 0:kt.rating)||0,profile:le.profile||{},isRegistered:!1,source:"server"}});console.log("📡 Преподаватели с сервера:",ie.length,ie);const ge=s.filter(le=>le.teacherId&&le.teacherName).map(le=>({id:le.teacherId,name:le.teacherName,avatar:le.teacherAvatar||"",rating:le.rating||0,profile:{subjects:le.subject?[le.subject]:[],experience:le.experience||"beginner",grades:le.grades||[],goals:le.goals||[],city:"",bio:"",rating:le.rating||0,hourlyRate:le.price||0},isRegistered:!1,source:"slots"}));console.log("📅 Преподаватели из слотов:",ge.length,ge);const ke=[..._,...Y,...ie,...ge];console.log("🔄 Всего источников:",ke.length);const ae=new Map;_.forEach(le=>{ae.set(le.id,le),console.log("✅ ГАРАНТИРОВАННО добавлен зарегистрированный преподаватель:",le.id,le.name)}),[...Y,...ie,...ge].forEach(le=>{ae.has(le.id)?console.log("⏭️ Пропущен дубликат преподавателя:",le.id,le.name,le.source):(ae.set(le.id,le),console.log("➕ Добавлен дополнительный преподаватель:",le.id,le.name,le.source))});const Se=Array.from(ae.values());return console.log("✅ Итоговый список всех преподавателей:",Se.length,Se),Se},[be,a,s,l]);U.useEffect(()=>{if(console.log("🔄 allUsers изменились:",(a==null?void 0:a.length)||0),a&&a.length>0){const _=a.filter(Y=>Y.role==="teacher");console.log("👨‍🏫 Обнаружены репетиторы в allUsers:",_.length),d().catch(console.error),o().catch(console.error)}},[a,d,o]);const b=U.useMemo(()=>{const _=Object.keys(u).length>0||ve||he||je,Y=s.filter(ke=>!ke.isBooked),ie=new Set(Y.map(ke=>ke.teacherId));console.log("🔍 Фильтрация преподавателей:"),console.log("- hasActiveFilters:",_),console.log("- filters:",u),console.log("- selectedDate:",ve),console.log("- selectedTimeRange:",he),console.log("- debouncedSearchQuery:",je),console.log("- availableSlots:",Y.length),console.log("- teacherIdsWithSlots:",Array.from(ie)),console.log("- allTeachers:",P.length);let ge=P;if(console.log("- Показываем ВСЕХ преподавателей (независимо от онлайн статуса):",ge.length),x!=null&&x.current&&h&&(console.log("🔄 Запрашиваем все слоты с сервера для синхронизации..."),x.current.emit("requestAllSlots")),_&&(ge=ge.filter(ke=>{const ae=ke.profile;return!(u.subject&&u.subject!==""&&(!(ae!=null&&ae.subjects)||!ae.subjects.includes(u.subject))||u.experience&&u.experience!==""&&(ae==null?void 0:ae.experience)!==u.experience||u.format&&u.format!==""&&(!(ae!=null&&ae.formats)||!ae.formats.includes(u.format))||u.city&&u.city!==""&&(!(ae!=null&&ae.city)||!ae.city.toLowerCase().includes(u.city.toLowerCase()))||u.minRating&&u.minRating>0&&((ae==null?void 0:ae.rating)||0)<u.minRating||u.duration&&u.duration>0&&(!(ae!=null&&ae.durations)||!ae.durations.includes(u.duration))||u.grade&&u.grade!==""&&(!(ae!=null&&ae.grades)||!ae.grades.includes(u.grade))||u.goals&&u.goals.length>0&&(!(ae!=null&&ae.goals)||!u.goals.some(Se=>ae.goals.includes(Se))))})),je.trim()){const ke=je.toLowerCase().trim();ge=ge.filter(ae=>{const Se=ae.profile;return!!(ae.name.toLowerCase().includes(ke)||Se!=null&&Se.subjects&&Se.subjects.some(le=>le.toLowerCase().includes(ke))||Se!=null&&Se.city&&Se.city.toLowerCase().includes(ke))})}return console.log("✅ StudentHome - Итоговый результат:",ge.length,"преподавателей"),ge},[P,u,ve,he,je,s]);function L(_){try{return JSON.parse(localStorage.getItem("tutoring_users")||"[]").find(ie=>ie.id===_&&ie.role==="teacher")||null}catch{return null}}const[O,R]=N.useState(null),[E,B]=N.useState(!1),[oe,ye]=N.useState(!1);U.useEffect(()=>{Object.keys(u).length>0||ve||he?q():Fe(),s.length>0&&(console.log("🔄 timeSlots изменились, синхронизируем с сервером..."),o().catch(console.error))},[u,ve,he,s,o]),U.useEffect(()=>{Fe(),o().catch(console.error)},[a,o]),U.useEffect(()=>{s.length>0&&(console.log("🔄 timeSlots изменились, принудительно синхронизируем с сервером..."),o().catch(console.error),x!=null&&x.current&&h&&(console.log("🔄 Запрашиваем все слоты с сервера..."),x.current.emit("requestAllSlots")),console.log("🔄 Обновляем преподавателей при изменении слотов..."),n(),d().catch(console.error))},[s,o,x,h,n,d]),U.useEffect(()=>{const _=ie=>{ie.key==="tutoring_users"&&(n(),Me([]),fetch(`${ze}/api/teachers`).then(ge=>ge.json()).then(ge=>Me(Array.isArray(ge)?ge:[])).catch(()=>Me([])),Fe())},Y=ie=>{var ge;((ge=ie.detail)==null?void 0:ge.key)==="tutoring_users"&&(n(),Me([]),fetch(`${ze}/api/teachers`).then(ke=>ke.json()).then(ke=>Me(Array.isArray(ke)?ke:[])).catch(()=>Me([])),Fe())};return window.addEventListener("storage",_),window.addEventListener("customStorage",Y),()=>{window.removeEventListener("storage",_),window.removeEventListener("customStorage",Y)}},[]),U.useEffect(()=>{Fe(),x!=null&&x.current&&h&&(console.log("🔄 StudentHome: Запрашиваем все слоты с сервера при монтировании..."),x.current.emit("requestAllSlots"))},[s,x,h]);const rt=async _=>{var ie,ge,ke,ae,Se,le,Ye,Ge,kt,Si;console.log("Teacher clicked:",_);try{const Us=await fetch(`${ze}/api/users/${_.id}`);if(Us.ok){const pt=await Us.json();if(console.log("Fresh teacher data from server:",pt),pt){const Od=JSON.parse(localStorage.getItem("tutoring_users")||"[]").map(Ci=>Ci.id===pt.id?pt:Ci);localStorage.setItem("tutoring_users",JSON.stringify(Od));const ki={id:pt.id,name:pt.name,email:pt.email,avatar:((ie=pt.profile)==null?void 0:ie.avatar)||pt.avatar,role:"teacher",profile:{...pt.profile,avatar:((ge=pt.profile)==null?void 0:ge.avatar)||pt.avatar,name:pt.name,email:pt.email}};console.log("Updated teacher data for modal:",ki),R(ki),B(!0);return}}}catch(Us){console.error("Error fetching fresh teacher data:",Us)}let Y=L(_.id);Y?Y={...Y,name:_.name||Y.name,email:((Ye=_.profile)==null?void 0:Ye.email)||_.email||Y.email,avatar:((Ge=_.profile)==null?void 0:Ge.avatar)||_.avatar||Y.avatar,profile:{...Y.profile,..._.profile,avatar:((kt=_.profile)==null?void 0:kt.avatar)||_.avatar||Y.avatar,name:_.name||Y.name,email:((Si=_.profile)==null?void 0:Si.email)||_.email||Y.email}}:Y={id:_.id,name:_.name,email:((ke=_.profile)==null?void 0:ke.email)||_.email||"",avatar:((ae=_.profile)==null?void 0:ae.avatar)||_.avatar,role:"teacher",profile:{..._.profile,avatar:((Se=_.profile)==null?void 0:Se.avatar)||_.avatar,name:_.name,email:((le=_.profile)==null?void 0:le.email)||_.email}},console.log("Fallback teacher data for modal:",Y),R(Y),B(!0)},dr=_=>{const Y=a.find(ie=>ie.id===_);Y&&(Q(Y),$(!0)),ye(!1)},wt=_=>{console.log("🔍 StudentHome handleMessage DEBUG:"),console.log("- Student user:",{id:v==null?void 0:v.id,name:v==null?void 0:v.name,role:v==null?void 0:v.role}),console.log("- Target teacher ID:",_);const Y=a.find(ie=>ie.id===_);if(console.log("- Found teacher:",Y),Y&&v){console.log("- Sending message to teacher:",{studentId:v.id,teacherId:_,studentName:v.name,teacherName:Y.name});const ie=c(v.id,v.name,_,Y.name,`Привет! Меня зовут ${v.name}. Можете ли вы помочь мне с обучением?`);console.log("- Message sent, chat ID:",ie),t("chats")}else console.log("❌ Teacher not found or user not available");console.log("🔍 END StudentHome DEBUG"),ye(!1)};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-3",children:"Найди своего идеального репетитора"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Изучай профили преподавателей, связывайся с ними и записывайся на уроки"})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"flex items-center space-x-2 bg-green-50 border border-green-200 rounded-full px-4 py-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx(wu,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Подключено в реальном времени"})]})})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap justify-center gap-4",children:[e.jsxs("button",{onClick:()=>j(!0),className:"group bg-gradient-to-r from-green-500 via-emerald-500 to-teal-500 text-white px-6 py-3 rounded-xl font-semibold text-base hover:from-green-600 hover:via-emerald-600 hover:to-teal-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(Be,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Овербукинг"}),e.jsx("div",{className:"text-xs opacity-90",children:"Автоподбор"})]})]}),e.jsxs("button",{onClick:()=>re(!0),className:"group bg-gradient-to-r from-purple-500 via-pink-500 to-rose-500 text-white px-6 py-3 rounded-xl font-semibold text-base hover:from-purple-600 hover:via-pink-600 hover:to-rose-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg group-hover:bg-white/30 transition-colors",children:e.jsx(lt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:"Календарь"}),e.jsx("div",{className:"text-xs opacity-90",children:"Слоты"})]})]})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative group",children:[e.jsx(cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{type:"text",value:Z,onChange:_=>K(_.target.value),placeholder:"🔍 Поиск по предмету, преподавателю или городу...",className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base placeholder-gray-400"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>y(!w),className:`flex items-center space-x-2 px-4 py-2.5 rounded-xl font-medium transition-all duration-200 text-sm ${w?"bg-blue-600 text-white shadow-md":"bg-white border-2 border-gray-200 text-gray-700 hover:border-blue-300 hover:bg-blue-50"}`,children:[e.jsx(Nn,{className:"h-4 w-4"}),e.jsx("span",{children:"Фильтры"}),(Object.keys(u).length>0||ve||he||Z.trim())&&e.jsx("span",{className:"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded-full text-xs font-bold",children:Object.keys(u).length+(ve?1:0)+(he?1:0)+(Z.trim()?1:0)})]}),e.jsx("button",{onClick:()=>q(!0),disabled:D,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2.5 rounded-xl font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 flex items-center space-x-2 text-sm",children:D?e.jsxs(e.Fragment,{children:[e.jsx(ea,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Применение..."})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Применить"})})}),(Object.keys(u).length>0||ve||he||Z.trim())&&e.jsx("button",{onClick:fe,className:"bg-white border-2 border-gray-300 text-gray-700 px-4 py-2.5 rounded-xl font-medium hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 text-sm",children:"Сбросить"})]})]}),w&&e.jsxs("div",{className:"bg-white p-6 rounded-2xl border-2 border-gray-100 shadow-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Класс"}),e.jsxs("select",{value:u.grade||"",onChange:_=>p({...u,grade:_.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой класс"}),De.map(_=>e.jsx("option",{value:_,children:_},_))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Предмет"}),e.jsxs("select",{value:u.subject||"",onChange:_=>p({...u,subject:_.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой предмет"}),ce.map(_=>e.jsx("option",{value:_,children:_},_))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Опыт"}),e.jsxs("select",{value:u.experience||"",onChange:_=>p({...u,experience:_.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой опыт"}),Le.map(_=>e.jsx("option",{value:_,children:A(_)},_))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Формат"}),e.jsxs("select",{value:u.format||"",onChange:_=>p({...u,format:_.target.value}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой формат"}),Xe.map(_=>e.jsx("option",{value:_,children:_==="online"?"Онлайн":_==="offline"?"Оффлайн":"Мини-группа"},_))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Длительность"}),e.jsxs("select",{value:u.duration||"",onChange:_=>p({...u,duration:_.target.value?parseInt(_.target.value):void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любая длительность"}),Qe.map(_=>e.jsxs("option",{value:_,children:[_," мин"]},_))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Мин. рейтинг"}),e.jsxs("select",{value:u.minRating||"",onChange:_=>p({...u,minRating:_.target.value?parseFloat(_.target.value):void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любой рейтинг"}),e.jsx("option",{value:"4",children:"4+ звезды"}),e.jsx("option",{value:"4.5",children:"4.5+ звезды"}),e.jsx("option",{value:"5",children:"5 звезд"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Город"}),e.jsx("input",{type:"text",value:u.city||"",onChange:_=>p({...u,city:_.target.value}),placeholder:"Введите город",className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Цели обучения"}),e.jsxs("select",{value:((_e=u.goals)==null?void 0:_e[0])||"",onChange:_=>p({...u,goals:_.target.value?[_.target.value]:void 0}),className:"w-full p-2.5 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Любые цели"}),Ie.map(_=>e.jsx("option",{value:_,children:_},_))]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4 text-center",children:"Выберите дату и время"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Дата"}),e.jsx("div",{className:"border-2 border-gray-200 rounded-2xl overflow-hidden shadow-lg",children:e.jsx(fi,{localizer:$e,events:[],startAccessor:"start",endAccessor:"end",style:{height:280},views:["month"],view:"month",selectable:!0,onSelectSlot:_=>{Ne(_.start)},onSelectEvent:()=>{}})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Время"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Начало"}),e.jsx("input",{type:"time",value:(he==null?void 0:he.start)||"",onChange:_=>Te(Y=>({start:_.target.value,end:(Y==null?void 0:Y.end)||"23:00"})),className:"w-full p-3 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Конец"}),e.jsx("input",{type:"time",value:(he==null?void 0:he.end)||"",onChange:_=>Te(Y=>({start:(Y==null?void 0:Y.start)||"00:00",end:_.target.value})),className:"w-full p-3 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-base"})]})]}),ve&&e.jsxs("div",{className:"mt-4 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(lt,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Выбрана дата:"})]}),e.jsx("p",{className:"text-base font-medium text-blue-900",children:at(ve,"dd MMMM yyyy",{locale:Dt})})]})]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:b.length>0?`Найдено ${b.length} преподавателей`:"Преподаватели"}),e.jsxs("button",{onClick:g,className:"px-3 py-1 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm flex items-center gap-2",title:"Обновить список преподавателей",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Обновить"]})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:b.length>0?"Зарегистрированные преподаватели всегда доступны для связи и бронирования уроков":"Попробуйте изменить фильтры или воспользоваться овербукингом"}),b.length>0&&e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 text-green-600 text-xs",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{children:"Все репетиторы доступны 24/7"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:b.length===0?e.jsx(h3,{title:Object.keys(u).length>0||ve||he?"Нет преподавателей подходящих под фильтры":"Нет зарегистрированных преподавателей",description:Object.keys(u).length>0||ve||he?"Попробуйте изменить фильтры или воспользоваться овербукингом":"Попробуйте воспользоваться овербукингом или обратитесь к администратору",actionPrimary:{label:"Овербукинг",onClick:()=>j(!0)},actionSecondary:{label:"Сбросить фильтры",onClick:fe,variant:"secondary"}}):e.jsx(e.Fragment,{children:b.map(_=>{const Y=_.profile,ke=s.filter(ae=>ae.teacherId===_.id).filter(ae=>!ae.isBooked).length>0;return e.jsxs("div",{className:"bg-white rounded-3xl border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer group overflow-hidden transform hover:-translate-y-2",onClick:()=>rt(_),children:[e.jsxs("div",{className:"h-32 relative overflow-hidden",style:{background:Y!=null&&Y.cardBackground?Y.cardBackground.startsWith("http")||Y.cardBackground.startsWith("data:")?`url(${Y.cardBackground}) center/cover`:Y.cardBackground:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsxs("div",{className:"absolute top-3 right-3 flex items-center space-x-2",children:[e.jsx("button",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-full text-white hover:bg-white/30 transition-colors border border-white/30",onClick:ae=>{ae.stopPropagation()},children:e.jsx(jt,{className:"h-3 w-3"})}),e.jsx("button",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-full text-white hover:bg-white/30 transition-colors border border-white/30",onClick:ae=>{ae.stopPropagation()},children:e.jsx(rr,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"relative -mt-12 flex justify-center",children:e.jsxs("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-2 border-white rounded-full shadow-lg animate-pulse",title:"Зарегистрированный репетитор (всегда доступен)"}),(()=>{const ae=(Y==null?void 0:Y.avatar)||_.avatar;return ae&&ae.trim()!==""&&ae!=="undefined"&&ae!=="null"?e.jsx("img",{src:ae,alt:_.name,className:"w-32 h-32 object-cover rounded-full",onError:le=>{const Ye=le.target;Ye.style.display="none";const Ge=Ye.nextElementSibling;Ge&&Ge.classList.remove("hidden")},onLoad:le=>{const Ge=le.target.nextElementSibling;Ge&&Ge.classList.add("hidden")}}):null})(),e.jsx("div",{className:`w-32 h-32 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${(()=>{const ae=(Y==null?void 0:Y.avatar)||_.avatar;return ae&&ae.trim()!==""&&ae!=="undefined"&&ae!=="null"?"hidden":""})()}`,children:e.jsx(Ce,{className:"h-16 w-16 text-white"})})]})}),e.jsxs("div",{className:"px-6 pb-6 pt-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:(Y==null?void 0:Y.name)||_.name||"Репетитор"}),e.jsx("p",{className:"text-sm text-gray-600",children:(Y==null?void 0:Y.teacherType)==="private"?"Частный преподаватель":(Y==null?void 0:Y.teacherType)==="school"?"Преподаватель школы":(Y==null?void 0:Y.teacherType)==="both"?"Частный + Школа":"Частный преподаватель"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-600 mb-4",children:[(Y==null?void 0:Y.age)&&e.jsxs("span",{children:["возраст ",Y.age," лет"]}),(Y==null?void 0:Y.experienceYears)&&e.jsxs("span",{children:["стаж ",Y.experienceYears," лет"]})]}),e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsxs("div",{className:"flex items-center space-x-1 bg-green-50 px-3 py-1.5 rounded-full",children:[e.jsx(tt,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:Y!=null&&Y.reviewsCount&&Y.reviewsCount>0?`${Y.reviewsCount} отзывов`:"отзывов нет"})]})}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-sm text-gray-600",children:[e.jsx(Nt,{className:"h-4 w-4"}),e.jsx("span",{children:(Y==null?void 0:Y.city)||"Город не указан"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:ae=>{ae.stopPropagation(),ke?(Q(_),$(!0)):rt(_)},className:`w-full py-3 rounded-xl font-semibold transition-all duration-200 text-base ${ke?"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1":"bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1"}`,children:ke?"Забронировать урок":"Связаться с репетитором"}),e.jsx("button",{onClick:ae=>{ae.stopPropagation(),rt(_)},className:"w-full py-2 text-gray-500 hover:text-blue-600 transition-colors text-sm font-medium",children:"Подробнее →"})]})]})]},_.id)})})})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Овербукинг - Автоподбор преподавателя"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Заполните форму, и мы автоматически подберем лучшего доступного преподавателя за 5 часов до занятия"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Класс"}),e.jsxs("select",{value:k.grade,onChange:_=>C({...k,grade:_.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Выберите класс"}),De.map(_=>e.jsx("option",{value:_,children:_},_))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предмет"}),e.jsxs("select",{value:k.subject,onChange:_=>C({...k,subject:_.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Выберите предмет"}),ce.map(_=>e.jsx("option",{value:_,children:_},_))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md-grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата занятия"}),e.jsx("input",{type:"date",value:k.date,onChange:_=>C({...k,date:_.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Время начала"}),e.jsx("input",{type:"time",value:k.startTime,onChange:_=>C({...k,startTime:_.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цель занятий"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ie.map(_=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:k.goals.includes(_),onChange:Y=>{Y.target.checked?C({...k,goals:[...k.goals,_]}):C({...k,goals:k.goals.filter(ie=>ie!==_)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:_})]},_))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Опыт преподавателя"}),e.jsxs("select",{value:k.experience,onChange:_=>C({...k,experience:_.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Любой"}),Le.map(_=>e.jsx("option",{value:_,children:A(_)},_))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Продолжительность"}),e.jsx("select",{value:k.duration,onChange:_=>C({...k,duration:Number(_.target.value)}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Qe.map(_=>e.jsxs("option",{value:_,children:[_," мин"]},_))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Формат"}),e.jsx("select",{value:k.format,onChange:_=>C({...k,format:_.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Xe.map(_=>e.jsx("option",{value:_,children:_==="online"?"Онлайн":_==="offline"?"Оффлайн":"Мини-группа"},_))})]})]}),k.format==="offline"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Город"}),e.jsx("input",{type:"text",value:k.city,onChange:_=>C({...k,city:_.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Введите ваш город"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Примечание"}),e.jsx("textarea",{value:k.comment,onChange:_=>C({...k,comment:_.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Например: хочу разобрать домашнее задание или подготовиться к контрольной..."})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-6",children:[e.jsx("button",{onClick:F,disabled:!k.grade||!k.subject||!k.date||!k.startTime,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white py-3 px-4 rounded-lg font-medium hover:from-green-600 hover:to-emerald-600 transition-all duration-200 disabled:opacity-50",children:"Отправить заявку"}),e.jsx("button",{onClick:()=>j(!1),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Отмена"})]})]})})}),E&&O&&e.jsx(d3,{teacher:O,onClose:()=>B(!1),onBookLesson:_=>{B(!1),dr(_)},onMessage:_=>{B(!1),wt(_)}}),M&&I&&v&&e.jsx(ji,{isOpen:M,onClose:()=>{z(!1),X(null)},onConfirm:S,slot:I,teacher:L(I.teacherId),student:v}),oe&&O&&e.jsx(Td,{teacher:O,onClose:()=>ye(!1),onBookLesson:dr,onMessage:wt}),G&&e.jsx(Dd,{onClose:()=>re(!1)}),H&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center",children:e.jsx(Ce,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Календарь ",(W==null?void 0:W.name)||"Преподавателя"]}),e.jsx("p",{className:"text-gray-600",children:"Выберите удобное время для занятия"})]})]}),e.jsx("button",{onClick:()=>{$(!1),Q(null)},className:"p-2 rounded-full hover:bg-gray-100",children:e.jsx(nt,{className:"w-5 h-5 text-gray-600"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{const _=new Date(te);_.setDate(_.getDate()-7),me(_)},className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[te.toLocaleDateString("ru-RU",{day:"numeric",month:"long"})," — ",new Date(te.getTime()+6*24*60*60*1e3).toLocaleDateString("ru-RU",{day:"numeric",month:"long"})]}),e.jsx("button",{onClick:()=>{const _=new Date(te);_.setDate(_.getDate()+7),me(_)},className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("button",{onClick:()=>{const _=new Date,Y=_.getDay(),ie=_.getDate()-Y+(Y===0?-6:1);me(new Date(_.setDate(ie)))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:"Сегодня"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-200 bg-gray-50",children:[e.jsx("div",{className:"w-20 p-3 border-r border-gray-200"}),Array.from({length:7},(_,Y)=>{const ie=new Date(te);return ie.setDate(ie.getDate()+Y),e.jsxs("div",{className:"flex-1 p-3 border-r border-gray-200 last:border-r-0 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:ie.toLocaleDateString("ru-RU",{weekday:"short"})}),e.jsx("div",{className:"text-xs text-gray-600",children:ie.toLocaleDateString("ru-RU",{day:"numeric",month:"short"})})]},Y)})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:Array.from({length:24},(_,Y)=>Y).map(_=>e.jsxs("div",{className:"flex border-b border-gray-200 last:border-b-0",children:[e.jsxs("div",{className:"w-20 bg-gray-50 p-3 border-r border-gray-200 flex items-center justify-center text-sm font-medium text-gray-600 sticky left-0",children:[_.toString().padStart(2,"0"),":00"]}),Array.from({length:7},(Y,ie)=>{const ge=new Date(te);ge.setDate(ge.getDate()+ie);const ke=ge.toISOString().split("T")[0],ae=s.filter(Se=>Se.teacherId===(W==null?void 0:W.id)&&!Se.isBooked&&Se.date===ke&&parseInt(Se.startTime.split(":")[0])===_);return e.jsx("div",{className:"flex-1 p-3 border-r border-gray-200 last:border-r-0 min-h-[60px]",children:ae.map(Se=>e.jsxs("div",{className:"bg-blue-100 border border-blue-300 rounded-lg p-2 mb-2 cursor-pointer hover:bg-blue-200 transition-colors",onClick:()=>{v&&(X(Se),z(!0),$(!1),Q(null))},children:[e.jsxs("div",{className:"text-xs font-medium text-blue-900",children:[Se.startTime," - ",Se.endTime]}),e.jsx("div",{className:"text-xs text-blue-700",children:Se.subject}),e.jsxs("div",{className:"text-xs text-blue-600",children:[Se.price," ₽"]})]},Se.id))},ie)})]},_))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["Доступные слоты: ",s.filter(_=>_.teacherId===(W==null?void 0:W.id)&&!_.isBooked).length]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Нажмите на любой слот в календаре для бронирования"})]})]})]})})]})},en=()=>{const{timeSlots:t,lessons:r,createSlot:s,cancelLesson:a,getOrCreateChat:n,completeLesson:i,deleteSlot:o,isConnected:c,socketRef:l}=ht(),{user:d}=it(),[m,x]=N.useState(!1),[h,g]=N.useState({date:"",startTime:"",duration:60,subject:"",lessonType:"regular",format:"online",price:1e3}),[v,u]=U.useState(null),[p,w]=U.useState(!1),[y,D]=U.useState(null),[f,T]=N.useState(!1),[j,k]=N.useState([]),[C,M]=N.useState(null),[z,I]=N.useState(!1);U.useEffect(()=>{l.current&&(d!=null&&d.id)&&c&&l.current.emit("subscribeOverbooking",d.id)},[l.current,d==null?void 0:d.id,c]),U.useEffect(()=>{if(!l.current)return;const J=()=>{d!=null&&d.id&&(d!=null&&d.profile)&&c&&l.current.emit("subscribeOverbooking",d.id)};return l.current.off("connect",J),l.current.on("connect",J),d!=null&&d.id&&(d!=null&&d.profile)&&(l.current.emit("subscribeOverbooking",d.id),l.current.on("overbookingRequests",$e=>{k($e),setTimeout(()=>{},100)}),l.current.on("newOverbookingRequest",$e=>{k(be=>[...be,$e])}),l.current.on("overbookingRequestAccepted",$e=>{k(be=>be.filter(Me=>Me.id!==$e.id))})),()=>{l.current&&(l.current.off("overbookingRequests"),l.current.off("newOverbookingRequest"),l.current.off("overbookingRequestAccepted"),l.current.off("connect",J))}},[d==null?void 0:d.id,d==null?void 0:d.profile,c]),U.useEffect(()=>{d&&d.profile&&Array.isArray(d.profile.subjects)&&d.profile.subjects.length>=1&&g(J=>({...J,subject:d.profile.subjects[0]}))},[d]);const G=t.filter(J=>J.teacherId===(d==null?void 0:d.id)).filter(J=>!J.isBooked),re=r.filter(J=>J.teacherId===(d==null?void 0:d.id)),H=re.filter(J=>J.status==="scheduled"),$=re.filter(J=>J.status==="completed"),W=(J,$e)=>{const be=new Date(`${J.date}T${J.startTime}`),Me=new Date(`${$e.date}T${$e.startTime}`);return be.getTime()-Me.getTime()},Q=[...G].sort(W),te=[...H].sort(W),me=[...$].sort(W),ve=()=>{if(!d||!h.date||!h.startTime||!h.subject){alert("Пожалуйста, заполните все обязательные поля");return}const J=new Date(`2000-01-01T${h.startTime}`),$e=new Date(J.getTime()+h.duration*6e4);let be;d.profile&&d.role==="teacher"&&(be=d.profile);const Me={teacherId:d.id,teacherName:d.name,teacherAvatar:d.avatar,date:h.date,startTime:h.startTime,endTime:$e.toTimeString().slice(0,5),duration:h.duration,subject:h.subject,lessonType:h.lessonType,format:h.format,price:h.price,experience:(be==null?void 0:be.experience)||"beginner",goals:(be==null?void 0:be.goals)||[],grades:(be==null?void 0:be.grades)||[],rating:be==null?void 0:be.rating,bio:(be==null?void 0:be.bio)||"",...h.format==="offline"&&(be!=null&&be.city)?{city:be.city}:{}};s(Me),x(!1),g({date:"",startTime:"",duration:60,subject:"",lessonType:"regular",format:"online",price:1e3})},Ne=J=>{d&&(u(J),D(null),w(!0))},he=J=>{d&&(D(J),u(null),w(!0))},Te=()=>{w(!1),u(null),D(null)},Z=async J=>{var be,Me,ut,Fe,q,fe;if(!d)return;l.current&&l.current.emit("acceptOverbookingRequest",{requestId:J.id,teacherId:d.id});const $e={teacherId:d.id,teacherName:d.name,teacherAvatar:d.avatar||"",date:J.date||new Date().toISOString().slice(0,10),startTime:J.startTime||"15:00",endTime:J.endTime||"16:00",duration:J.duration||60,subject:J.subject,lessonType:"regular",format:J.format,price:1e3,experience:((be=d.profile)==null?void 0:be.experience)||"beginner",goals:((Me=d.profile)==null?void 0:Me.goals)||[],grades:((ut=d.profile)==null?void 0:ut.grades)||[],rating:(Fe=d.profile)==null?void 0:Fe.rating,bio:((q=d.profile)==null?void 0:q.bio)||"",city:((fe=d.profile)==null?void 0:fe.city)||""};await s($e,J.studentId,J.studentName),T(!1),alert("Вы приняли заявку. Слот создан и забронирован!")},K=J=>{switch(J){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return J}},je=J=>{switch(J){case"trial":return"Пробный";case"regular":return"Обычный";default:return J}},V=({slot:J,isBooked:$e,onClick:be})=>e.jsx("div",{className:`card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden border-l-4 ${$e?"border-green-500":"border-blue-500"} cursor-pointer`,onClick:be,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 leading-tight mb-1",children:J.subject}),e.jsxs("div",{className:"text-xs text-gray-500",children:[J.date," • ",J.startTime,"–",J.endTime]})]})}),ce=({lesson:J,status:$e,onClick:be})=>e.jsx("div",{className:`card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden border-l-4 ${$e==="completed"?"border-gray-400":"border-green-500"} cursor-pointer`,onClick:be,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 leading-tight mb-1",children:J.subject}),e.jsxs("div",{className:"text-xs text-gray-500",children:[J.date," • ",J.startTime,"–",J.endTime]})]})}),De=(d==null?void 0:d.profile)&&"overbookingEnabled"in d.profile&&d.profile.overbookingEnabled,Ie=d!=null&&d.profile&&"subjects"in d.profile?d.profile.subjects:[],Le=[45,60,90],Xe=["regular","trial"],Qe=["online","offline","mini-group"];return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 relative",children:[De&&e.jsxs("button",{className:"absolute top-0 right-0 p-2 rounded-full hover:bg-gray-100 transition z-10",title:"Уведомления",onClick:()=>T(!0),children:[e.jsx(as,{className:"w-7 h-7 text-blue-500"}),j.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full text-xs px-1.5 py-0.5",children:j.length})]}),e.jsx("h1",{className:"text-3xl font-bold gradient-text mb-2",children:"Управление слотами"}),e.jsx("p",{className:"text-gray-600",children:"Создавайте временные слоты для уроков и управляйте своим расписанием"})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:()=>T(!1),title:"Закрыть",children:e.jsx(nt,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Заявки на овербукинг"}),j.length===0?e.jsx("div",{className:"text-gray-500 text-center",children:"Нет новых заявок"}):e.jsx("div",{className:"space-y-2",children:j.map(J=>e.jsxs("div",{className:"flex items-center gap-2 border rounded-lg px-3 py-2 bg-purple-50 cursor-pointer hover:bg-purple-100 transition",onClick:()=>{M(J),I(!0)},children:[e.jsx("span",{className:"font-semibold text-purple-800",children:J.studentName}),e.jsx("span",{className:"text-xs text-gray-500",children:J.subject}),e.jsx("span",{className:"text-xs text-gray-500",children:J.startTime||"—"})]},J.id))})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>x(!0),className:"btn-primary flex items-center space-x-2",children:[e.jsx(ls,{className:"h-5 w-5"}),e.jsx("span",{children:"Создать новый слот"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700 mb-4",children:"Свободные слоты"}),Q.length>0?e.jsx("div",{className:"space-y-4",children:Q.map(J=>e.jsx(V,{slot:J,isBooked:!1,onClick:()=>Ne(J)},J.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет свободных слотов"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-green-700 mb-4",children:"Забронированные уроки"}),te.length>0?e.jsx("div",{className:"space-y-4",children:te.map(J=>e.jsx(ce,{lesson:J,status:"scheduled",onClick:()=>he(J)},J.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет забронированных уроков"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4",children:"Завершённые уроки"}),me.length>0?e.jsx("div",{className:"space-y-4",children:me.map(J=>e.jsx(ce,{lesson:J,status:"completed",onClick:()=>he(J)},J.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет завершённых уроков"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-purple-700 mb-4",children:"Овербукинг"}),e.jsx("div",{className:"text-gray-400 text-center py-8",children:"Нет новых заявок"})]})]}),m&&e.jsx("div",{className:"fixed inset-0 modal-backdrop flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"modal-content bg-white rounded-2xl shadow-2xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold gradient-text",children:"Создать новый слот"}),e.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600 transition-colors p-2 rounded-full hover:bg-gray-100",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Предмет *"}),e.jsxs("select",{value:h.subject,onChange:J=>g({...h,subject:J.target.value}),className:"input-modern w-full",children:[e.jsx("option",{value:"",children:"Выберите предмет"}),Ie.map(J=>e.jsx("option",{value:J,children:J},J))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Дата *"}),e.jsx("input",{type:"date",value:h.date,onChange:J=>g({...h,date:J.target.value}),className:"input-modern w-full",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Время начала *"}),e.jsx("input",{type:"time",value:h.startTime,onChange:J=>g({...h,startTime:J.target.value}),className:"input-modern w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Длительность"}),e.jsx("select",{value:h.duration,onChange:J=>g({...h,duration:parseInt(J.target.value)}),className:"input-modern w-full",children:Le.map(J=>e.jsxs("option",{value:J,children:[J," минут"]},J))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Цена (₽)"}),e.jsx("input",{type:"number",value:h.price,onChange:J=>g({...h,price:parseInt(J.target.value)}),className:"input-modern w-full",min:"100",step:"100"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Тип урока"}),e.jsx("select",{value:h.lessonType,onChange:J=>g({...h,lessonType:J.target.value}),className:"input-modern w-full",children:Xe.map(J=>e.jsx("option",{value:J,children:je(J)},J))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Формат"}),e.jsx("select",{value:h.format,onChange:J=>g({...h,format:J.target.value}),className:"input-modern w-full",children:Qe.map(J=>e.jsx("option",{value:J,children:K(J)},J))})]})]}),e.jsxs("div",{className:"flex space-x-4 pt-4",children:[e.jsx("button",{onClick:ve,className:"btn-primary flex-1",children:"Создать слот"}),e.jsx("button",{onClick:()=>x(!1),className:"btn-secondary flex-1",children:"Отмена"})]})]})]})})}),p&&(v||y)&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[e.jsx("button",{onClick:Te,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:v?"Детали слота":"Детали урока"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Предмет:"})," ",(v||y).subject]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Дата:"})," ",(v||y).date," ",(v||y).startTime," - ",(v||y).endTime]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Формат:"})," ",(v||y).format]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Цена:"})," ",(v||y).price,"₽"]}),v&&v.studentName&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",v.studentName]}),y&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",y.studentName]}),((y==null?void 0:y.comment)||(v==null?void 0:v.comment))&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-blue-900",children:[e.jsx("span",{className:"font-medium",children:"Комментарий ученика:"})," ",(y==null?void 0:y.comment)||(v==null?void 0:v.comment)]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[v&&v.isBooked&&v.studentId&&d&&e.jsxs("button",{onClick:()=>{n(d.id,v.studentId,d.name,v.studentName),Te()},className:"flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200",children:[e.jsx(tt,{className:"w-5 h-5"})," Чат с учеником"]}),v&&v.isBooked&&v.format==="online"&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(Xt,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Видеозвонок"})]})}),v&&v.isBooked&&e.jsxs("button",{onClick:()=>{i(v.lessonId),Te()},className:"flex items-center gap-2 bg-amber-100 text-amber-700 px-4 py-2 rounded-lg hover:bg-amber-200",children:[e.jsx(Or,{className:"w-5 h-5"})," Завершить урок"]}),v&&e.jsx("button",{onClick:()=>{o(v.id),Te()},className:"absolute top-4 left-4 text-red-500 hover:text-red-700",children:e.jsx(ds,{className:"w-6 h-6"})}),y&&y.status==="scheduled"&&d&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{n(d.id,y.studentId,d.name,y.studentName),Te()},className:"flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200",children:[e.jsx(tt,{className:"w-5 h-5"})," Чат с учеником"]}),y.format==="online"&&e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(Xt,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Видеозвонок"})]}),e.jsxs("button",{onClick:()=>{i(y.id),Te()},className:"flex items-center gap-2 bg-amber-100 text-amber-700 px-4 py-2 rounded-lg hover:bg-amber-200",children:[e.jsx(Or,{className:"w-5 h-5"})," Завершить урок"]})]}),y&&y.status==="completed"&&e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg text-center text-gray-800",children:"Урок завершён"})]})]})}),z&&C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[e.jsx("button",{onClick:()=>{I(!1),M(null)},className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Заявка на овербукинг"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ученик:"})," ",C.studentName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Предмет:"})," ",C.subject]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Класс:"})," ",C.grade]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Формат:"})," ",C.format]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Длительность:"})," ",C.duration," мин"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Время:"})," ",C.startTime||"—"," - ",C.endTime||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Цели:"})," ",Array.isArray(C.goals)?C.goals.join(", "):C.goals]}),C.comment&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-blue-900",children:[e.jsx("span",{className:"font-medium",children:"Комментарий:"})," ",C.comment]})]}),e.jsx("button",{className:"mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",onClick:()=>{Z(C),I(!1),M(null)},children:"Забронировать слот"})]})})]})},f3={ru:Dt},g3=gi({format:at,parse:yi,startOfWeek:Cs,getDay:pi,locales:f3}),Ed=({mode:t,student:r,onAssign:s})=>{const{timeSlots:a,lessons:n,bookLesson:i,createSlot:o}=ht(),{user:c}=it(),[l,d]=N.useState(null),[m,x]=N.useState(!1),[h,g]=N.useState(""),[v,u]=N.useState(!1),[p,w]=N.useState(!1),[y,D]=N.useState({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),[f,T]=N.useState(!1),[j,k]=N.useState(null),[C,M]=N.useState(!1),[z,I]=N.useState(""),X=a.filter(K=>{if(K.teacherId!==(c==null?void 0:c.id)||K.status==="completed")return!1;if(t==="assign"&&r){if(K.isBooked&&K.bookedStudentId!==r.id)return!1}else if(K.isBooked)return!1;return!0}),G=n.filter(K=>K.teacherId===(c==null?void 0:c.id)&&K.status!=="completed"),re=t==="assign"?a.filter(K=>K.teacherId===(c==null?void 0:c.id)&&K.status!=="completed"):X,H=t==="assign"?n.filter(K=>K.teacherId===(c==null?void 0:c.id)&&K.status!=="completed"):G,$=re.map(K=>({id:K.id,title:`${K.subject} - ${K.isBooked?"Забронирован":"Свободен"}`,start:new Date(`${K.date}T${K.startTime}`),end:new Date(`${K.date}T${K.endTime}`),resource:K,type:"slot",isBooked:K.isBooked,subject:K.subject,price:K.price,format:K.format,lessonType:K.lessonType})),W=H.map(K=>({id:K.id,title:`${K.subject} - ${K.studentName}`,start:new Date(`${K.date}T${K.startTime}`),end:new Date(`${K.date}T${K.endTime}`),resource:K,type:"lesson",studentName:K.studentName,subject:K.subject,price:K.price,format:K.format,status:K.status})),Q=[...$,...W],te=N.useCallback(K=>{let je={borderRadius:"8px",border:"none",padding:"4px 8px",fontSize:"12px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",transition:"all 0.2s ease"};return K.type==="slot"?K.isBooked?(je.backgroundColor="#10b981",je.color="white"):(je.backgroundColor="#3b82f6",je.color="white"):K.type==="lesson"&&(je.backgroundColor="#f59e0b",je.color="white"),{style:je}},[]),me=N.useCallback(K=>{d(K),x(!0),g("")},[]),ve=()=>{x(!1),d(null),g("")},Ne=async K=>{t==="assign"&&r&&(await i(K.id,r.id,r.name),s&&s())},he=N.useCallback(K=>{const{start:je,end:V}=K,ce=at(je,"yyyy-MM-dd"),De=at(je,"HH:mm"),Ie=at(V,"HH:mm");D({date:ce,startTime:De,endTime:Ie,subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),w(!0)},[]),Te=async()=>{if(!c||!y.subject.trim()){alert("Пожалуйста, заполните все обязательные поля");return}if(!y.startTime||!y.endTime||y.startTime>=y.endTime){alert("Проверьте корректность времени начала и окончания");return}T(!0);try{if(t==="assign"&&r){await o({...y,teacherId:c.id,teacherName:c.name,duration:60,lessonType:y.lessonType,format:y.format,experience:y.experience,goals:y.goals||[],grades:y.grades||[]},r.id,r.name,{mode:"assign"}),w(!1),D({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]});return}await o({...y,teacherId:c.id,teacherName:c.name,duration:60,lessonType:y.lessonType,format:y.format,experience:y.experience,goals:y.goals||[],grades:y.grades||[]}),w(!1),D({date:"",startTime:"",endTime:"",subject:"",lessonType:"regular",format:"online",price:1e3,experience:"beginner",goals:[],grades:[]}),alert("Слот успешно создан!")}catch{alert("Ошибка при создании слота")}finally{T(!1)}},Z=async K=>{if(r){M(!0);try{await i(K.id,r.id,r.name),I(`Урок назначен для ${r.name}`),setTimeout(()=>{I(""),k(null),s&&s()},1200)}catch{alert("Ошибка при бронировании слота")}finally{M(!1)}}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 p-2",children:[e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-1",children:"Календарь занятий"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Управляйте своим расписанием и отслеживайте забронированные уроки"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"p-3",children:e.jsx(fi,{localizer:g3,events:Q,startAccessor:"start",endAccessor:"end",style:{height:400},eventPropGetter:te,onSelectEvent:me,onSelectSlot:he,selectable:!0,views:["month","week","day"],messages:{next:"Следующий",previous:"Предыдущий",today:"Сегодня",month:"Месяц",week:"Неделя",day:"День",noEventsInRange:"Нет событий в выбранном диапазоне",showMore:K=>`+${K} еще`},className:"custom-calendar"})})}),e.jsxs("div",{className:"mt-3 bg-white rounded-lg shadow-sm border border-gray-100 p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Легенда"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Свободные слоты"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Забронированные слоты"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Запланированные уроки"})]})]})]})]}),m&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-xs w-full p-3 transform transition-all duration-300 scale-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900",children:l.type==="slot"?"Детали слота":"Детали урока"}),e.jsx("button",{onClick:ve,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Предмет:"}),e.jsx("p",{className:"text-xs text-gray-900",children:l.subject})]}),l.type==="slot"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Статус:"}),e.jsx("p",{className:`text-xs font-medium ${l.isBooked?"text-green-600":"text-blue-600"}`,children:l.isBooked?"Забронирован":"Свободен"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Тип урока:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:l.lessonType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Формат:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:l.format})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Цена:"}),e.jsxs("p",{className:"text-xs text-gray-900",children:[l.price," ₽"]})]}),!l.isBooked&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Имя студента для бронирования:"}),e.jsx("input",{type:"text",value:h,onChange:K=>g(K.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"Введите имя студента"}),e.jsx("button",{onClick:()=>Ne(l.resource),disabled:v,className:"mt-2 px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:v?"Бронирую...":"Забронировать слот"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Ученик:"}),e.jsx("p",{className:"text-xs text-gray-900",children:l.studentName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Статус:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:l.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Формат:"}),e.jsx("p",{className:"text-xs text-gray-900 capitalize",children:l.format})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Цена:"}),e.jsxs("p",{className:"text-xs text-gray-900",children:[l.price," ₽"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Время:"}),e.jsxs("p",{className:"text-gray-900 text-xs",children:[at(l.start,"HH:mm")," - ",at(l.end,"HH:mm")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Дата:"}),e.jsx("p",{className:"text-gray-900 text-xs",children:at(l.start,"dd MMMM yyyy",{locale:Dt})})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:ve,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Закрыть"})})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-sm w-full p-4 transform transition-all duration-300 scale-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Создать новый слот"}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Предмет *"}),e.jsx("input",{type:"text",value:y.subject,onChange:K=>D({...y,subject:K.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"Например: Математика",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Время начала"}),e.jsx("input",{type:"time",value:y.startTime,onChange:K=>D({...y,startTime:K.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Время окончания"}),e.jsx("input",{type:"time",value:y.endTime,onChange:K=>D({...y,endTime:K.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Тип урока"}),e.jsxs("select",{value:y.lessonType,onChange:K=>D({...y,lessonType:K.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"regular",children:"Обычный"}),e.jsx("option",{value:"trial",children:"Пробный"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Формат"}),e.jsxs("select",{value:y.format,onChange:K=>D({...y,format:K.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"online",children:"Онлайн"}),e.jsx("option",{value:"offline",children:"Офлайн"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Цена (₽)"}),e.jsx("input",{type:"number",value:y.price,onChange:K=>D({...y,price:parseInt(K.target.value)||0}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",placeholder:"1000",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Опыт"}),e.jsxs("select",{value:y.experience,onChange:K=>D({...y,experience:K.target.value}),className:"w-full border border-gray-300 rounded-md shadow-sm p-1.5 text-xs",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>w(!1),className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Отмена"}),e.jsx("button",{onClick:Te,disabled:f||!y.subject.trim(),className:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:f?"Создаю...":"Создать слот"})]})]})}),t==="assign"&&r&&j&&!j.isBooked&&e.jsx("button",{onClick:()=>Z(j),disabled:C,style:{marginTop:12,padding:"6px 16px",fontSize:14},children:C?"Назначение...":`Забронировать для ${r.name}`}),z&&e.jsx("div",{style:{color:"green",marginTop:8,fontSize:14},children:z})]})},x3={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},p3={background:"#fff",borderRadius:12,boxShadow:"0 2px 16px rgba(0,0,0,0.15)",padding:24,minWidth:320,maxHeight:"90vh",overflowY:"auto",position:"relative"},v3={position:"absolute",top:12,right:16,fontSize:24,background:"none",border:"none",cursor:"pointer",color:"#888"},$r=({open:t,onClose:r,children:s,style:a})=>t?e.jsx("div",{style:x3,onClick:r,children:e.jsxs("div",{style:{...p3,...a},onClick:n=>n.stopPropagation(),children:[e.jsx("button",{style:v3,onClick:r,"aria-label":"Закрыть",children:"×"}),s]})}):null,Ni=({onSubmit:t,onCancel:r,initialText:s="",isEditing:a=!1,userName:n="U",userAvatar:i})=>{const[o,c]=N.useState(s),[l,d]=N.useState([]),[m,x]=N.useState([]),h=N.useRef(null),g=w=>{const y=Array.from(w.target.files||[]);if(y.length===0)return;const D=[...l,...y];d(D);const f=y.map(T=>URL.createObjectURL(T));x([...m,...f]),h.current&&(h.current.value="")},v=w=>{const y=l.filter((f,T)=>T!==w),D=m.filter((f,T)=>T!==w);d(y),x(D)},u=()=>{if(!o.trim()&&l.length===0)return;const w=l.length>0?l.some(D=>D.type.startsWith("video/"))?"video":"image":"text",y={text:o.trim(),media:l,type:w};t(y),m.forEach(D=>URL.revokeObjectURL(D))},p=!o.trim()&&l.length===0;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center overflow-hidden",children:i?e.jsx("img",{src:i,alt:n,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:n.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{value:o,onChange:w=>c(w.target.value),placeholder:a?"Редактировать запись...":"Что нового?",className:"w-full border-none resize-none focus:ring-0 text-gray-900 placeholder-gray-500",rows:3}),m.length>0&&e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2",children:m.map((w,y)=>{var D;return e.jsxs("div",{className:"relative group",children:[(D=l[y])!=null&&D.type.startsWith("video/")?e.jsx("video",{src:w,className:"w-full h-24 object-cover rounded-lg",controls:!0}):e.jsx("img",{src:w,alt:"Preview",className:"w-full h-24 object-cover rounded-lg"}),e.jsx("button",{onClick:()=>v(y),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(nt,{className:"w-3 h-3"})})]},y)})}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{var w;return(w=h.current)==null?void 0:w.click()},className:"p-2 text-gray-500 hover:text-blue-500 transition-colors",title:"Добавить фото или видео",children:e.jsx(tn,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-500 hover:text-blue-500 transition-colors",children:e.jsx(Cn,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Отмена"}),e.jsx("button",{onClick:u,disabled:p,className:`px-4 py-2 rounded-lg font-medium transition-colors ${p?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:a?"Сохранить":"Опубликовать"})]})]})]})]}),e.jsx("input",{ref:h,type:"file",multiple:!0,accept:"image/*,video/*",onChange:g,className:"hidden"})]})},wn=({post:t,onReaction:r,onComment:s,onShare:a,onBookmark:n,onEdit:i,onDelete:o})=>{const[c,l]=N.useState(!1),[d,m]=N.useState(""),[x,h]=N.useState(!1),[g,v]=N.useState(!1),u=f=>{r(t.id,f),v(!1)},p=()=>{d.trim()&&(s(t.id,d.trim()),m(""))},w=f=>{i&&(i(t.id,f),h(!1))},y=()=>{o&&o(t.id)},D=f=>{const T=new Date(f),k=Math.floor((new Date().getTime()-T.getTime())/(1e3*60*60));return k<1?"только что":k<24?`${k}ч назад`:k<48?"вчера":T.toLocaleDateString("ru-RU")};return t.reactions.reduce((f,T)=>f+T.count,0),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 mb-4",children:[e.jsx("div",{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:t.userAvatar?e.jsx("img",{src:t.userAvatar,alt:t.userName,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:t.userName.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.userName}),e.jsx("div",{className:"text-sm text-gray-500",children:D(t.date)})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(kl,{className:"w-5 h-5"})}),e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10",children:[i&&e.jsx("button",{onClick:()=>h(!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50",children:"Редактировать"}),o&&e.jsx("button",{onClick:y,className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50",children:"Удалить"})]})]})]})}),x&&i&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx(Ni,{onSubmit:({text:f})=>w(f),onCancel:()=>h(!1),initialText:t.text,isEditing:!0})}),!x&&e.jsxs(e.Fragment,{children:[t.text&&e.jsxs("div",{className:"px-4 pb-3",children:[e.jsx("p",{className:"text-gray-900 whitespace-pre-line",children:t.text}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:t.tags.map(f=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-700 font-medium",children:["#",f]},f))})]}),t.media&&t.media.length>0&&e.jsx("div",{className:"px-4 pb-3",children:t.type==="video"?e.jsxs("div",{className:"relative",children:[e.jsx("video",{src:t.media[0],className:"w-full rounded-lg",controls:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(xu,{className:"w-12 h-12 text-white opacity-80"})})]}):e.jsx("div",{className:`grid gap-2 ${t.media.length===1?"grid-cols-1":t.media.length===2?"grid-cols-2":"grid-cols-3"}`,children:t.media.map((f,T)=>e.jsx("div",{className:"relative aspect-square",children:e.jsx("img",{src:f,alt:"Post media",className:"w-full h-full object-cover rounded-lg"})},T))})}),(t.likes&&t.likes>0||t.comments.length>0||t.views&&t.views>0)&&e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[t.likes&&t.likes>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(jt,{className:"w-4 h-4 text-red-500 fill-current"}),e.jsx("span",{children:t.likes})]}),t.comments.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(tt,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:t.comments.length})]}),t.views&&t.views>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(sr,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:t.views})]})]}),t.editedAt&&e.jsx("span",{className:"text-xs text-gray-400",children:"ред."})]})}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>v(!g),className:`flex items-center space-x-1 px-3 py-1 rounded-full transition-colors ${t.reactions.some(f=>f.userReacted)?"text-red-500 bg-red-50":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx(jt,{className:`w-5 h-5 ${t.reactions.some(f=>f.userReacted)?"fill-current":""}`}),e.jsx("span",{className:"text-sm",children:"Нравится"})]}),g&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>u("like"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Нравится",children:e.jsx(Dl,{className:"w-6 h-6 text-blue-500"})}),e.jsx("button",{onClick:()=>u("love"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Любовь",children:e.jsx(jt,{className:"w-6 h-6 text-red-500"})}),e.jsx("button",{onClick:()=>u("smile"),className:"p-2 hover:bg-gray-50 rounded-full transition-colors",title:"Улыбка",children:e.jsx(Cn,{className:"w-6 h-6 text-yellow-500"})})]})]}),e.jsxs("button",{onClick:()=>l(!c),className:"flex items-center space-x-1 px-3 py-1 rounded-full text-gray-500 hover:bg-gray-50 transition-colors",children:[e.jsx(tt,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Комментировать"})]}),e.jsxs("button",{onClick:()=>a(t.id),className:"flex items-center space-x-1 px-3 py-1 rounded-full text-gray-500 hover:bg-gray-50 transition-colors",children:[e.jsx(pu,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Поделиться"})]})]}),e.jsx("button",{onClick:()=>n(t.id),className:`p-2 rounded-full transition-colors ${t.isBookmarked?"text-blue-500 bg-blue-50":"text-gray-500 hover:bg-gray-50"}`,children:e.jsx(fa,{className:`w-5 h-5 ${t.isBookmarked?"fill-current":""}`})})]})}),c&&e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50",children:[e.jsx("div",{className:"space-y-3 mb-3",children:t.comments.map(f=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:f.userAvatar?e.jsx("img",{src:f.userAvatar,alt:f.userName,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-xs font-medium",children:f.userName.charAt(0).toUpperCase()})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"bg-white rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:f.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:D(f.date)})]}),e.jsx("p",{className:"text-sm text-gray-800",children:f.text})]})})]},f.id))}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:"U"})}),e.jsxs("div",{className:"flex-1 flex items-center space-x-2 bg-white rounded-full px-3 py-2",children:[e.jsx("input",{type:"text",value:d,onChange:f=>m(f.target.value),placeholder:"Написать комментарий...",className:"flex-1 border-none outline-none text-sm",onKeyPress:f=>f.key==="Enter"&&p()}),e.jsx("button",{onClick:p,disabled:!d.trim(),className:`p-1 rounded-full transition-colors ${d.trim()?"text-blue-500 hover:bg-blue-50":"text-gray-400"}`,children:e.jsx(Tl,{className:"w-4 h-4"})})]})]})]})]})]})},b3=({onSearchResults:t,onClose:r,className:s=""})=>{var $;const{posts:a,searchPosts:n}=ht(),[i,o]=N.useState(""),[c,l]=N.useState([]),[d,m]=N.useState("all"),[x,h]=N.useState(""),[g,v]=N.useState(""),[u,p]=N.useState(""),[w,y]=N.useState("date"),[D,f]=N.useState(!1),[T,j]=N.useState([]),[k,C]=N.useState(!1),M=N.useRef(),z=Array.from(new Set(a.flatMap(W=>W.tags||[]))).sort(),I=Array.from(new Set(a.map(W=>({id:W.userId,name:W.userName})))).filter((W,Q,te)=>Q===te.findIndex(me=>me.id===W.id)),X=()=>{C(!0);const W={query:i.trim()||void 0,tags:c.length>0?c:void 0,userId:x||void 0,dateFrom:g||void 0,dateTo:u||void 0,type:d==="all"?void 0:d,limit:50};let Q=[...a];if(W.query){const te=W.query.toLowerCase();Q=Q.filter(me=>me.text.toLowerCase().includes(te)||me.userName.toLowerCase().includes(te))}W.tags&&W.tags.length>0&&(Q=Q.filter(te=>te.tags&&W.tags.some(me=>te.tags.includes(me)))),W.userId&&(Q=Q.filter(te=>te.userId===W.userId)),W.type&&(Q=Q.filter(te=>te.type===W.type)),W.dateFrom&&(Q=Q.filter(te=>te.date>=W.dateFrom)),W.dateTo&&(Q=Q.filter(te=>te.date<=W.dateTo)),Q.sort((te,me)=>{switch(w){case"likes":return(me.likes||0)-(te.likes||0);case"comments":return me.comments.length-te.comments.length;case"views":return(me.views||0)-(te.views||0);case"date":default:return new Date(me.date).getTime()-new Date(te.date).getTime()}}),j(Q),C(!1),t&&t(Q),n(W)};N.useEffect(()=>(M.current&&clearTimeout(M.current),M.current=setTimeout(()=>{i.trim()||c.length>0||x||d!=="all"||g||u?X():(j([]),t&&t([]))},300),()=>{M.current&&clearTimeout(M.current)}),[i,c,x,d,g,u,w]);const G=()=>{o(""),l([]),h(""),m("all"),v(""),p(""),y("date"),j([]),t&&t([])},re=W=>{l(Q=>Q.includes(W)?Q.filter(te=>te!==W):[...Q,W])},H=W=>{const Q=new Date(W),me=Math.floor((new Date().getTime()-Q.getTime())/(1e3*60*60));return me<1?"только что":me<24?`${me}ч назад`:me<48?"вчера":Q.toLocaleDateString("ru-RU")};return e.jsxs("div",{className:`bg-white rounded-2xl shadow-lg border border-gray-200 ${s}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Поиск записей"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>f(!D),className:`p-2 rounded-full transition-colors ${D?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,title:"Фильтры",children:e.jsx(Nn,{className:"w-5 h-5"})}),e.jsx("button",{onClick:G,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Очистить поиск",children:e.jsx(nt,{className:"w-5 h-5"})}),r&&e.jsx("button",{onClick:r,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Закрыть",children:e.jsx(nt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mt-4 relative",children:[e.jsx(cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:i,onChange:W=>o(W.target.value),placeholder:"Поиск по записям...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),k&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"})})]}),(c.length>0||x||d!=="all"||g||u)&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[c.map(W=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-700",children:[e.jsx(ou,{className:"w-3 h-3 mr-1"}),W,e.jsx("button",{onClick:()=>re(W),className:"ml-2 hover:bg-blue-200 rounded-full p-0.5",children:e.jsx(nt,{className:"w-3 h-3"})})]},W)),x&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-700",children:[e.jsx(Ce,{className:"w-3 h-3 mr-1"}),(($=I.find(W=>W.id===x))==null?void 0:$.name)||x,e.jsx("button",{onClick:()=>h(""),className:"ml-2 hover:bg-green-200 rounded-full p-0.5",children:e.jsx(nt,{className:"w-3 h-3"})})]}),d!=="all"&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 text-purple-700",children:[d==="text"&&e.jsx(ar,{className:"w-3 h-3 mr-1"}),d==="image"&&e.jsx(tn,{className:"w-3 h-3 mr-1"}),d==="video"&&e.jsx(Xt,{className:"w-3 h-3 mr-1"}),d==="text"?"Текст":d==="image"?"Изображения":"Видео",e.jsx("button",{onClick:()=>m("all"),className:"ml-2 hover:bg-purple-200 rounded-full p-0.5",children:e.jsx(nt,{className:"w-3 h-3"})})]})]})]}),D&&e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тип контента"}),e.jsxs("select",{value:d,onChange:W=>m(W.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Все типы"}),e.jsx("option",{value:"text",children:"Только текст"}),e.jsx("option",{value:"image",children:"С изображениями"}),e.jsx("option",{value:"video",children:"С видео"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Автор"}),e.jsxs("select",{value:x,onChange:W=>h(W.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Все авторы"}),I.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Сортировка"}),e.jsxs("select",{value:w,onChange:W=>y(W.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"date",children:"По дате"}),e.jsx("option",{value:"likes",children:"По лайкам"}),e.jsx("option",{value:"comments",children:"По комментариям"}),e.jsx("option",{value:"views",children:"По просмотрам"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата от"}),e.jsx("input",{type:"date",value:g,onChange:W=>v(W.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата до"}),e.jsx("input",{type:"date",value:u,onChange:W=>p(W.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),z.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Популярные теги"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:z.slice(0,10).map(W=>e.jsxs("button",{onClick:()=>re(W),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${c.includes(W)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["#",W]},W))})]})]}),T.length>0&&e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Найдено ",T.length," записей"]})}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:T.map(W=>e.jsx("div",{className:"p-3 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center flex-shrink-0",children:W.userAvatar?e.jsx("img",{src:W.userAvatar,alt:W.userName,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("span",{className:"text-white text-sm font-medium",children:W.userName.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:W.userName}),e.jsx("span",{className:"text-xs text-gray-500",children:H(W.date)}),W.type!=="text"&&e.jsx("span",{className:"text-xs text-gray-500",children:W.type==="image"?e.jsx(tn,{className:"w-3 h-3 inline"}):e.jsx(Xt,{className:"w-3 h-3 inline"})})]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2 mb-2",children:W.text}),W.tags&&W.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[W.tags.slice(0,3).map(Q=>e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["#",Q]},Q)),W.tags.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",W.tags.length-3]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(jt,{className:"w-3 h-3"}),e.jsx("span",{children:W.likes||0})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(tt,{className:"w-3 h-3"}),e.jsx("span",{children:W.comments.length})]}),W.views&&e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(sr,{className:"w-3 h-3"}),e.jsx("span",{children:W.views})]})]})]})]})},W.id))})]}),i.trim()&&T.length===0&&!k&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(cs,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"По вашему запросу ничего не найдено"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Попробуйте изменить параметры поиска"})]})]})},y3=({className:t=""})=>{const{notifications:r,markNotificationAsRead:s,markAllNotificationsAsRead:a,deleteNotification:n}=ht(),{user:i}=it(),[o,c]=N.useState(!1),[l,d]=N.useState(!1),[m,x]=N.useState("all"),h=N.useRef(null),g=r.filter(f=>!f.isRead).length;N.useEffect(()=>{const f=T=>{h.current&&!h.current.contains(T.target)&&c(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const v=r.filter(f=>m==="unread"?!f.isRead:m==="read"?f.isRead:!0),u=l?v:v.slice(0,5),p=f=>{switch(f){case"new_post":return e.jsx(ar,{className:"w-5 h-5 text-blue-500"});case"reaction":return e.jsx(jt,{className:"w-5 h-5 text-red-500"});case"comment":return e.jsx(tt,{className:"w-5 h-5 text-green-500"});case"new_message":return e.jsx(tt,{className:"w-5 h-5 text-blue-500"});case"follow":return e.jsx(us,{className:"w-5 h-5 text-purple-500"});case"lesson_reminder":return e.jsx(lt,{className:"w-5 h-5 text-orange-500"});case"system":return e.jsx(ga,{className:"w-5 h-5 text-gray-500"});default:return e.jsx(as,{className:"w-5 h-5 text-gray-500"})}},w=f=>{const T=new Date(f),k=Math.floor((new Date().getTime()-T.getTime())/(1e3*60));return k<1?"только что":k<60?`${k}м назад`:k<1440?`${Math.floor(k/60)}ч назад`:T.toLocaleDateString("ru-RU")},y=()=>{i&&a(i.id)},D=f=>{var T,j;f.isRead||s(f.id),f.type==="new_message"&&((T=f.data)!=null&&T.chatId)?(window.location.href=`#chat-${f.data.chatId}`,c(!1)):(j=f.data)!=null&&j.postId};return e.jsxs("div",{className:`relative ${t}`,ref:h,children:[e.jsxs("button",{onClick:()=>c(!o),className:"relative p-2 rounded-full hover:bg-gray-100 transition-colors",children:[e.jsx(as,{className:"w-6 h-6 text-gray-600"}),g>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:g>99?"99+":g})]}),o&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 bg-white rounded-2xl shadow-2xl border border-gray-200 z-50 max-h-[600px] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Уведомления"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[g>0&&e.jsx("button",{onClick:y,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Отметить все как прочитанные"}),e.jsx("button",{onClick:()=>c(!1),className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(nt,{className:"w-4 h-4 text-gray-500"})})]})]}),e.jsx("div",{className:"flex items-center space-x-2 mt-3",children:[{key:"all",label:"Все",count:r.length},{key:"unread",label:"Непрочитанные",count:g},{key:"read",label:"Прочитанные",count:r.length-g}].map(({key:f,label:T,count:j})=>e.jsxs("button",{onClick:()=>x(f),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${m===f?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[T," (",j,")"]},f))})]}),e.jsx("div",{className:"overflow-y-auto max-h-[400px]",children:u.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(as,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsxs("p",{className:"text-gray-500",children:[m==="all"&&"Нет уведомлений",m==="unread"&&"Нет непрочитанных уведомлений",m==="read"&&"Нет прочитанных уведомлений"]})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:u.map(f=>e.jsx("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${f.isRead?"":"bg-blue-50"}`,onClick:()=>D(f),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:p(f.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:f.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:w(f.createdAt)})]}),!f.isRead&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center space-x-1",children:[!f.isRead&&e.jsx("button",{onClick:T=>{T.stopPropagation(),s(f.id)},className:"p-1 rounded-full hover:bg-green-100 transition-colors",title:"Отметить как прочитанное",children:e.jsx(ru,{className:"w-4 h-4 text-green-600"})}),e.jsx("button",{onClick:T=>{T.stopPropagation(),n(f.id)},className:"p-1 rounded-full hover:bg-red-100 transition-colors",title:"Удалить",children:e.jsx(ds,{className:"w-4 h-4 text-red-600"})})]})]})},f.id))})}),v.length>5&&e.jsx("div",{className:"p-4 border-t border-gray-100",children:e.jsx("button",{onClick:()=>d(!l),className:"w-full flex items-center justify-center space-x-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:l?e.jsxs(e.Fragment,{children:[e.jsx(au,{className:"w-4 h-4"}),e.jsx("span",{children:"Показать меньше"})]}):e.jsxs(e.Fragment,{children:[e.jsx(su,{className:"w-4 h-4"}),e.jsxs("span",{children:["Показать все (",v.length,")"]})]})})})]})]})},w3=({posts:t,currentUserId:r,currentUserName:s,currentUserAvatar:a,onCreatePost:n,onReaction:i,onComment:o,onShare:c,onBookmark:l,onEdit:d,onDelete:m,showCreateButton:x=!0,title:h="Записи",showSearch:g=!0,showNotifications:v=!0,showTrending:u=!0,showBookmarks:p=!0})=>{const[w,y]=N.useState(!1),[D,f]=N.useState(!1),[T,j]=N.useState("all"),[k,C]=N.useState(t),[M,z]=N.useState([]);N.useEffect(()=>{let X=t;T==="my"?X=t.filter(G=>G.userId===r):T==="others"?X=t.filter(G=>G.userId!==r):T==="trending"?X=[...t].sort((G,re)=>{const H=(G.likes||0)+G.comments.length;return(re.likes||0)+re.comments.length-H}).slice(0,20):T==="bookmarks"&&(X=t.filter(G=>{var re;return(re=G.bookmarks)==null?void 0:re.includes(r)})),C(X)},[t,T,r]);const I=X=>{n(X),y(!1)};return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:h}),e.jsxs("div",{className:"flex items-center space-x-2",children:[v&&e.jsx(y3,{className:"mr-2"}),g&&e.jsx("button",{onClick:()=>f(!D),className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"Поиск",children:e.jsx(cs,{className:"w-5 h-5"})}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:T,onChange:X=>j(X.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg px-3 py-2 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Все записи"}),e.jsx("option",{value:"my",children:"Мои записи"}),e.jsx("option",{value:"others",children:"Записи других"}),u&&e.jsx("option",{value:"trending",children:"Популярные"}),p&&e.jsx("option",{value:"bookmarks",children:"Закладки"})]}),e.jsx(Nn,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]}),x&&e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ls,{className:"w-4 h-4"}),e.jsx("span",{children:"Создать запись"})]})]})]}),D&&e.jsx("div",{className:"mb-6",children:e.jsx(b3,{onSearchResults:z,onClose:()=>f(!1)})}),w&&e.jsx("div",{className:"mb-6",children:e.jsx(Ni,{onSubmit:I,onCancel:()=>y(!1),userName:s,userAvatar:a})}),e.jsxs("div",{className:"space-y-4",children:[M.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Результаты поиска (",M.length,")"]}),e.jsx("div",{className:"space-y-4",children:M.map(X=>e.jsx(wn,{post:X,currentUserId:r,onReaction:i,onComment:o,onShare:c,onBookmark:l,onEdit:d,onDelete:m},X.id))})]}),k.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"text-gray-400 text-lg mb-2",children:[T==="all"&&"Пока нет записей",T==="my"&&"У вас пока нет записей",T==="others"&&"Пока нет записей от других",T==="trending"&&"Пока нет популярных записей",T==="bookmarks"&&"У вас пока нет закладок"]}),e.jsxs("p",{className:"text-gray-500",children:[T==="my"&&x&&"Создайте первую запись!",T==="others"&&"Записи от других пользователей появятся здесь",T==="trending"&&"Популярные записи появятся здесь",T==="bookmarks"&&"Добавляйте записи в закладки!"]})]}):k.map(X=>e.jsx(wn,{post:X,currentUserId:r,onReaction:i,onComment:o,onShare:c,onBookmark:l,onEdit:d,onDelete:m},X.id))]})]})},j3=({userId:t,onClose:r,onMessage:s,onBookLesson:a,isModal:n=!1})=>{const{user:i}=it(),{posts:o,createPost:c,addReaction:l,addComment:d,sharePost:m,bookmarkPost:x,editPost:h,deletePost:g,allUsers:v}=ht(),[u,p]=N.useState(!1),[w,y]=N.useState(!1),[D,f]=N.useState(!1),[T,j]=N.useState("posts"),k=v.find(H=>H.id===t),C=(i==null?void 0:i.id)===t,M=(k==null?void 0:k.role)==="teacher",z=o.filter(H=>H.userId===t),I=k==null?void 0:k.profile,X=H=>{switch(H){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return H}},G=H=>{switch(H){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return H}};if(!k)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ce,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пользователь не найден"}),e.jsx("p",{className:"text-gray-500",children:"Пользователь с таким ID не существует"})]})});const re=()=>{var H;return e.jsx("div",{className:`${n?"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4":""}`,children:e.jsxs("div",{className:`bg-white rounded-3xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto relative ${n?"":"border border-gray-200"}`,children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[r&&e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(jn,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!C&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>y(!w),className:`p-2 rounded-full transition-colors ${w?"text-blue-500 bg-blue-50":"text-gray-400 hover:text-blue-500"}`,children:e.jsx(fa,{className:`w-5 h-5 ${w?"fill-current":""}`})}),e.jsx("button",{onClick:()=>p(!u),className:`p-2 rounded-full transition-colors ${u?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500"}`,children:e.jsx(jt,{className:`w-5 h-5 ${u?"fill-current":""}`})})]}),e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(rr,{className:"w-5 h-5"})}),C&&e.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ga,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsxs("div",{className:"h-56 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"}),e.jsx("div",{className:"absolute bottom-6 left-8 right-8",children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"text-white flex-1 mr-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3 leading-tight",children:(I==null?void 0:I.name)||k.name||"Пользователь"}),e.jsxs("div",{className:"flex items-center space-x-4 flex-wrap",children:[M&&(I==null?void 0:I.experience)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Jt,{className:"h-4 w-4 text-yellow-300"}),e.jsx("span",{className:"font-semibold text-xs",children:X(I.experience)})]}),(I==null?void 0:I.rating)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(zt,{className:"h-4 w-4 text-yellow-300 fill-current"}),e.jsx("span",{className:"font-semibold text-xs",children:I.rating})]}),(I==null?void 0:I.city)&&e.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full border border-white/30",children:[e.jsx(Nt,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-xs",children:I.city})]})]})]}),e.jsxs("div",{className:"text-right text-white/90 flex-shrink-0",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:z.length}),e.jsx("div",{className:"text-sm opacity-80",children:"записей"})]})]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start mt-8",children:[e.jsxs("div",{className:"flex-shrink-0 -mt-12 ml-8 relative",children:[e.jsxs("div",{className:"w-36 h-36 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center overflow-hidden border-6 border-white shadow-2xl relative",children:[e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-green-500 border-3 border-white rounded-full shadow-lg"}),I!=null&&I.avatar&&I.avatar.trim()!==""?e.jsx("img",{src:I.avatar,alt:k.name,className:"w-36 h-36 object-cover rounded-full",onError:$=>{var Q;const W=$.target;W.style.display="none",(Q=W.nextElementSibling)==null||Q.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-36 h-36 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center ${I!=null&&I.avatar&&I.avatar.trim()!==""?"hidden":""}`,children:e.jsx(Ce,{className:"h-20 w-20 text-white"})})]}),!C&&e.jsxs("div",{className:"absolute -bottom-2 -right-2 flex space-x-2",children:[e.jsx("button",{onClick:()=>p(!u),className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${u?"bg-red-500 text-white scale-110":"bg-white text-gray-600 hover:bg-red-50 hover:text-red-500"}`,children:e.jsx(jt,{className:`w-5 h-5 ${u?"fill-current":""}`})}),e.jsx("button",{className:"w-10 h-10 rounded-full bg-white text-gray-600 hover:bg-gray-50 shadow-lg transition-all duration-200 flex items-center justify-center",children:e.jsx(rr,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-wrap gap-4 mt-12 lg:mt-0",children:[!C&&e.jsxs(e.Fragment,{children:[M&&a&&e.jsxs("button",{onClick:()=>a(k.id),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(Be,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Записаться на урок"})]}),s&&e.jsxs("button",{onClick:()=>s(k.id),className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-2xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(tt,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Написать сообщение"})]}),e.jsxs("button",{onClick:()=>f(!D),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-2xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center space-x-2 transform hover:-translate-y-1",children:[e.jsx(sr,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Контактная информация"})]})]}),C&&e.jsxs("button",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center space-x-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[e.jsx(os,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg",children:"Редактировать профиль"})]})]})]})]}),D&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 mb-8 mt-8 border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-lg",children:"Контактная информация"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[k.phone&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx($t,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:k.phone})]}),k.email&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border border-blue-200",children:[e.jsx(Sn,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:k.email})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6 mt-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:z.length}),e.jsx("div",{className:"text-blue-100 text-xs",children:"Записей"})]}),M&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(I==null?void 0:I.lessonsCount)||0}),e.jsx("div",{className:"text-green-100 text-xs",children:"Проведено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:((H=I==null?void 0:I.students)==null?void 0:H.length)||0}),e.jsx("div",{className:"text-purple-100 text-xs",children:"Учеников"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 to-orange-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:(I==null?void 0:I.rating)||0}),e.jsx("div",{className:"text-orange-100 text-xs",children:"Рейтинг"})]})]}),!M&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-green-100 text-xs",children:"Посещено уроков"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-purple-100 text-xs",children:"Преподавателей"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 to-orange-700 text-white rounded-lg p-3 text-center shadow-md",children:[e.jsx("div",{className:"text-xl font-bold mb-1",children:"0"}),e.jsx("div",{className:"text-orange-100 text-xs",children:"Дней в системе"})]})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8 mt-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"posts",label:"Записи",count:z.length},{id:"about",label:"О пользователе",count:null},{id:"lessons",label:M?"Расписание":"Мои уроки",count:0},{id:"reviews",label:"Отзывы",count:0}].map($=>e.jsxs("button",{onClick:()=>j($.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${T===$.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[$.label,$.count!==null&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2 rounded-full text-xs",children:$.count})]},$.id))})}),e.jsxs("div",{className:"min-h-[400px]",children:[T==="posts"&&e.jsx("div",{className:"space-y-6",children:e.jsx(w3,{posts:z,currentUserId:(i==null?void 0:i.id)||"",currentUserName:(i==null?void 0:i.name)||"",currentUserAvatar:i==null?void 0:i.avatar,onCreatePost:c,onReaction:l,onComment:d,onShare:m,onBookmark:x,onEdit:h,onDelete:g,showCreateButton:C,title:`Записи ${(I==null?void 0:I.name)||k.name}`,showSearch:!0,showNotifications:!1,showTrending:!1,showBookmarks:!0})}),T==="about"&&e.jsxs("div",{className:"space-y-3",children:[(I==null?void 0:I.bio)&&e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-indigo-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-indigo-500 to-purple-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"О пользователе"]}),e.jsx("div",{className:"bg-white/60 backdrop-blur-sm rounded-md p-2 border border-indigo-200/50",children:e.jsx("p",{className:"text-indigo-800 leading-relaxed whitespace-pre-line text-xs",children:I.bio})})]}),M&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[(I==null?void 0:I.subjects)&&I.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Предметы"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:I.subjects.map(($,W)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium border border-blue-200/50 shadow-sm",children:$},W))})]}),(I==null?void 0:I.grades)&&I.grades.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-emerald-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 to-teal-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Классы"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:I.grades.map(($,W)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-emerald-800 px-2 py-0.5 rounded-md text-xs font-medium border border-emerald-200/50 shadow-sm",children:$},W))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2.5",children:[(I==null?void 0:I.hourlyRate)&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-200 rounded-lg p-2.5 text-center shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-purple-900 mb-1.5 flex items-center justify-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-purple-500 to-violet-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Стоимость"]}),e.jsxs("div",{className:"text-base font-bold text-purple-700 bg-white/60 backdrop-blur-sm rounded-md py-1 px-1.5 border border-purple-200/50",children:[I.hourlyRate," ₽/час"]})]}),(I==null?void 0:I.formats)&&I.formats.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-orange-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-orange-500 to-amber-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Форматы"]}),e.jsx("div",{className:"space-y-1",children:I.formats.map(($,W)=>e.jsxs("div",{className:"flex items-center space-x-1.5 p-1 bg-white/60 backdrop-blur-sm rounded border border-orange-200/50",children:[e.jsx(Rt,{className:"h-3 w-3 text-orange-600"}),e.jsx("span",{className:"text-orange-800 text-xs font-medium",children:G($)})]},W))})]}),(I==null?void 0:I.durations)&&I.durations.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 border border-cyan-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-cyan-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-cyan-500 to-blue-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Длительность"]}),e.jsx("div",{className:"space-y-1",children:I.durations.map(($,W)=>e.jsxs("div",{className:"flex items-center space-x-1.5 p-1 bg-white/60 backdrop-blur-sm rounded border border-cyan-200/50",children:[e.jsx(Rt,{className:"h-3 w-3 text-cyan-600"}),e.jsxs("span",{className:"text-cyan-800 text-xs font-medium",children:[$," минут"]})]},W))})]})]})]}),!M&&I&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[I.subjects&&I.subjects.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Интересуется предметами"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:I.subjects.map(($,W)=>e.jsx("span",{className:"bg-white/80 backdrop-blur-sm text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium border border-blue-200/50 shadow-sm",children:$},W))})]}),I.grade&&e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-2.5 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-emerald-900 mb-1.5 flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 to-teal-600 rounded flex items-center justify-center mr-1.5",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})}),"Класс"]}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm text-emerald-800 px-2 py-1 rounded-md text-xs font-medium border border-emerald-200/50 shadow-sm",children:I.grade})]})]})]}),T==="lessons"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(lt,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:M?"Расписание пока не настроено":"Уроки пока не запланированы"}),e.jsx("p",{className:"text-gray-500",children:M?"Настройте расписание для проведения уроков":"Запишитесь на уроки к преподавателям"})]}),T==="reviews"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(zt,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Пока нет отзывов"}),e.jsx("p",{className:"text-gray-500",children:"Отзывы о пользователе появятся здесь"})]})]})]})]})})};return n?e.jsx(re,{}):e.jsx(re,{})};async function xl(t){try{const r=JSON.parse(localStorage.getItem("tutoring_studentProfiles")||"{}");if(r[t])return console.log(" Found student profile in localStorage:",r[t]),r[t];const a=JSON.parse(localStorage.getItem("tutoring_users")||"[]").find(n=>n.id===t&&n.role==="student");if(a!=null&&a.profile)return console.log(" Found student profile in users list:",a.profile),a.profile;try{console.log(" Loading student profile from server for ID:",t);const n=await fetch(`${ze}/api/students/${t}`);if(n.ok){const i=await n.json();console.log(" Loaded student profile from server:",i);const o={...r,[t]:i};return localStorage.setItem("tutoring_studentProfiles",JSON.stringify(o)),i}}catch(n){console.warn(" Failed to load student profile from server:",n)}return}catch(r){console.error(" Error getting student profile:",r);return}}const Vs=({icon:t,value:r,label:s,color:a})=>e.jsxs("div",{className:`${a} rounded-xl p-4 text-center`,children:[e.jsx("div",{className:"w-8 h-8 mx-auto mb-2 flex items-center justify-center",children:t}),e.jsx("div",{className:"text-2xl font-bold",children:r}),e.jsx("div",{className:"text-sm text-gray-600",children:s})]}),ur=({icon:t,label:r,value:s,fallback:a="Не указано"})=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-gray-400",children:t}),e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[r,":"]})," ",e.jsx("span",{children:s||a})]})]}),rs=({items:t,color:r,emptyMessage:s})=>!t||t.length===0?s?e.jsx("span",{className:"text-gray-500 text-sm",children:s}):null:e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map((a,n)=>e.jsx("span",{className:`${r} px-3 py-1 rounded-full text-sm`,children:a},n))}),N3=()=>{var he,Te,Z,K,je;const{user:t}=it(),{lessons:r,createSlot:s,studentProfiles:a}=ht(),[n,i]=N.useState(null),[o,c]=N.useState(!1),[l,d]=N.useState(!1),[m,x]=N.useState(null),[h,g]=N.useState({subject:"",date:"",startTime:"",endTime:"",duration:60,lessonType:"regular",format:"online",price:1e3,experience:"beginner",grades:[],goals:[]}),[v,u]=N.useState(!1),[p,w]=N.useState(""),[y,D]=N.useState(!1),[f,T]=N.useState(null),[j,k]=N.useState(null),[C,M]=N.useState(null),[z,I]=N.useState(!1),X=r.filter(V=>V.teacherId===(t==null?void 0:t.id)),G={};X.forEach(V=>{G[V.studentId]||(G[V.studentId]={studentName:V.studentName,studentId:V.studentId,lessons:[]}),G[V.studentId].lessons.push(V)});const re=Object.values(G);N.useEffect(()=>{(async()=>{if(n){I(!0),console.log(" Loading profile for student:",n.studentId);let ce=a[n.studentId];ce||(ce=await xl(n.studentId)),console.log(" Profile loaded:",ce),M(ce||null),I(!1)}})()},[n,a]);const H=(V,ce)=>{alert(`Чат с ${ce} открыт! Перейдите в раздел "Чаты" для общения.`)},$=V=>{i(V),c(!0)},W=()=>{c(!1),i(null),M(null)},Q=async()=>{if(n){I(!0);try{console.log(" Refreshing student profile from server...");const V=await xl(n.studentId);M(V||null)}catch(V){console.error(" Error refreshing student profile:",V)}finally{I(!1)}}},te=V=>{T(V),D(!0)},me=async()=>{if(!(!t||!m)){u(!0),w("");try{await s({...h,teacherId:t.id,teacherName:t.name},m.id,m.name,{mode:"assign"}),d(!1)}catch(V){w(V.message||"Ошибка при создании урока")}finally{u(!1)}}},Ne=(V=>{var Ie,Le,Xe;if(!V)return 0;const ce=[V.grade,V.age,V.school,V.city,V.phone,V.parentName,V.parentPhone,(Ie=V.subjects)==null?void 0:Ie.length,(Le=V.goals)==null?void 0:Le.length,(Xe=V.interests)==null?void 0:Xe.length,V.learningStyle,V.experience,V.bio],De=ce.filter(Qe=>Qe&&(Array.isArray(Qe)?Qe.length>0:!0)).length;return Math.round(De/ce.length*100)})(C);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Ученики"}),e.jsx("p",{className:"text-gray-600",children:"Здесь отображаются все ученики, которые бронировали у вас уроки, и история ваших занятий с ними"})]}),re.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(us,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Пока нет учеников"}),e.jsx("p",{className:"text-gray-600",children:"Ученики появятся здесь после того, как забронируют у вас уроки"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:re.map(V=>e.jsx("div",{className:"card-gradient hover:shadow-lg transition-shadow duration-200 overflow-hidden cursor-pointer",onClick:()=>$(V),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-400 to-indigo-500 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"h-6 w-6 text-white"})}),e.jsx("div",{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:V.studentName})}),e.jsxs("div",{className:"ml-auto flex items-center space-x-1",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-blue-600",title:"Просмотреть записи",onClick:ce=>{ce.stopPropagation(),k(V.studentId)},children:e.jsx(ar,{className:"h-5 w-5"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-blue-600",title:"Подробнее о профиле",onClick:ce=>{ce.stopPropagation(),$(V)},children:e.jsx(cu,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Уроки:"}),V.lessons.length>0?e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[V.lessons.slice(0,3).map((ce,De)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:ce.subject}),e.jsx("span",{className:"text-gray-400",children:ce.date})]},ce.id)),V.lessons.length>3&&e.jsxs("li",{className:"text-gray-400 text-xs",children:["и еще ",V.lessons.length-3," уроков..."]})]}):e.jsx("p",{className:"text-sm text-gray-500",children:"Нет уроков"})]})]})},V.studentId))}),o&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-5xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:W,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(nt,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:Q,disabled:z,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors flex items-center space-x-2 disabled:opacity-50",title:"Обновить данные",children:[e.jsx(ea,{className:`w-4 h-4 ${z?"animate-spin":""}`}),e.jsx("span",{children:"Обновить"})]}),e.jsxs("button",{onClick:()=>H(n.studentId,n.studentName),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-2",children:[e.jsx(tt,{className:"w-4 h-4"}),e.jsx("span",{children:"Написать"})]}),e.jsxs("button",{onClick:()=>te({id:n.studentId,name:n.studentName}),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center space-x-2",children:[e.jsx(lt,{className:"w-4 h-4"}),e.jsx("span",{children:"Назначить урок"})]})]})]})}),e.jsx("div",{className:"p-6",children:z?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ea,{className:"w-8 h-8 mx-auto mb-4 animate-spin text-blue-500"}),e.jsx("p",{className:"text-gray-600",children:"Загружаем данные профиля..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col items-center lg:items-start",children:[C!=null&&C.avatar&&C.avatar.trim()!==""?e.jsx("img",{src:C.avatar,alt:"avatar",className:"w-32 h-32 rounded-full object-cover mb-4",onError:V=>{var De;const ce=V.target;ce.style.display="none",(De=ce.nextElementSibling)==null||De.classList.remove("hidden")}}):null,e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-r from-blue-400 to-indigo-500 flex items-center justify-center mb-4",children:e.jsx(Ce,{className:"h-16 w-16 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:n.studentName}),e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Ne>70?e.jsx(Or,{className:"w-5 h-5 text-green-500"}):Ne>30?e.jsx($i,{className:"w-5 h-5 text-yellow-500"}):e.jsx($i,{className:"w-5 h-5 text-red-500"}),e.jsxs("span",{className:`text-sm font-medium ${Ne>70?"text-green-600":Ne>30?"text-yellow-600":"text-red-600"}`,children:["Профиль заполнен на ",Ne,"%"]})]}),(C==null?void 0:C.grade)&&e.jsxs("div",{className:"flex items-center text-lg text-gray-600 mb-2",children:[e.jsx(fr,{className:"w-5 h-5 mr-2"}),e.jsxs("span",{children:[C.grade," класс"]})]}),(C==null?void 0:C.age)&&e.jsxs("div",{className:"text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Возраст:"})," ",C.age," лет"]})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(Vs,{icon:e.jsx(Be,{className:"w-8 h-8 text-blue-500"}),value:((he=G[n.studentId])==null?void 0:he.lessons.length)||0,label:"Всего уроков",color:"bg-blue-50"}),e.jsx(Vs,{icon:e.jsx(Jt,{className:"w-8 h-8 text-green-500"}),value:((Te=G[n.studentId])==null?void 0:Te.lessons.filter(V=>V.status==="completed").length)||0,label:"Завершено",color:"bg-green-50"}),e.jsx(Vs,{icon:e.jsx(us,{className:"w-8 h-8 text-purple-500"}),value:((Z=C==null?void 0:C.subjects)==null?void 0:Z.length)||0,label:"Предметов",color:"bg-purple-50"}),e.jsx(Vs,{icon:e.jsx(Ts,{className:"w-8 h-8 text-orange-500"}),value:C!=null&&C.experience?C.experience==="beginner"?"Начинающий":C.experience==="intermediate"?"Средний":"Продвинутый":"Не указан",label:"Уровень",color:"bg-orange-50"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ce,{className:"w-5 h-5 mr-2 text-blue-500"}),"Личная информация"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(ur,{icon:e.jsx(kn,{className:"w-4 h-4"}),label:"Школа",value:(C==null?void 0:C.school)||"",fallback:"Не указана"}),e.jsx(ur,{icon:e.jsx(Nt,{className:"w-4 h-4"}),label:"Город",value:(C==null?void 0:C.city)||"",fallback:"Не указан"}),e.jsx(ur,{icon:e.jsx($t,{className:"w-4 h-4"}),label:"Телефон",value:(C==null?void 0:C.phone)||"",fallback:"Не указан"}),e.jsx(ur,{icon:e.jsx(Ce,{className:"w-4 h-4"}),label:"Родитель",value:(C==null?void 0:C.parentName)||"",fallback:"Не указан"}),e.jsx(ur,{icon:e.jsx($t,{className:"w-4 h-4"}),label:"Телефон родителя",value:(C==null?void 0:C.parentPhone)||"",fallback:"Не указан"}),e.jsx(ur,{icon:e.jsx(Rt,{className:"w-4 h-4"}),label:"Часовой пояс",value:(C==null?void 0:C.timeZone)||"",fallback:"Не указан"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Be,{className:"w-5 h-5 mr-2 text-green-500"}),"Учебная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 block mb-2",children:"Изучаемые предметы:"}),e.jsx(rs,{items:(C==null?void 0:C.subjects)||[],color:"bg-blue-100 text-blue-800",emptyMessage:"Не указаны"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 block mb-2",children:"Цели обучения:"}),e.jsx(rs,{items:(C==null?void 0:C.goals)||[],color:"bg-green-100 text-green-800",emptyMessage:"Не указаны"})]}),e.jsx(ur,{icon:e.jsx(Tn,{className:"w-4 h-4"}),label:"Стиль обучения",value:(C==null?void 0:C.learningStyle)==="visual"?"Визуальный":(C==null?void 0:C.learningStyle)==="auditory"?"Аудиальный":(C==null?void 0:C.learningStyle)==="kinesthetic"?"Кинестетический":(C==null?void 0:C.learningStyle)==="mixed"?"Смешанный":"",fallback:"Не указан"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 block mb-2",children:"Предпочитаемые форматы:"}),e.jsx(rs,{items:(C==null?void 0:C.preferredFormats)||[],color:"bg-purple-100 text-purple-800",emptyMessage:"Не указаны"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 block mb-2",children:"Предпочитаемая длительность:"}),e.jsx(rs,{items:((K=C==null?void 0:C.preferredDurations)==null?void 0:K.map(V=>`${V} мин`))||[],color:"bg-orange-100 text-orange-800",emptyMessage:"Не указана"})]})]})]}),(C==null?void 0:C.interests)&&C.interests.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(jt,{className:"w-5 h-5 mr-2 text-red-500"}),"Интересы и хобби"]}),e.jsx(rs,{items:C.interests,color:"bg-red-100 text-red-800"})]}),(C==null?void 0:C.bio)&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ar,{className:"w-5 h-5 mr-2 text-indigo-500"}),"О себе"]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:C.bio})]})]}),((je=G[n.studentId])==null?void 0:je.lessons)&&G[n.studentId].lessons.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(lt,{className:"w-5 h-5 mr-2 text-blue-500"}),"История уроков"]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:e.jsx("div",{className:"max-h-64 overflow-y-auto",children:G[n.studentId].lessons.map((V,ce)=>e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:V.subject}),e.jsxs("p",{className:"text-sm text-gray-600",children:[V.date," в ",V.startTime,"-",V.endTime]}),V.comment&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:V.comment})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V.status==="completed"?"bg-green-100 text-green-800":V.status==="scheduled"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:V.status==="completed"?"Завершен":V.status==="scheduled"?"Запланирован":"Отменен"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[V.price," ₽"]})]})]})},V.id))})})]}),!C&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ce,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Профиль не заполнен"}),e.jsx("p",{className:"text-gray-600",children:"Ученик еще не заполнил информацию о себе"})]})]})})]})}),l&&m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:()=>d(!1),title:"Закрыть",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("h3",{children:["Назначить урок для ",m.name]}),e.jsxs("form",{className:"flex flex-col gap-2",children:[e.jsx("input",{type:"text",placeholder:"Предмет",value:h.subject,onChange:V=>g({...h,subject:V.target.value}),required:!0}),e.jsx("input",{type:"date",value:h.date,onChange:V=>g({...h,date:V.target.value}),required:!0}),e.jsx("input",{type:"time",value:h.startTime,onChange:V=>g({...h,startTime:V.target.value}),required:!0}),e.jsx("input",{type:"time",value:h.endTime,onChange:V=>g({...h,endTime:V.target.value}),required:!0}),e.jsx("input",{type:"number",placeholder:"Цена",value:h.price,onChange:V=>g({...h,price:Number(V.target.value)})}),e.jsxs("select",{value:h.lessonType,onChange:V=>g({...h,lessonType:V.target.value}),children:[e.jsx("option",{value:"regular",children:"Обычный"}),e.jsx("option",{value:"trial",children:"Пробный"})]}),e.jsxs("select",{value:h.format,onChange:V=>g({...h,format:V.target.value}),children:[e.jsx("option",{value:"online",children:"Онлайн"}),e.jsx("option",{value:"offline",children:"Оффлайн"})]}),e.jsxs("select",{value:h.experience,onChange:V=>g({...h,experience:V.target.value}),children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"})]}),p&&e.jsx("div",{className:"text-red-500",children:p}),e.jsx("button",{type:"button",className:"btn btn-success mt-2",onClick:me,disabled:v,children:v?"Назначение...":"Назначить"})]})]})}),y&&f&&e.jsx($r,{open:y,onClose:()=>D(!1),children:e.jsxs("div",{style:{minWidth:1100,minHeight:600,maxWidth:"98vw"},children:[e.jsxs("h2",{style:{marginBottom:16},children:["Назначить урок для ",f.name]}),e.jsx(Ed,{mode:"assign",student:f,onAssign:()=>D(!1)})]})}),j&&e.jsx(j3,{userId:j,onClose:()=>k(null),onMessage:V=>{k(null)},onBookLesson:V=>{k(null)},isModal:!0})]})},S3=()=>{var y,D;const{user:t}=it(),[r,s]=N.useState([]),[a,n]=N.useState(""),[i,o]=N.useState(""),[c,l]=N.useState([]),[d,m]=N.useState(null),[x,h]=N.useState(""),g=t?`teacher_materials_${t.id}`:void 0;N.useEffect(()=>{if(g)try{const f=localStorage.getItem(g);f&&s(JSON.parse(f))}catch{}},[g]),N.useEffect(()=>{if(g)try{localStorage.setItem(g,JSON.stringify(r))}catch{}},[r,g]);const v=f=>{const T=Array.from(f.target.files||[]);l(T)},u=async()=>{if(!a.trim()&&c.length===0&&!i.trim())return;const f=await Promise.all(c.map(C=>new Promise(M=>{const z=new FileReader;z.onload=()=>{M({id:Math.random().toString(36).slice(2),title:a.trim()||C.name,fileName:C.name,fileType:C.type,dataUrl:String(z.result||""),createdAt:new Date().toISOString()})},z.readAsDataURL(C)}))),j=[i.trim()?{id:Math.random().toString(36).slice(2),title:a.trim()||i.trim(),url:i.trim(),createdAt:new Date().toISOString()}:null,...f].filter(Boolean);if(j.length===0)return;s(C=>[...j,...C]),n(""),o(""),l([]);const k=document.getElementById("materials-file-input");k&&(k.value="")},p=f=>{s(T=>T.filter(j=>j.id!==f))},w=(f,T)=>{s(j=>j.map(k=>k.id===f?{...k,title:T.trim()||k.title}:k))};return e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold gradient-text",children:"Материалы"}),e.jsx("p",{className:"text-gray-600",children:"Сохраняйте ссылки и описания материалов для занятий"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("input",{value:a,onChange:f=>n(f.target.value),placeholder:"Название материала",className:"input-modern w-full"}),e.jsx("input",{value:i,onChange:f=>o(f.target.value),placeholder:"Ссылка (необязательно)",className:"input-modern w-full"}),e.jsx("input",{id:"materials-file-input",type:"file",multiple:!0,onChange:v,className:"input-modern w-full",accept:".pdf,.doc,.docx,.ppt,.pptx,image/*,.txt,.xlsx,.xls,.csv,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf"}),e.jsx("button",{onClick:u,className:"btn-primary",children:"Добавить"})]}),c.length>0&&e.jsxs("div",{className:"mt-3 text-xs text-gray-600",children:["Выбрано файлов: ",c.length]}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{value:x,onChange:f=>h(f.target.value),placeholder:"Поиск по названию или ссылке",className:"input-modern w-full"})})]}),e.jsx("div",{className:"space-y-3",children:r.length===0?e.jsx("div",{className:"text-gray-500 text-center py-12 bg-white rounded-2xl shadow",children:"Пока нет материалов"}):r.filter(f=>{const T=x.trim().toLowerCase();return T?f.title.toLowerCase().includes(T)||(f.url?f.url.toLowerCase().includes(T):!1)||(f.fileName?f.fileName.toLowerCase().includes(T):!1):!0}).map(f=>e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(k3,{title:f.title,onSave:T=>w(f.id,T)}),f.url&&e.jsx("a",{href:f.url,target:"_blank",rel:"noreferrer",className:"text-blue-600 text-sm break-all",children:f.url}),f.dataUrl&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[f.fileName," ",f.fileType&&`• ${f.fileType}`]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[(f.dataUrl||f.url)&&e.jsx("button",{onClick:()=>{f.dataUrl?m(f):f.url&&window.open(f.url,"_blank")},className:"text-blue-600 hover:text-blue-700",children:"Открыть"}),f.dataUrl&&e.jsx("a",{href:f.dataUrl,download:f.fileName||"material",className:"text-blue-600 hover:text-blue-700",children:"Скачать"}),e.jsx("button",{onClick:()=>p(f.id),className:"text-red-600 hover:text-red-700",children:"Удалить"})]})]},f.id))}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>m(null),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full h-[80vh] overflow-hidden relative",onClick:f=>f.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[e.jsx("div",{className:"font-semibold truncate pr-4",children:d.title}),e.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>m(null),children:"Закрыть"})]}),e.jsxs("div",{className:"w-full h-[calc(80vh-52px)] bg-gray-50 flex items-center justify-center",children:[d.dataUrl&&((y=d.fileType)==null?void 0:y.startsWith("image/"))&&e.jsx("img",{src:d.dataUrl,alt:d.title,className:"max-h-full max-w-full object-contain"}),d.dataUrl&&d.fileType==="application/pdf"&&e.jsx("iframe",{title:"pdf",src:d.dataUrl,className:"w-full h-full"}),d.dataUrl&&((D=d.fileType)==null?void 0:D.startsWith("text/"))&&e.jsx("iframe",{title:"text",src:d.dataUrl,className:"w-full h-full bg-white"}),d.dataUrl&&!/^(image\/|application\/pdf|text\/).*/.test(d.fileType||"")&&e.jsx("div",{className:"p-6 text-center text-gray-600",children:"Онлайн-просмотр для этого формата не поддерживается. Скачайте файл для просмотра."}),d.url&&!d.dataUrl&&e.jsx("iframe",{title:"url",src:d.url,className:"w-full h-full bg-white"})]})]})})]})},k3=({title:t,onSave:r})=>{const[s,a]=N.useState(!1),[n,i]=N.useState(t);return N.useEffect(()=>i(t),[t]),s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:n,onChange:o=>i(o.target.value),onKeyDown:o=>{o.key==="Enter"&&(r(n),a(!1))},className:"input-modern",autoFocus:!0}),e.jsx("button",{className:"btn-primary",onClick:()=>{r(n),a(!1)},children:"OK"}),e.jsx("button",{className:"btn-secondary",onClick:()=>{i(t),a(!1)},children:"Отмена"})]}):e.jsx("div",{className:"font-semibold text-gray-900 truncate max-w-md",title:t,onDoubleClick:()=>a(!0),children:t})},C3=({setActiveTab:t})=>{const{lessons:r,cancelLesson:s,rescheduleLesson:a,getOrCreateChat:n}=ht(),{user:i}=it(),[o,c]=N.useState(!1),[l,d]=N.useState(null),[m,x]=N.useState(""),[h,g]=N.useState(""),v=r.filter(M=>M.studentId===(i==null?void 0:i.id)),u=v.filter(M=>M.status==="scheduled"),p=v.filter(M=>M.status==="completed"),w=(M,z)=>{i&&n(i.id,M,i.name,z)},y=M=>{window.confirm("Вы уверены, что хотите отменить урок?")&&s(M)},D=()=>{l&&m&&h&&(a(l.id,m,h),c(!1),d(null),x(""),g(""))},f=M=>{d(M),x(M.date),g(M.startTime),c(!0)},T=M=>{switch(M){case"online":return e.jsx(Xt,{className:"h-4 w-4"});case"offline":return e.jsx(Nt,{className:"h-4 w-4"});case"mini-group":return e.jsx(us,{className:"h-4 w-4"});default:return e.jsx(Xt,{className:"h-4 w-4"})}},j=M=>{switch(M){case"online":return"Онлайн";case"offline":return"Оффлайн";case"mini-group":return"Мини-группа";default:return M}},k=M=>M==="scheduled"?e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-sm",children:[e.jsx(vu,{className:"h-4 w-4 mr-2"}),"Запланирован"]}):e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gradient-to-r from-green-500 to-green-600 text-white shadow-sm",children:[e.jsx(Or,{className:"h-4 w-4 mr-2"}),"Завершен"]}),C=({lesson:M,isScheduled:z})=>e.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden border border-gray-100 hover:border-blue-200",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 p-4 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white opacity-10 rounded-full -translate-y-12 translate-x-12"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 bg-white opacity-10 rounded-full translate-y-8 -translate-x-8"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold mb-1",children:M.subject}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ce,{className:"h-4 w-4 text-blue-200"}),e.jsx("span",{className:"text-blue-100 text-sm font-medium",children:M.teacherName})]})]}),k(M.status)]}),e.jsxs("div",{className:"flex items-center space-x-3 text-blue-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[T(M.format),e.jsx("span",{className:"text-xs font-medium",children:j(M.format)})]}),M.lessonType==="trial"&&e.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-400 bg-opacity-20 px-2 py-1 rounded-full",children:[e.jsx(zt,{className:"h-3 w-3 text-yellow-300"}),e.jsx("span",{className:"text-yellow-200 text-xs font-medium",children:"Пробный"})]})]})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-md",children:e.jsx(lt,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Дата"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:M.date})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 rounded-md",children:e.jsx(Rt,{className:"h-4 w-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Время"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[M.startTime," - ",M.endTime]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-green-100 rounded-md",children:e.jsx(bu,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Длительность"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[M.duration," мин"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Стоимость"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[M.price,"₽"]})]})]}),z&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>w(M.teacherId,M.teacherName),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg text-sm font-medium hover:from-blue-600 hover:to-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:[e.jsx(tt,{className:"h-4 w-4"}),e.jsx("span",{children:"Чат"})]}),M.format==="online"&&e.jsxs("button",{className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg text-sm font-medium hover:from-purple-600 hover:to-purple-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:[e.jsx(Xt,{className:"h-4 w-4"}),e.jsx("span",{children:"Видеозвонок"})]})]}),e.jsxs("div",{className:"flex space-x-2 pt-2 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>f(M),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 text-orange-600 bg-orange-50 hover:bg-orange-100 rounded-lg text-sm font-medium transition-all duration-200 border border-orange-200 hover:border-orange-300",children:[e.jsx(os,{className:"h-3 w-3"}),e.jsx("span",{children:"Перенести"})]}),e.jsxs("button",{onClick:()=>y(M.id),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm font-medium transition-all duration-200 border border-red-200 hover:border-red-300",children:[e.jsx(ds,{className:"h-3 w-3"}),e.jsx("span",{children:"Отменить"})]})]})]}),!z&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 py-2 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[e.jsx(Or,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-700 text-sm font-medium",children:"Урок успешно завершен"})]})]}),e.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-3 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent",children:"Мои уроки"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed",children:"Управляйте вашими запланированными и завершенными уроками. Отслеживайте прогресс и достигайте новых высот в обучении."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(lt,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:u.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Запланировано"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Or,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:p.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Завершено"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Ts,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:v.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Всего уроков"})]})]})})]}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(lt,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Запланированные уроки"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ваши предстоящие занятия"})]})]}),u.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(M=>e.jsx(C,{lesson:M,isScheduled:!0},M.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md border border-gray-100",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(lt,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Нет запланированных уроков"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"Забронируйте свой первый урок на главной странице и начните свой путь к знаниям"}),e.jsxs("button",{onClick:()=>{console.log("🎯 Переход к главной странице для бронирования урока"),t("home")},className:"inline-flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[e.jsx(ju,{className:"h-4 w-4"}),e.jsx("span",{children:"Забронировать урок"})]})]})]}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Jt,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Завершенные уроки"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ваши достижения и пройденный материал"})]})]}),p.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(M=>e.jsx(C,{lesson:M,isScheduled:!1},M.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md border border-gray-100",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-green-100 to-emerald-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Jt,{className:"h-8 w-8 text-green-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Нет завершенных уроков"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:"После завершения уроков здесь будут отображаться ваши достижения и прогресс"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-medium",children:[e.jsx(Tn,{className:"h-4 w-4"}),e.jsx("span",{children:"Достижения появятся здесь"})]})]})]}),e.jsx("div",{className:"text-center py-12 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-2xl text-white shadow-xl",children:e.jsxs("div",{className:"max-w-xl mx-auto px-6",children:[e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Готовы к следующему уроку?"}),e.jsx("p",{className:"text-lg text-blue-100 mb-6",children:"Продолжайте обучение и достигайте новых высот вместе с нашими преподавателями"}),e.jsxs("button",{onClick:()=>{console.log("🔍 Переход к главной странице для поиска преподавателя"),t("home")},className:"inline-flex items-center space-x-2 px-6 py-3 bg-white text-blue-600 rounded-lg font-semibold text-base hover:bg-gray-50 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:[e.jsx(gu,{className:"h-5 w-5"}),e.jsx("span",{children:"Найти преподавателя"})]})]})})]}),o&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full shadow-2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Перенести урок"}),e.jsx("button",{onClick:()=>c(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(nt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Урок:"})," ",l.subject," с ",l.teacherName]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Новая дата"}),e.jsx("input",{type:"date",value:m,onChange:M=>x(M.target.value),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Новое время"}),e.jsx("input",{type:"time",value:h,onChange:M=>g(M.target.value),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})]}),e.jsxs("div",{className:"flex space-x-4 mt-8",children:[e.jsx("button",{onClick:D,disabled:!m||!h,className:"flex-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 px-6 rounded-xl font-semibold hover:from-blue-600 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Перенести урок"}),e.jsx("button",{onClick:()=>c(!1),className:"px-8 py-4 border-2 border-gray-300 rounded-xl text-gray-700 font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"Отмена"})]})]})})})]})},T3=()=>{const{chats:t,sendMessage:r,sendMessageToUser:s,allUsers:a,setAllUsers:n,teacherProfiles:i,studentProfiles:o,lessons:c,deleteChat:l,markChatAsRead:d,clearChatMessages:m,archiveChat:x,unarchiveChat:h,getOrCreateChat:g,loadChatsFromServer:v}=ht(),{user:u}=it(),[p,w]=N.useState(null),[y,D]=N.useState(""),[f,T]=N.useState(""),[j,k]=N.useState(!1),[C,M]=N.useState(null);N.useState([]);const[z,I]=N.useState(null),[X,G]=N.useState(null),[re,H]=N.useState(!1),[$,W]=N.useState(!1),[Q,te]=N.useState(!1),[me,ve]=N.useState(!1),[Ne,he]=N.useState(!1),[Te,Z]=N.useState(""),K=N.useRef(null),je=N.useRef(null);ht();const V=()=>{var E;(E=K.current)==null||E.scrollIntoView({behavior:"smooth"})};N.useEffect(()=>{V()},[p,t]),N.useEffect(()=>{u&&(console.log("ChatList: Loading chats for user:",u.id),v())},[u,v]),N.useEffect(()=>{if(t.length>0&&!p){const E=t.find(B=>B.participants.includes((u==null?void 0:u.id)||"")&&!B.archived);E&&w(E.id)}},[t,p,u]),N.useEffect(()=>{var E;if(p&&u){const B=t.find(oe=>oe.id===p);B&&((E=B.messages)!=null&&E.some(ye=>ye.senderId!==u.id&&!ye.isRead))&&d(p)}},[p,t,u,d]);const ce=E=>{let B=a.find(oe=>oe.id===E);if(!B){const oe=i?i[E]:null;oe&&(B={id:E,role:"teacher",profile:oe,avatar:oe.avatar||"",name:oe.name||"",email:oe.email||"",nickname:""});const ye=o?o[E]:null;if(!B&&ye&&(B={id:E,role:"student",profile:ye,avatar:ye.avatar||"",name:ye.name||"",email:ye.email||"",nickname:""}),B){const rt=[...a,B];n(rt),localStorage.setItem("tutoring_users",JSON.stringify(rt))}}return B||null},De=t.filter(E=>E.participants.includes((u==null?void 0:u.id)||""));console.log("🔍 ChatList DEBUG INFO:"),console.log("- Current user:",{id:u==null?void 0:u.id,name:u==null?void 0:u.name,role:u==null?void 0:u.role}),console.log("- All chats count:",t.length),console.log("- User chats count:",De.length),t.length>0&&(console.log("- All chats details:"),t.forEach((E,B)=>{var oe;console.log(`  Chat ${B+1}:`,{id:E.id,participants:E.participants,participantNames:E.participantNames,includesUser:E.participants.includes((u==null?void 0:u.id)||""),messagesCount:((oe=E.messages)==null?void 0:oe.length)||0})}));const Ie=De.filter(E=>{if(E.archived&&!me||!E.archived&&me)return!1;const B=E.participantNames.find(oe=>oe!==(u==null?void 0:u.name));return B==null?void 0:B.toLowerCase().includes(f.toLowerCase())});console.log("- Filtered chats count:",Ie.length),console.log("🔍 END DEBUG INFO");const Le=p?t.find(E=>E.id===p):null,Xe=()=>{!y.trim()||!p||!u||(r(p,u.id,u.name,y.trim()),D(""),H(!1))},Qe=(E,B)=>{if(!Te.trim()||!u)return;console.log("🔍 ChatList handleSendMessageToUser DEBUG:"),console.log("- Sender:",{id:u.id,name:u.name}),console.log("- Receiver:",{id:E,name:B}),console.log("- Message:",Te.trim());const oe=s(u.id,u.name,E,B,Te.trim());console.log("- Chat created/opened with ID:",oe),w(oe),Z(""),he(!1),console.log("🔍 END ChatList handleSendMessageToUser DEBUG")},J=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),Xe())},$e=E=>E.participantNames.find(B=>B!==(u==null?void 0:u.name))||"Неизвестный пользователь",be=E=>E.participants.find(B=>B!==(u==null?void 0:u.id))||"",Me=E=>{try{const B=new Date(E);return ml(B)?at(B,"HH:mm",{locale:Dt}):hl(B)?"Вчера":S4(B)?at(B,"EEEE",{locale:Dt}):at(B,"dd.MM.yyyy",{locale:Dt})}catch{return""}},ut=E=>{try{const B=new Date(E);return ml(B)?at(B,"HH:mm",{locale:Dt}):hl(B)?"Вчера":at(B,"dd.MM",{locale:Dt})}catch{return""}},Fe=E=>{console.log("handleDeleteChat called with chatId:",E),console.log("Current chats in component:",t.length);const B=t.find(ye=>ye.id===E),oe=B?$e(B):"пользователем";if(confirm(`Вы уверены, что хотите удалить чат с ${oe}? Это действие нельзя отменить.`))try{console.log("User confirmed deletion. Deleting chat:",E),l(E),p===E&&(console.log("Removing selection from deleted chat"),w(null)),I(null),G(null),setTimeout(()=>{console.log("Forcing state update after chat deletion"),I(null)},100),console.log("Chat deletion process completed")}catch(ye){console.error("Error deleting chat:",ye),alert("Ошибка при удалении чата. Попробуйте еще раз.")}else console.log("User cancelled chat deletion")},q=E=>{console.log("handleMarkAsRead called with chatId:",E);try{d(E),I(null),console.log("Chat marked as read successfully")}catch(B){console.error("Error marking chat as read:",B),alert("Ошибка при отметке чата как прочитанного.")}},fe=E=>{var ye;console.log("handleClearMessages called with chatId:",E);const B=t.find(rt=>rt.id===E),oe=((ye=B==null?void 0:B.messages)==null?void 0:ye.length)||0;if(oe===0){alert("В этом чате нет сообщений для очистки."),I(null);return}if(confirm(`Вы уверены, что хотите очистить все ${oe} сообщений в этом чате? Это действие нельзя отменить.`))try{console.log("Clearing messages for chat:",E),m(E),I(null),console.log("Messages cleared successfully")}catch(rt){console.error("Error clearing messages:",rt),alert("Ошибка при очистке сообщений.")}},S=E=>{console.log("handleArchiveChat called with chatId:",E);try{x(E),I(null),p===E&&w(null),console.log("Chat archived successfully")}catch(B){console.error("Error archiving chat:",B),alert("Ошибка при архивировании чата.")}},F=E=>{console.log("handleUnarchiveChat called with chatId:",E);try{h(E),I(null),console.log("Chat unarchived successfully")}catch(B){console.error("Error unarchiving chat:",B),alert("Ошибка при восстановлении чата.")}},A=()=>{alert("Функция создания нового чата будет добавлена в следующем обновлении.")},P=E=>{const B=E.target.files;B&&B.length>0&&console.log("Files to upload:",B),te(!1)},b=E=>{console.log("handleShowProfile called with chatId:",E);try{const B=t.find(oe=>oe.id===E);if(console.log("Found chat:",B),B){const oe=be(B);console.log("Other participant ID:",oe),oe?(M(oe),k(!0),console.log("Profile modal opened for user:",oe)):alert("Не удалось определить пользователя для показа профиля.")}else alert("Чат не найден.");I(null)}catch(B){console.error("Error showing profile:",B),alert("Ошибка при открытии профиля пользователя."),I(null)}},L=()=>{t.filter(B=>{var oe;return B.participants.includes((u==null?void 0:u.id)||"")&&!B.archived&&((oe=B.messages)==null?void 0:oe.some(ye=>ye.senderId!==(u==null?void 0:u.id)&&!ye.isRead))}).forEach(B=>{d(B.id)})};N.useEffect(()=>{const E=B=>{const oe=B.target,ye=oe.closest('button[onClick*="setShowChatMenu"]'),rt=oe.closest(".chat-menu");z&&!ye&&!rt&&(console.log("Click outside menu detected, closing menu"),I(null))};return document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[z]);const R=(()=>t.filter(E=>{var B;return E.participants.includes((u==null?void 0:u.id)||"")&&!E.archived&&((B=E.messages)==null?void 0:B.some(oe=>oe.senderId!==(u==null?void 0:u.id)&&!oe.isRead))}).length)();return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-3 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"МОИ ЧАТЫ"}),e.jsx("p",{className:"text-gray-600 text-xs",children:R>0?`${R} непрочитанных сообщений`:"Общайтесь с преподавателями и учениками"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[R>0&&e.jsx("button",{onClick:L,className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:"Отметить все как прочитанные"}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ga,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>ve(!me),className:`px-3 py-1 text-sm rounded-lg transition-colors ${me?"bg-gray-200 text-gray-700":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:me?"Активные":"Архив"}),e.jsx("button",{onClick:A,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Создать новый чат",children:e.jsx(ls,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden min-h-0",children:[e.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col flex-shrink-0",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 space-y-2 flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx(cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Поиск чатов...",value:f,onChange:E=>T(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("button",{onClick:()=>he(!0),className:"w-full bg-gradient-to-r from-green-600 to-green-700 text-white px-4 py-2 rounded-lg font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(ls,{className:"h-4 w-4"}),e.jsx("span",{children:"Новый чат"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:Ie.length>0?Ie.map(E=>{var dr,wt;const B=be(E),oe=ce(B),ye=p===E.id,rt=(dr=E.messages)==null?void 0:dr.some(_e=>_e.senderId!==(u==null?void 0:u.id)&&!_e.isRead);return e.jsxs("div",{className:`relative p-4 hover:bg-gray-50 cursor-pointer transition-colors chat-menu ${ye?"bg-blue-50 border-r-2 border-blue-500":""}`,onClick:()=>w(E.id),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[oe!=null&&oe.avatar?e.jsx("img",{src:oe.avatar,alt:"avatar",className:"h-12 w-12 rounded-full object-cover",onError:_e=>{var Y;const _=_e.target;_.style.display="none",(Y=_.nextElementSibling)==null||Y.classList.remove("hidden")}}):e.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:$e(E).charAt(0).toUpperCase()})}),rt&&e.jsx("div",{className:"absolute -top-1 -right-1 h-4 w-4 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:((wt=E.messages)==null?void 0:wt.filter(_e=>_e.senderId!==(u==null?void 0:u.id)&&!_e.isRead).length)||0})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:[$e(E),E.archived&&e.jsx("span",{className:"ml-2 text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded",children:"Архив"})]}),E.lastMessage&&e.jsx("span",{className:"text-xs text-gray-400",children:ut(E.lastMessage.timestamp)})]}),E.lastMessage?e.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:E.lastMessage.content}):e.jsx("p",{className:"text-sm text-gray-400 italic mt-1",children:"Нет сообщений"})]}),e.jsx("button",{onClick:_e=>{console.log("Menu button clicked for chat:",E.id),_e.stopPropagation(),I(z===E.id?null:E.id)},className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(kl,{className:"w-4 h-4"})})]}),z===E.id&&e.jsxs("div",{className:"absolute right-2 top-12 bg-white border border-gray-200 rounded-lg shadow-xl py-1 z-50 min-w-[180px]",children:[e.jsxs("button",{onClick:_e=>{console.log("Profile button clicked for chat:",E.id),_e.preventDefault(),_e.stopPropagation(),b(E.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{children:"Профиль"})]}),e.jsxs("button",{onClick:_e=>{console.log("Mark as read button clicked for chat:",E.id),_e.preventDefault(),_e.stopPropagation(),q(E.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(sr,{className:"w-4 h-4"}),e.jsx("span",{children:"Отметить как прочитанное"})]}),e.jsxs("button",{onClick:_e=>{console.log("Archive button clicked for chat:",E.id),_e.preventDefault(),_e.stopPropagation(),S(E.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Oi,{className:"w-4 h-4"}),e.jsx("span",{children:"Архивировать"})]}),E.archived&&e.jsxs("button",{onClick:_e=>{console.log("Unarchive button clicked for chat:",E.id),_e.preventDefault(),_e.stopPropagation(),F(E.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(Oi,{className:"w-4 h-4"}),e.jsx("span",{children:"Восстановить"})]}),e.jsxs("button",{onClick:_e=>{console.log("Clear messages button clicked for chat:",E.id),_e.preventDefault(),_e.stopPropagation(),fe(E.id)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center space-x-2 transition-colors",children:[e.jsx(ds,{className:"w-4 h-4"}),e.jsx("span",{children:"Очистить сообщения"})]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:_e=>{console.log("Delete chat button clicked for chat:",E.id),_e.preventDefault(),_e.stopPropagation(),Fe(E.id)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-2 transition-colors",children:[e.jsx(ds,{className:"w-4 h-4"}),e.jsx("span",{children:"Удалить чат"})]})]})]},E.id)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx(tt,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Нет чатов"}),e.jsx("p",{className:"text-sm text-center",children:"Начните общение с преподавателями или учениками"})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-white min-h-0",children:Le?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[(()=>{const E=be(Le),B=ce(E);return B!=null&&B.avatar?e.jsx("img",{src:B.avatar,alt:"avatar",className:"h-10 w-10 rounded-full object-cover"}):e.jsx("div",{className:"h-10 w-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:$e(Le).charAt(0).toUpperCase()})})})(),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:$e(Le)}),e.jsx("p",{className:"text-sm text-gray-500",children:(()=>{const E=be(Le),B=ce(E);return(B==null?void 0:B.role)==="teacher"?"Преподаватель":"Ученик"})()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx($t,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Xt,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{const E=be(Le);M(E),k(!0)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Ce,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 min-h-0",children:[Le.messages&&Le.messages.length>0?Le.messages.map(E=>e.jsx("div",{className:`flex ${E.senderId===(u==null?void 0:u.id)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${E.senderId===(u==null?void 0:u.id)?"bg-blue-600 text-white":"bg-white text-gray-900 shadow-sm"}`,children:[e.jsx("p",{className:"text-sm",children:E.content}),e.jsxs("div",{className:`flex items-center justify-end mt-1 space-x-1 ${E.senderId===(u==null?void 0:u.id)?"text-blue-100":"text-gray-400"}`,children:[e.jsx("span",{className:"text-xs",children:Me(E.timestamp)}),E.senderId===(u==null?void 0:u.id)&&e.jsx(tu,{className:"w-3 h-3"})]})]})},E.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx(tt,{className:"w-16 h-16 mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Начните общение"}),e.jsx("p",{className:"text-sm text-center",children:"Отправьте первое сообщение"})]}),e.jsx("div",{ref:K})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-end space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("textarea",{value:y,onChange:E=>{D(E.target.value),H(E.target.value.length>0)},onKeyPress:J,placeholder:"Введите сообщение...",className:"w-full px-4 py-3 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:1,style:{minHeight:"44px",maxHeight:"120px"}}),e.jsxs("div",{className:"absolute right-3 bottom-3 flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>W(!$),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Cn,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>te(!Q),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Pi,{className:"w-5 h-5"})})]})]}),e.jsx("button",{onClick:Xe,disabled:!y.trim(),className:"p-3 bg-blue-600 text-white rounded-full hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:e.jsx(Tl,{className:"w-5 h-5"})})]}),Q&&e.jsx("div",{className:"mt-2 p-2 bg-white border border-gray-200 rounded-lg shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>{var E;return(E=je.current)==null?void 0:E.click()},className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx(Pi,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Файл"})]}),e.jsxs("button",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx(mu,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Голосовое"})]})]})}),e.jsx("input",{ref:je,type:"file",multiple:!0,onChange:P,className:"hidden"})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500",children:[e.jsx(tt,{className:"w-24 h-24 mb-6 text-gray-300"}),e.jsx("h2",{className:"text-2xl font-medium mb-2",children:"Выберите чат"}),e.jsx("p",{className:"text-center",children:"Выберите чат из списка слева, чтобы начать общение"})]})})]}),j&&C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Профиль пользователя"}),e.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(jn,{className:"w-5 h-5"})})]}),(()=>{var B;const E=ce(C);return E?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[E.avatar?e.jsx("img",{src:E.avatar,alt:"avatar",className:"h-16 w-16 rounded-full object-cover"}):e.jsx("div",{className:"h-16 w-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium text-lg",children:((B=E.name)==null?void 0:B.charAt(0).toUpperCase())||"U"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:E.name||"Неизвестный пользователь"}),e.jsx("p",{className:"text-gray-500",children:E.role==="teacher"?"Преподаватель":"Ученик"}),E.email&&e.jsx("p",{className:"text-sm text-gray-400",children:E.email})]})]}),E.profile&&e.jsxs("div",{className:"space-y-4",children:[E.profile.bio&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"О себе"}),e.jsx("p",{className:"text-gray-600",children:E.profile.bio})]}),E.profile.subjects&&E.profile.subjects.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Предметы"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:E.profile.subjects.map((oe,ye)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:oe},ye))})]}),E.profile.experience&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Опыт"}),e.jsxs("p",{className:"text-gray-600",children:[E.profile.experience==="beginner"&&"Начинающий",E.profile.experience==="experienced"&&"Опытный",E.profile.experience==="professional"&&"Профессионал"]})]}),E.profile.city&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Город"}),e.jsx("p",{className:"text-gray-600",children:E.profile.city})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[e.jsxs("button",{onClick:()=>{k(!1)},className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx($t,{className:"w-4 h-4"}),e.jsx("span",{children:"Позвонить"})]}),e.jsxs("button",{onClick:()=>{k(!1)},className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Xt,{className:"w-4 h-4"}),e.jsx("span",{children:"Видео"})]})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Профиль пользователя не найден"})})})()]})})}),Ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 max-h-[80vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Новый чат"}),e.jsx("button",{onClick:()=>he(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(nt,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Сообщение"}),e.jsx("textarea",{value:Te,onChange:E=>Z(E.target.value),placeholder:"Введите ваше сообщение...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Выберите получателя"}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-lg",children:a.filter(E=>E.id!==(u==null?void 0:u.id)).map(E=>e.jsxs("button",{onClick:()=>Qe(E.id,E.name),className:"w-full p-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold",children:E.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:E.name}),e.jsx("div",{className:"text-sm text-gray-500 capitalize",children:E.role==="teacher"?"Преподаватель":"Ученик"})]})]},E.id))})]})]})]})})]})},$d=({isOpen:t,onClose:r,onSave:s})=>{const{user:a}=it(),{updateStudentProfile:n}=ht(),[i,o]=N.useState({grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""}),[c,l]=N.useState(0);N.useEffect(()=>{t&&(a!=null&&a.profile)&&(o(a.profile),d(a.profile))},[t,a]);const d=g=>{const v=["bio","age","school","city","phone","parentName","parentPhone","subjects","goals","interests","learningStyle","experience","preferredFormats","preferredDurations","timeZone"],u=v.filter(w=>{const y=g[w];return Array.isArray(y)?y.length>0:y&&y!==""}).length,p=Math.round(u/v.length*100);l(p)};N.useEffect(()=>{d(i)},[i]);const m=()=>{a&&(n(a.id,i),s(i),r())},x=g=>{var u;const v=(u=g.target.files)==null?void 0:u[0];if(v){if(v.size>5*1024*1024){alert("Размер файла не должен превышать 5MB");return}if(!v.type.startsWith("image/")){alert("Пожалуйста, выберите изображение");return}const p=new FileReader;p.onload=w=>{var D;const y=(D=w.target)==null?void 0:D.result;o({...i,avatar:y})},p.readAsDataURL(v)}},h=g=>{switch(g){case"beginner":return"Начинающий";case"intermediate":return"Средний";case"advanced":return"Продвинутый";default:return g}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(nt,{className:"w-6 h-6 text-gray-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Редактирование профиля"}),e.jsxs("button",{onClick:m,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Cl,{className:"w-4 h-4"}),e.jsx("span",{children:"Сохранить"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-6 mb-8",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-green-400 to-blue-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-lg relative",children:[i!=null&&i.avatar&&i.avatar.trim()!==""&&i.avatar!=="undefined"&&i.avatar!=="null"?e.jsx("img",{src:i.avatar,alt:a==null?void 0:a.name,className:"w-24 h-24 object-cover rounded-full",onError:g=>{const v=g.target;v.style.display="none";const u=v.nextElementSibling;u&&u.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-24 h-24 bg-gradient-to-br from-green-400 to-blue-500 rounded-full flex items-center justify-center ${i!=null&&i.avatar&&i.avatar.trim()!==""&&i.avatar!=="undefined"&&i.avatar!=="null"?"hidden":""}`,children:e.jsx(Ce,{className:"h-12 w-12 text-white"})})]}),e.jsxs("label",{className:"absolute -bottom-2 -right-2 bg-blue-600 text-white rounded-full p-2 cursor-pointer hover:bg-blue-700 transition-colors",children:[e.jsx(El,{className:"w-4 h-4"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:x})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a==null?void 0:a.name}),e.jsxs("p",{className:"text-gray-500",children:["@",a==null?void 0:a.id]})]})}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"!"})}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Профиль заполнен на ",c,"%"]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsx("span",{children:"1 урок"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(fr,{className:"w-4 h-4"}),e.jsx("span",{children:"0 завершено"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{children:"0 предметов"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{className:"w-4 h-4"}),e.jsx("span",{children:i.experience?h(i.experience):"Не указан"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ce,{className:"w-5 h-5 mr-2"}),"Личная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(kn,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Школа"}),e.jsx("input",{type:"text",value:i.school||"",onChange:g=>o({...i,school:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Название школы"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Nt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Город"}),e.jsx("input",{type:"text",value:i.city||"",onChange:g=>o({...i,city:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ваш город"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($t,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Телефон"}),e.jsx("input",{type:"tel",value:i.phone||"",onChange:g=>o({...i,phone:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Родитель"}),e.jsx("input",{type:"text",value:i.parentName||"",onChange:g=>o({...i,parentName:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Имя родителя"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($t,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Телефон родителя"}),e.jsx("input",{type:"tel",value:i.parentPhone||"",onChange:g=>o({...i,parentPhone:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+7 (999) 123-45-67"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Часовой пояс"}),e.jsx("input",{type:"text",value:i.timeZone||"",onChange:g=>o({...i,timeZone:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"UTC+3 (Москва)"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(Be,{className:"w-5 h-5 mr-2"}),"Учебная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Изучаемые предметы"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Математика","Русский язык","Физика","Химия","Биология","История","География","Английский язык"].map(g=>{var v;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((v=i.subjects)==null?void 0:v.includes(g))||!1,onChange:u=>{u.target.checked?o({...i,subjects:[...i.subjects||[],g]}):o({...i,subjects:(i.subjects||[]).filter(p=>p!==g)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:g})]},g)})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Цели обучения"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:["Подготовка к ЕГЭ","Подготовка к ОГЭ","Повышение успеваемости","Углубленное изучение","Подготовка к олимпиаде"].map(g=>{var v;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((v=i.goals)==null?void 0:v.includes(g))||!1,onChange:u=>{u.target.checked?o({...i,goals:[...i.goals||[],g]}):o({...i,goals:(i.goals||[]).filter(p=>p!==g)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:g})]},g)})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sr,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Стиль обучения"}),e.jsxs("select",{value:i.learningStyle||"mixed",onChange:g=>o({...i,learningStyle:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"visual",children:"Визуальный"}),e.jsx("option",{value:"auditory",children:"Аудиальный"}),e.jsx("option",{value:"kinesthetic",children:"Кинестетический"}),e.jsx("option",{value:"mixed",children:"Смешанный"})]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Предпочитаемые форматы"}),e.jsx("div",{className:"flex space-x-4",children:["online","offline","mini-group"].map(g=>{var v;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((v=i.preferredFormats)==null?void 0:v.includes(g))||!1,onChange:u=>{u.target.checked?o({...i,preferredFormats:[...i.preferredFormats||[],g]}):o({...i,preferredFormats:(i.preferredFormats||[]).filter(p=>p!==g)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:g==="online"?"Онлайн":g==="offline"?"Оффлайн":"Мини-группа"})]},g)})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Предпочитаемая длительность"}),e.jsx("div",{className:"flex space-x-4",children:[30,45,60,90].map(g=>{var v;return e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((v=i.preferredDurations)==null?void 0:v.includes(g))||!1,onChange:u=>{u.target.checked?o({...i,preferredDurations:[...i.preferredDurations||[],g]}):o({...i,preferredDurations:(i.preferredDurations||[]).filter(p=>p!==g)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[g," мин"]})]},g)})})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"О себе"}),e.jsx("textarea",{value:i.bio||"",onChange:g=>o({...i,bio:g.target.value}),rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Расскажите о себе, своих интересах и целях..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Возраст"}),e.jsx("input",{type:"number",value:i.age||"",onChange:g=>o({...i,age:g.target.value?Number(g.target.value):void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"5",max:"25",placeholder:"Укажите возраст"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Уровень знаний"}),e.jsxs("select",{value:i.experience||"beginner",onChange:g=>o({...i,experience:g.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"intermediate",children:"Средний"}),e.jsx("option",{value:"advanced",children:"Продвинутый"})]})]})]})]})]})}):null},D3=({isOpen:t,onClose:r})=>{var p;const{user:s}=it(),{lessons:a}=ht(),[n,i]=N.useState(!1),[o,c]=N.useState(0),l=s==null?void 0:s.profile,d=a.filter(w=>w.studentId===(s==null?void 0:s.id)),m=d.filter(w=>w.status==="completed"),x=((p=l==null?void 0:l.subjects)==null?void 0:p.length)||0;N.useEffect(()=>{if(l){const w=["bio","age","school","city","phone","parentName","parentPhone","subjects","goals","interests","learningStyle","experience","preferredFormats","preferredDurations","timeZone"],y=w.filter(f=>{const T=l[f];return Array.isArray(T)?T.length>0:T&&T!==""}).length,D=Math.round(y/w.length*100);c(D)}},[l]);const h=w=>{switch(w){case"beginner":return"Начинающий";case"intermediate":return"Средний";case"advanced":return"Продвинутый";default:return w}},g=w=>{switch(w){case"visual":return"Визуальный";case"auditory":return"Аудиальный";case"kinesthetic":return"Кинестетический";case"mixed":return"Смешанный";default:return w}},v=()=>{i(!0)},u=w=>{i(!1)};return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto relative",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-3xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(nt,{className:"w-6 h-6 text-gray-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Профиль ученика"}),e.jsxs("button",{onClick:v,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(os,{className:"w-4 h-4"}),e.jsx("span",{children:"Редактировать"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-6 mb-8",children:[e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-green-400 to-blue-500 flex items-center justify-center overflow-hidden border-4 border-white shadow-lg relative",children:[l!=null&&l.avatar&&l.avatar.trim()!==""&&l.avatar!=="undefined"&&l.avatar!=="null"?e.jsx("img",{src:l.avatar,alt:s==null?void 0:s.name,className:"w-24 h-24 object-cover rounded-full",onError:w=>{const y=w.target;y.style.display="none";const D=y.nextElementSibling;D&&D.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-24 h-24 bg-gradient-to-br from-green-400 to-blue-500 rounded-full flex items-center justify-center ${l!=null&&l.avatar&&l.avatar.trim()!==""&&l.avatar!=="undefined"&&l.avatar!=="null"?"hidden":""}`,children:e.jsx(Ce,{className:"h-12 w-12 text-white"})})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s==null?void 0:s.name}),e.jsxs("p",{className:"text-gray-500",children:["@",s==null?void 0:s.id]})]})}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"!"})}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Профиль заполнен на ",o,"%"]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsxs("span",{children:[d.length," уроков"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(fr,{className:"w-4 h-4"}),e.jsxs("span",{children:[m.length," завершено"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsxs("span",{children:[x," предметов"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{className:"w-4 h-4"}),e.jsx("span",{children:l!=null&&l.experience?h(l.experience):"Не указан"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ce,{className:"w-5 h-5 mr-2"}),"Личная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(kn,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Школа"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.school)||"Не указана"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Nt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Город"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.city)||"Не указан"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($t,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Телефон"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.phone)||"Не указан"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Родитель"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.parentName)||"Не указан"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($t,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Телефон родителя"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.parentPhone)||"Не указан"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Часовой пояс"}),e.jsx("div",{className:"text-base text-gray-900",children:(l==null?void 0:l.timeZone)||"Не указан"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(Be,{className:"w-5 h-5 mr-2"}),"Учебная информация"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Изучаемые предметы"}),e.jsx("div",{className:"text-base text-gray-900 mt-1",children:l!=null&&l.subjects&&l.subjects.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.subjects.map((w,y)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:w},y))}):"Не указаны"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Цели обучения"}),e.jsx("div",{className:"text-base text-gray-900 mt-1",children:l!=null&&l.goals&&l.goals.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.goals.map((w,y)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:w},y))}):"Не указаны"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sr,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Стиль обучения"}),e.jsx("div",{className:"text-base text-gray-900",children:l!=null&&l.learningStyle?g(l.learningStyle):"Не указан"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Предпочитаемые форматы"}),e.jsx("div",{className:"text-base text-gray-900 mt-1",children:l!=null&&l.preferredFormats&&l.preferredFormats.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.preferredFormats.map((w,y)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full",children:w==="online"?"Онлайн":w==="offline"?"Оффлайн":"Мини-группа"},y))}):"Не указаны"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Предпочитаемая длительность"}),e.jsx("div",{className:"text-base text-gray-900 mt-1",children:l!=null&&l.preferredDurations&&l.preferredDurations.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.preferredDurations.map((w,y)=>e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full",children:[w," мин"]},y))}):"Не указана"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 mt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"О себе"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-line leading-relaxed",children:(l==null?void 0:l.bio)||"Информация о себе не указана"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Возраст"}),e.jsx("div",{className:"text-base text-gray-900",children:l!=null&&l.age?`${l.age} лет`:"Не указан"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Уровень знаний"}),e.jsx("div",{className:"text-base text-gray-900",children:l!=null&&l.experience?h(l.experience):"Не указан"})]})]})]})]})}),n&&e.jsx($d,{isOpen:n,onClose:()=>i(!1),onSave:u})]}):null},E3=()=>{var Xe,Qe,J,$e,be,Me,ut,Fe;const{user:t,updateProfile:r,deleteAccount:s}=it(),{updateStudentProfile:a,updateTeacherProfile:n,lessons:i,posts:o,createPost:c,addReaction:l,addComment:d,sharePost:m,bookmarkPost:x,editPost:h,deletePost:g}=ht();N.useState(!1);const[v,u]=N.useState(!1),[p,w]=N.useState(!1),[y,D]=N.useState(!1),[f,T]=N.useState({grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""}),[j,k]=N.useState({subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,teacherType:"private",education:{university:"",degree:"",graduationYear:void 0,courses:[]}}),[C,M]=N.useState(!1),[z,I]=N.useState(!1),[X,G]=N.useState(!1),[re,H]=N.useState(!1),[$]=N.useState([{id:1,avatar:((Xe=t==null?void 0:t.profile)==null?void 0:Xe.avatar)||"",name:(t==null?void 0:t.name)||""}]),[W,Q]=N.useState(!1),[te,me]=N.useState(()=>typeof window<"u"&&localStorage.getItem("theme")||"light"),ve=["Математика","Русский язык","Английский язык"],Ne=["1","2","3","4","5","6","7","8","9","10","11","Студент","Взрослый"],he=["подготовка к экзаменам","помощь с домашним заданием","углубленное изучение","разговорная практика"],Te=[45,60],Z=["online","offline","mini-group"];N.useEffect(()=>{if(t!=null&&t.profile)if(t.role==="student"){const q=t.profile;T({...f,...q})}else{const q=t.profile;k({...j,...q,education:{university:"",degree:"",graduationYear:void 0,courses:[]}})}else if(t&&!t.profile){const q=t.role==="teacher"?{subjects:[],experience:"experienced",grades:[],goals:[],lessonTypes:[],durations:[],formats:[],offlineAvailable:!1,city:"",overbookingEnabled:!1,bio:"",avatar:"",rating:0,hourlyRate:1500,age:void 0,experienceYears:void 0,teacherType:"private",education:{university:"",degree:"",graduationYear:void 0,courses:[]}}:{grade:"",bio:"",avatar:"",subjects:[],age:void 0,school:"",city:"",phone:"",parentName:"",parentPhone:"",goals:[],interests:[],learningStyle:"mixed",experience:"beginner",preferredFormats:[],preferredDurations:[],timeZone:""};r(q)}},[t]);const K=q=>{switch(q){case"beginner":return"Начинающий";case"experienced":return"Опытный";case"professional":return"Профессионал";default:return q}},je=q=>{switch(q){case"private":return"Частный преподаватель";case"school":return"Преподаватель школы";case"both":return"Частный + Школа";default:return"Частный преподаватель"}};let V=0,ce=0;if(t&&t.role==="student"&&Array.isArray(i)){const q=i.filter(fe=>fe.studentId===t.id);V=q.length,ce=Array.from(new Set(q.map(fe=>fe.teacherId))).length}if(!t)return null;const De=q=>{var S;const fe=(S=q.target.files)==null?void 0:S[0];if(fe){if(fe.size>5*1024*1024){alert("Размер файла не должен превышать 5MB");return}if(!fe.type.startsWith("image/")){alert("Пожалуйста, выберите изображение");return}const F=new FileReader;F.onload=A=>{var P;try{const b=(P=A.target)==null?void 0:P.result;if(t.role==="student"){const L={...f,avatar:b};T(L),r(L),a(t.id,L),console.log(" Аватар студента сохранен")}else{const L={...j,avatar:b};k(L),r(L),n(t.id,{...L,name:t.name,email:t.email}),console.log(" Аватар преподавателя сохранен")}}catch(b){console.error(" Ошибка при сохранении аватара:",b),alert("Ошибка при сохранении фото. Попробуйте еще раз.")}},F.onerror=()=>{console.error(" Ошибка чтения файла"),alert("Ошибка при чтении файла. Попробуйте выбрать другое изображение.")},F.readAsDataURL(fe)}},Ie=q=>{T(q),t&&(r(q),a(t.id,q)),w(!1)},Le=q=>{k(q),D(!1),t&&(r(q),n(t.id,{...q,name:t.name,email:t.email})),alert("Профиль преподавателя сохранен!")};return e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 relative",children:[e.jsx("div",{className:"h-20 w-20 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center overflow-hidden shadow-lg",children:(Qe=t.profile)!=null&&Qe.avatar?e.jsx("img",{src:t.profile.avatar,alt:"Avatar",className:"h-20 w-20 rounded-full object-cover"}):e.jsx(Ce,{className:"h-10 w-10 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:t?t.name:""}),t&&t.nickname&&e.jsxs("span",{className:"text-gray-400 text-sm",children:["@",t.nickname]})]}),t&&t.role==="student"&&e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[e.jsx(Be,{className:"w-5 h-5 text-blue-500 mr-1"}),V]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Пройдено уроков"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[e.jsx(Ce,{className:"w-5 h-5 text-green-500 mr-1"}),ce]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Учителей"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[t.role==="student"?e.jsx(e.Fragment,{children:e.jsxs("button",{className:"btn-primary text-sm px-3 py-2",onClick:()=>w(!0),children:[e.jsx(os,{className:"w-4 h-4 mr-1"}),"Редактировать"]})}):e.jsxs("button",{className:"btn-primary text-sm px-3 py-2",onClick:()=>D(!0),children:[e.jsx(os,{className:"w-4 h-4 mr-1"}),"Редактировать"]}),e.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-500 hover:text-blue-600 rounded-full p-2 shadow transition-colors duration-150 focus:outline-none",style:{width:36,height:36},"aria-label":"Настройки",onClick:()=>I(!0),children:e.jsx(ga,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow p-4 mb-6 text-sm flex flex-col gap-2 card-gradient",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1 space-y-1"})})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-5 mb-6 card-gradient",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-3",children:"О себе"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-line leading-relaxed mb-4 text-sm",children:t.role==="student"?f.bio||"":((J=t.profile)==null?void 0:J.bio)||""}),t.role==="student"&&e.jsxs("div",{className:"space-y-3",children:[f.subjects&&f.subjects.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Предметы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:f.subjects.map((q,fe)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:q},fe))})]}),(f.age||f.school||f.city)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[f.age&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Возраст:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[f.age," лет"]})]}),f.school&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Школа:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:f.school})]}),f.city&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Город:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:f.city})]})]}),f.goals&&f.goals.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Цели обучения:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:f.goals.map((q,fe)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:q},fe))})]}),f.interests&&f.interests.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Интересы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:f.interests.map((q,fe)=>e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:q},fe))})]}),(f.learningStyle||f.experience)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[f.learningStyle&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Стиль обучения:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:f.learningStyle==="visual"?"Визуальный":f.learningStyle==="auditory"?"Аудиальный":f.learningStyle==="kinesthetic"?"Кинестетический":"Смешанный"})]}),f.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Уровень:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:f.experience==="beginner"?"Начинающий":f.experience==="intermediate"?"Средний":"Продвинутый"})]})]}),(f.preferredFormats&&f.preferredFormats.length>0||f.preferredDurations&&f.preferredDurations.length>0)&&e.jsxs("div",{className:"space-y-2",children:[f.preferredFormats&&f.preferredFormats.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Форматы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:f.preferredFormats.map((q,fe)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full",children:q==="online"?"Онлайн":q==="offline"?"Оффлайн":"Мини-группа"},fe))})]}),f.preferredDurations&&f.preferredDurations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Длительность:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:f.preferredDurations.map((q,fe)=>e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full",children:[q," мин"]},fe))})]})]})]}),t.role==="teacher"&&e.jsxs("div",{className:"space-y-3",children:[j.subjects&&j.subjects.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Предметы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.subjects.map((q,fe)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:q},fe))})]}),j.grades&&j.grades.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Классы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.grades.map((q,fe)=>e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:q},fe))})]}),(j.city||j.age||j.experienceYears)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[j.city&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Город:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:j.city})]}),j.age&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Возраст:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[j.age," лет"]})]}),j.experienceYears&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Опыт:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[j.experienceYears," лет"]})]})]}),(j.experience||j.teacherType)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[j.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Уровень:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:K(j.experience)})]}),j.teacherType&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Тип:"}),e.jsx("span",{className:"text-sm text-gray-900 ml-1",children:je(j.teacherType)})]})]}),j.goals&&j.goals.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Цели обучения:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.goals.map((q,fe)=>e.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:q},fe))})]}),(j.formats&&j.formats.length>0||j.durations&&j.durations.length>0)&&e.jsxs("div",{className:"space-y-2",children:[j.formats&&j.formats.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Форматы:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.formats.map((q,fe)=>e.jsx("span",{className:"bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full",children:q==="online"?"Онлайн":q==="offline"?"Оффлайн":"Мини-группа"},fe))})]}),j.durations&&j.durations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Длительность:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.durations.map((q,fe)=>e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full",children:[q," мин"]},fe))})]})]}),j.hourlyRate&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Стоимость:"}),e.jsxs("span",{className:"text-sm text-gray-900 ml-1",children:[j.hourlyRate," руб/час"]})]}),j.education&&(j.education.university||j.education.degree)&&e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Образование:"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[j.education.university&&e.jsx("div",{className:"text-sm text-gray-900",children:j.education.university}),j.education.degree&&e.jsx("div",{className:"text-sm text-gray-700",children:j.education.degree}),j.education.graduationYear&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Год окончания: ",j.education.graduationYear]})]})]})]})]}),e.jsx(D3,{isOpen:v,onClose:()=>u(!1)}),e.jsx($d,{isOpen:p,onClose:()=>w(!1),onSave:Ie}),e.jsx($r,{open:y,onClose:()=>D(!1),children:e.jsxs("div",{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"text-lg font-bold mb-4 text-center",children:"Редактирование профиля преподавателя"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"h-24 w-24 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center overflow-hidden shadow-lg mx-auto",children:j.avatar?e.jsx("img",{src:j.avatar,alt:"Avatar",className:"h-24 w-24 rounded-full object-cover"}):e.jsx(Ce,{className:"h-12 w-12 text-white"})}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-blue-500 text-white rounded-full p-2 cursor-pointer hover:bg-blue-600 transition-colors",children:[e.jsx(El,{className:"w-4 h-4"}),e.jsx("input",{type:"file",accept:"image/*",onChange:De,className:"hidden"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"О себе (био)"}),e.jsx("textarea",{value:j.bio||"",onChange:q=>k({...j,bio:q.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Расскажите о себе..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Город"}),e.jsx("input",{type:"text",value:j.city||"",onChange:q=>k({...j,city:q.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ваш город"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Предметы"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ve.map(q=>{var fe;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((fe=j.subjects)==null?void 0:fe.includes(q))||!1,onChange:S=>{const F=S.target.checked?[...j.subjects||[],q]:(j.subjects||[]).filter(A=>A!==q);k({...j,subjects:F})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:q})]},q)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Классы"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ne.map(q=>{var fe;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((fe=j.grades)==null?void 0:fe.includes(q))||!1,onChange:S=>{const F=S.target.checked?[...j.grades||[],q]:(j.grades||[]).filter(A=>A!==q);k({...j,grades:F})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:q})]},q)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Уровень опыта"}),e.jsxs("select",{value:j.experience||"experienced",onChange:q=>k({...j,experience:q.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"beginner",children:"Начинающий"}),e.jsx("option",{value:"experienced",children:"Опытный"}),e.jsx("option",{value:"professional",children:"Профессионал"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Тип преподавателя"}),e.jsxs("select",{value:j.teacherType||"private",onChange:q=>k({...j,teacherType:q.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"private",children:"Частный преподаватель"}),e.jsx("option",{value:"school",children:"Преподаватель школы"}),e.jsx("option",{value:"both",children:"Частный + Школа"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Возраст"}),e.jsx("input",{type:"number",value:j.age||"",onChange:q=>k({...j,age:parseInt(q.target.value)||void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ваш возраст"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Годы опыта"}),e.jsx("input",{type:"number",value:j.experienceYears||"",onChange:q=>k({...j,experienceYears:parseInt(q.target.value)||void 0}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Количество лет опыта"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цели обучения"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:he.map(q=>{var fe;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((fe=j.goals)==null?void 0:fe.includes(q))||!1,onChange:S=>{const F=S.target.checked?[...j.goals||[],q]:(j.goals||[]).filter(A=>A!==q);k({...j,goals:F})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:q})]},q)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Форматы занятий"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.map(q=>{var fe;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((fe=j.formats)==null?void 0:fe.includes(q))||!1,onChange:S=>{const F=S.target.checked?[...j.formats||[],q]:(j.formats||[]).filter(A=>A!==q);k({...j,formats:F})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:q==="online"?"Онлайн":q==="offline"?"Оффлайн":"Мини-группа"})]},q)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Длительность занятий"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Te.map(q=>{var fe;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((fe=j.durations)==null?void 0:fe.includes(q))||!1,onChange:S=>{const F=S.target.checked?[...j.durations||[],q]:(j.durations||[]).filter(A=>A!==q);k({...j,durations:F})},className:"mr-2"}),e.jsxs("span",{className:"text-sm",children:[q," мин"]})]},q)})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Стоимость за час (руб.)"}),e.jsx("input",{type:"number",value:j.hourlyRate||1500,onChange:q=>k({...j,hourlyRate:parseInt(q.target.value)||1500}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"1500"})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Образование"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Университет"}),e.jsx("input",{type:"text",value:(($e=j.education)==null?void 0:$e.university)||"",onChange:q=>k({...j,education:{...j.education,university:q.target.value}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Название университета"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Степень/Специальность"}),e.jsx("input",{type:"text",value:((be=j.education)==null?void 0:be.degree)||"",onChange:q=>k({...j,education:{...j.education,degree:q.target.value}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Степень или специальность"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Год окончания"}),e.jsx("input",{type:"number",value:((Me=j.education)==null?void 0:Me.graduationYear)||"",onChange:q=>k({...j,education:{...j.education,graduationYear:parseInt(q.target.value)||void 0}}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"2020"})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Дополнительные настройки"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:j.offlineAvailable||!1,onChange:q=>k({...j,offlineAvailable:q.target.checked}),className:"mr-3"}),e.jsx("span",{className:"text-sm",children:"Доступен для оффлайн занятий"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:j.overbookingEnabled||!1,onChange:q=>k({...j,overbookingEnabled:q.target.checked}),className:"mr-3"}),e.jsx("span",{className:"text-sm",children:"Разрешить перебронирование"})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t",children:[e.jsx("button",{onClick:()=>D(!1),className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Отмена"}),e.jsxs("button",{onClick:()=>Le(j),className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Cl,{className:"w-4 h-4 mr-2 inline"}),"Сохранить"]})]})]})}),e.jsxs($r,{open:C,onClose:()=>M(!1),children:[e.jsx("div",{className:"text-base font-bold mb-2",children:"Контактная информация"}),e.jsxs("div",{className:"mb-2 text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",t.email]})]}),e.jsx($r,{open:z,onClose:()=>I(!1),children:e.jsxs("div",{className:"w-[320px] max-w-full",children:[e.jsx("div",{className:"text-lg font-bold mb-4 text-center",children:"Настройки"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",onClick:()=>{I(!1),G(!0)},children:[e.jsx(as,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"flex-1",children:"Push-уведомления"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Sl,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"flex-1",children:"Конфиденциальность"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",onClick:()=>{I(!1),H(!0)},children:[e.jsx(Ce,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"flex-1",children:"Аккаунт"})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fu,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"flex-1",children:"Тема"})]}),e.jsx("button",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none ${te==="dark"?"bg-gray-900":"bg-gray-300"}`,onClick:()=>{const q=te==="dark"?"light":"dark";me(q),q==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",q)},"aria-pressed":te==="dark",type:"button",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${te==="dark"?"translate-x-5":"translate-x-1"}`})})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(nu,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"flex-1",children:"Память"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(hu,{className:"w-5 h-5 text-indigo-500"}),e.jsx("span",{className:"flex-1",children:"Устройства"})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(Be,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{className:"flex-1",children:"База знаний"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(tt,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"flex-1",children:"Поддержка"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(ar,{className:"w-5 h-5 text-blue-700"}),e.jsx("span",{className:"flex-1",children:"Документация"})]}),e.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors w-full text-left",children:[e.jsx(zt,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"flex-1",children:"Оценить приложение"})]})]})]})}),e.jsx($r,{open:X,onClose:()=>G(!1),children:e.jsxs("div",{className:"w-[340px] max-w-full",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("button",{onClick:()=>G(!1),className:"mr-2 p-1 rounded hover:bg-gray-100",children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left w-5 h-5 text-gray-500",children:[e.jsx("path",{d:"M19 12H5"}),e.jsx("path",{d:"m12 19-7-7 7-7"})]})}),e.jsx("div",{className:"text-lg font-bold text-center flex-1",children:"Уведомления"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"СООБЩЕНИЯ"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Kt,{label:"Личные сообщения"}),e.jsx(Kt,{label:"Инфобот"}),e.jsx(Kt,{label:"Лиды"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ПУБЛИКАЦИИ ОТ ПОДПИСОК"}),e.jsx("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:e.jsx(Kt,{label:"Новые публикации"})}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ПОДПИСЧИКИ И ДЕЛОВЫЕ СВЯЗИ"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Kt,{label:"Новые подписчики"}),e.jsx(Kt,{label:"Установлена деловая связь"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"МАРКЕТСПЕЙС"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl mb-4 overflow-hidden",children:[e.jsx(Kt,{label:"Отклики"}),e.jsx(Kt,{label:"Рекомендации"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ГОСЗАКУПКИ"}),e.jsx("div",{className:"bg-gray-50 rounded-xl mb-2 overflow-hidden",children:e.jsx(Kt,{label:"Подборка тендеров по ИНН"})})]})}),e.jsx($r,{open:re,onClose:()=>H(!1),children:e.jsxs("div",{className:"w-[340px] max-w-full flex flex-col min-h-[340px]",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("button",{onClick:()=>H(!1),className:"mr-2 p-1 rounded hover:bg-gray-100",children:e.jsxs("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left w-5 h-5 text-gray-500",children:[e.jsx("path",{d:"M19 12H5"}),e.jsx("path",{d:"m12 19-7-7 7-7"})]})}),e.jsx("div",{className:"text-lg font-bold text-center flex-1",children:"Аккаунт"})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"НОМЕР ТЕЛЕФОНА"}),e.jsxs("div",{className:"bg-white rounded-xl mb-4 overflow-hidden flex items-center justify-between px-4 py-3",children:[e.jsx("span",{className:"text-sm text-gray-900",children:"Изменить номер"}),e.jsx("span",{className:"text-gray-400 text-sm",children:t.phone||"+7 (999) 300-18-02"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 ml-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-1 mt-2",children:"ЭЛЕКТРОННАЯ ПОЧТА"}),e.jsxs("div",{className:"bg-white rounded-xl mb-4 overflow-hidden flex items-center justify-between px-4 py-3",children:[e.jsx("span",{className:"text-sm text-gray-900",children:"Изменить эл. почту"}),e.jsx("span",{className:"text-gray-400 text-sm truncate max-w-[120px]",children:t.email}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 ml-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:s,className:"w-full mt-8 mb-2 py-3 rounded-xl bg-red-50 text-red-600 font-bold text-base hover:bg-red-100 transition",children:"Удалить аккаунт"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-bold text-base",children:"Истории"}),e.jsx("button",{className:"text-blue-500 text-xs font-medium hover:underline",onClick:()=>alert("Скоро можно будет добавлять истории!"),children:"Добавить"})]}),e.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-2",children:[e.jsxs("div",{className:"flex flex-col items-center cursor-pointer group",children:[e.jsxs("div",{className:"relative h-14 w-14 rounded-full bg-gradient-to-tr from-blue-400 to-purple-500 flex items-center justify-center overflow-hidden border-2 border-blue-400 group-hover:scale-105 transition",children:[(t.role==="student"?f.avatar:(ut=t.profile)!=null&&ut.avatar)?e.jsx("img",{src:t.role==="student"?f.avatar:(Fe=t.profile)==null?void 0:Fe.avatar,alt:"avatar",className:"h-14 w-14 object-cover rounded-full"}):e.jsx(Ce,{className:"h-7 w-7 text-white"}),e.jsx("span",{className:"absolute bottom-0 right-0 bg-blue-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs border-2 border-white",children:"+"})]}),e.jsx("span",{className:"text-xs mt-1 text-gray-700",children:"Ваша история"})]}),$.map(q=>e.jsxs("div",{className:"flex flex-col items-center cursor-pointer group",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-gradient-to-tr from-pink-400 to-yellow-400 flex items-center justify-center overflow-hidden border-2 border-pink-400 group-hover:scale-105 transition",children:q.avatar?e.jsx("img",{src:q.avatar,alt:q.name,className:"h-14 w-14 object-cover rounded-full"}):e.jsx(Ce,{className:"h-7 w-7 text-white"})}),e.jsx("span",{className:"text-xs mt-1 text-gray-700 truncate max-w-[60px]",children:q.name})]},q.id))]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"font-bold text-base",children:"Мои записи"}),e.jsxs("button",{onClick:()=>Q(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ls,{className:"w-4 h-4"}),e.jsx("span",{children:"Создать запись"})]})]}),W&&e.jsx("div",{className:"mb-6",children:e.jsx(Ni,{onSubmit:q=>{c(q),Q(!1)},onCancel:()=>Q(!1),userName:(t==null?void 0:t.name)||"Пользователь",userAvatar:t==null?void 0:t.avatar})}),e.jsx("div",{className:"space-y-4",children:o.filter(q=>q.userId===(t==null?void 0:t.id)).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"У вас пока нет записей"}),e.jsx("p",{className:"text-gray-500",children:"Создайте первую запись!"})]}):o.filter(q=>q.userId===(t==null?void 0:t.id)).map(q=>e.jsx(wn,{post:q,onReaction:l,onComment:d,onShare:m,onBookmark:x,onEdit:h,onDelete:g},q.id))})]})]})},Kt=({label:t})=>{const[r,s]=N.useState(!0);return e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b last:border-b-0",children:[e.jsx("span",{className:"text-sm text-gray-900",children:t}),e.jsx("button",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none ${r?"bg-green-500":"bg-gray-300"}`,onClick:()=>s(a=>!a),"aria-pressed":r,type:"button",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-200 ${r?"translate-x-5":"translate-x-1"}`})})]})};const $3=()=>{N.useState(null);const[t,r]=N.useState(!0),[s,a]=N.useState(!1);try{const{user:n}=it(),[i,o]=N.useState((n==null?void 0:n.role)==="teacher"?"slots":"home");if(N.useEffect(()=>{if(n&&!s){const l=n.role==="teacher"?"slots":"home";o(l),a(!0)}r(!1)},[n,s]),t)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Загрузка приложения..."})]})});if(!n)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Добро пожаловать в Nauchi"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Платформа для репетиторов и учеников"}),e.jsx(Nu,{onSuccess:()=>{}})]})});const c=()=>{try{switch(i){case"home":return n.role==="student"?e.jsx(Za,{setActiveTab:o}):e.jsx(en,{});case"slots":return n.role==="teacher"?e.jsx(en,{}):e.jsx(Za,{setActiveTab:o});case"calendar":return n.role==="student"?e.jsx(Dd,{onClose:()=>o("home")}):e.jsx(Ed,{});case"lessons":return n.role==="student"?e.jsx(C3,{setActiveTab:o}):null;case"students":return n.role==="teacher"?e.jsx(N3,{}):null;case"materials":return n.role==="teacher"?e.jsx(S3,{}):null;case"chats":return e.jsx(T3,{});case"profile":return e.jsx(E3,{});default:return n.role==="student"?e.jsx(Za,{setActiveTab:o}):e.jsx(en,{})}}catch(l){return console.error("Error rendering content:",l),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Ошибка загрузки контента"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Попробуйте перезагрузить страницу"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Перезагрузить"})]})})}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Su,{activeTab:i,onTabChange:o}),e.jsx("main",{className:i==="chats"?"h-[calc(100vh-64px)]":"container mx-auto px-4 py-8",children:c()})]})}catch(n){return console.error("Error in AppContent:",n),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Ошибка загрузки"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Произошла ошибка при загрузке приложения"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Перезагрузить страницу"})]})})}},O3=()=>e.jsx("div",{className:"App",children:e.jsx(Kd,{children:e.jsx(Jd,{children:e.jsxs(_d,{children:[e.jsx(Ti,{path:"/teacher/:teacherId",element:e.jsx(Td,{teacher:{},onClose:()=>{},onBookLesson:()=>{}})}),e.jsx(Ti,{path:"*",element:e.jsx($3,{})})]})})})});yl(document.getElementById("root")).render(e.jsx(N.StrictMode,{children:e.jsx(Ad,{children:e.jsx(O3,{})})}));
