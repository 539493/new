# Деплой на Render

## Подготовка к деплою

Проект настроен для деплоя на Render с поддержкой real-time функциональности.

### Структура проекта

- `backend/production-server.cjs` - объединенный сервер для продакшена (WebSocket + статические файлы)
- `render.yaml` - конфигурация для Render
- `package.json` - обновлен с необходимыми скриптами

### Real-time функциональность

Проект включает полную real-time поддержку для учеников:

1. **WebSocket соединения** - мгновенная синхронизация данных
2. **Чат в реальном времени** - обмен сообщениями между учениками и преподавателями
3. **Обновления слотов** - мгновенное отображение доступных/забронированных слотов
4. **Уведомления о уроках** - real-time уведомления о новых уроках
5. **Синхронизация профилей** - обновления профилей в реальном времени

### Шаги для деплоя

1. **Создайте аккаунт на Render**
   - Зайдите на https://render.com
   - Создайте аккаунт и подключите GitHub

2. **Создайте новый Web Service**
   - Нажмите "New +" → "Web Service"
   - Подключите ваш GitHub репозиторий

3. **Настройте сервис**
   - **Name**: tutoring-platform
   - **Environment**: Node
   - **Build Command**: `npm install && npm run build`
   - **Start Command**: `node backend/production-server.cjs`
   - **Health Check Path**: `/api/health`

4. **Переменные окружения**
   - `NODE_ENV`: production
   - `PORT`: 10000 (или оставьте пустым для автоматического назначения)

5. **Деплой**
   - Нажмите "Create Web Service"
   - Render автоматически соберет и запустит приложение

### Проверка работы

После деплоя проверьте:

1. **Основная страница**: https://your-app-name.onrender.com
2. **Health check**: https://your-app-name.onrender.com/api/health
3. **WebSocket соединение**: автоматически подключается к тому же домену

### Real-time функции для учеников

- ✅ Мгновенное отображение доступных слотов
- ✅ Real-time бронирование уроков
- ✅ Чат с преподавателями в реальном времени
- ✅ Уведомления о новых уроках
- ✅ Синхронизация профилей между устройствами
- ✅ WebRTC для видеозвонков (если настроено)

### Локальная разработка

```bash
# Запуск в режиме разработки
npm run dev

# Запуск продакшн сервера локально
npm run build
node backend/production-server.cjs
```

### Структура файлов для деплоя

```
проект/
├── backend/
│   ├── production-server.cjs    # Основной сервер для продакшена
│   ├── server.cjs              # Сервер для разработки
│   └── server_data.json        # Данные (создается автоматически)
├── src/                        # Исходный код React
├── dist/                       # Собранные файлы (создается при build)
├── package.json                # Зависимости и скрипты
├── render.yaml                 # Конфигурация Render
└── DEPLOY.md                   # Эта инструкция
```

### Troubleshooting

**Проблема**: WebSocket не подключается
**Решение**: Проверьте, что в `src/config.ts` правильно настроен URL для продакшена

**Проблема**: Статические файлы не загружаются
**Решение**: Убедитесь, что папка `dist` создана командой `npm run build`

**Проблема**: Сервер не запускается
**Решение**: Проверьте логи в Render Dashboard и убедитесь, что все зависимости установлены 