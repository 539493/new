<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frontend Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background-color: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .teacher-card {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <h1>üîç Frontend Debug Test - Nauchi Platform</h1>
    
    <div class="container">
        <h2>üåê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞</h2>
        <button onclick="testAll()">üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ</button>
        <button onclick="clearResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
        <button onclick="openMainApp()">üöÄ –û—Ç–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
    </div>

    <div class="grid">
        <div class="container">
            <h3>üìä –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
            <div id="data-loading-result"></div>
        </div>

        <div class="container">
            <h3>üë®‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</h3>
            <div id="teachers-display"></div>
        </div>

        <div class="container">
            <h3>üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</h3>
            <div id="config-result"></div>
        </div>

        <div class="container">
            <h3>üåê –°–µ—Ç–µ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h3>
            <div id="network-result"></div>
        </div>
    </div>

    <div class="container">
        <h3>üìù –õ–æ–≥–∏</h3>
        <div id="logs"></div>
    </div>

    <script>
        const SERVER_URL = 'https://na-uchi.onrender.com';
        let logs = [];

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            logs.push(logEntry);
            
            const logsDiv = document.getElementById('logs');
            logsDiv.innerHTML = logs.map(log => `<div>${log}</div>`).join('');
            logsDiv.scrollTop = logsDiv.scrollHeight;
            
            console.log(logEntry);
        }

        function showResult(elementId, content, type = 'info') {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="status ${type}">${content}</div>`;
        }

        async function testDataLoading() {
            log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö...');
            
            try {
                // –¢–µ—Å—Ç 1: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
                const teachersResponse = await fetch(`${SERVER_URL}/api/teachers`);
                const teachers = await teachersResponse.json();
                
                // –¢–µ—Å—Ç 2: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                const usersResponse = await fetch(`${SERVER_URL}/api/users`);
                const users = await usersResponse.json();
                
                // –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
                const statusResponse = await fetch(`${SERVER_URL}/api/status`);
                const status = await statusResponse.json();
                
                showResult('data-loading-result', `
                    <strong>‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!</strong><br>
                    <strong>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏:</strong> ${teachers.length}<br>
                    <strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:</strong> ${users.length}<br>
                    <strong>–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞:</strong> ${status.status}<br>
                    <strong>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</strong> ${status.connectedClients}
                `, 'success');
                
                log(`‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã: ${teachers.length} –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π, ${users.length} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π`);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
                displayTeachers(teachers);
                
            } catch (error) {
                showResult('data-loading-result', `‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ${error.message}`, 'error');
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ${error.message}`, 'error');
            }
        }

        function displayTeachers(teachers) {
            const container = document.getElementById('teachers-display');
            
            if (teachers.length === 0) {
                container.innerHTML = '<div class="status info">‚ö†Ô∏è –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            const teachersHtml = teachers.map(teacher => `
                <div class="teacher-card">
                    <h4>${teacher.name}</h4>
                    <p><strong>ID:</strong> ${teacher.id}</p>
                    <p><strong>–ü—Ä–µ–¥–º–µ—Ç—ã:</strong> ${teacher.profile?.subjects?.join(', ') || '–ù–µ —É–∫–∞–∑–∞–Ω—ã'}</p>
                    <p><strong>–û–ø—ã—Ç:</strong> ${teacher.profile?.experience || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                    <p><strong>–†–µ–π—Ç–∏–Ω–≥:</strong> ${teacher.profile?.rating || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                </div>
            `).join('');
            
            container.innerHTML = `
                <div class="status success">
                    <strong>‚úÖ –ù–∞–π–¥–µ–Ω–æ ${teachers.length} –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π</strong>
                </div>
                ${teachersHtml}
            `;
        }

        function testConfiguration() {
            log('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...');
            
            const config = {
                serverUrl: SERVER_URL,
                userAgent: navigator.userAgent,
                language: navigator.language,
                cookiesEnabled: navigator.cookieEnabled,
                online: navigator.onLine,
                platform: navigator.platform
            };
            
            showResult('config-result', `
                <strong>‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞</strong><br>
                <strong>–°–µ—Ä–≤–µ—Ä:</strong> ${config.serverUrl}<br>
                <strong>–ë—Ä–∞—É–∑–µ—Ä:</strong> ${config.userAgent.split(' ')[0]}<br>
                <strong>–Ø–∑—ã–∫:</strong> ${config.language}<br>
                <strong>Cookies:</strong> ${config.cookiesEnabled ? '–í–∫–ª—é—á–µ–Ω—ã' : '–û—Ç–∫–ª—é—á–µ–Ω—ã'}<br>
                <strong>–û–Ω–ª–∞–π–Ω:</strong> ${config.online ? '–î–∞' : '–ù–µ—Ç'}<br>
                <strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</strong> ${config.platform}
            `, 'success');
            
            log(`‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: ${config.serverUrl}, –æ–Ω–ª–∞–π–Ω: ${config.online}`);
        }

        function testNetwork() {
            log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏...');
            
            const startTime = Date.now();
            
            fetch(`${SERVER_URL}/api/status`)
                .then(response => {
                    const endTime = Date.now();
                    const responseTime = endTime - startTime;
                    
                    showResult('network-result', `
                        <strong>‚úÖ –°–µ—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç</strong><br>
                        <strong>–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞:</strong> ${responseTime}ms<br>
                        <strong>–°—Ç–∞—Ç—É—Å:</strong> ${response.status}<br>
                        <strong>–¢–∏–ø:</strong> ${response.type}<br>
                        <strong>URL:</strong> ${response.url}
                    `, 'success');
                    
                    log(`‚úÖ –°–µ—Ç—å: –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ ${responseTime}ms, —Å—Ç–∞—Ç—É—Å ${response.status}`);
                })
                .catch(error => {
                    showResult('network-result', `‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`, 'error');
                    log(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`, 'error');
                });
        }

        async function testAll() {
            log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞...');
            
            testConfiguration();
            testNetwork();
            await testDataLoading();
            
            log('‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!');
        }

        function clearResults() {
            document.getElementById('data-loading-result').innerHTML = '';
            document.getElementById('teachers-display').innerHTML = '';
            document.getElementById('config-result').innerHTML = '';
            document.getElementById('network-result').innerHTML = '';
            logs = [];
            document.getElementById('logs').innerHTML = '';
            log('üóëÔ∏è –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—á–∏—â–µ–Ω—ã');
        }

        function openMainApp() {
            log('–û—Ç–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            window.open('https://na-uchi.onrender.com/', '_blank');
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            log('üåê –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            testAll();
        };
    </script>
</body>
</html>
